# AOT ID: ['3_inference']
from ctypes import c_void_p, c_long, c_int
import torch
import math
import random
import os
import tempfile
from math import inf, nan
from torch._inductor.hooks import run_intermediate_hooks
from torch._inductor.utils import maybe_profile
from torch._inductor.codegen.memory_planning import _align as align
from torch import device, empty_strided
from torch._inductor.async_compile import AsyncCompile
from torch._inductor.select_algorithm import extern_kernels
from torch._inductor.codegen.multi_kernel import MultiKernelCall

aten = torch.ops.aten
inductor_ops = torch.ops.inductor
_quantized = torch.ops._quantized
assert_size_stride = torch._C._dynamo.guards.assert_size_stride
empty_strided_cpu = torch._C._dynamo.guards._empty_strided_cpu
empty_strided_cuda = torch._C._dynamo.guards._empty_strided_cuda
empty_strided_xpu = torch._C._dynamo.guards._empty_strided_xpu
reinterpret_tensor = torch._C._dynamo.guards._reinterpret_tensor
alloc_from_pool = torch.ops.inductor._alloc_from_pool
async_compile = AsyncCompile()
_frozen_param8 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f422e80ade0
_frozen_param9 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f422e80b060
_frozen_param14 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f422e80bf60
_frozen_param15 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f422e80ad40
_frozen_param24 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f422e80b510
_frozen_param25 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f422e80b420
_frozen_param30 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f422e80b9c0
_frozen_param31 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f422e80ba10
_frozen_param40 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f422e80aed0
_frozen_param41 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f422e80ad90
_frozen_param46 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f422e80b2e0
_frozen_param47 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f422e80b3d0
_frozen_param56 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214744ef0
_frozen_param57 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214745080
_frozen_param62 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214744d10
_frozen_param63 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f42147452b0
_frozen_param72 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214745300
_frozen_param73 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f42147445e0
_frozen_param78 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214745940
_frozen_param79 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f42147458f0
_frozen_param88 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214745e90
_frozen_param89 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214745ee0
_frozen_param94 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214745b70
_frozen_param95 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f42147460c0
_frozen_param104 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214746660
_frozen_param105 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214746110
_frozen_param110 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214746700
_frozen_param111 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214746020
_frozen_param120 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214744860
_frozen_param121 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214746200
_frozen_param126 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214746340
_frozen_param127 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f42147453f0
_frozen_param136 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214746ca0
_frozen_param137 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214746cf0
_frozen_param142 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214746e30
_frozen_param143 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214746de0
_frozen_param152 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214747380
_frozen_param153 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f42147473d0
_frozen_param158 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214747510
_frozen_param159 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f42147474c0
_frozen_param168 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214747a60
_frozen_param169 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214747ab0
_frozen_param174 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214747bf0
_frozen_param175 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f4214747ba0
_frozen_param184 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f41e927c220
_frozen_param185 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f41e927c1d0
_frozen_param190 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f41e927c310
_frozen_param191 = None  # device(type='cpu') torch.float32 (768,) (1,) 7f41e927c270
_frozen_param192 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413fe1e0c0
_frozen_param336 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f413fff6660
_frozen_param194 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413ffc4fe0
_frozen_param337 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f413fd55760
_frozen_param196 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f41400d8090
_frozen_param338 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f413fdc8b30
_frozen_param198 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f41400c2ed0
_frozen_param339 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f413fe3f330
_frozen_param200 = None  # device(type='cpu') torch.bfloat16 (3072,) (1,) 7f413ff4cd60
_frozen_param340 = None  # device(type='cpu') torch.bfloat16 (3072, 768) (1, 0) 7f4140037ec0
_frozen_param202 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f41400ece00
_frozen_param341 = None  # device(type='cpu') torch.bfloat16 (768, 3072) (1, 0) 7f413ff3b060
_frozen_param204 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413ff0a610
_frozen_param342 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f41400acf90
_frozen_param206 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413ff383b0
_frozen_param343 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f41401ef970
_frozen_param208 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413ff80400
_frozen_param344 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f413fecbec0
_frozen_param210 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413ff63e20
_frozen_param345 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f41402ad530
_frozen_param212 = None  # device(type='cpu') torch.bfloat16 (3072,) (1,) 7f413ff62840
_frozen_param346 = None  # device(type='cpu') torch.bfloat16 (3072, 768) (1, 0) 7f4140035260
_frozen_param214 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413ffab7e0
_frozen_param347 = None  # device(type='cpu') torch.bfloat16 (768, 3072) (1, 0) 7f413fefe7f0
_frozen_param216 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413fd54540
_frozen_param348 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f413fe9aac0
_frozen_param218 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413fff7c40
_frozen_param349 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f413ff4e6b0
_frozen_param220 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413fe3dfd0
_frozen_param350 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140162700
_frozen_param222 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413fe6bec0
_frozen_param351 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f41401ee9d0
_frozen_param224 = None  # device(type='cpu') torch.bfloat16 (3072,) (1,) 7f413fe80900
_frozen_param352 = None  # device(type='cpu') torch.bfloat16 (3072, 768) (1, 0) 7f41400efe70
_frozen_param226 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413fd22cf0
_frozen_param353 = None  # device(type='cpu') torch.bfloat16 (768, 3072) (1, 0) 7f41401603b0
_frozen_param228 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413feaee30
_frozen_param354 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f413ff09bc0
_frozen_param230 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413fd6d530
_frozen_param355 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f41400ee110
_frozen_param232 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413fefdda0
_frozen_param356 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f413ff818a0
_frozen_param234 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413fd3e1b0
_frozen_param357 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f413ff81d00
_frozen_param236 = None  # device(type='cpu') torch.bfloat16 (3072,) (1,) 7f413fd80fe0
_frozen_param358 = None  # device(type='cpu') torch.bfloat16 (3072, 768) (1, 0) 7f413feac090
_frozen_param238 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f41406a1e40
_frozen_param359 = None  # device(type='cpu') torch.bfloat16 (768, 3072) (1, 0) 7f413fe1f7e0
_frozen_param240 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413fd82ca0
_frozen_param360 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f413fe1f010
_frozen_param242 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f413fd9a5c0
_frozen_param361 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f414027c0e0
_frozen_param244 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f41400ae110
_frozen_param362 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140137560
_frozen_param246 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f41400974c0
_frozen_param363 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140065030
_frozen_param248 = None  # device(type='cpu') torch.bfloat16 (3072,) (1,) 7f4140097600
_frozen_param364 = None  # device(type='cpu') torch.bfloat16 (3072, 768) (1, 0) 7f4140066c00
_frozen_param250 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f41400972e0
_frozen_param365 = None  # device(type='cpu') torch.bfloat16 (768, 3072) (1, 0) 7f414029fdd0
_frozen_param252 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f4140096d40
_frozen_param366 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f414029eca0
_frozen_param254 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f4140096c00
_frozen_param367 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f414029e930
_frozen_param256 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f4140096750
_frozen_param368 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f414029fce0
_frozen_param258 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f4140096a20
_frozen_param369 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f413fe1f5b0
_frozen_param260 = None  # device(type='cpu') torch.bfloat16 (3072,) (1,) 7f4140096520
_frozen_param370 = None  # device(type='cpu') torch.bfloat16 (3072, 768) (1, 0) 7f41402700e0
_frozen_param262 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f41400960c0
_frozen_param371 = None  # device(type='cpu') torch.bfloat16 (768, 3072) (1, 0) 7f4140270360
_frozen_param264 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f4140095ad0
_frozen_param372 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f41402703b0
_frozen_param266 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f41400958f0
_frozen_param373 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f41402709a0
_frozen_param268 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f41400953f0
_frozen_param374 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140272ed0
_frozen_param270 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f4140095620
_frozen_param375 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140272e30
_frozen_param272 = None  # device(type='cpu') torch.bfloat16 (3072,) (1,) 7f41400951c0
_frozen_param376 = None  # device(type='cpu') torch.bfloat16 (3072, 768) (1, 0) 7f4140273ec0
_frozen_param274 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f4140094d60
_frozen_param377 = None  # device(type='cpu') torch.bfloat16 (768, 3072) (1, 0) 7f4140273a60
_frozen_param276 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f4140094950
_frozen_param378 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140273e70
_frozen_param278 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f4140094400
_frozen_param379 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140273f10
_frozen_param280 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f4140094130
_frozen_param380 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140273b00
_frozen_param282 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f41400941d0
_frozen_param381 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140273ce0
_frozen_param284 = None  # device(type='cpu') torch.bfloat16 (3072,) (1,) 7f414007ff60
_frozen_param382 = None  # device(type='cpu') torch.bfloat16 (3072, 768) (1, 0) 7f4140273c40
_frozen_param286 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007fab0
_frozen_param383 = None  # device(type='cpu') torch.bfloat16 (768, 3072) (1, 0) 7f4140273c90
_frozen_param288 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007f4c0
_frozen_param384 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140273bf0
_frozen_param290 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007f420
_frozen_param385 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140272cf0
_frozen_param292 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007e520
_frozen_param386 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140273920
_frozen_param294 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007f060
_frozen_param387 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f41402739c0
_frozen_param296 = None  # device(type='cpu') torch.bfloat16 (3072,) (1,) 7f414007ecf0
_frozen_param388 = None  # device(type='cpu') torch.bfloat16 (3072, 768) (1, 0) 7f4140273740
_frozen_param298 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007eb10
_frozen_param389 = None  # device(type='cpu') torch.bfloat16 (768, 3072) (1, 0) 7f41402737e0
_frozen_param300 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007e480
_frozen_param390 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140273790
_frozen_param302 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007e340
_frozen_param391 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140273560
_frozen_param304 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007ddf0
_frozen_param392 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140273600
_frozen_param306 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007d6c0
_frozen_param393 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f41402735b0
_frozen_param308 = None  # device(type='cpu') torch.bfloat16 (3072,) (1,) 7f414007dc60
_frozen_param394 = None  # device(type='cpu') torch.bfloat16 (3072, 768) (1, 0) 7f4140273380
_frozen_param310 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007d760
_frozen_param395 = None  # device(type='cpu') torch.bfloat16 (768, 3072) (1, 0) 7f4140273420
_frozen_param312 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007d300
_frozen_param396 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f41402733d0
_frozen_param314 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007d0d0
_frozen_param397 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140273150
_frozen_param316 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007cd60
_frozen_param398 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f41402731f0
_frozen_param318 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007ccc0
_frozen_param399 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f41402731a0
_frozen_param320 = None  # device(type='cpu') torch.bfloat16 (3072,) (1,) 7f414007cb80
_frozen_param400 = None  # device(type='cpu') torch.bfloat16 (3072, 768) (1, 0) 7f4140272de0
_frozen_param322 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007c4f0
_frozen_param401 = None  # device(type='cpu') torch.bfloat16 (768, 3072) (1, 0) 7f4140272fc0
_frozen_param324 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007c130
_frozen_param402 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140272b60
_frozen_param326 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f414007c1d0
_frozen_param403 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140272f20
_frozen_param328 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f4140067a10
_frozen_param404 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140272f70
_frozen_param330 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f4140067b00
_frozen_param405 = None  # device(type='cpu') torch.bfloat16 (768, 768) (1, 0) 7f4140272520
_frozen_param332 = None  # device(type='cpu') torch.bfloat16 (3072,) (1,) 7f4140067600
_frozen_param406 = None  # device(type='cpu') torch.bfloat16 (3072, 768) (1, 0) 7f4140272d40
_frozen_param334 = None  # device(type='cpu') torch.bfloat16 (768,) (1,) 7f4140067290
_frozen_param407 = None  # device(type='cpu') torch.bfloat16 (768, 3072) (1, 0) 7f4140272c00


cpp_fused__to_copy_0 = async_compile.cpp_pybinding(['const float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const float* in_ptr0,
                       bfloat16* out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<float>::loadu(in_ptr0 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<bfloat16>(tmp0);
                tmp1.store(out_ptr0 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_1 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<float>(tmp0);
                auto tmp2 = static_cast<float>(0.125);
                auto tmp3 = at::vec::Vectorized<float>(tmp2);
                auto tmp4 = tmp1 * tmp3;
                auto tmp5 = at::vec::convert<bfloat16>(tmp4);
                tmp5.store(in_out_ptr0 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_2 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(32L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 32);
                tmp0.store(in_out_ptr0 + static_cast<int64_t>(x0), 32);
            }
        }
    }
}
''')


cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_view_where_3 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'float*', 'float*', 'float*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2,
                       bfloat16* out_ptr3,
                       bfloat16* out_ptr4,
                       bfloat16* out_ptr5,
                       bfloat16* out_ptr6,
                       bfloat16* out_ptr7,
                       bfloat16* out_ptr8,
                       float* out_ptr9,
                       float* out_ptr10,
                       float* out_ptr11)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(2L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = at::vec::VectorizedN<int64_t,2>::arange(tmp5, 1);
                            auto tmp7 = static_cast<int64_t>(256);
                            auto tmp8 = at::vec::VectorizedN<int64_t,2>(tmp7);
                            auto tmp9 = at::vec::VecMask<int64_t,2>(tmp6 >= tmp8);
                            auto tmp10 = [&]
                            {
                                auto tmp11 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                    {
                                        if (tmp9.is_masked(x3_inner))
                                        {
                                            tmpbuf[x3_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp12 = static_cast<int64_t>(512);
                                auto tmp13 = at::vec::VectorizedN<int64_t,2>(tmp12);
                                auto tmp14 = at::vec::VecMask<int64_t,2>(tmp11 < tmp13);
                                auto tmp16 = tmp14 & tmp9;
                                auto tmp15 = [&]
                                {
                                    auto tmp17 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp16.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>(131072L + x3 + x3_inner + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp18 = at::vec::convert<float>(tmp17);
                                    return tmp18;
                                }
                                ;
                                auto tmp21 =
                                [&]
                                {
                                    if (tmp16.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp19 = tmp15();
                                        auto tmp20 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp19)::blendv(tmp20, tmp19, tmp16.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp21;
                            }
                            ;
                            auto tmp24 =
                            [&]
                            {
                                if (tmp9.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp22 = tmp10();
                                    auto tmp23 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp22)::blendv(tmp23, tmp22, tmp9.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp25 = static_cast<int64_t>(1);
                            auto tmp26 = tmp25 < tmp25;
                            auto tmp27 = [&]
                            {
                                auto tmp29 = at::vec::VecMask<float,1>::from(tmp26);
                                auto tmp30 = tmp9 & tmp29;
                                auto tmp28 = [&]
                                {
                                    auto tmp31 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp30.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp32 = static_cast<int64_t>(512);
                                    auto tmp33 = at::vec::VectorizedN<int64_t,2>(tmp32);
                                    auto tmp34 = at::vec::VecMask<int64_t,2>(tmp31 < tmp33);
                                    auto tmp36 = tmp34 & tmp30;
                                    auto tmp35 = [&]
                                    {
                                        auto tmp37 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp36.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp38 = at::vec::convert<float>(tmp37);
                                        return tmp38;
                                    }
                                    ;
                                    auto tmp41 =
                                    [&]
                                    {
                                        if (tmp36.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp39 = tmp35();
                                            auto tmp40 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp39)::blendv(tmp40, tmp39, tmp36.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp41;
                                }
                                ;
                                auto tmp44 =
                                [&]
                                {
                                    if (tmp30.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp42 = tmp28();
                                        auto tmp43 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp42)::blendv(tmp43, tmp42, tmp30.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp45 = static_cast<float>(0.0);
                                auto tmp46 = at::vec::Vectorized<float>(tmp45);
                                auto tmp47 = decltype(tmp44)::blendv(tmp46, tmp44, tmp9.template cast<float,1>());
                                return tmp47;
                            }
                            ;
                            auto tmp48 = tmp26 ? tmp27() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp49 = static_cast<float>(0.0);
                            auto tmp50 = at::vec::VecMask<float,1>::from(tmp26);
                            auto tmp51 = at::vec::Vectorized<float>(tmp49);
                            auto tmp52 = decltype(tmp48)::blendv(tmp51, tmp48, tmp50.template cast<float,1>());
                            auto tmp53 = decltype(tmp24)::blendv(tmp52, tmp24, tmp9.template cast<float,1>());
                            auto tmp54 = c10::convert<int64_t>(tmp0);
                            auto tmp55 = tmp54 < tmp25;
                            auto tmp56 = [&]
                            {
                                auto tmp58 = at::vec::VecMask<float,1>::from(tmp55);
                                auto tmp59 = tmp9 & tmp58;
                                auto tmp57 = [&]
                                {
                                    auto tmp60 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp59.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp61 = static_cast<int64_t>(512);
                                    auto tmp62 = at::vec::VectorizedN<int64_t,2>(tmp61);
                                    auto tmp63 = at::vec::VecMask<int64_t,2>(tmp60 < tmp62);
                                    auto tmp65 = tmp63 & tmp59;
                                    auto tmp64 = [&]
                                    {
                                        auto tmp66 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp65.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp67 = at::vec::convert<float>(tmp66);
                                        return tmp67;
                                    }
                                    ;
                                    auto tmp70 =
                                    [&]
                                    {
                                        if (tmp65.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp68 = tmp64();
                                            auto tmp69 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp68)::blendv(tmp69, tmp68, tmp65.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp70;
                                }
                                ;
                                auto tmp73 =
                                [&]
                                {
                                    if (tmp59.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp71 = tmp57();
                                        auto tmp72 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp71)::blendv(tmp72, tmp71, tmp59.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp74 = decltype(tmp73)::blendv(tmp51, tmp73, tmp9.template cast<float,1>());
                                return tmp74;
                            }
                            ;
                            auto tmp75 = tmp55 ? tmp56() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp76 = at::vec::VecMask<float,1>::from(tmp55);
                            auto tmp77 = decltype(tmp75)::blendv(tmp51, tmp75, tmp76.template cast<float,1>());
                            auto tmp78 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp79 = decltype(tmp53)::blendv(tmp77, tmp53, tmp78.template cast<float,1>());
                            auto tmp80 = at::vec::convert<bfloat16>(tmp79);
                            tmp80.store(out_ptr0 + static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(256);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + (513L*x1))), static_cast<int64_t>(512L)));
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = static_cast<int64_t>(512);
                                auto tmp12 = tmp10 < tmp11;
                                auto tmp13 = [&]
                                {
                                    auto tmp14 = in_ptr0[static_cast<int64_t>(131072L + x3 + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                    auto tmp15 = c10::convert<float>(tmp14);
                                    return tmp15;
                                }
                                ;
                                auto tmp16 = tmp12 ? tmp13() : static_cast<decltype(tmp13())>(0.0);
                                return tmp16;
                            }
                            ;
                            auto tmp17 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp18 = static_cast<int64_t>(1);
                            auto tmp19 = tmp18 < tmp18;
                            auto tmp20 = [&]
                            {
                                auto tmp21 = [&]
                                {
                                    auto tmp22 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp23 = c10::convert<int64_t>(tmp22);
                                    auto tmp24 = static_cast<int64_t>(512);
                                    auto tmp25 = tmp23 < tmp24;
                                    auto tmp26 = [&]
                                    {
                                        auto tmp27 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                        auto tmp28 = c10::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp29 = tmp25 ? tmp26() : static_cast<decltype(tmp26())>(0.0);
                                    return tmp29;
                                }
                                ;
                                auto tmp30 = tmp7 ? tmp21() : static_cast<decltype(tmp21())>(0.0);
                                auto tmp31 = static_cast<float>(0.0);
                                auto tmp32 = tmp7 ? tmp30 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                            auto tmp34 = static_cast<float>(0.0);
                            auto tmp35 = tmp19 ? tmp33 : tmp34;
                            auto tmp36 = tmp7 ? tmp17 : tmp35;
                            auto tmp37 = c10::convert<int64_t>(tmp0);
                            auto tmp38 = tmp37 < tmp18;
                            auto tmp39 = [&]
                            {
                                auto tmp40 = [&]
                                {
                                    auto tmp41 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp42 = c10::convert<int64_t>(tmp41);
                                    auto tmp43 = static_cast<int64_t>(512);
                                    auto tmp44 = tmp42 < tmp43;
                                    auto tmp45 = [&]
                                    {
                                        auto tmp46 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                        auto tmp47 = c10::convert<float>(tmp46);
                                        return tmp47;
                                    }
                                    ;
                                    auto tmp48 = tmp44 ? tmp45() : static_cast<decltype(tmp45())>(0.0);
                                    return tmp48;
                                }
                                ;
                                auto tmp49 = tmp7 ? tmp40() : static_cast<decltype(tmp40())>(0.0);
                                auto tmp50 = tmp7 ? tmp49 : tmp34;
                                return tmp50;
                            }
                            ;
                            auto tmp51 = tmp38 ? tmp39() : static_cast<decltype(tmp39())>(0.0);
                            auto tmp52 = tmp38 ? tmp51 : tmp34;
                            auto tmp53 = tmp3 ? tmp36 : tmp52;
                            auto tmp54 = c10::convert<bfloat16>(tmp53);
                            out_ptr0[static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0))] = tmp54;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(256L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp96 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp132 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = at::vec::VectorizedN<int64_t,2>::arange(tmp10, 1);
                                auto tmp12 = at::vec::VectorizedN<int64_t,2>(tmp6);
                                auto tmp13 = at::vec::VecMask<int64_t,2>(tmp11 >= tmp12);
                                auto tmp14 = static_cast<int64_t>(256);
                                auto tmp15 = at::vec::VectorizedN<int64_t,2>(tmp14);
                                auto tmp16 = at::vec::VecMask<int64_t,2>(tmp11 < tmp15);
                                auto tmp17 = tmp13 & tmp16;
                                auto tmp19 = at::vec::VecMask<float,1>::from(tmp7);
                                auto tmp20 = tmp17 & tmp19;
                                auto tmp18 = [&]
                                {
                                    auto tmp21 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp20.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp22 = static_cast<int64_t>(512);
                                    auto tmp23 = at::vec::VectorizedN<int64_t,2>(tmp22);
                                    auto tmp24 = at::vec::VecMask<int64_t,2>(tmp21 < tmp23);
                                    auto tmp26 = tmp24 & tmp20;
                                    auto tmp25 = [&]
                                    {
                                        auto tmp27 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp26.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp28 = at::vec::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp31 =
                                    [&]
                                    {
                                        if (tmp26.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp29 = tmp25();
                                            auto tmp30 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp31;
                                }
                                ;
                                auto tmp34 =
                                [&]
                                {
                                    if (tmp20.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp32 = tmp18();
                                        auto tmp33 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp32)::blendv(tmp33, tmp32, tmp20.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp35 = static_cast<int64_t>(0);
                                auto tmp36 = tmp35 >= tmp6;
                                auto tmp38 = tmp36 & tmp7;
                                auto tmp37 = [&]
                                {
                                    auto tmp40 = at::vec::VecMask<float,1>::from(tmp38);
                                    auto tmp41 = tmp16 & tmp40;
                                    auto tmp39 = [&]
                                    {
                                        auto tmp42 =
                                        [&]
                                        {
                                            __at_align__ std::array<int64_t, 16> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp41.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                                }
                                            }
                                            return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp43 = static_cast<int64_t>(512);
                                        auto tmp44 = at::vec::VectorizedN<int64_t,2>(tmp43);
                                        auto tmp45 = at::vec::VecMask<int64_t,2>(tmp42 < tmp44);
                                        auto tmp47 = tmp45 & tmp41;
                                        auto tmp46 = [&]
                                        {
                                            auto tmp48 =
                                            [&]
                                            {
                                                __at_align__ std::array<bfloat16, 32> tmpbuf;
                                                #pragma GCC unroll 16
                                                for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                                {
                                                    if (tmp47.is_masked(x3_inner))
                                                    {
                                                        tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                    }
                                                }
                                                return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                            }
                                            ()
                                            ;
                                            auto tmp49 = at::vec::convert<float>(tmp48);
                                            return tmp49;
                                        }
                                        ;
                                        auto tmp52 =
                                        [&]
                                        {
                                            if (tmp47.all_zero())
                                            {
                                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            }
                                            else
                                            {
                                                auto tmp50 = tmp46();
                                                auto tmp51 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                                return decltype(tmp50)::blendv(tmp51, tmp50, tmp47.template cast<float,1>());
                                            }
                                        }
                                        ()
                                        ;
                                        return tmp52;
                                    }
                                    ;
                                    auto tmp55 =
                                    [&]
                                    {
                                        if (tmp41.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp53 = tmp39();
                                            auto tmp54 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp53)::blendv(tmp54, tmp53, tmp41.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    auto tmp56 = at::vec::VecMask<float,1>::from(tmp38).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                    auto tmp57 = at::vec::convert<float>(tmp56);
                                    auto tmp58 = decltype(tmp55)::blendv(tmp57, tmp55, tmp16.template cast<float,1>());
                                    return tmp58;
                                }
                                ;
                                auto tmp59 = tmp36 ? tmp37() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                                auto tmp60 = at::vec::VecMask<float,1>::from(tmp7).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp61 = at::vec::convert<float>(tmp60);
                                auto tmp62 = at::vec::VecMask<float,1>::from(tmp36);
                                auto tmp63 = decltype(tmp59)::blendv(tmp61, tmp59, tmp62.template cast<float,1>());
                                auto tmp64 = decltype(tmp34)::blendv(tmp63, tmp34, tmp17.template cast<float,1>());
                                return tmp64;
                            }
                            ;
                            auto tmp65 = tmp7 ? tmp8() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp66 = static_cast<int64_t>(0);
                            auto tmp67 = tmp66 >= tmp6;
                            auto tmp68 = [&]
                            {
                                auto tmp69 = x3;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(256);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 < tmp73);
                                auto tmp76 = at::vec::VecMask<float,1>::from(tmp67);
                                auto tmp77 = tmp74 & tmp76;
                                auto tmp75 = [&]
                                {
                                    auto tmp78 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp77.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp79 = static_cast<int64_t>(512);
                                    auto tmp80 = at::vec::VectorizedN<int64_t,2>(tmp79);
                                    auto tmp81 = at::vec::VecMask<int64_t,2>(tmp78 < tmp80);
                                    auto tmp83 = tmp81 & tmp77;
                                    auto tmp82 = [&]
                                    {
                                        auto tmp84 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp83.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp85 = at::vec::convert<float>(tmp84);
                                        return tmp85;
                                    }
                                    ;
                                    auto tmp88 =
                                    [&]
                                    {
                                        if (tmp83.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp86 = tmp82();
                                            auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp86)::blendv(tmp87, tmp86, tmp83.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp88;
                                }
                                ;
                                auto tmp91 =
                                [&]
                                {
                                    if (tmp77.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp89 = tmp75();
                                        auto tmp90 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp89)::blendv(tmp90, tmp89, tmp77.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp92 = at::vec::VecMask<float,1>::from(tmp67).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp93 = at::vec::convert<float>(tmp92);
                                auto tmp94 = decltype(tmp91)::blendv(tmp93, tmp91, tmp74.template cast<float,1>());
                                return tmp94;
                            }
                            ;
                            auto tmp95 = tmp67 ? tmp68() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp97 = at::vec::convert<float>(tmp96);
                            auto tmp98 = at::vec::VecMask<float,1>::from(tmp67);
                            auto tmp99 = decltype(tmp95)::blendv(tmp97, tmp95, tmp98.template cast<float,1>());
                            auto tmp100 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp101 = decltype(tmp65)::blendv(tmp99, tmp65, tmp100.template cast<float,1>());
                            auto tmp102 = c10::convert<int64_t>(tmp0);
                            auto tmp103 = tmp102 >= tmp6;
                            auto tmp104 = [&]
                            {
                                auto tmp105 = x3;
                                auto tmp106 = c10::convert<int64_t>(tmp105);
                                auto tmp107 = at::vec::VectorizedN<int64_t,2>::arange(tmp106, 1);
                                auto tmp108 = static_cast<int64_t>(256);
                                auto tmp109 = at::vec::VectorizedN<int64_t,2>(tmp108);
                                auto tmp110 = at::vec::VecMask<int64_t,2>(tmp107 < tmp109);
                                auto tmp112 = at::vec::VecMask<float,1>::from(tmp103);
                                auto tmp113 = tmp110 & tmp112;
                                auto tmp111 = [&]
                                {
                                    auto tmp114 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp113.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp115 = static_cast<int64_t>(512);
                                    auto tmp116 = at::vec::VectorizedN<int64_t,2>(tmp115);
                                    auto tmp117 = at::vec::VecMask<int64_t,2>(tmp114 < tmp116);
                                    auto tmp119 = tmp117 & tmp113;
                                    auto tmp118 = [&]
                                    {
                                        auto tmp120 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp119.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp121 = at::vec::convert<float>(tmp120);
                                        return tmp121;
                                    }
                                    ;
                                    auto tmp124 =
                                    [&]
                                    {
                                        if (tmp119.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp122 = tmp118();
                                            auto tmp123 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp122)::blendv(tmp123, tmp122, tmp119.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp124;
                                }
                                ;
                                auto tmp127 =
                                [&]
                                {
                                    if (tmp113.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp125 = tmp111();
                                        auto tmp126 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp125)::blendv(tmp126, tmp125, tmp113.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp128 = at::vec::VecMask<float,1>::from(tmp103).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp129 = at::vec::convert<float>(tmp128);
                                auto tmp130 = decltype(tmp127)::blendv(tmp129, tmp127, tmp110.template cast<float,1>());
                                return tmp130;
                            }
                            ;
                            auto tmp131 = tmp103 ? tmp104() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp133 = at::vec::convert<float>(tmp132);
                            auto tmp134 = at::vec::VecMask<float,1>::from(tmp103);
                            auto tmp135 = decltype(tmp131)::blendv(tmp133, tmp131, tmp134.template cast<float,1>());
                            auto tmp136 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp137 = decltype(tmp101)::blendv(tmp135, tmp101, tmp136.template cast<float,1>());
                            auto tmp138 = at::vec::convert<bfloat16>(tmp137);
                            tmp138.store(out_ptr1 + static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp68 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                            auto tmp93 = out_ptr0[static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0))];
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = tmp10 >= tmp6;
                                auto tmp12 = static_cast<int64_t>(256);
                                auto tmp13 = tmp10 < tmp12;
                                auto tmp14 = tmp11 & tmp13;
                                auto tmp15 = [&]
                                {
                                    auto tmp16 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp17 = c10::convert<int64_t>(tmp16);
                                    auto tmp18 = static_cast<int64_t>(512);
                                    auto tmp19 = tmp17 < tmp18;
                                    auto tmp20 = [&]
                                    {
                                        auto tmp21 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                        auto tmp22 = c10::convert<float>(tmp21);
                                        return tmp22;
                                    }
                                    ;
                                    auto tmp23 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                                    return tmp23;
                                }
                                ;
                                auto tmp24 = tmp14 ? tmp15() : static_cast<decltype(tmp15())>(0.0);
                                auto tmp25 = static_cast<int64_t>(0);
                                auto tmp26 = tmp25 >= tmp6;
                                auto tmp27 = [&]
                                {
                                    auto tmp28 = [&]
                                    {
                                        auto tmp29 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                        auto tmp30 = c10::convert<int64_t>(tmp29);
                                        auto tmp31 = static_cast<int64_t>(512);
                                        auto tmp32 = tmp30 < tmp31;
                                        auto tmp33 = [&]
                                        {
                                            auto tmp34 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                            auto tmp35 = c10::convert<float>(tmp34);
                                            return tmp35;
                                        }
                                        ;
                                        auto tmp36 = tmp32 ? tmp33() : static_cast<decltype(tmp33())>(0.0);
                                        return tmp36;
                                    }
                                    ;
                                    auto tmp37 = tmp13 ? tmp28() : static_cast<decltype(tmp28())>(0.0);
                                    auto tmp38 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                    auto tmp39 = c10::convert<float>(tmp38);
                                    auto tmp40 = tmp13 ? tmp37 : tmp39;
                                    return tmp40;
                                }
                                ;
                                auto tmp41 = tmp26 ? tmp27() : static_cast<decltype(tmp27())>(0.0);
                                auto tmp42 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp43 = c10::convert<float>(tmp42);
                                auto tmp44 = tmp26 ? tmp41 : tmp43;
                                auto tmp45 = tmp14 ? tmp24 : tmp44;
                                return tmp45;
                            }
                            ;
                            auto tmp46 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp47 = static_cast<int64_t>(0);
                            auto tmp48 = tmp47 >= tmp6;
                            auto tmp49 = [&]
                            {
                                auto tmp50 = x3;
                                auto tmp51 = c10::convert<int64_t>(tmp50);
                                auto tmp52 = static_cast<int64_t>(256);
                                auto tmp53 = tmp51 < tmp52;
                                auto tmp54 = [&]
                                {
                                    auto tmp55 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp56 = c10::convert<int64_t>(tmp55);
                                    auto tmp57 = static_cast<int64_t>(512);
                                    auto tmp58 = tmp56 < tmp57;
                                    auto tmp59 = [&]
                                    {
                                        auto tmp60 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp61 = c10::convert<float>(tmp60);
                                        return tmp61;
                                    }
                                    ;
                                    auto tmp62 = tmp58 ? tmp59() : static_cast<decltype(tmp59())>(0.0);
                                    return tmp62;
                                }
                                ;
                                auto tmp63 = tmp53 ? tmp54() : static_cast<decltype(tmp54())>(0.0);
                                auto tmp64 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp65 = c10::convert<float>(tmp64);
                                auto tmp66 = tmp53 ? tmp63 : tmp65;
                                return tmp66;
                            }
                            ;
                            auto tmp67 = tmp48 ? tmp49() : static_cast<decltype(tmp49())>(0.0);
                            auto tmp69 = c10::convert<float>(tmp68);
                            auto tmp70 = tmp48 ? tmp67 : tmp69;
                            auto tmp71 = tmp7 ? tmp46 : tmp70;
                            auto tmp72 = c10::convert<int64_t>(tmp0);
                            auto tmp73 = tmp72 >= tmp6;
                            auto tmp74 = [&]
                            {
                                auto tmp75 = x3;
                                auto tmp76 = c10::convert<int64_t>(tmp75);
                                auto tmp77 = static_cast<int64_t>(256);
                                auto tmp78 = tmp76 < tmp77;
                                auto tmp79 = [&]
                                {
                                    auto tmp80 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp81 = c10::convert<int64_t>(tmp80);
                                    auto tmp82 = static_cast<int64_t>(512);
                                    auto tmp83 = tmp81 < tmp82;
                                    auto tmp84 = [&]
                                    {
                                        auto tmp85 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp86 = c10::convert<float>(tmp85);
                                        return tmp86;
                                    }
                                    ;
                                    auto tmp87 = tmp83 ? tmp84() : static_cast<decltype(tmp84())>(0.0);
                                    return tmp87;
                                }
                                ;
                                auto tmp88 = tmp78 ? tmp79() : static_cast<decltype(tmp79())>(0.0);
                                auto tmp89 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp90 = c10::convert<float>(tmp89);
                                auto tmp91 = tmp78 ? tmp88 : tmp90;
                                return tmp91;
                            }
                            ;
                            auto tmp92 = tmp73 ? tmp74() : static_cast<decltype(tmp74())>(0.0);
                            auto tmp94 = c10::convert<float>(tmp93);
                            auto tmp95 = tmp73 ? tmp92 : tmp94;
                            auto tmp96 = tmp3 ? tmp71 : tmp95;
                            auto tmp97 = c10::convert<bfloat16>(tmp96);
                            out_ptr1[static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0))] = tmp97;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp93 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)), 16);
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(256);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 >= tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp8 = c10::convert<int64_t>(tmp7);
                            auto tmp9 = at::vec::VectorizedN<int64_t,2>::arange(tmp8, -1);
                            auto tmp10 = static_cast<int64_t>(0);
                            auto tmp11 = at::vec::VectorizedN<int64_t,2>(tmp10);
                            auto tmp12 = at::vec::VecMask<int64_t,2>(tmp9 <= tmp11);
                            auto tmp13 = static_cast<float>(1.0);
                            auto tmp14 = static_cast<float>(0.0);
                            auto tmp15 = at::vec::Vectorized<float>(tmp13);
                            auto tmp16 = at::vec::Vectorized<float>(tmp14);
                            auto tmp17 = decltype(tmp15)::blendv(tmp16, tmp15, tmp12.template cast<float,1>());
                            auto tmp18 = at::vec::VecMask<float,1>::from<float,1>(tmp17);
                            auto tmp19 = 256L + x1;
                            auto tmp20 = c10::convert<int64_t>(tmp19);
                            auto tmp21 = tmp20 < tmp3;
                            auto tmp23 = at::vec::VecMask<float,1>::from(tmp21);
                            auto tmp24 = tmp23 & tmp5;
                            auto tmp22 = [&]
                            {
                                auto tmp25 = static_cast<int64_t>(257);
                                auto tmp26 = at::vec::VectorizedN<int64_t,2>(tmp25);
                                auto tmp27 = at::vec::VecMask<int64_t,2>(tmp2 < tmp26);
                                auto tmp29 = tmp27 & tmp24;
                                auto tmp28 = [&]
                                {
                                    auto tmp30 = 1L + x1 + x2;
                                    auto tmp31 = c10::convert<int64_t>(tmp30);
                                    auto tmp32 = at::vec::VectorizedN<int64_t,2>::arange(tmp31, 1);
                                    auto tmp33 = at::vec::VecMask<int64_t,2>(tmp32 <= tmp11);
                                    auto tmp34 = decltype(tmp15)::blendv(tmp16, tmp15, tmp33.template cast<float,1>());
                                    auto tmp35 = at::vec::VecMask<float,1>::from<float,1>(tmp34);
                                    auto tmp36 = tmp29.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                    auto tmp37 = at::vec::convert<float>(tmp36);
                                    auto tmp38 = -std::numeric_limits<float>::infinity();
                                    auto tmp39 = at::vec::Vectorized<float>(tmp38);
                                    auto tmp40 = decltype(tmp39)::blendv(tmp37, tmp39, tmp35.template cast<float,1>());
                                    return tmp40;
                                }
                                ;
                                auto tmp43 =
                                [&]
                                {
                                    if (tmp29.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp41 = tmp28();
                                        auto tmp42 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp41)::blendv(tmp42, tmp41, tmp29.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp44 = tmp24.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp45 = at::vec::convert<float>(tmp44);
                                auto tmp46 = decltype(tmp43)::blendv(tmp45, tmp43, tmp27.template cast<float,1>());
                                return tmp46;
                            }
                            ;
                            auto tmp49 =
                            [&]
                            {
                                if (tmp24.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp47 = tmp22();
                                    auto tmp48 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp47)::blendv(tmp48, tmp47, tmp24.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp50 = tmp5.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp51 = at::vec::convert<float>(tmp50);
                            auto tmp52 = decltype(tmp49)::blendv(tmp51, tmp49, tmp23.template cast<float,1>());
                            auto tmp53 = -std::numeric_limits<float>::infinity();
                            auto tmp54 = at::vec::Vectorized<float>(tmp53);
                            auto tmp55 = decltype(tmp54)::blendv(tmp52, tmp54, tmp18.template cast<float,1>());
                            return tmp55;
                        }
                        ;
                        auto tmp58 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp56 = tmp6();
                                auto tmp57 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp56)::blendv(tmp57, tmp56, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp59 = 256L + x1;
                        auto tmp60 = c10::convert<int64_t>(tmp59);
                        auto tmp61 = tmp60 < tmp3;
                        auto tmp62 = [&]
                        {
                            auto tmp63 = static_cast<int64_t>(257);
                            auto tmp64 = at::vec::VectorizedN<int64_t,2>(tmp63);
                            auto tmp65 = at::vec::VecMask<int64_t,2>(tmp2 < tmp64);
                            auto tmp67 = at::vec::VecMask<float,1>::from(tmp61);
                            auto tmp68 = tmp65 & tmp67;
                            auto tmp66 = [&]
                            {
                                auto tmp69 = 1L + x1 + x2;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(0);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 <= tmp73);
                                auto tmp75 = static_cast<float>(1.0);
                                auto tmp76 = static_cast<float>(0.0);
                                auto tmp77 = at::vec::Vectorized<float>(tmp75);
                                auto tmp78 = at::vec::Vectorized<float>(tmp76);
                                auto tmp79 = decltype(tmp77)::blendv(tmp78, tmp77, tmp74.template cast<float,1>());
                                auto tmp80 = at::vec::VecMask<float,1>::from<float,1>(tmp79);
                                auto tmp81 = tmp68.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp82 = at::vec::convert<float>(tmp81);
                                auto tmp83 = -std::numeric_limits<float>::infinity();
                                auto tmp84 = at::vec::Vectorized<float>(tmp83);
                                auto tmp85 = decltype(tmp84)::blendv(tmp82, tmp84, tmp80.template cast<float,1>());
                                return tmp85;
                            }
                            ;
                            auto tmp88 =
                            [&]
                            {
                                if (tmp68.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp86 = tmp66();
                                    auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp86)::blendv(tmp87, tmp86, tmp68.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp89 = at::vec::VecMask<float,1>::from(tmp61).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp90 = at::vec::convert<float>(tmp89);
                            auto tmp91 = decltype(tmp88)::blendv(tmp90, tmp88, tmp65.template cast<float,1>());
                            return tmp91;
                        }
                        ;
                        auto tmp92 = tmp61 ? tmp62() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp94 = at::vec::convert<float>(tmp93);
                        auto tmp95 = at::vec::VecMask<float,1>::from(tmp61);
                        auto tmp96 = decltype(tmp92)::blendv(tmp94, tmp92, tmp95.template cast<float,1>());
                        auto tmp97 = decltype(tmp58)::blendv(tmp96, tmp58, tmp5.template cast<float,1>());
                        auto tmp98 = at::vec::convert<bfloat16>(tmp97);
                        tmp98.store(out_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp64 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp6 = c10::convert<int64_t>(tmp5);
                            auto tmp7 = static_cast<int64_t>(0);
                            auto tmp8 = tmp6 <= tmp7;
                            auto tmp9 = static_cast<float>(1.0);
                            auto tmp10 = static_cast<float>(0.0);
                            auto tmp11 = tmp8 ? tmp9 : tmp10;
                            auto tmp12 = c10::convert<bool>(tmp11);
                            auto tmp13 = 256L + x1;
                            auto tmp14 = c10::convert<int64_t>(tmp13);
                            auto tmp15 = tmp14 < tmp2;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = static_cast<int64_t>(257);
                                auto tmp18 = tmp1 < tmp17;
                                auto tmp19 = [&]
                                {
                                    auto tmp20 = 1L + x1 + x2;
                                    auto tmp21 = c10::convert<int64_t>(tmp20);
                                    auto tmp22 = tmp21 <= tmp7;
                                    auto tmp23 = tmp22 ? tmp9 : tmp10;
                                    auto tmp24 = c10::convert<bool>(tmp23);
                                    auto tmp25 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                    auto tmp26 = c10::convert<float>(tmp25);
                                    auto tmp27 = -std::numeric_limits<float>::infinity();
                                    auto tmp28 = tmp24 ? tmp27 : tmp26;
                                    return tmp28;
                                }
                                ;
                                auto tmp29 = tmp18 ? tmp19() : static_cast<decltype(tmp19())>(0.0);
                                auto tmp30 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp31 = c10::convert<float>(tmp30);
                                auto tmp32 = tmp18 ? tmp29 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp34 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp35 = c10::convert<float>(tmp34);
                            auto tmp36 = tmp15 ? tmp33 : tmp35;
                            auto tmp37 = -std::numeric_limits<float>::infinity();
                            auto tmp38 = tmp12 ? tmp37 : tmp36;
                            return tmp38;
                        }
                        ;
                        auto tmp39 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp40 = 256L + x1;
                        auto tmp41 = c10::convert<int64_t>(tmp40);
                        auto tmp42 = tmp41 < tmp2;
                        auto tmp43 = [&]
                        {
                            auto tmp44 = static_cast<int64_t>(257);
                            auto tmp45 = tmp1 < tmp44;
                            auto tmp46 = [&]
                            {
                                auto tmp47 = 1L + x1 + x2;
                                auto tmp48 = c10::convert<int64_t>(tmp47);
                                auto tmp49 = static_cast<int64_t>(0);
                                auto tmp50 = tmp48 <= tmp49;
                                auto tmp51 = static_cast<float>(1.0);
                                auto tmp52 = static_cast<float>(0.0);
                                auto tmp53 = tmp50 ? tmp51 : tmp52;
                                auto tmp54 = c10::convert<bool>(tmp53);
                                auto tmp55 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp56 = c10::convert<float>(tmp55);
                                auto tmp57 = -std::numeric_limits<float>::infinity();
                                auto tmp58 = tmp54 ? tmp57 : tmp56;
                                return tmp58;
                            }
                            ;
                            auto tmp59 = tmp45 ? tmp46() : static_cast<decltype(tmp46())>(0.0);
                            auto tmp60 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp61 = c10::convert<float>(tmp60);
                            auto tmp62 = tmp45 ? tmp59 : tmp61;
                            return tmp62;
                        }
                        ;
                        auto tmp63 = tmp42 ? tmp43() : static_cast<decltype(tmp43())>(0.0);
                        auto tmp65 = c10::convert<float>(tmp64);
                        auto tmp66 = tmp42 ? tmp63 : tmp65;
                        auto tmp67 = tmp3 ? tmp39 : tmp66;
                        auto tmp68 = c10::convert<bfloat16>(tmp67);
                        out_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0))] = tmp68;
                    }
                }
            }
        }
        #pragma omp single
        {
            {
                for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x0), 16);
                    auto tmp1 = static_cast<float>(0.0);
                    auto tmp2 = at::vec::Vectorized<float>(tmp1);
                    auto tmp3 = at::vec::VecMask<float,1>(tmp0 != tmp2);
                    auto tmp4 = tmp3.to<float,1>();
                    auto tmp5 = static_cast<float>(-3.3895313892515355e+38);
                    auto tmp6 = at::vec::Vectorized<float>(tmp5);
                    auto tmp7 = decltype(tmp6)::blendv(tmp4, tmp6, tmp3.template cast<float,1>());
                    auto tmp8 = at::vec::convert<bfloat16>(tmp7);
                    tmp8.store(out_ptr3 + static_cast<int64_t>(x0), 16);
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(2L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = x0;
                        auto tmp1 = c10::convert<int32_t>(tmp0);
                        auto tmp2 = static_cast<int32_t>(1);
                        auto tmp3 = tmp1 == tmp2;
                        auto tmp4 = x2;
                        auto tmp5 = c10::convert<int64_t>(tmp4);
                        auto tmp6 = at::vec::VectorizedN<int64_t,2>::arange(tmp5, 1);
                        auto tmp7 = static_cast<int64_t>(256);
                        auto tmp8 = at::vec::VectorizedN<int64_t,2>(tmp7);
                        auto tmp9 = at::vec::VecMask<int64_t,2>(tmp6 >= tmp8);
                        auto tmp10 = [&]
                        {
                            auto tmp11 =
                            [&]
                            {
                                __at_align__ std::array<int64_t, 16> tmpbuf;
                                #pragma GCC unroll 16
                                for (long x2_inner = 0; x2_inner < 16; x2_inner++)
                                {
                                    if (tmp9.is_masked(x2_inner))
                                    {
                                        tmpbuf[x2_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x2 + x2_inner + (513L*x1))), static_cast<int64_t>(512L))));
                                    }
                                }
                                return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                            }
                            ()
                            ;
                            auto tmp12 = static_cast<int64_t>(512);
                            auto tmp13 = at::vec::VectorizedN<int64_t,2>(tmp12);
                            auto tmp14 = at::vec::VecMask<int64_t,2>(tmp11 < tmp13);
                            auto tmp16 = tmp14 & tmp9;
                            auto tmp15 = [&]
                            {
                                auto tmp17 =
                                [&]
                                {
                                    __at_align__ std::array<bfloat16, 32> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x2_inner = 0; x2_inner < 16; x2_inner++)
                                    {
                                        if (tmp16.is_masked(x2_inner))
                                        {
                                            tmpbuf[x2_inner] = out_ptr3[static_cast<int64_t>(static_cast<int64_t>((x2 + x2_inner + (513L*x1))) % static_cast<int64_t>(512L))];
                                        }
                                    }
                                    return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp18 = at::vec::convert<float>(tmp17);
                                auto tmp19 = static_cast<float>(1.0);
                                auto tmp20 = at::vec::Vectorized<float>(tmp19);
                                auto tmp21 = tmp20 * tmp18;
                                return tmp21;
                            }
                            ;
                            auto tmp24 =
                            [&]
                            {
                                if (tmp16.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp22 = tmp15();
                                    auto tmp23 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp22)::blendv(tmp23, tmp22, tmp16.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            return tmp24;
                        }
                        ;
                        auto tmp27 =
                        [&]
                        {
                            if (tmp9.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp25 = tmp10();
                                auto tmp26 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp25)::blendv(tmp26, tmp25, tmp9.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp28 = static_cast<int64_t>(1);
                        auto tmp29 = tmp28 < tmp28;
                        auto tmp30 = [&]
                        {
                            auto tmp32 = at::vec::VecMask<float,1>::from(tmp29);
                            auto tmp33 = tmp9 & tmp32;
                            auto tmp31 = [&]
                            {
                                auto tmp34 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x2_inner = 0; x2_inner < 16; x2_inner++)
                                    {
                                        if (tmp33.is_masked(x2_inner))
                                        {
                                            tmpbuf[x2_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x2 + x2_inner + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp35 = static_cast<int64_t>(512);
                                auto tmp36 = at::vec::VectorizedN<int64_t,2>(tmp35);
                                auto tmp37 = at::vec::VecMask<int64_t,2>(tmp34 < tmp36);
                                auto tmp39 = tmp37 & tmp33;
                                auto tmp38 = [&]
                                {
                                    auto tmp40 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x2_inner = 0; x2_inner < 16; x2_inner++)
                                        {
                                            if (tmp39.is_masked(x2_inner))
                                            {
                                                tmpbuf[x2_inner] = out_ptr3[static_cast<int64_t>(static_cast<int64_t>(((-256L) + x2 + x2_inner + (513L*x1))) % static_cast<int64_t>(512L))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp41 = at::vec::convert<float>(tmp40);
                                    auto tmp42 = static_cast<float>(1.0);
                                    auto tmp43 = at::vec::Vectorized<float>(tmp42);
                                    auto tmp44 = tmp43 * tmp41;
                                    return tmp44;
                                }
                                ;
                                auto tmp47 =
                                [&]
                                {
                                    if (tmp39.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp45 = tmp38();
                                        auto tmp46 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp45)::blendv(tmp46, tmp45, tmp39.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp47;
                            }
                            ;
                            auto tmp50 =
                            [&]
                            {
                                if (tmp33.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp48 = tmp31();
                                    auto tmp49 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp48)::blendv(tmp49, tmp48, tmp33.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp51 = static_cast<float>(0.0);
                            auto tmp52 = at::vec::Vectorized<float>(tmp51);
                            auto tmp53 = decltype(tmp50)::blendv(tmp52, tmp50, tmp9.template cast<float,1>());
                            return tmp53;
                        }
                        ;
                        auto tmp54 = tmp29 ? tmp30() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp55 = static_cast<float>(0.0);
                        auto tmp56 = at::vec::VecMask<float,1>::from(tmp29);
                        auto tmp57 = at::vec::Vectorized<float>(tmp55);
                        auto tmp58 = decltype(tmp54)::blendv(tmp57, tmp54, tmp56.template cast<float,1>());
                        auto tmp59 = decltype(tmp27)::blendv(tmp58, tmp27, tmp9.template cast<float,1>());
                        auto tmp60 = c10::convert<int64_t>(tmp0);
                        auto tmp61 = tmp60 < tmp28;
                        auto tmp62 = [&]
                        {
                            auto tmp64 = at::vec::VecMask<float,1>::from(tmp61);
                            auto tmp65 = tmp9 & tmp64;
                            auto tmp63 = [&]
                            {
                                auto tmp66 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x2_inner = 0; x2_inner < 16; x2_inner++)
                                    {
                                        if (tmp65.is_masked(x2_inner))
                                        {
                                            tmpbuf[x2_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x2 + x2_inner + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp67 = static_cast<int64_t>(512);
                                auto tmp68 = at::vec::VectorizedN<int64_t,2>(tmp67);
                                auto tmp69 = at::vec::VecMask<int64_t,2>(tmp66 < tmp68);
                                auto tmp71 = tmp69 & tmp65;
                                auto tmp70 = [&]
                                {
                                    auto tmp72 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x2_inner = 0; x2_inner < 16; x2_inner++)
                                        {
                                            if (tmp71.is_masked(x2_inner))
                                            {
                                                tmpbuf[x2_inner] = out_ptr3[static_cast<int64_t>(static_cast<int64_t>(((-256L) + x2 + x2_inner + (513L*x1))) % static_cast<int64_t>(512L))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp73 = at::vec::convert<float>(tmp72);
                                    auto tmp74 = static_cast<float>(1.0);
                                    auto tmp75 = at::vec::Vectorized<float>(tmp74);
                                    auto tmp76 = tmp75 * tmp73;
                                    return tmp76;
                                }
                                ;
                                auto tmp79 =
                                [&]
                                {
                                    if (tmp71.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp77 = tmp70();
                                        auto tmp78 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp77)::blendv(tmp78, tmp77, tmp71.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp79;
                            }
                            ;
                            auto tmp82 =
                            [&]
                            {
                                if (tmp65.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp80 = tmp63();
                                    auto tmp81 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp80)::blendv(tmp81, tmp80, tmp65.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp83 = decltype(tmp82)::blendv(tmp57, tmp82, tmp9.template cast<float,1>());
                            return tmp83;
                        }
                        ;
                        auto tmp84 = tmp61 ? tmp62() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp85 = at::vec::VecMask<float,1>::from(tmp61);
                        auto tmp86 = decltype(tmp84)::blendv(tmp57, tmp84, tmp85.template cast<float,1>());
                        auto tmp87 = at::vec::VecMask<float,1>::from(tmp3);
                        auto tmp88 = decltype(tmp59)::blendv(tmp86, tmp59, tmp87.template cast<float,1>());
                        auto tmp89 = at::vec::convert<bfloat16>(tmp88);
                        tmp89.store(out_ptr4 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = x0;
                        auto tmp1 = c10::convert<int32_t>(tmp0);
                        auto tmp2 = static_cast<int32_t>(1);
                        auto tmp3 = tmp1 == tmp2;
                        auto tmp4 = x2;
                        auto tmp5 = c10::convert<int64_t>(tmp4);
                        auto tmp6 = static_cast<int64_t>(256);
                        auto tmp7 = tmp5 >= tmp6;
                        auto tmp8 = [&]
                        {
                            auto tmp9 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x2 + (513L*x1))), static_cast<int64_t>(512L)));
                            auto tmp10 = c10::convert<int64_t>(tmp9);
                            auto tmp11 = static_cast<int64_t>(512);
                            auto tmp12 = tmp10 < tmp11;
                            auto tmp13 = [&]
                            {
                                auto tmp14 = out_ptr3[static_cast<int64_t>(static_cast<int64_t>((x2 + (513L*x1))) % static_cast<int64_t>(512L))];
                                auto tmp15 = c10::convert<float>(tmp14);
                                auto tmp16 = static_cast<float>(1.0);
                                auto tmp17 = decltype(tmp16)(tmp16 * tmp15);
                                return tmp17;
                            }
                            ;
                            auto tmp18 = tmp12 ? tmp13() : static_cast<decltype(tmp13())>(0.0);
                            return tmp18;
                        }
                        ;
                        auto tmp19 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                        auto tmp20 = static_cast<int64_t>(1);
                        auto tmp21 = tmp20 < tmp20;
                        auto tmp22 = [&]
                        {
                            auto tmp23 = [&]
                            {
                                auto tmp24 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x2 + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                auto tmp25 = c10::convert<int64_t>(tmp24);
                                auto tmp26 = static_cast<int64_t>(512);
                                auto tmp27 = tmp25 < tmp26;
                                auto tmp28 = [&]
                                {
                                    auto tmp29 = out_ptr3[static_cast<int64_t>(static_cast<int64_t>(((-256L) + x2 + (513L*x1))) % static_cast<int64_t>(512L))];
                                    auto tmp30 = c10::convert<float>(tmp29);
                                    auto tmp31 = static_cast<float>(1.0);
                                    auto tmp32 = decltype(tmp31)(tmp31 * tmp30);
                                    return tmp32;
                                }
                                ;
                                auto tmp33 = tmp27 ? tmp28() : static_cast<decltype(tmp28())>(0.0);
                                return tmp33;
                            }
                            ;
                            auto tmp34 = tmp7 ? tmp23() : static_cast<decltype(tmp23())>(0.0);
                            auto tmp35 = static_cast<float>(0.0);
                            auto tmp36 = tmp7 ? tmp34 : tmp35;
                            return tmp36;
                        }
                        ;
                        auto tmp37 = tmp21 ? tmp22() : static_cast<decltype(tmp22())>(0.0);
                        auto tmp38 = static_cast<float>(0.0);
                        auto tmp39 = tmp21 ? tmp37 : tmp38;
                        auto tmp40 = tmp7 ? tmp19 : tmp39;
                        auto tmp41 = c10::convert<int64_t>(tmp0);
                        auto tmp42 = tmp41 < tmp20;
                        auto tmp43 = [&]
                        {
                            auto tmp44 = [&]
                            {
                                auto tmp45 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x2 + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                auto tmp46 = c10::convert<int64_t>(tmp45);
                                auto tmp47 = static_cast<int64_t>(512);
                                auto tmp48 = tmp46 < tmp47;
                                auto tmp49 = [&]
                                {
                                    auto tmp50 = out_ptr3[static_cast<int64_t>(static_cast<int64_t>(((-256L) + x2 + (513L*x1))) % static_cast<int64_t>(512L))];
                                    auto tmp51 = c10::convert<float>(tmp50);
                                    auto tmp52 = static_cast<float>(1.0);
                                    auto tmp53 = decltype(tmp52)(tmp52 * tmp51);
                                    return tmp53;
                                }
                                ;
                                auto tmp54 = tmp48 ? tmp49() : static_cast<decltype(tmp49())>(0.0);
                                return tmp54;
                            }
                            ;
                            auto tmp55 = tmp7 ? tmp44() : static_cast<decltype(tmp44())>(0.0);
                            auto tmp56 = tmp7 ? tmp55 : tmp38;
                            return tmp56;
                        }
                        ;
                        auto tmp57 = tmp42 ? tmp43() : static_cast<decltype(tmp43())>(0.0);
                        auto tmp58 = tmp42 ? tmp57 : tmp38;
                        auto tmp59 = tmp3 ? tmp40 : tmp58;
                        auto tmp60 = c10::convert<bfloat16>(tmp59);
                        out_ptr4[static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0))] = tmp60;
                    }
                }
            }
        }
        #pragma omp single
        {
            {
                #pragma GCC ivdep
                for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(256L); x0+=static_cast<int64_t>(1L))
                {
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp101 = at::vec::Vectorized<bfloat16>::loadu(out_ptr4 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp0 = x0;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(1);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = x1;
                            auto tmp6 = c10::convert<int64_t>(tmp5);
                            auto tmp7 = at::vec::VectorizedN<int64_t,2>::arange(tmp6, 1);
                            auto tmp8 = at::vec::VectorizedN<int64_t,2>(tmp2);
                            auto tmp9 = at::vec::VecMask<int64_t,2>(tmp7 >= tmp8);
                            auto tmp10 = static_cast<int64_t>(256);
                            auto tmp11 = at::vec::VectorizedN<int64_t,2>(tmp10);
                            auto tmp12 = at::vec::VecMask<int64_t,2>(tmp7 < tmp11);
                            auto tmp13 = tmp9 & tmp12;
                            auto tmp15 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp16 = tmp13 & tmp15;
                            auto tmp14 = [&]
                            {
                                auto tmp17 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x1_inner = 0; x1_inner < 16; x1_inner++)
                                    {
                                        if (tmp16.is_masked(x1_inner))
                                        {
                                            tmpbuf[x1_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x1 + x1_inner + (513L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp18 = static_cast<int64_t>(512);
                                auto tmp19 = at::vec::VectorizedN<int64_t,2>(tmp18);
                                auto tmp20 = at::vec::VecMask<int64_t,2>(tmp17 < tmp19);
                                auto tmp22 = tmp20 & tmp16;
                                auto tmp21 = [&]
                                {
                                    auto tmp23 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x1_inner = 0; x1_inner < 16; x1_inner++)
                                        {
                                            if (tmp22.is_masked(x1_inner))
                                            {
                                                tmpbuf[x1_inner] = out_ptr3[static_cast<int64_t>(static_cast<int64_t>(((-256L) + x1 + x1_inner + (513L*x0))) % static_cast<int64_t>(512L))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp24 = at::vec::convert<float>(tmp23);
                                    auto tmp25 = static_cast<float>(1.0);
                                    auto tmp26 = at::vec::Vectorized<float>(tmp25);
                                    auto tmp27 = tmp26 * tmp24;
                                    return tmp27;
                                }
                                ;
                                auto tmp30 =
                                [&]
                                {
                                    if (tmp22.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp28 = tmp21();
                                        auto tmp29 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp28)::blendv(tmp29, tmp28, tmp22.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp30;
                            }
                            ;
                            auto tmp33 =
                            [&]
                            {
                                if (tmp16.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp31 = tmp14();
                                    auto tmp32 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp31)::blendv(tmp32, tmp31, tmp16.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp34 = static_cast<int64_t>(0);
                            auto tmp35 = tmp34 >= tmp2;
                            auto tmp37 = tmp35 & tmp3;
                            auto tmp36 = [&]
                            {
                                auto tmp39 = at::vec::VecMask<float,1>::from(tmp37);
                                auto tmp40 = tmp12 & tmp39;
                                auto tmp38 = [&]
                                {
                                    auto tmp41 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x1_inner = 0; x1_inner < 16; x1_inner++)
                                        {
                                            if (tmp40.is_masked(x1_inner))
                                            {
                                                tmpbuf[x1_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x1 + x1_inner + (513L*x0))), static_cast<int64_t>(512L))));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp42 = static_cast<int64_t>(512);
                                    auto tmp43 = at::vec::VectorizedN<int64_t,2>(tmp42);
                                    auto tmp44 = at::vec::VecMask<int64_t,2>(tmp41 < tmp43);
                                    auto tmp46 = tmp44 & tmp40;
                                    auto tmp45 = [&]
                                    {
                                        auto tmp47 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x1_inner = 0; x1_inner < 16; x1_inner++)
                                            {
                                                if (tmp46.is_masked(x1_inner))
                                                {
                                                    tmpbuf[x1_inner] = out_ptr3[static_cast<int64_t>(static_cast<int64_t>((x1 + x1_inner + (513L*x0))) % static_cast<int64_t>(512L))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp48 = at::vec::convert<float>(tmp47);
                                        auto tmp49 = static_cast<float>(1.0);
                                        auto tmp50 = at::vec::Vectorized<float>(tmp49);
                                        auto tmp51 = tmp50 * tmp48;
                                        return tmp51;
                                    }
                                    ;
                                    auto tmp54 =
                                    [&]
                                    {
                                        if (tmp46.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp52 = tmp45();
                                            auto tmp53 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp52)::blendv(tmp53, tmp52, tmp46.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp54;
                                }
                                ;
                                auto tmp57 =
                                [&]
                                {
                                    if (tmp40.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp55 = tmp38();
                                        auto tmp56 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp55)::blendv(tmp56, tmp55, tmp40.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp58 = at::vec::VecMask<float,1>::from(tmp37).template loadu<bfloat16,1>(out_ptr4 + static_cast<int64_t>(131328L + x1 + (513L*x0)));
                                auto tmp59 = at::vec::convert<float>(tmp58);
                                auto tmp60 = decltype(tmp57)::blendv(tmp59, tmp57, tmp12.template cast<float,1>());
                                return tmp60;
                            }
                            ;
                            auto tmp61 = tmp35 ? tmp36() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp62 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr4 + static_cast<int64_t>(x1 + (513L*x0)));
                            auto tmp63 = at::vec::convert<float>(tmp62);
                            auto tmp64 = at::vec::VecMask<float,1>::from(tmp35);
                            auto tmp65 = decltype(tmp61)::blendv(tmp63, tmp61, tmp64.template cast<float,1>());
                            auto tmp66 = decltype(tmp33)::blendv(tmp65, tmp33, tmp13.template cast<float,1>());
                            return tmp66;
                        }
                        ;
                        auto tmp67 = tmp3 ? tmp4() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp68 = static_cast<int64_t>(0);
                        auto tmp69 = tmp68 >= tmp2;
                        auto tmp70 = [&]
                        {
                            auto tmp71 = x1;
                            auto tmp72 = c10::convert<int64_t>(tmp71);
                            auto tmp73 = at::vec::VectorizedN<int64_t,2>::arange(tmp72, 1);
                            auto tmp74 = static_cast<int64_t>(256);
                            auto tmp75 = at::vec::VectorizedN<int64_t,2>(tmp74);
                            auto tmp76 = at::vec::VecMask<int64_t,2>(tmp73 < tmp75);
                            auto tmp78 = at::vec::VecMask<float,1>::from(tmp69);
                            auto tmp79 = tmp76 & tmp78;
                            auto tmp77 = [&]
                            {
                                auto tmp80 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x1_inner = 0; x1_inner < 16; x1_inner++)
                                    {
                                        if (tmp79.is_masked(x1_inner))
                                        {
                                            tmpbuf[x1_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x1 + x1_inner + (513L*x0))), static_cast<int64_t>(512L))));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp81 = static_cast<int64_t>(512);
                                auto tmp82 = at::vec::VectorizedN<int64_t,2>(tmp81);
                                auto tmp83 = at::vec::VecMask<int64_t,2>(tmp80 < tmp82);
                                auto tmp85 = tmp83 & tmp79;
                                auto tmp84 = [&]
                                {
                                    auto tmp86 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x1_inner = 0; x1_inner < 16; x1_inner++)
                                        {
                                            if (tmp85.is_masked(x1_inner))
                                            {
                                                tmpbuf[x1_inner] = out_ptr3[static_cast<int64_t>(static_cast<int64_t>((x1 + x1_inner + (513L*x0))) % static_cast<int64_t>(512L))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp87 = at::vec::convert<float>(tmp86);
                                    auto tmp88 = static_cast<float>(1.0);
                                    auto tmp89 = at::vec::Vectorized<float>(tmp88);
                                    auto tmp90 = tmp89 * tmp87;
                                    return tmp90;
                                }
                                ;
                                auto tmp93 =
                                [&]
                                {
                                    if (tmp85.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp91 = tmp84();
                                        auto tmp92 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp91)::blendv(tmp92, tmp91, tmp85.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp93;
                            }
                            ;
                            auto tmp96 =
                            [&]
                            {
                                if (tmp79.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp94 = tmp77();
                                    auto tmp95 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp94)::blendv(tmp95, tmp94, tmp79.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp97 = at::vec::VecMask<float,1>::from(tmp69).template loadu<bfloat16,1>(out_ptr4 + static_cast<int64_t>(131328L + x1 + (513L*x0)));
                            auto tmp98 = at::vec::convert<float>(tmp97);
                            auto tmp99 = decltype(tmp96)::blendv(tmp98, tmp96, tmp76.template cast<float,1>());
                            return tmp99;
                        }
                        ;
                        auto tmp100 = tmp69 ? tmp70() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp102 = at::vec::convert<float>(tmp101);
                        auto tmp103 = at::vec::VecMask<float,1>::from(tmp69);
                        auto tmp104 = decltype(tmp100)::blendv(tmp102, tmp100, tmp103.template cast<float,1>());
                        auto tmp105 = at::vec::VecMask<float,1>::from(tmp3);
                        auto tmp106 = decltype(tmp67)::blendv(tmp104, tmp67, tmp105.template cast<float,1>());
                        auto tmp107 = at::vec::convert<bfloat16>(tmp106);
                        tmp107.store(out_ptr5 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp70 = out_ptr4[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp0 = x0;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(1);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = x1;
                            auto tmp6 = c10::convert<int64_t>(tmp5);
                            auto tmp7 = tmp6 >= tmp2;
                            auto tmp8 = static_cast<int64_t>(256);
                            auto tmp9 = tmp6 < tmp8;
                            auto tmp10 = tmp7 & tmp9;
                            auto tmp11 = [&]
                            {
                                auto tmp12 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x1 + (513L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                auto tmp13 = c10::convert<int64_t>(tmp12);
                                auto tmp14 = static_cast<int64_t>(512);
                                auto tmp15 = tmp13 < tmp14;
                                auto tmp16 = [&]
                                {
                                    auto tmp17 = out_ptr3[static_cast<int64_t>(static_cast<int64_t>(((-256L) + x1 + (513L*x0))) % static_cast<int64_t>(512L))];
                                    auto tmp18 = c10::convert<float>(tmp17);
                                    auto tmp19 = static_cast<float>(1.0);
                                    auto tmp20 = decltype(tmp19)(tmp19 * tmp18);
                                    return tmp20;
                                }
                                ;
                                auto tmp21 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                                return tmp21;
                            }
                            ;
                            auto tmp22 = tmp10 ? tmp11() : static_cast<decltype(tmp11())>(0.0);
                            auto tmp23 = static_cast<int64_t>(0);
                            auto tmp24 = tmp23 >= tmp2;
                            auto tmp25 = [&]
                            {
                                auto tmp26 = [&]
                                {
                                    auto tmp27 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x1 + (513L*x0))), static_cast<int64_t>(512L)));
                                    auto tmp28 = c10::convert<int64_t>(tmp27);
                                    auto tmp29 = static_cast<int64_t>(512);
                                    auto tmp30 = tmp28 < tmp29;
                                    auto tmp31 = [&]
                                    {
                                        auto tmp32 = out_ptr3[static_cast<int64_t>(static_cast<int64_t>((x1 + (513L*x0))) % static_cast<int64_t>(512L))];
                                        auto tmp33 = c10::convert<float>(tmp32);
                                        auto tmp34 = static_cast<float>(1.0);
                                        auto tmp35 = decltype(tmp34)(tmp34 * tmp33);
                                        return tmp35;
                                    }
                                    ;
                                    auto tmp36 = tmp30 ? tmp31() : static_cast<decltype(tmp31())>(0.0);
                                    return tmp36;
                                }
                                ;
                                auto tmp37 = tmp9 ? tmp26() : static_cast<decltype(tmp26())>(0.0);
                                auto tmp38 = out_ptr4[static_cast<int64_t>(131328L + x1 + (513L*x0))];
                                auto tmp39 = c10::convert<float>(tmp38);
                                auto tmp40 = tmp9 ? tmp37 : tmp39;
                                return tmp40;
                            }
                            ;
                            auto tmp41 = tmp24 ? tmp25() : static_cast<decltype(tmp25())>(0.0);
                            auto tmp42 = out_ptr4[static_cast<int64_t>(x1 + (513L*x0))];
                            auto tmp43 = c10::convert<float>(tmp42);
                            auto tmp44 = tmp24 ? tmp41 : tmp43;
                            auto tmp45 = tmp10 ? tmp22 : tmp44;
                            return tmp45;
                        }
                        ;
                        auto tmp46 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp47 = static_cast<int64_t>(0);
                        auto tmp48 = tmp47 >= tmp2;
                        auto tmp49 = [&]
                        {
                            auto tmp50 = x1;
                            auto tmp51 = c10::convert<int64_t>(tmp50);
                            auto tmp52 = static_cast<int64_t>(256);
                            auto tmp53 = tmp51 < tmp52;
                            auto tmp54 = [&]
                            {
                                auto tmp55 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x1 + (513L*x0))), static_cast<int64_t>(512L)));
                                auto tmp56 = c10::convert<int64_t>(tmp55);
                                auto tmp57 = static_cast<int64_t>(512);
                                auto tmp58 = tmp56 < tmp57;
                                auto tmp59 = [&]
                                {
                                    auto tmp60 = out_ptr3[static_cast<int64_t>(static_cast<int64_t>((x1 + (513L*x0))) % static_cast<int64_t>(512L))];
                                    auto tmp61 = c10::convert<float>(tmp60);
                                    auto tmp62 = static_cast<float>(1.0);
                                    auto tmp63 = decltype(tmp62)(tmp62 * tmp61);
                                    return tmp63;
                                }
                                ;
                                auto tmp64 = tmp58 ? tmp59() : static_cast<decltype(tmp59())>(0.0);
                                return tmp64;
                            }
                            ;
                            auto tmp65 = tmp53 ? tmp54() : static_cast<decltype(tmp54())>(0.0);
                            auto tmp66 = out_ptr4[static_cast<int64_t>(131328L + x1 + (513L*x0))];
                            auto tmp67 = c10::convert<float>(tmp66);
                            auto tmp68 = tmp53 ? tmp65 : tmp67;
                            return tmp68;
                        }
                        ;
                        auto tmp69 = tmp48 ? tmp49() : static_cast<decltype(tmp49())>(0.0);
                        auto tmp71 = c10::convert<float>(tmp70);
                        auto tmp72 = tmp48 ? tmp69 : tmp71;
                        auto tmp73 = tmp3 ? tmp46 : tmp72;
                        auto tmp74 = c10::convert<bfloat16>(tmp73);
                        out_ptr5[static_cast<int64_t>(x1 + (513L*x0))] = tmp74;
                    }
                }
            }
        }
        #pragma omp single
        {
            {
                #pragma GCC ivdep
                for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(256L); x0+=static_cast<int64_t>(1L))
                {
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp14 = at::vec::Vectorized<bfloat16>::loadu(out_ptr5 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp47 = at::vec::Vectorized<bfloat16>::loadu(out_ptr4 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp0 = (-255L) + x0 + x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(0);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 <= tmp4);
                        auto tmp6 = static_cast<float>(1.0);
                        auto tmp7 = static_cast<float>(0.0);
                        auto tmp8 = at::vec::Vectorized<float>(tmp6);
                        auto tmp9 = at::vec::Vectorized<float>(tmp7);
                        auto tmp10 = decltype(tmp8)::blendv(tmp9, tmp8, tmp5.template cast<float,1>());
                        auto tmp11 = at::vec::VecMask<float,1>::from<float,1>(tmp10);
                        auto tmp12 = static_cast<int32_t>(0);
                        auto tmp13 = tmp12 == tmp12;
                        auto tmp15 = at::vec::convert<float>(tmp14);
                        auto tmp16 = static_cast<int64_t>(1);
                        auto tmp17 = tmp3 >= tmp16;
                        auto tmp18 = [&]
                        {
                            auto tmp19 = x1;
                            auto tmp20 = c10::convert<int64_t>(tmp19);
                            auto tmp21 = at::vec::VectorizedN<int64_t,2>::arange(tmp20, 1);
                            auto tmp22 = static_cast<int64_t>(256);
                            auto tmp23 = at::vec::VectorizedN<int64_t,2>(tmp22);
                            auto tmp24 = at::vec::VecMask<int64_t,2>(tmp21 < tmp23);
                            auto tmp26 = at::vec::VecMask<float,1>::from(tmp17);
                            auto tmp27 = tmp24 & tmp26;
                            auto tmp25 = [&]
                            {
                                auto tmp28 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x1_inner = 0; x1_inner < 16; x1_inner++)
                                    {
                                        if (tmp27.is_masked(x1_inner))
                                        {
                                            tmpbuf[x1_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x1 + x1_inner + (513L*x0))), static_cast<int64_t>(512L))));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp29 = static_cast<int64_t>(512);
                                auto tmp30 = at::vec::VectorizedN<int64_t,2>(tmp29);
                                auto tmp31 = at::vec::VecMask<int64_t,2>(tmp28 < tmp30);
                                auto tmp33 = tmp31 & tmp27;
                                auto tmp32 = [&]
                                {
                                    auto tmp34 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x1_inner = 0; x1_inner < 16; x1_inner++)
                                        {
                                            if (tmp33.is_masked(x1_inner))
                                            {
                                                tmpbuf[x1_inner] = out_ptr3[static_cast<int64_t>(static_cast<int64_t>((x1 + x1_inner + (513L*x0))) % static_cast<int64_t>(512L))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp35 = at::vec::convert<float>(tmp34);
                                    auto tmp36 = tmp8 * tmp35;
                                    return tmp36;
                                }
                                ;
                                auto tmp39 =
                                [&]
                                {
                                    if (tmp33.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp37 = tmp32();
                                        auto tmp38 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp37)::blendv(tmp38, tmp37, tmp33.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp39;
                            }
                            ;
                            auto tmp42 =
                            [&]
                            {
                                if (tmp27.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp40 = tmp25();
                                    auto tmp41 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp40)::blendv(tmp41, tmp40, tmp27.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp43 = at::vec::VecMask<float,1>::from(tmp17).template loadu<bfloat16,1>(out_ptr4 + static_cast<int64_t>(131328L + x1 + (513L*x0)));
                            auto tmp44 = at::vec::convert<float>(tmp43);
                            auto tmp45 = decltype(tmp42)::blendv(tmp44, tmp42, tmp24.template cast<float,1>());
                            return tmp45;
                        }
                        ;
                        auto tmp46 = tmp17 ? tmp18() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp48 = at::vec::convert<float>(tmp47);
                        auto tmp49 = at::vec::VecMask<float,1>::from(tmp17);
                        auto tmp50 = decltype(tmp46)::blendv(tmp48, tmp46, tmp49.template cast<float,1>());
                        auto tmp51 = at::vec::VecMask<float,1>::from(tmp13);
                        auto tmp52 = decltype(tmp15)::blendv(tmp50, tmp15, tmp51.template cast<float,1>());
                        auto tmp53 = -std::numeric_limits<float>::infinity();
                        auto tmp54 = at::vec::Vectorized<float>(tmp53);
                        auto tmp55 = decltype(tmp54)::blendv(tmp52, tmp54, tmp11.template cast<float,1>());
                        auto tmp56 = at::vec::convert<bfloat16>(tmp55);
                        tmp56.store(out_ptr6 + static_cast<int64_t>(x1 + (257L*x0)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(256L); x1<static_cast<int64_t>(257L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp10 = out_ptr5[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp34 = out_ptr4[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp0 = (-255L) + x0 + x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(0);
                        auto tmp3 = tmp1 <= tmp2;
                        auto tmp4 = static_cast<float>(1.0);
                        auto tmp5 = static_cast<float>(0.0);
                        auto tmp6 = tmp3 ? tmp4 : tmp5;
                        auto tmp7 = c10::convert<bool>(tmp6);
                        auto tmp8 = static_cast<int32_t>(0);
                        auto tmp9 = tmp8 == tmp8;
                        auto tmp11 = c10::convert<float>(tmp10);
                        auto tmp12 = static_cast<int64_t>(1);
                        auto tmp13 = tmp2 >= tmp12;
                        auto tmp14 = [&]
                        {
                            auto tmp15 = x1;
                            auto tmp16 = c10::convert<int64_t>(tmp15);
                            auto tmp17 = static_cast<int64_t>(256);
                            auto tmp18 = tmp16 < tmp17;
                            auto tmp19 = [&]
                            {
                                auto tmp20 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x1 + (513L*x0))), static_cast<int64_t>(512L)));
                                auto tmp21 = c10::convert<int64_t>(tmp20);
                                auto tmp22 = static_cast<int64_t>(512);
                                auto tmp23 = tmp21 < tmp22;
                                auto tmp24 = [&]
                                {
                                    auto tmp25 = out_ptr3[static_cast<int64_t>(static_cast<int64_t>((x1 + (513L*x0))) % static_cast<int64_t>(512L))];
                                    auto tmp26 = c10::convert<float>(tmp25);
                                    auto tmp27 = decltype(tmp4)(tmp4 * tmp26);
                                    return tmp27;
                                }
                                ;
                                auto tmp28 = tmp23 ? tmp24() : static_cast<decltype(tmp24())>(0.0);
                                return tmp28;
                            }
                            ;
                            auto tmp29 = tmp18 ? tmp19() : static_cast<decltype(tmp19())>(0.0);
                            auto tmp30 = out_ptr4[static_cast<int64_t>(131328L + x1 + (513L*x0))];
                            auto tmp31 = c10::convert<float>(tmp30);
                            auto tmp32 = tmp18 ? tmp29 : tmp31;
                            return tmp32;
                        }
                        ;
                        auto tmp33 = tmp13 ? tmp14() : static_cast<decltype(tmp14())>(0.0);
                        auto tmp35 = c10::convert<float>(tmp34);
                        auto tmp36 = tmp13 ? tmp33 : tmp35;
                        auto tmp37 = tmp9 ? tmp11 : tmp36;
                        auto tmp38 = -std::numeric_limits<float>::infinity();
                        auto tmp39 = tmp7 ? tmp38 : tmp37;
                        auto tmp40 = c10::convert<bfloat16>(tmp39);
                        out_ptr6[static_cast<int64_t>(x1 + (257L*x0))] = tmp40;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp68 = at::vec::Vectorized<bfloat16>::loadu(out_ptr5 + static_cast<int64_t>(x1 + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L)))), 16);
                    auto tmp103 = at::vec::Vectorized<bfloat16>::loadu(out_ptr4 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                    auto tmp0 = x0;
                    auto tmp1 = c10::convert<int64_t>(tmp0);
                    auto tmp2 = static_cast<int64_t>(256);
                    auto tmp3 = tmp1 < tmp2;
                    auto tmp4 = [&]
                    {
                        auto tmp5 = x1;
                        auto tmp6 = c10::convert<int64_t>(tmp5);
                        auto tmp7 = at::vec::VectorizedN<int64_t,2>::arange(tmp6, 1);
                        auto tmp8 = static_cast<int64_t>(257);
                        auto tmp9 = at::vec::VectorizedN<int64_t,2>(tmp8);
                        auto tmp10 = at::vec::VecMask<int64_t,2>(tmp7 < tmp9);
                        auto tmp12 = at::vec::VecMask<float,1>::from(tmp3);
                        auto tmp13 = tmp10 & tmp12;
                        auto tmp11 = [&]
                        {
                            auto tmp14 = tmp13.template cast<float,1>().template loadu<bfloat16,1>(out_ptr6 + static_cast<int64_t>(x1 + (257L*x0)));
                            auto tmp15 = at::vec::convert<float>(tmp14);
                            return tmp15;
                        }
                        ;
                        auto tmp18 =
                        [&]
                        {
                            if (tmp13.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp16 = tmp11();
                                auto tmp17 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp16)::blendv(tmp17, tmp16, tmp13.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp19 = c10::div_floor_integer(static_cast<int64_t>(x0), static_cast<int64_t>(256L));
                        auto tmp20 = c10::convert<int32_t>(tmp19);
                        auto tmp21 = static_cast<int32_t>(0);
                        auto tmp22 = tmp20 == tmp21;
                        auto tmp23 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr5 + static_cast<int64_t>(x1 + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L)))));
                        auto tmp24 = at::vec::convert<float>(tmp23);
                        auto tmp25 = c10::convert<int64_t>(tmp19);
                        auto tmp26 = static_cast<int64_t>(1);
                        auto tmp27 = tmp25 >= tmp26;
                        auto tmp29 = tmp27 & tmp3;
                        auto tmp28 = [&]
                        {
                            auto tmp30 = at::vec::VectorizedN<int64_t,2>(tmp2);
                            auto tmp31 = at::vec::VecMask<int64_t,2>(tmp7 < tmp30);
                            auto tmp33 = at::vec::VecMask<float,1>::from(tmp29);
                            auto tmp34 = tmp31 & tmp33;
                            auto tmp32 = [&]
                            {
                                auto tmp35 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x1_inner = 0; x1_inner < 16; x1_inner++)
                                    {
                                        if (tmp34.is_masked(x1_inner))
                                        {
                                            tmpbuf[x1_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x1 + x1_inner + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L))))), static_cast<int64_t>(512L))));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp36 = static_cast<int64_t>(512);
                                auto tmp37 = at::vec::VectorizedN<int64_t,2>(tmp36);
                                auto tmp38 = at::vec::VecMask<int64_t,2>(tmp35 < tmp37);
                                auto tmp40 = tmp38 & tmp34;
                                auto tmp39 = [&]
                                {
                                    auto tmp41 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x1_inner = 0; x1_inner < 16; x1_inner++)
                                        {
                                            if (tmp40.is_masked(x1_inner))
                                            {
                                                tmpbuf[x1_inner] = out_ptr3[static_cast<int64_t>(static_cast<int64_t>((x1 + x1_inner + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L))))) % static_cast<int64_t>(512L))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp42 = at::vec::convert<float>(tmp41);
                                    auto tmp43 = static_cast<float>(1.0);
                                    auto tmp44 = at::vec::Vectorized<float>(tmp43);
                                    auto tmp45 = tmp44 * tmp42;
                                    return tmp45;
                                }
                                ;
                                auto tmp48 =
                                [&]
                                {
                                    if (tmp40.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp46 = tmp39();
                                        auto tmp47 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp46)::blendv(tmp47, tmp46, tmp40.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp48;
                            }
                            ;
                            auto tmp51 =
                            [&]
                            {
                                if (tmp34.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp49 = tmp32();
                                    auto tmp50 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp49)::blendv(tmp50, tmp49, tmp34.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp52 = at::vec::VecMask<float,1>::from(tmp29).template loadu<bfloat16,1>(out_ptr4 + static_cast<int64_t>(131328L + x1 + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L)))));
                            auto tmp53 = at::vec::convert<float>(tmp52);
                            auto tmp54 = decltype(tmp51)::blendv(tmp53, tmp51, tmp31.template cast<float,1>());
                            return tmp54;
                        }
                        ;
                        auto tmp55 = tmp27 ? tmp28() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp56 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr4 + static_cast<int64_t>(x1 + (513L*x0)));
                        auto tmp57 = at::vec::convert<float>(tmp56);
                        auto tmp58 = at::vec::VecMask<float,1>::from(tmp27);
                        auto tmp59 = decltype(tmp55)::blendv(tmp57, tmp55, tmp58.template cast<float,1>());
                        auto tmp60 = at::vec::VecMask<float,1>::from(tmp22);
                        auto tmp61 = decltype(tmp24)::blendv(tmp59, tmp24, tmp60.template cast<float,1>());
                        auto tmp62 = decltype(tmp18)::blendv(tmp61, tmp18, tmp10.template cast<float,1>());
                        return tmp62;
                    }
                    ;
                    auto tmp63 = tmp3 ? tmp4() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                    auto tmp64 = c10::div_floor_integer(static_cast<int64_t>(x0), static_cast<int64_t>(256L));
                    auto tmp65 = c10::convert<int32_t>(tmp64);
                    auto tmp66 = static_cast<int32_t>(0);
                    auto tmp67 = tmp65 == tmp66;
                    auto tmp69 = at::vec::convert<float>(tmp68);
                    auto tmp70 = c10::convert<int64_t>(tmp64);
                    auto tmp71 = static_cast<int64_t>(1);
                    auto tmp72 = tmp70 >= tmp71;
                    auto tmp73 = [&]
                    {
                        auto tmp74 = x1;
                        auto tmp75 = c10::convert<int64_t>(tmp74);
                        auto tmp76 = at::vec::VectorizedN<int64_t,2>::arange(tmp75, 1);
                        auto tmp77 = at::vec::VectorizedN<int64_t,2>(tmp2);
                        auto tmp78 = at::vec::VecMask<int64_t,2>(tmp76 < tmp77);
                        auto tmp80 = at::vec::VecMask<float,1>::from(tmp72);
                        auto tmp81 = tmp78 & tmp80;
                        auto tmp79 = [&]
                        {
                            auto tmp82 =
                            [&]
                            {
                                __at_align__ std::array<int64_t, 16> tmpbuf;
                                #pragma GCC unroll 16
                                for (long x1_inner = 0; x1_inner < 16; x1_inner++)
                                {
                                    if (tmp81.is_masked(x1_inner))
                                    {
                                        tmpbuf[x1_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x1 + x1_inner + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L))))), static_cast<int64_t>(512L))));
                                    }
                                }
                                return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                            }
                            ()
                            ;
                            auto tmp83 = static_cast<int64_t>(512);
                            auto tmp84 = at::vec::VectorizedN<int64_t,2>(tmp83);
                            auto tmp85 = at::vec::VecMask<int64_t,2>(tmp82 < tmp84);
                            auto tmp87 = tmp85 & tmp81;
                            auto tmp86 = [&]
                            {
                                auto tmp88 =
                                [&]
                                {
                                    __at_align__ std::array<bfloat16, 32> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x1_inner = 0; x1_inner < 16; x1_inner++)
                                    {
                                        if (tmp87.is_masked(x1_inner))
                                        {
                                            tmpbuf[x1_inner] = out_ptr3[static_cast<int64_t>(static_cast<int64_t>((x1 + x1_inner + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L))))) % static_cast<int64_t>(512L))];
                                        }
                                    }
                                    return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp89 = at::vec::convert<float>(tmp88);
                                auto tmp90 = static_cast<float>(1.0);
                                auto tmp91 = at::vec::Vectorized<float>(tmp90);
                                auto tmp92 = tmp91 * tmp89;
                                return tmp92;
                            }
                            ;
                            auto tmp95 =
                            [&]
                            {
                                if (tmp87.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp93 = tmp86();
                                    auto tmp94 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp93)::blendv(tmp94, tmp93, tmp87.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            return tmp95;
                        }
                        ;
                        auto tmp98 =
                        [&]
                        {
                            if (tmp81.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp96 = tmp79();
                                auto tmp97 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp96)::blendv(tmp97, tmp96, tmp81.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp99 = at::vec::VecMask<float,1>::from(tmp72).template loadu<bfloat16,1>(out_ptr4 + static_cast<int64_t>(131328L + x1 + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L)))));
                        auto tmp100 = at::vec::convert<float>(tmp99);
                        auto tmp101 = decltype(tmp98)::blendv(tmp100, tmp98, tmp78.template cast<float,1>());
                        return tmp101;
                    }
                    ;
                    auto tmp102 = tmp72 ? tmp73() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                    auto tmp104 = at::vec::convert<float>(tmp103);
                    auto tmp105 = at::vec::VecMask<float,1>::from(tmp72);
                    auto tmp106 = decltype(tmp102)::blendv(tmp104, tmp102, tmp105.template cast<float,1>());
                    auto tmp107 = at::vec::VecMask<float,1>::from(tmp67);
                    auto tmp108 = decltype(tmp69)::blendv(tmp106, tmp69, tmp107.template cast<float,1>());
                    auto tmp109 = at::vec::VecMask<float,1>::from(tmp3);
                    auto tmp110 = decltype(tmp63)::blendv(tmp108, tmp63, tmp109.template cast<float,1>());
                    auto tmp111 = at::vec::convert<bfloat16>(tmp110);
                    tmp111.store(out_ptr7 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                }
                #pragma omp simd simdlen(8) 
                for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                {
                    auto tmp50 = out_ptr5[static_cast<int64_t>(x1 + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L))))];
                    auto tmp75 = out_ptr4[static_cast<int64_t>(x1 + (513L*x0))];
                    auto tmp0 = x0;
                    auto tmp1 = c10::convert<int64_t>(tmp0);
                    auto tmp2 = static_cast<int64_t>(256);
                    auto tmp3 = tmp1 < tmp2;
                    auto tmp4 = [&]
                    {
                        auto tmp5 = x1;
                        auto tmp6 = c10::convert<int64_t>(tmp5);
                        auto tmp7 = static_cast<int64_t>(257);
                        auto tmp8 = tmp6 < tmp7;
                        auto tmp9 = [&]
                        {
                            auto tmp10 = out_ptr6[static_cast<int64_t>(x1 + (257L*x0))];
                            auto tmp11 = c10::convert<float>(tmp10);
                            return tmp11;
                        }
                        ;
                        auto tmp12 = tmp8 ? tmp9() : static_cast<decltype(tmp9())>(0.0);
                        auto tmp13 = c10::div_floor_integer(static_cast<int64_t>(x0), static_cast<int64_t>(256L));
                        auto tmp14 = c10::convert<int32_t>(tmp13);
                        auto tmp15 = static_cast<int32_t>(0);
                        auto tmp16 = tmp14 == tmp15;
                        auto tmp17 = out_ptr5[static_cast<int64_t>(x1 + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L))))];
                        auto tmp18 = c10::convert<float>(tmp17);
                        auto tmp19 = c10::convert<int64_t>(tmp13);
                        auto tmp20 = static_cast<int64_t>(1);
                        auto tmp21 = tmp19 >= tmp20;
                        auto tmp22 = [&]
                        {
                            auto tmp23 = tmp6 < tmp2;
                            auto tmp24 = [&]
                            {
                                auto tmp25 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x1 + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L))))), static_cast<int64_t>(512L)));
                                auto tmp26 = c10::convert<int64_t>(tmp25);
                                auto tmp27 = static_cast<int64_t>(512);
                                auto tmp28 = tmp26 < tmp27;
                                auto tmp29 = [&]
                                {
                                    auto tmp30 = out_ptr3[static_cast<int64_t>(static_cast<int64_t>((x1 + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L))))) % static_cast<int64_t>(512L))];
                                    auto tmp31 = c10::convert<float>(tmp30);
                                    auto tmp32 = static_cast<float>(1.0);
                                    auto tmp33 = decltype(tmp32)(tmp32 * tmp31);
                                    return tmp33;
                                }
                                ;
                                auto tmp34 = tmp28 ? tmp29() : static_cast<decltype(tmp29())>(0.0);
                                return tmp34;
                            }
                            ;
                            auto tmp35 = tmp23 ? tmp24() : static_cast<decltype(tmp24())>(0.0);
                            auto tmp36 = out_ptr4[static_cast<int64_t>(131328L + x1 + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L))))];
                            auto tmp37 = c10::convert<float>(tmp36);
                            auto tmp38 = tmp23 ? tmp35 : tmp37;
                            return tmp38;
                        }
                        ;
                        auto tmp39 = tmp21 ? tmp22() : static_cast<decltype(tmp22())>(0.0);
                        auto tmp40 = out_ptr4[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp41 = c10::convert<float>(tmp40);
                        auto tmp42 = tmp21 ? tmp39 : tmp41;
                        auto tmp43 = tmp16 ? tmp18 : tmp42;
                        auto tmp44 = tmp8 ? tmp12 : tmp43;
                        return tmp44;
                    }
                    ;
                    auto tmp45 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                    auto tmp46 = c10::div_floor_integer(static_cast<int64_t>(x0), static_cast<int64_t>(256L));
                    auto tmp47 = c10::convert<int32_t>(tmp46);
                    auto tmp48 = static_cast<int32_t>(0);
                    auto tmp49 = tmp47 == tmp48;
                    auto tmp51 = c10::convert<float>(tmp50);
                    auto tmp52 = c10::convert<int64_t>(tmp46);
                    auto tmp53 = static_cast<int64_t>(1);
                    auto tmp54 = tmp52 >= tmp53;
                    auto tmp55 = [&]
                    {
                        auto tmp56 = x1;
                        auto tmp57 = c10::convert<int64_t>(tmp56);
                        auto tmp58 = tmp57 < tmp2;
                        auto tmp59 = [&]
                        {
                            auto tmp60 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x1 + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L))))), static_cast<int64_t>(512L)));
                            auto tmp61 = c10::convert<int64_t>(tmp60);
                            auto tmp62 = static_cast<int64_t>(512);
                            auto tmp63 = tmp61 < tmp62;
                            auto tmp64 = [&]
                            {
                                auto tmp65 = out_ptr3[static_cast<int64_t>(static_cast<int64_t>((x1 + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L))))) % static_cast<int64_t>(512L))];
                                auto tmp66 = c10::convert<float>(tmp65);
                                auto tmp67 = static_cast<float>(1.0);
                                auto tmp68 = decltype(tmp67)(tmp67 * tmp66);
                                return tmp68;
                            }
                            ;
                            auto tmp69 = tmp63 ? tmp64() : static_cast<decltype(tmp64())>(0.0);
                            return tmp69;
                        }
                        ;
                        auto tmp70 = tmp58 ? tmp59() : static_cast<decltype(tmp59())>(0.0);
                        auto tmp71 = out_ptr4[static_cast<int64_t>(131328L + x1 + (513L*(static_cast<int64_t>(x0) % static_cast<int64_t>(256L))))];
                        auto tmp72 = c10::convert<float>(tmp71);
                        auto tmp73 = tmp58 ? tmp70 : tmp72;
                        return tmp73;
                    }
                    ;
                    auto tmp74 = tmp54 ? tmp55() : static_cast<decltype(tmp55())>(0.0);
                    auto tmp76 = c10::convert<float>(tmp75);
                    auto tmp77 = tmp54 ? tmp74 : tmp76;
                    auto tmp78 = tmp49 ? tmp51 : tmp77;
                    auto tmp79 = tmp3 ? tmp45 : tmp78;
                    auto tmp80 = c10::convert<bfloat16>(tmp79);
                    out_ptr7[static_cast<int64_t>(x1 + (513L*x0))] = tmp80;
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp45 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)), 16);
                        auto tmp83 = at::vec::Vectorized<bfloat16>::loadu(out_ptr7 + static_cast<int64_t>(x2 + (513L*x1)), 16);
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr2 + static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0)));
                            auto tmp6 = at::vec::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = at::vec::VectorizedN<int64_t,2>::arange(tmp13, 1);
                            auto tmp15 = static_cast<int64_t>(257);
                            auto tmp16 = at::vec::VectorizedN<int64_t,2>(tmp15);
                            auto tmp17 = at::vec::VecMask<int64_t,2>(tmp14 < tmp16);
                            auto tmp19 = at::vec::VecMask<float,1>::from(tmp10);
                            auto tmp20 = tmp17 & tmp19;
                            auto tmp18 = [&]
                            {
                                auto tmp21 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp22 = c10::convert<int64_t>(tmp21);
                                auto tmp23 = at::vec::VectorizedN<int64_t,2>::arange(tmp22, 1);
                                auto tmp24 = static_cast<int64_t>(0);
                                auto tmp25 = at::vec::VectorizedN<int64_t,2>(tmp24);
                                auto tmp26 = at::vec::VecMask<int64_t,2>(tmp23 <= tmp25);
                                auto tmp27 = static_cast<float>(1.0);
                                auto tmp28 = static_cast<float>(0.0);
                                auto tmp29 = at::vec::Vectorized<float>(tmp27);
                                auto tmp30 = at::vec::Vectorized<float>(tmp28);
                                auto tmp31 = decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                auto tmp32 = at::vec::VecMask<float,1>::from<float,1>(tmp31);
                                auto tmp33 = tmp20.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                                auto tmp34 = at::vec::convert<float>(tmp33);
                                auto tmp35 = -std::numeric_limits<float>::infinity();
                                auto tmp36 = at::vec::Vectorized<float>(tmp35);
                                auto tmp37 = decltype(tmp36)::blendv(tmp34, tmp36, tmp32.template cast<float,1>());
                                return tmp37;
                            }
                            ;
                            auto tmp40 =
                            [&]
                            {
                                if (tmp20.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp38 = tmp18();
                                    auto tmp39 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp38)::blendv(tmp39, tmp38, tmp20.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp41 = at::vec::VecMask<float,1>::from(tmp10).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                            auto tmp42 = at::vec::convert<float>(tmp41);
                            auto tmp43 = decltype(tmp40)::blendv(tmp42, tmp40, tmp17.template cast<float,1>());
                            return tmp43;
                        }
                        ;
                        auto tmp44 = tmp10 ? tmp11() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp46 = at::vec::convert<float>(tmp45);
                        auto tmp47 = at::vec::VecMask<float,1>::from(tmp10);
                        auto tmp48 = decltype(tmp44)::blendv(tmp46, tmp44, tmp47.template cast<float,1>());
                        auto tmp49 = at::vec::VecMask<float,1>::from(tmp3);
                        auto tmp50 = decltype(tmp7)::blendv(tmp48, tmp7, tmp49.template cast<float,1>());
                        auto tmp51 = [&]
                        {
                            auto tmp52 = x2;
                            auto tmp53 = c10::convert<int64_t>(tmp52);
                            auto tmp54 = at::vec::VectorizedN<int64_t,2>::arange(tmp53, 1);
                            auto tmp55 = at::vec::VectorizedN<int64_t,2>(tmp2);
                            auto tmp56 = at::vec::VecMask<int64_t,2>(tmp54 >= tmp55);
                            auto tmp58 = tmp56 & tmp49;
                            auto tmp57 = [&]
                            {
                                auto tmp59 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp60 = c10::convert<int64_t>(tmp59);
                                auto tmp61 = at::vec::VectorizedN<int64_t,2>::arange(tmp60, -1);
                                auto tmp62 = static_cast<int64_t>(0);
                                auto tmp63 = at::vec::VectorizedN<int64_t,2>(tmp62);
                                auto tmp64 = at::vec::VecMask<int64_t,2>(tmp61 <= tmp63);
                                auto tmp65 = static_cast<float>(1.0);
                                auto tmp66 = static_cast<float>(0.0);
                                auto tmp67 = at::vec::Vectorized<float>(tmp65);
                                auto tmp68 = at::vec::Vectorized<float>(tmp66);
                                auto tmp69 = decltype(tmp67)::blendv(tmp68, tmp67, tmp64.template cast<float,1>());
                                auto tmp70 = at::vec::VecMask<float,1>::from<float,1>(tmp69);
                                auto tmp71 = tmp58.template cast<float,1>().template loadu<bfloat16,1>(out_ptr7 + static_cast<int64_t>(x2 + (513L*x1)));
                                auto tmp72 = at::vec::convert<float>(tmp71);
                                auto tmp73 = -std::numeric_limits<float>::infinity();
                                auto tmp74 = at::vec::Vectorized<float>(tmp73);
                                auto tmp75 = decltype(tmp74)::blendv(tmp72, tmp74, tmp70.template cast<float,1>());
                                return tmp75;
                            }
                            ;
                            auto tmp78 =
                            [&]
                            {
                                if (tmp58.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp76 = tmp57();
                                    auto tmp77 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp76)::blendv(tmp77, tmp76, tmp58.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp79 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr7 + static_cast<int64_t>(x2 + (513L*x1)));
                            auto tmp80 = at::vec::convert<float>(tmp79);
                            auto tmp81 = decltype(tmp78)::blendv(tmp80, tmp78, tmp56.template cast<float,1>());
                            return tmp81;
                        }
                        ;
                        auto tmp82 = tmp3 ? tmp51() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp84 = at::vec::convert<float>(tmp83);
                        auto tmp85 = decltype(tmp82)::blendv(tmp84, tmp82, tmp49.template cast<float,1>());
                        auto tmp86 = tmp50 + tmp85;
                        auto tmp87 = at::vec::convert<bfloat16>(tmp86);
                        tmp87.store(out_ptr8 + static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp34 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                        auto tmp60 = out_ptr7[static_cast<int64_t>(x2 + (513L*x1))];
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = out_ptr2[static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0))];
                            auto tmp6 = c10::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = static_cast<int64_t>(257);
                            auto tmp15 = tmp13 < tmp14;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp18 = c10::convert<int64_t>(tmp17);
                                auto tmp19 = static_cast<int64_t>(0);
                                auto tmp20 = tmp18 <= tmp19;
                                auto tmp21 = static_cast<float>(1.0);
                                auto tmp22 = static_cast<float>(0.0);
                                auto tmp23 = tmp20 ? tmp21 : tmp22;
                                auto tmp24 = c10::convert<bool>(tmp23);
                                auto tmp25 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                                auto tmp26 = c10::convert<float>(tmp25);
                                auto tmp27 = -std::numeric_limits<float>::infinity();
                                auto tmp28 = tmp24 ? tmp27 : tmp26;
                                return tmp28;
                            }
                            ;
                            auto tmp29 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp30 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                            auto tmp31 = c10::convert<float>(tmp30);
                            auto tmp32 = tmp15 ? tmp29 : tmp31;
                            return tmp32;
                        }
                        ;
                        auto tmp33 = tmp10 ? tmp11() : static_cast<decltype(tmp11())>(0.0);
                        auto tmp35 = c10::convert<float>(tmp34);
                        auto tmp36 = tmp10 ? tmp33 : tmp35;
                        auto tmp37 = tmp3 ? tmp7 : tmp36;
                        auto tmp38 = [&]
                        {
                            auto tmp39 = x2;
                            auto tmp40 = c10::convert<int64_t>(tmp39);
                            auto tmp41 = tmp40 >= tmp2;
                            auto tmp42 = [&]
                            {
                                auto tmp43 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp44 = c10::convert<int64_t>(tmp43);
                                auto tmp45 = static_cast<int64_t>(0);
                                auto tmp46 = tmp44 <= tmp45;
                                auto tmp47 = static_cast<float>(1.0);
                                auto tmp48 = static_cast<float>(0.0);
                                auto tmp49 = tmp46 ? tmp47 : tmp48;
                                auto tmp50 = c10::convert<bool>(tmp49);
                                auto tmp51 = out_ptr7[static_cast<int64_t>(x2 + (513L*x1))];
                                auto tmp52 = c10::convert<float>(tmp51);
                                auto tmp53 = -std::numeric_limits<float>::infinity();
                                auto tmp54 = tmp50 ? tmp53 : tmp52;
                                return tmp54;
                            }
                            ;
                            auto tmp55 = tmp41 ? tmp42() : static_cast<decltype(tmp42())>(0.0);
                            auto tmp56 = out_ptr7[static_cast<int64_t>(x2 + (513L*x1))];
                            auto tmp57 = c10::convert<float>(tmp56);
                            auto tmp58 = tmp41 ? tmp55 : tmp57;
                            return tmp58;
                        }
                        ;
                        auto tmp59 = tmp3 ? tmp38() : static_cast<decltype(tmp38())>(0.0);
                        auto tmp61 = c10::convert<float>(tmp60);
                        auto tmp62 = tmp3 ? tmp59 : tmp61;
                        auto tmp63 = decltype(tmp37)(tmp37 + tmp62);
                        auto tmp64 = c10::convert<bfloat16>(tmp63);
                        out_ptr8[static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1))] = tmp64;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(6144L); x0+=static_cast<int64_t>(1L))
            {
                {
                    float tmp_acc0 = -std::numeric_limits<float>::infinity();
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(-std::numeric_limits<float>::infinity());
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr8 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        tmp_acc0_vec = at::vec::maximum(tmp_acc0_vec, tmp1);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr8[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp1 = c10::convert<float>(tmp0);
                        tmp_acc0 = max_propagate_nan(tmp_acc0, tmp1);
                    }
                    tmp_acc0 = max_propagate_nan(tmp_acc0, at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return at::vec::maximum(x, y); }, tmp_acc0_vec));
                    out_ptr9[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
                {
                    float tmp_acc0 = 0;
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(0);
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr8 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp2 = out_ptr9[static_cast<int64_t>(x0)];
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = at::vec::Vectorized<float>(tmp2);
                        auto tmp4 = tmp1 - tmp3;
                        auto tmp5 = tmp4.exp();
                        tmp5.store(out_ptr10 + static_cast<int64_t>(x1 + (513L*x0)));
                        tmp_acc0_vec = tmp_acc0_vec + tmp5;
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr8[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp2 = out_ptr9[static_cast<int64_t>(x0)];
                        auto tmp1 = c10::convert<float>(tmp0);
                        auto tmp3 = decltype(tmp1)(tmp1 - tmp2);
                        auto tmp4 = std::exp(tmp3);
                        out_ptr10[static_cast<int64_t>(x1 + (513L*x0))] = tmp4;
                        tmp_acc0 = tmp_acc0 + tmp4;
                    }
                    tmp_acc0 = tmp_acc0 + at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return x + y; }, tmp_acc0_vec);
                    out_ptr11[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
            }
        }
    }
}
''')


cpp_fused_clone_constant_pad_nd_4 = async_compile.cpp_pybinding(['const bfloat16*', 'const bool*', 'const float*', 'const float*', 'bfloat16*', 'bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bool* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(1024L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = (-256L) + x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(0);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = static_cast<int64_t>(512);
                        auto tmp5 = tmp1 < tmp4;
                        auto tmp6 = tmp3 & tmp5;
                        auto tmp7 = [&]
                        {
                            auto tmp8 = at::vec::VecMask<float,1>::from(tmp6).template loadu<bfloat16,1>(in_ptr0 + static_cast<int64_t>((-196608L) + x2 + (64L*x0) + (768L*x1)));
                            auto tmp9 = at::vec::convert<float>(tmp8);
                            return tmp9;
                        }
                        ;
                        auto tmp10 = tmp6 ? tmp7() : at::vec::Vectorized<float>(static_cast<float>(-1.0));
                        auto tmp11 = at::vec::convert<bfloat16>(tmp10);
                        tmp11.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (65536L*x0)), 16);
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(768L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(513);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 < tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp8 = tmp5.template cast<float,1>().template loadu<float,1>(in_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0)));
                            auto tmp9 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp10 = at::vec::Vectorized<float>(tmp9);
                            auto tmp11 = tmp8 / tmp10;
                            auto tmp12 = static_cast<float>(0.0);
                            auto tmp13 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp14 = at::vec::Vectorized<float>(tmp12);
                            auto tmp15 = decltype(tmp14)::blendv(tmp11, tmp14, tmp13.template cast<float,1>());
                            auto tmp16 = (tmp15);
                            return tmp16;
                        }
                        ;
                        auto tmp19 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp17 = tmp6();
                                auto tmp18 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp17)::blendv(tmp18, tmp17, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp20 = at::vec::convert<bfloat16>(tmp19);
                        tmp20.store(out_ptr1 + static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(768L); x2<static_cast<int64_t>(770L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(513);
                        auto tmp3 = tmp1 < tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp6 = in_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0))];
                            auto tmp7 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp8 = tmp6 / tmp7;
                            auto tmp9 = static_cast<float>(0.0);
                            auto tmp10 = tmp5 ? tmp9 : tmp8;
                            auto tmp11 = c10::convert<float>(tmp10);
                            return tmp11;
                        }
                        ;
                        auto tmp12 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp13 = c10::convert<bfloat16>(tmp12);
                        out_ptr1[static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1))] = tmp13;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(49152L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x2 + (16384L*x1) + (65536L*x0)), 32);
                        tmp0.store(out_ptr2 + static_cast<int64_t>(x2 + (49152L*x1) + (98304L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused_clone_5 = async_compile.cpp_pybinding(['const bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       bfloat16* out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x2 + (64L*x0) + (32768L*x1)), 32);
                        tmp0.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (768L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_6 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    auto tmp19 = at::vec::convert<bfloat16>(tmp18);
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                    tmp19.store(out_ptr3 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_7 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<float>::loadu(out_ptr2 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<bfloat16>(tmp0);
                tmp1.store(out_ptr3 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_8 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<float>(tmp0);
                auto tmp2 = static_cast<float>(0.125);
                auto tmp3 = at::vec::Vectorized<float>(tmp2);
                auto tmp4 = tmp1 * tmp3;
                auto tmp5 = at::vec::convert<bfloat16>(tmp4);
                tmp5.store(in_out_ptr0 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_9 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(32L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 32);
                tmp0.store(in_out_ptr0 + static_cast<int64_t>(x0), 32);
            }
        }
    }
}
''')


cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_10 = async_compile.cpp_pybinding(['const bfloat16*', 'const bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'float*', 'float*', 'float*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bfloat16* in_ptr1,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2,
                       bfloat16* out_ptr3,
                       float* out_ptr4,
                       float* out_ptr5,
                       float* out_ptr6)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(2L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = at::vec::VectorizedN<int64_t,2>::arange(tmp5, 1);
                            auto tmp7 = static_cast<int64_t>(256);
                            auto tmp8 = at::vec::VectorizedN<int64_t,2>(tmp7);
                            auto tmp9 = at::vec::VecMask<int64_t,2>(tmp6 >= tmp8);
                            auto tmp10 = [&]
                            {
                                auto tmp11 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                    {
                                        if (tmp9.is_masked(x3_inner))
                                        {
                                            tmpbuf[x3_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp12 = static_cast<int64_t>(512);
                                auto tmp13 = at::vec::VectorizedN<int64_t,2>(tmp12);
                                auto tmp14 = at::vec::VecMask<int64_t,2>(tmp11 < tmp13);
                                auto tmp16 = tmp14 & tmp9;
                                auto tmp15 = [&]
                                {
                                    auto tmp17 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp16.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>(131072L + x3 + x3_inner + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp18 = at::vec::convert<float>(tmp17);
                                    return tmp18;
                                }
                                ;
                                auto tmp21 =
                                [&]
                                {
                                    if (tmp16.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp19 = tmp15();
                                        auto tmp20 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp19)::blendv(tmp20, tmp19, tmp16.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp21;
                            }
                            ;
                            auto tmp24 =
                            [&]
                            {
                                if (tmp9.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp22 = tmp10();
                                    auto tmp23 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp22)::blendv(tmp23, tmp22, tmp9.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp25 = static_cast<int64_t>(1);
                            auto tmp26 = tmp25 < tmp25;
                            auto tmp27 = [&]
                            {
                                auto tmp29 = at::vec::VecMask<float,1>::from(tmp26);
                                auto tmp30 = tmp9 & tmp29;
                                auto tmp28 = [&]
                                {
                                    auto tmp31 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp30.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp32 = static_cast<int64_t>(512);
                                    auto tmp33 = at::vec::VectorizedN<int64_t,2>(tmp32);
                                    auto tmp34 = at::vec::VecMask<int64_t,2>(tmp31 < tmp33);
                                    auto tmp36 = tmp34 & tmp30;
                                    auto tmp35 = [&]
                                    {
                                        auto tmp37 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp36.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp38 = at::vec::convert<float>(tmp37);
                                        return tmp38;
                                    }
                                    ;
                                    auto tmp41 =
                                    [&]
                                    {
                                        if (tmp36.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp39 = tmp35();
                                            auto tmp40 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp39)::blendv(tmp40, tmp39, tmp36.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp41;
                                }
                                ;
                                auto tmp44 =
                                [&]
                                {
                                    if (tmp30.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp42 = tmp28();
                                        auto tmp43 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp42)::blendv(tmp43, tmp42, tmp30.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp45 = static_cast<float>(0.0);
                                auto tmp46 = at::vec::Vectorized<float>(tmp45);
                                auto tmp47 = decltype(tmp44)::blendv(tmp46, tmp44, tmp9.template cast<float,1>());
                                return tmp47;
                            }
                            ;
                            auto tmp48 = tmp26 ? tmp27() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp49 = static_cast<float>(0.0);
                            auto tmp50 = at::vec::VecMask<float,1>::from(tmp26);
                            auto tmp51 = at::vec::Vectorized<float>(tmp49);
                            auto tmp52 = decltype(tmp48)::blendv(tmp51, tmp48, tmp50.template cast<float,1>());
                            auto tmp53 = decltype(tmp24)::blendv(tmp52, tmp24, tmp9.template cast<float,1>());
                            auto tmp54 = c10::convert<int64_t>(tmp0);
                            auto tmp55 = tmp54 < tmp25;
                            auto tmp56 = [&]
                            {
                                auto tmp58 = at::vec::VecMask<float,1>::from(tmp55);
                                auto tmp59 = tmp9 & tmp58;
                                auto tmp57 = [&]
                                {
                                    auto tmp60 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp59.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp61 = static_cast<int64_t>(512);
                                    auto tmp62 = at::vec::VectorizedN<int64_t,2>(tmp61);
                                    auto tmp63 = at::vec::VecMask<int64_t,2>(tmp60 < tmp62);
                                    auto tmp65 = tmp63 & tmp59;
                                    auto tmp64 = [&]
                                    {
                                        auto tmp66 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp65.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp67 = at::vec::convert<float>(tmp66);
                                        return tmp67;
                                    }
                                    ;
                                    auto tmp70 =
                                    [&]
                                    {
                                        if (tmp65.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp68 = tmp64();
                                            auto tmp69 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp68)::blendv(tmp69, tmp68, tmp65.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp70;
                                }
                                ;
                                auto tmp73 =
                                [&]
                                {
                                    if (tmp59.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp71 = tmp57();
                                        auto tmp72 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp71)::blendv(tmp72, tmp71, tmp59.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp74 = decltype(tmp73)::blendv(tmp51, tmp73, tmp9.template cast<float,1>());
                                return tmp74;
                            }
                            ;
                            auto tmp75 = tmp55 ? tmp56() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp76 = at::vec::VecMask<float,1>::from(tmp55);
                            auto tmp77 = decltype(tmp75)::blendv(tmp51, tmp75, tmp76.template cast<float,1>());
                            auto tmp78 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp79 = decltype(tmp53)::blendv(tmp77, tmp53, tmp78.template cast<float,1>());
                            auto tmp80 = at::vec::convert<bfloat16>(tmp79);
                            tmp80.store(out_ptr0 + static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(256);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + (513L*x1))), static_cast<int64_t>(512L)));
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = static_cast<int64_t>(512);
                                auto tmp12 = tmp10 < tmp11;
                                auto tmp13 = [&]
                                {
                                    auto tmp14 = in_ptr0[static_cast<int64_t>(131072L + x3 + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                    auto tmp15 = c10::convert<float>(tmp14);
                                    return tmp15;
                                }
                                ;
                                auto tmp16 = tmp12 ? tmp13() : static_cast<decltype(tmp13())>(0.0);
                                return tmp16;
                            }
                            ;
                            auto tmp17 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp18 = static_cast<int64_t>(1);
                            auto tmp19 = tmp18 < tmp18;
                            auto tmp20 = [&]
                            {
                                auto tmp21 = [&]
                                {
                                    auto tmp22 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp23 = c10::convert<int64_t>(tmp22);
                                    auto tmp24 = static_cast<int64_t>(512);
                                    auto tmp25 = tmp23 < tmp24;
                                    auto tmp26 = [&]
                                    {
                                        auto tmp27 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                        auto tmp28 = c10::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp29 = tmp25 ? tmp26() : static_cast<decltype(tmp26())>(0.0);
                                    return tmp29;
                                }
                                ;
                                auto tmp30 = tmp7 ? tmp21() : static_cast<decltype(tmp21())>(0.0);
                                auto tmp31 = static_cast<float>(0.0);
                                auto tmp32 = tmp7 ? tmp30 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                            auto tmp34 = static_cast<float>(0.0);
                            auto tmp35 = tmp19 ? tmp33 : tmp34;
                            auto tmp36 = tmp7 ? tmp17 : tmp35;
                            auto tmp37 = c10::convert<int64_t>(tmp0);
                            auto tmp38 = tmp37 < tmp18;
                            auto tmp39 = [&]
                            {
                                auto tmp40 = [&]
                                {
                                    auto tmp41 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp42 = c10::convert<int64_t>(tmp41);
                                    auto tmp43 = static_cast<int64_t>(512);
                                    auto tmp44 = tmp42 < tmp43;
                                    auto tmp45 = [&]
                                    {
                                        auto tmp46 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                        auto tmp47 = c10::convert<float>(tmp46);
                                        return tmp47;
                                    }
                                    ;
                                    auto tmp48 = tmp44 ? tmp45() : static_cast<decltype(tmp45())>(0.0);
                                    return tmp48;
                                }
                                ;
                                auto tmp49 = tmp7 ? tmp40() : static_cast<decltype(tmp40())>(0.0);
                                auto tmp50 = tmp7 ? tmp49 : tmp34;
                                return tmp50;
                            }
                            ;
                            auto tmp51 = tmp38 ? tmp39() : static_cast<decltype(tmp39())>(0.0);
                            auto tmp52 = tmp38 ? tmp51 : tmp34;
                            auto tmp53 = tmp3 ? tmp36 : tmp52;
                            auto tmp54 = c10::convert<bfloat16>(tmp53);
                            out_ptr0[static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0))] = tmp54;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(256L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp96 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp132 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = at::vec::VectorizedN<int64_t,2>::arange(tmp10, 1);
                                auto tmp12 = at::vec::VectorizedN<int64_t,2>(tmp6);
                                auto tmp13 = at::vec::VecMask<int64_t,2>(tmp11 >= tmp12);
                                auto tmp14 = static_cast<int64_t>(256);
                                auto tmp15 = at::vec::VectorizedN<int64_t,2>(tmp14);
                                auto tmp16 = at::vec::VecMask<int64_t,2>(tmp11 < tmp15);
                                auto tmp17 = tmp13 & tmp16;
                                auto tmp19 = at::vec::VecMask<float,1>::from(tmp7);
                                auto tmp20 = tmp17 & tmp19;
                                auto tmp18 = [&]
                                {
                                    auto tmp21 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp20.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp22 = static_cast<int64_t>(512);
                                    auto tmp23 = at::vec::VectorizedN<int64_t,2>(tmp22);
                                    auto tmp24 = at::vec::VecMask<int64_t,2>(tmp21 < tmp23);
                                    auto tmp26 = tmp24 & tmp20;
                                    auto tmp25 = [&]
                                    {
                                        auto tmp27 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp26.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp28 = at::vec::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp31 =
                                    [&]
                                    {
                                        if (tmp26.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp29 = tmp25();
                                            auto tmp30 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp31;
                                }
                                ;
                                auto tmp34 =
                                [&]
                                {
                                    if (tmp20.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp32 = tmp18();
                                        auto tmp33 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp32)::blendv(tmp33, tmp32, tmp20.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp35 = static_cast<int64_t>(0);
                                auto tmp36 = tmp35 >= tmp6;
                                auto tmp38 = tmp36 & tmp7;
                                auto tmp37 = [&]
                                {
                                    auto tmp40 = at::vec::VecMask<float,1>::from(tmp38);
                                    auto tmp41 = tmp16 & tmp40;
                                    auto tmp39 = [&]
                                    {
                                        auto tmp42 =
                                        [&]
                                        {
                                            __at_align__ std::array<int64_t, 16> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp41.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                                }
                                            }
                                            return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp43 = static_cast<int64_t>(512);
                                        auto tmp44 = at::vec::VectorizedN<int64_t,2>(tmp43);
                                        auto tmp45 = at::vec::VecMask<int64_t,2>(tmp42 < tmp44);
                                        auto tmp47 = tmp45 & tmp41;
                                        auto tmp46 = [&]
                                        {
                                            auto tmp48 =
                                            [&]
                                            {
                                                __at_align__ std::array<bfloat16, 32> tmpbuf;
                                                #pragma GCC unroll 16
                                                for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                                {
                                                    if (tmp47.is_masked(x3_inner))
                                                    {
                                                        tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                    }
                                                }
                                                return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                            }
                                            ()
                                            ;
                                            auto tmp49 = at::vec::convert<float>(tmp48);
                                            return tmp49;
                                        }
                                        ;
                                        auto tmp52 =
                                        [&]
                                        {
                                            if (tmp47.all_zero())
                                            {
                                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            }
                                            else
                                            {
                                                auto tmp50 = tmp46();
                                                auto tmp51 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                                return decltype(tmp50)::blendv(tmp51, tmp50, tmp47.template cast<float,1>());
                                            }
                                        }
                                        ()
                                        ;
                                        return tmp52;
                                    }
                                    ;
                                    auto tmp55 =
                                    [&]
                                    {
                                        if (tmp41.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp53 = tmp39();
                                            auto tmp54 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp53)::blendv(tmp54, tmp53, tmp41.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    auto tmp56 = at::vec::VecMask<float,1>::from(tmp38).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                    auto tmp57 = at::vec::convert<float>(tmp56);
                                    auto tmp58 = decltype(tmp55)::blendv(tmp57, tmp55, tmp16.template cast<float,1>());
                                    return tmp58;
                                }
                                ;
                                auto tmp59 = tmp36 ? tmp37() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                                auto tmp60 = at::vec::VecMask<float,1>::from(tmp7).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp61 = at::vec::convert<float>(tmp60);
                                auto tmp62 = at::vec::VecMask<float,1>::from(tmp36);
                                auto tmp63 = decltype(tmp59)::blendv(tmp61, tmp59, tmp62.template cast<float,1>());
                                auto tmp64 = decltype(tmp34)::blendv(tmp63, tmp34, tmp17.template cast<float,1>());
                                return tmp64;
                            }
                            ;
                            auto tmp65 = tmp7 ? tmp8() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp66 = static_cast<int64_t>(0);
                            auto tmp67 = tmp66 >= tmp6;
                            auto tmp68 = [&]
                            {
                                auto tmp69 = x3;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(256);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 < tmp73);
                                auto tmp76 = at::vec::VecMask<float,1>::from(tmp67);
                                auto tmp77 = tmp74 & tmp76;
                                auto tmp75 = [&]
                                {
                                    auto tmp78 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp77.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp79 = static_cast<int64_t>(512);
                                    auto tmp80 = at::vec::VectorizedN<int64_t,2>(tmp79);
                                    auto tmp81 = at::vec::VecMask<int64_t,2>(tmp78 < tmp80);
                                    auto tmp83 = tmp81 & tmp77;
                                    auto tmp82 = [&]
                                    {
                                        auto tmp84 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp83.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp85 = at::vec::convert<float>(tmp84);
                                        return tmp85;
                                    }
                                    ;
                                    auto tmp88 =
                                    [&]
                                    {
                                        if (tmp83.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp86 = tmp82();
                                            auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp86)::blendv(tmp87, tmp86, tmp83.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp88;
                                }
                                ;
                                auto tmp91 =
                                [&]
                                {
                                    if (tmp77.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp89 = tmp75();
                                        auto tmp90 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp89)::blendv(tmp90, tmp89, tmp77.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp92 = at::vec::VecMask<float,1>::from(tmp67).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp93 = at::vec::convert<float>(tmp92);
                                auto tmp94 = decltype(tmp91)::blendv(tmp93, tmp91, tmp74.template cast<float,1>());
                                return tmp94;
                            }
                            ;
                            auto tmp95 = tmp67 ? tmp68() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp97 = at::vec::convert<float>(tmp96);
                            auto tmp98 = at::vec::VecMask<float,1>::from(tmp67);
                            auto tmp99 = decltype(tmp95)::blendv(tmp97, tmp95, tmp98.template cast<float,1>());
                            auto tmp100 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp101 = decltype(tmp65)::blendv(tmp99, tmp65, tmp100.template cast<float,1>());
                            auto tmp102 = c10::convert<int64_t>(tmp0);
                            auto tmp103 = tmp102 >= tmp6;
                            auto tmp104 = [&]
                            {
                                auto tmp105 = x3;
                                auto tmp106 = c10::convert<int64_t>(tmp105);
                                auto tmp107 = at::vec::VectorizedN<int64_t,2>::arange(tmp106, 1);
                                auto tmp108 = static_cast<int64_t>(256);
                                auto tmp109 = at::vec::VectorizedN<int64_t,2>(tmp108);
                                auto tmp110 = at::vec::VecMask<int64_t,2>(tmp107 < tmp109);
                                auto tmp112 = at::vec::VecMask<float,1>::from(tmp103);
                                auto tmp113 = tmp110 & tmp112;
                                auto tmp111 = [&]
                                {
                                    auto tmp114 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp113.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp115 = static_cast<int64_t>(512);
                                    auto tmp116 = at::vec::VectorizedN<int64_t,2>(tmp115);
                                    auto tmp117 = at::vec::VecMask<int64_t,2>(tmp114 < tmp116);
                                    auto tmp119 = tmp117 & tmp113;
                                    auto tmp118 = [&]
                                    {
                                        auto tmp120 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp119.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp121 = at::vec::convert<float>(tmp120);
                                        return tmp121;
                                    }
                                    ;
                                    auto tmp124 =
                                    [&]
                                    {
                                        if (tmp119.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp122 = tmp118();
                                            auto tmp123 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp122)::blendv(tmp123, tmp122, tmp119.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp124;
                                }
                                ;
                                auto tmp127 =
                                [&]
                                {
                                    if (tmp113.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp125 = tmp111();
                                        auto tmp126 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp125)::blendv(tmp126, tmp125, tmp113.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp128 = at::vec::VecMask<float,1>::from(tmp103).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp129 = at::vec::convert<float>(tmp128);
                                auto tmp130 = decltype(tmp127)::blendv(tmp129, tmp127, tmp110.template cast<float,1>());
                                return tmp130;
                            }
                            ;
                            auto tmp131 = tmp103 ? tmp104() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp133 = at::vec::convert<float>(tmp132);
                            auto tmp134 = at::vec::VecMask<float,1>::from(tmp103);
                            auto tmp135 = decltype(tmp131)::blendv(tmp133, tmp131, tmp134.template cast<float,1>());
                            auto tmp136 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp137 = decltype(tmp101)::blendv(tmp135, tmp101, tmp136.template cast<float,1>());
                            auto tmp138 = at::vec::convert<bfloat16>(tmp137);
                            tmp138.store(out_ptr1 + static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp68 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                            auto tmp93 = out_ptr0[static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0))];
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = tmp10 >= tmp6;
                                auto tmp12 = static_cast<int64_t>(256);
                                auto tmp13 = tmp10 < tmp12;
                                auto tmp14 = tmp11 & tmp13;
                                auto tmp15 = [&]
                                {
                                    auto tmp16 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp17 = c10::convert<int64_t>(tmp16);
                                    auto tmp18 = static_cast<int64_t>(512);
                                    auto tmp19 = tmp17 < tmp18;
                                    auto tmp20 = [&]
                                    {
                                        auto tmp21 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                        auto tmp22 = c10::convert<float>(tmp21);
                                        return tmp22;
                                    }
                                    ;
                                    auto tmp23 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                                    return tmp23;
                                }
                                ;
                                auto tmp24 = tmp14 ? tmp15() : static_cast<decltype(tmp15())>(0.0);
                                auto tmp25 = static_cast<int64_t>(0);
                                auto tmp26 = tmp25 >= tmp6;
                                auto tmp27 = [&]
                                {
                                    auto tmp28 = [&]
                                    {
                                        auto tmp29 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                        auto tmp30 = c10::convert<int64_t>(tmp29);
                                        auto tmp31 = static_cast<int64_t>(512);
                                        auto tmp32 = tmp30 < tmp31;
                                        auto tmp33 = [&]
                                        {
                                            auto tmp34 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                            auto tmp35 = c10::convert<float>(tmp34);
                                            return tmp35;
                                        }
                                        ;
                                        auto tmp36 = tmp32 ? tmp33() : static_cast<decltype(tmp33())>(0.0);
                                        return tmp36;
                                    }
                                    ;
                                    auto tmp37 = tmp13 ? tmp28() : static_cast<decltype(tmp28())>(0.0);
                                    auto tmp38 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                    auto tmp39 = c10::convert<float>(tmp38);
                                    auto tmp40 = tmp13 ? tmp37 : tmp39;
                                    return tmp40;
                                }
                                ;
                                auto tmp41 = tmp26 ? tmp27() : static_cast<decltype(tmp27())>(0.0);
                                auto tmp42 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp43 = c10::convert<float>(tmp42);
                                auto tmp44 = tmp26 ? tmp41 : tmp43;
                                auto tmp45 = tmp14 ? tmp24 : tmp44;
                                return tmp45;
                            }
                            ;
                            auto tmp46 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp47 = static_cast<int64_t>(0);
                            auto tmp48 = tmp47 >= tmp6;
                            auto tmp49 = [&]
                            {
                                auto tmp50 = x3;
                                auto tmp51 = c10::convert<int64_t>(tmp50);
                                auto tmp52 = static_cast<int64_t>(256);
                                auto tmp53 = tmp51 < tmp52;
                                auto tmp54 = [&]
                                {
                                    auto tmp55 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp56 = c10::convert<int64_t>(tmp55);
                                    auto tmp57 = static_cast<int64_t>(512);
                                    auto tmp58 = tmp56 < tmp57;
                                    auto tmp59 = [&]
                                    {
                                        auto tmp60 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp61 = c10::convert<float>(tmp60);
                                        return tmp61;
                                    }
                                    ;
                                    auto tmp62 = tmp58 ? tmp59() : static_cast<decltype(tmp59())>(0.0);
                                    return tmp62;
                                }
                                ;
                                auto tmp63 = tmp53 ? tmp54() : static_cast<decltype(tmp54())>(0.0);
                                auto tmp64 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp65 = c10::convert<float>(tmp64);
                                auto tmp66 = tmp53 ? tmp63 : tmp65;
                                return tmp66;
                            }
                            ;
                            auto tmp67 = tmp48 ? tmp49() : static_cast<decltype(tmp49())>(0.0);
                            auto tmp69 = c10::convert<float>(tmp68);
                            auto tmp70 = tmp48 ? tmp67 : tmp69;
                            auto tmp71 = tmp7 ? tmp46 : tmp70;
                            auto tmp72 = c10::convert<int64_t>(tmp0);
                            auto tmp73 = tmp72 >= tmp6;
                            auto tmp74 = [&]
                            {
                                auto tmp75 = x3;
                                auto tmp76 = c10::convert<int64_t>(tmp75);
                                auto tmp77 = static_cast<int64_t>(256);
                                auto tmp78 = tmp76 < tmp77;
                                auto tmp79 = [&]
                                {
                                    auto tmp80 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp81 = c10::convert<int64_t>(tmp80);
                                    auto tmp82 = static_cast<int64_t>(512);
                                    auto tmp83 = tmp81 < tmp82;
                                    auto tmp84 = [&]
                                    {
                                        auto tmp85 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp86 = c10::convert<float>(tmp85);
                                        return tmp86;
                                    }
                                    ;
                                    auto tmp87 = tmp83 ? tmp84() : static_cast<decltype(tmp84())>(0.0);
                                    return tmp87;
                                }
                                ;
                                auto tmp88 = tmp78 ? tmp79() : static_cast<decltype(tmp79())>(0.0);
                                auto tmp89 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp90 = c10::convert<float>(tmp89);
                                auto tmp91 = tmp78 ? tmp88 : tmp90;
                                return tmp91;
                            }
                            ;
                            auto tmp92 = tmp73 ? tmp74() : static_cast<decltype(tmp74())>(0.0);
                            auto tmp94 = c10::convert<float>(tmp93);
                            auto tmp95 = tmp73 ? tmp92 : tmp94;
                            auto tmp96 = tmp3 ? tmp71 : tmp95;
                            auto tmp97 = c10::convert<bfloat16>(tmp96);
                            out_ptr1[static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0))] = tmp97;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp93 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)), 16);
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(256);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 >= tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp8 = c10::convert<int64_t>(tmp7);
                            auto tmp9 = at::vec::VectorizedN<int64_t,2>::arange(tmp8, -1);
                            auto tmp10 = static_cast<int64_t>(0);
                            auto tmp11 = at::vec::VectorizedN<int64_t,2>(tmp10);
                            auto tmp12 = at::vec::VecMask<int64_t,2>(tmp9 <= tmp11);
                            auto tmp13 = static_cast<float>(1.0);
                            auto tmp14 = static_cast<float>(0.0);
                            auto tmp15 = at::vec::Vectorized<float>(tmp13);
                            auto tmp16 = at::vec::Vectorized<float>(tmp14);
                            auto tmp17 = decltype(tmp15)::blendv(tmp16, tmp15, tmp12.template cast<float,1>());
                            auto tmp18 = at::vec::VecMask<float,1>::from<float,1>(tmp17);
                            auto tmp19 = 256L + x1;
                            auto tmp20 = c10::convert<int64_t>(tmp19);
                            auto tmp21 = tmp20 < tmp3;
                            auto tmp23 = at::vec::VecMask<float,1>::from(tmp21);
                            auto tmp24 = tmp23 & tmp5;
                            auto tmp22 = [&]
                            {
                                auto tmp25 = static_cast<int64_t>(257);
                                auto tmp26 = at::vec::VectorizedN<int64_t,2>(tmp25);
                                auto tmp27 = at::vec::VecMask<int64_t,2>(tmp2 < tmp26);
                                auto tmp29 = tmp27 & tmp24;
                                auto tmp28 = [&]
                                {
                                    auto tmp30 = 1L + x1 + x2;
                                    auto tmp31 = c10::convert<int64_t>(tmp30);
                                    auto tmp32 = at::vec::VectorizedN<int64_t,2>::arange(tmp31, 1);
                                    auto tmp33 = at::vec::VecMask<int64_t,2>(tmp32 <= tmp11);
                                    auto tmp34 = decltype(tmp15)::blendv(tmp16, tmp15, tmp33.template cast<float,1>());
                                    auto tmp35 = at::vec::VecMask<float,1>::from<float,1>(tmp34);
                                    auto tmp36 = tmp29.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                    auto tmp37 = at::vec::convert<float>(tmp36);
                                    auto tmp38 = -std::numeric_limits<float>::infinity();
                                    auto tmp39 = at::vec::Vectorized<float>(tmp38);
                                    auto tmp40 = decltype(tmp39)::blendv(tmp37, tmp39, tmp35.template cast<float,1>());
                                    return tmp40;
                                }
                                ;
                                auto tmp43 =
                                [&]
                                {
                                    if (tmp29.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp41 = tmp28();
                                        auto tmp42 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp41)::blendv(tmp42, tmp41, tmp29.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp44 = tmp24.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp45 = at::vec::convert<float>(tmp44);
                                auto tmp46 = decltype(tmp43)::blendv(tmp45, tmp43, tmp27.template cast<float,1>());
                                return tmp46;
                            }
                            ;
                            auto tmp49 =
                            [&]
                            {
                                if (tmp24.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp47 = tmp22();
                                    auto tmp48 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp47)::blendv(tmp48, tmp47, tmp24.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp50 = tmp5.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp51 = at::vec::convert<float>(tmp50);
                            auto tmp52 = decltype(tmp49)::blendv(tmp51, tmp49, tmp23.template cast<float,1>());
                            auto tmp53 = -std::numeric_limits<float>::infinity();
                            auto tmp54 = at::vec::Vectorized<float>(tmp53);
                            auto tmp55 = decltype(tmp54)::blendv(tmp52, tmp54, tmp18.template cast<float,1>());
                            return tmp55;
                        }
                        ;
                        auto tmp58 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp56 = tmp6();
                                auto tmp57 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp56)::blendv(tmp57, tmp56, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp59 = 256L + x1;
                        auto tmp60 = c10::convert<int64_t>(tmp59);
                        auto tmp61 = tmp60 < tmp3;
                        auto tmp62 = [&]
                        {
                            auto tmp63 = static_cast<int64_t>(257);
                            auto tmp64 = at::vec::VectorizedN<int64_t,2>(tmp63);
                            auto tmp65 = at::vec::VecMask<int64_t,2>(tmp2 < tmp64);
                            auto tmp67 = at::vec::VecMask<float,1>::from(tmp61);
                            auto tmp68 = tmp65 & tmp67;
                            auto tmp66 = [&]
                            {
                                auto tmp69 = 1L + x1 + x2;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(0);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 <= tmp73);
                                auto tmp75 = static_cast<float>(1.0);
                                auto tmp76 = static_cast<float>(0.0);
                                auto tmp77 = at::vec::Vectorized<float>(tmp75);
                                auto tmp78 = at::vec::Vectorized<float>(tmp76);
                                auto tmp79 = decltype(tmp77)::blendv(tmp78, tmp77, tmp74.template cast<float,1>());
                                auto tmp80 = at::vec::VecMask<float,1>::from<float,1>(tmp79);
                                auto tmp81 = tmp68.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp82 = at::vec::convert<float>(tmp81);
                                auto tmp83 = -std::numeric_limits<float>::infinity();
                                auto tmp84 = at::vec::Vectorized<float>(tmp83);
                                auto tmp85 = decltype(tmp84)::blendv(tmp82, tmp84, tmp80.template cast<float,1>());
                                return tmp85;
                            }
                            ;
                            auto tmp88 =
                            [&]
                            {
                                if (tmp68.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp86 = tmp66();
                                    auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp86)::blendv(tmp87, tmp86, tmp68.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp89 = at::vec::VecMask<float,1>::from(tmp61).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp90 = at::vec::convert<float>(tmp89);
                            auto tmp91 = decltype(tmp88)::blendv(tmp90, tmp88, tmp65.template cast<float,1>());
                            return tmp91;
                        }
                        ;
                        auto tmp92 = tmp61 ? tmp62() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp94 = at::vec::convert<float>(tmp93);
                        auto tmp95 = at::vec::VecMask<float,1>::from(tmp61);
                        auto tmp96 = decltype(tmp92)::blendv(tmp94, tmp92, tmp95.template cast<float,1>());
                        auto tmp97 = decltype(tmp58)::blendv(tmp96, tmp58, tmp5.template cast<float,1>());
                        auto tmp98 = at::vec::convert<bfloat16>(tmp97);
                        tmp98.store(out_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp64 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp6 = c10::convert<int64_t>(tmp5);
                            auto tmp7 = static_cast<int64_t>(0);
                            auto tmp8 = tmp6 <= tmp7;
                            auto tmp9 = static_cast<float>(1.0);
                            auto tmp10 = static_cast<float>(0.0);
                            auto tmp11 = tmp8 ? tmp9 : tmp10;
                            auto tmp12 = c10::convert<bool>(tmp11);
                            auto tmp13 = 256L + x1;
                            auto tmp14 = c10::convert<int64_t>(tmp13);
                            auto tmp15 = tmp14 < tmp2;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = static_cast<int64_t>(257);
                                auto tmp18 = tmp1 < tmp17;
                                auto tmp19 = [&]
                                {
                                    auto tmp20 = 1L + x1 + x2;
                                    auto tmp21 = c10::convert<int64_t>(tmp20);
                                    auto tmp22 = tmp21 <= tmp7;
                                    auto tmp23 = tmp22 ? tmp9 : tmp10;
                                    auto tmp24 = c10::convert<bool>(tmp23);
                                    auto tmp25 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                    auto tmp26 = c10::convert<float>(tmp25);
                                    auto tmp27 = -std::numeric_limits<float>::infinity();
                                    auto tmp28 = tmp24 ? tmp27 : tmp26;
                                    return tmp28;
                                }
                                ;
                                auto tmp29 = tmp18 ? tmp19() : static_cast<decltype(tmp19())>(0.0);
                                auto tmp30 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp31 = c10::convert<float>(tmp30);
                                auto tmp32 = tmp18 ? tmp29 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp34 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp35 = c10::convert<float>(tmp34);
                            auto tmp36 = tmp15 ? tmp33 : tmp35;
                            auto tmp37 = -std::numeric_limits<float>::infinity();
                            auto tmp38 = tmp12 ? tmp37 : tmp36;
                            return tmp38;
                        }
                        ;
                        auto tmp39 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp40 = 256L + x1;
                        auto tmp41 = c10::convert<int64_t>(tmp40);
                        auto tmp42 = tmp41 < tmp2;
                        auto tmp43 = [&]
                        {
                            auto tmp44 = static_cast<int64_t>(257);
                            auto tmp45 = tmp1 < tmp44;
                            auto tmp46 = [&]
                            {
                                auto tmp47 = 1L + x1 + x2;
                                auto tmp48 = c10::convert<int64_t>(tmp47);
                                auto tmp49 = static_cast<int64_t>(0);
                                auto tmp50 = tmp48 <= tmp49;
                                auto tmp51 = static_cast<float>(1.0);
                                auto tmp52 = static_cast<float>(0.0);
                                auto tmp53 = tmp50 ? tmp51 : tmp52;
                                auto tmp54 = c10::convert<bool>(tmp53);
                                auto tmp55 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp56 = c10::convert<float>(tmp55);
                                auto tmp57 = -std::numeric_limits<float>::infinity();
                                auto tmp58 = tmp54 ? tmp57 : tmp56;
                                return tmp58;
                            }
                            ;
                            auto tmp59 = tmp45 ? tmp46() : static_cast<decltype(tmp46())>(0.0);
                            auto tmp60 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp61 = c10::convert<float>(tmp60);
                            auto tmp62 = tmp45 ? tmp59 : tmp61;
                            return tmp62;
                        }
                        ;
                        auto tmp63 = tmp42 ? tmp43() : static_cast<decltype(tmp43())>(0.0);
                        auto tmp65 = c10::convert<float>(tmp64);
                        auto tmp66 = tmp42 ? tmp63 : tmp65;
                        auto tmp67 = tmp3 ? tmp39 : tmp66;
                        auto tmp68 = c10::convert<bfloat16>(tmp67);
                        out_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0))] = tmp68;
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp45 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)), 16);
                        auto tmp83 = at::vec::Vectorized<bfloat16>::loadu(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)), 16);
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr2 + static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0)));
                            auto tmp6 = at::vec::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = at::vec::VectorizedN<int64_t,2>::arange(tmp13, 1);
                            auto tmp15 = static_cast<int64_t>(257);
                            auto tmp16 = at::vec::VectorizedN<int64_t,2>(tmp15);
                            auto tmp17 = at::vec::VecMask<int64_t,2>(tmp14 < tmp16);
                            auto tmp19 = at::vec::VecMask<float,1>::from(tmp10);
                            auto tmp20 = tmp17 & tmp19;
                            auto tmp18 = [&]
                            {
                                auto tmp21 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp22 = c10::convert<int64_t>(tmp21);
                                auto tmp23 = at::vec::VectorizedN<int64_t,2>::arange(tmp22, 1);
                                auto tmp24 = static_cast<int64_t>(0);
                                auto tmp25 = at::vec::VectorizedN<int64_t,2>(tmp24);
                                auto tmp26 = at::vec::VecMask<int64_t,2>(tmp23 <= tmp25);
                                auto tmp27 = static_cast<float>(1.0);
                                auto tmp28 = static_cast<float>(0.0);
                                auto tmp29 = at::vec::Vectorized<float>(tmp27);
                                auto tmp30 = at::vec::Vectorized<float>(tmp28);
                                auto tmp31 = decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                auto tmp32 = at::vec::VecMask<float,1>::from<float,1>(tmp31);
                                auto tmp33 = tmp20.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                                auto tmp34 = at::vec::convert<float>(tmp33);
                                auto tmp35 = -std::numeric_limits<float>::infinity();
                                auto tmp36 = at::vec::Vectorized<float>(tmp35);
                                auto tmp37 = decltype(tmp36)::blendv(tmp34, tmp36, tmp32.template cast<float,1>());
                                return tmp37;
                            }
                            ;
                            auto tmp40 =
                            [&]
                            {
                                if (tmp20.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp38 = tmp18();
                                    auto tmp39 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp38)::blendv(tmp39, tmp38, tmp20.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp41 = at::vec::VecMask<float,1>::from(tmp10).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                            auto tmp42 = at::vec::convert<float>(tmp41);
                            auto tmp43 = decltype(tmp40)::blendv(tmp42, tmp40, tmp17.template cast<float,1>());
                            return tmp43;
                        }
                        ;
                        auto tmp44 = tmp10 ? tmp11() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp46 = at::vec::convert<float>(tmp45);
                        auto tmp47 = at::vec::VecMask<float,1>::from(tmp10);
                        auto tmp48 = decltype(tmp44)::blendv(tmp46, tmp44, tmp47.template cast<float,1>());
                        auto tmp49 = at::vec::VecMask<float,1>::from(tmp3);
                        auto tmp50 = decltype(tmp7)::blendv(tmp48, tmp7, tmp49.template cast<float,1>());
                        auto tmp51 = [&]
                        {
                            auto tmp52 = x2;
                            auto tmp53 = c10::convert<int64_t>(tmp52);
                            auto tmp54 = at::vec::VectorizedN<int64_t,2>::arange(tmp53, 1);
                            auto tmp55 = at::vec::VectorizedN<int64_t,2>(tmp2);
                            auto tmp56 = at::vec::VecMask<int64_t,2>(tmp54 >= tmp55);
                            auto tmp58 = tmp56 & tmp49;
                            auto tmp57 = [&]
                            {
                                auto tmp59 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp60 = c10::convert<int64_t>(tmp59);
                                auto tmp61 = at::vec::VectorizedN<int64_t,2>::arange(tmp60, -1);
                                auto tmp62 = static_cast<int64_t>(0);
                                auto tmp63 = at::vec::VectorizedN<int64_t,2>(tmp62);
                                auto tmp64 = at::vec::VecMask<int64_t,2>(tmp61 <= tmp63);
                                auto tmp65 = static_cast<float>(1.0);
                                auto tmp66 = static_cast<float>(0.0);
                                auto tmp67 = at::vec::Vectorized<float>(tmp65);
                                auto tmp68 = at::vec::Vectorized<float>(tmp66);
                                auto tmp69 = decltype(tmp67)::blendv(tmp68, tmp67, tmp64.template cast<float,1>());
                                auto tmp70 = at::vec::VecMask<float,1>::from<float,1>(tmp69);
                                auto tmp71 = tmp58.template cast<float,1>().template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                                auto tmp72 = at::vec::convert<float>(tmp71);
                                auto tmp73 = -std::numeric_limits<float>::infinity();
                                auto tmp74 = at::vec::Vectorized<float>(tmp73);
                                auto tmp75 = decltype(tmp74)::blendv(tmp72, tmp74, tmp70.template cast<float,1>());
                                return tmp75;
                            }
                            ;
                            auto tmp78 =
                            [&]
                            {
                                if (tmp58.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp76 = tmp57();
                                    auto tmp77 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp76)::blendv(tmp77, tmp76, tmp58.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp79 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                            auto tmp80 = at::vec::convert<float>(tmp79);
                            auto tmp81 = decltype(tmp78)::blendv(tmp80, tmp78, tmp56.template cast<float,1>());
                            return tmp81;
                        }
                        ;
                        auto tmp82 = tmp3 ? tmp51() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp84 = at::vec::convert<float>(tmp83);
                        auto tmp85 = decltype(tmp82)::blendv(tmp84, tmp82, tmp49.template cast<float,1>());
                        auto tmp86 = tmp50 + tmp85;
                        auto tmp87 = at::vec::convert<bfloat16>(tmp86);
                        tmp87.store(out_ptr3 + static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp34 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                        auto tmp60 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = out_ptr2[static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0))];
                            auto tmp6 = c10::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = static_cast<int64_t>(257);
                            auto tmp15 = tmp13 < tmp14;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp18 = c10::convert<int64_t>(tmp17);
                                auto tmp19 = static_cast<int64_t>(0);
                                auto tmp20 = tmp18 <= tmp19;
                                auto tmp21 = static_cast<float>(1.0);
                                auto tmp22 = static_cast<float>(0.0);
                                auto tmp23 = tmp20 ? tmp21 : tmp22;
                                auto tmp24 = c10::convert<bool>(tmp23);
                                auto tmp25 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                                auto tmp26 = c10::convert<float>(tmp25);
                                auto tmp27 = -std::numeric_limits<float>::infinity();
                                auto tmp28 = tmp24 ? tmp27 : tmp26;
                                return tmp28;
                            }
                            ;
                            auto tmp29 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp30 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                            auto tmp31 = c10::convert<float>(tmp30);
                            auto tmp32 = tmp15 ? tmp29 : tmp31;
                            return tmp32;
                        }
                        ;
                        auto tmp33 = tmp10 ? tmp11() : static_cast<decltype(tmp11())>(0.0);
                        auto tmp35 = c10::convert<float>(tmp34);
                        auto tmp36 = tmp10 ? tmp33 : tmp35;
                        auto tmp37 = tmp3 ? tmp7 : tmp36;
                        auto tmp38 = [&]
                        {
                            auto tmp39 = x2;
                            auto tmp40 = c10::convert<int64_t>(tmp39);
                            auto tmp41 = tmp40 >= tmp2;
                            auto tmp42 = [&]
                            {
                                auto tmp43 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp44 = c10::convert<int64_t>(tmp43);
                                auto tmp45 = static_cast<int64_t>(0);
                                auto tmp46 = tmp44 <= tmp45;
                                auto tmp47 = static_cast<float>(1.0);
                                auto tmp48 = static_cast<float>(0.0);
                                auto tmp49 = tmp46 ? tmp47 : tmp48;
                                auto tmp50 = c10::convert<bool>(tmp49);
                                auto tmp51 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                                auto tmp52 = c10::convert<float>(tmp51);
                                auto tmp53 = -std::numeric_limits<float>::infinity();
                                auto tmp54 = tmp50 ? tmp53 : tmp52;
                                return tmp54;
                            }
                            ;
                            auto tmp55 = tmp41 ? tmp42() : static_cast<decltype(tmp42())>(0.0);
                            auto tmp56 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                            auto tmp57 = c10::convert<float>(tmp56);
                            auto tmp58 = tmp41 ? tmp55 : tmp57;
                            return tmp58;
                        }
                        ;
                        auto tmp59 = tmp3 ? tmp38() : static_cast<decltype(tmp38())>(0.0);
                        auto tmp61 = c10::convert<float>(tmp60);
                        auto tmp62 = tmp3 ? tmp59 : tmp61;
                        auto tmp63 = decltype(tmp37)(tmp37 + tmp62);
                        auto tmp64 = c10::convert<bfloat16>(tmp63);
                        out_ptr3[static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1))] = tmp64;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(6144L); x0+=static_cast<int64_t>(1L))
            {
                {
                    float tmp_acc0 = -std::numeric_limits<float>::infinity();
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(-std::numeric_limits<float>::infinity());
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        tmp_acc0_vec = at::vec::maximum(tmp_acc0_vec, tmp1);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp1 = c10::convert<float>(tmp0);
                        tmp_acc0 = max_propagate_nan(tmp_acc0, tmp1);
                    }
                    tmp_acc0 = max_propagate_nan(tmp_acc0, at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return at::vec::maximum(x, y); }, tmp_acc0_vec));
                    out_ptr4[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
                {
                    float tmp_acc0 = 0;
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(0);
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = at::vec::Vectorized<float>(tmp2);
                        auto tmp4 = tmp1 - tmp3;
                        auto tmp5 = tmp4.exp();
                        tmp5.store(out_ptr5 + static_cast<int64_t>(x1 + (513L*x0)));
                        tmp_acc0_vec = tmp_acc0_vec + tmp5;
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = c10::convert<float>(tmp0);
                        auto tmp3 = decltype(tmp1)(tmp1 - tmp2);
                        auto tmp4 = std::exp(tmp3);
                        out_ptr5[static_cast<int64_t>(x1 + (513L*x0))] = tmp4;
                        tmp_acc0 = tmp_acc0 + tmp4;
                    }
                    tmp_acc0 = tmp_acc0 + at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return x + y; }, tmp_acc0_vec);
                    out_ptr6[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
            }
        }
    }
}
''')


cpp_fused_clone_constant_pad_nd_11 = async_compile.cpp_pybinding(['const bfloat16*', 'const bool*', 'const float*', 'const float*', 'bfloat16*', 'bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bool* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(1024L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = (-256L) + x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(0);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = static_cast<int64_t>(512);
                        auto tmp5 = tmp1 < tmp4;
                        auto tmp6 = tmp3 & tmp5;
                        auto tmp7 = [&]
                        {
                            auto tmp8 = at::vec::VecMask<float,1>::from(tmp6).template loadu<bfloat16,1>(in_ptr0 + static_cast<int64_t>((-196608L) + x2 + (64L*x0) + (768L*x1)));
                            auto tmp9 = at::vec::convert<float>(tmp8);
                            return tmp9;
                        }
                        ;
                        auto tmp10 = tmp6 ? tmp7() : at::vec::Vectorized<float>(static_cast<float>(-1.0));
                        auto tmp11 = at::vec::convert<bfloat16>(tmp10);
                        tmp11.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (65536L*x0)), 16);
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(768L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(513);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 < tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp8 = tmp5.template cast<float,1>().template loadu<float,1>(in_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0)));
                            auto tmp9 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp10 = at::vec::Vectorized<float>(tmp9);
                            auto tmp11 = tmp8 / tmp10;
                            auto tmp12 = static_cast<float>(0.0);
                            auto tmp13 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp14 = at::vec::Vectorized<float>(tmp12);
                            auto tmp15 = decltype(tmp14)::blendv(tmp11, tmp14, tmp13.template cast<float,1>());
                            auto tmp16 = (tmp15);
                            return tmp16;
                        }
                        ;
                        auto tmp19 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp17 = tmp6();
                                auto tmp18 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp17)::blendv(tmp18, tmp17, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp20 = at::vec::convert<bfloat16>(tmp19);
                        tmp20.store(out_ptr1 + static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(768L); x2<static_cast<int64_t>(770L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(513);
                        auto tmp3 = tmp1 < tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp6 = in_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0))];
                            auto tmp7 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp8 = tmp6 / tmp7;
                            auto tmp9 = static_cast<float>(0.0);
                            auto tmp10 = tmp5 ? tmp9 : tmp8;
                            auto tmp11 = c10::convert<float>(tmp10);
                            return tmp11;
                        }
                        ;
                        auto tmp12 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp13 = c10::convert<bfloat16>(tmp12);
                        out_ptr1[static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1))] = tmp13;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(49152L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x2 + (16384L*x1) + (65536L*x0)), 32);
                        tmp0.store(out_ptr2 + static_cast<int64_t>(x2 + (49152L*x1) + (98304L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused_clone_12 = async_compile.cpp_pybinding(['const bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       bfloat16* out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x2 + (64L*x0) + (32768L*x1)), 32);
                        tmp0.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (768L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_13 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    auto tmp19 = at::vec::convert<bfloat16>(tmp18);
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                    tmp19.store(out_ptr3 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_14 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<float>::loadu(out_ptr2 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<bfloat16>(tmp0);
                tmp1.store(out_ptr3 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_15 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<float>(tmp0);
                auto tmp2 = static_cast<float>(0.125);
                auto tmp3 = at::vec::Vectorized<float>(tmp2);
                auto tmp4 = tmp1 * tmp3;
                auto tmp5 = at::vec::convert<bfloat16>(tmp4);
                tmp5.store(in_out_ptr0 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_16 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(32L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 32);
                tmp0.store(in_out_ptr0 + static_cast<int64_t>(x0), 32);
            }
        }
    }
}
''')


cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_17 = async_compile.cpp_pybinding(['const bfloat16*', 'const bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'float*', 'float*', 'float*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bfloat16* in_ptr1,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2,
                       bfloat16* out_ptr3,
                       float* out_ptr4,
                       float* out_ptr5,
                       float* out_ptr6)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(2L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = at::vec::VectorizedN<int64_t,2>::arange(tmp5, 1);
                            auto tmp7 = static_cast<int64_t>(256);
                            auto tmp8 = at::vec::VectorizedN<int64_t,2>(tmp7);
                            auto tmp9 = at::vec::VecMask<int64_t,2>(tmp6 >= tmp8);
                            auto tmp10 = [&]
                            {
                                auto tmp11 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                    {
                                        if (tmp9.is_masked(x3_inner))
                                        {
                                            tmpbuf[x3_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp12 = static_cast<int64_t>(512);
                                auto tmp13 = at::vec::VectorizedN<int64_t,2>(tmp12);
                                auto tmp14 = at::vec::VecMask<int64_t,2>(tmp11 < tmp13);
                                auto tmp16 = tmp14 & tmp9;
                                auto tmp15 = [&]
                                {
                                    auto tmp17 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp16.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>(131072L + x3 + x3_inner + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp18 = at::vec::convert<float>(tmp17);
                                    return tmp18;
                                }
                                ;
                                auto tmp21 =
                                [&]
                                {
                                    if (tmp16.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp19 = tmp15();
                                        auto tmp20 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp19)::blendv(tmp20, tmp19, tmp16.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp21;
                            }
                            ;
                            auto tmp24 =
                            [&]
                            {
                                if (tmp9.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp22 = tmp10();
                                    auto tmp23 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp22)::blendv(tmp23, tmp22, tmp9.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp25 = static_cast<int64_t>(1);
                            auto tmp26 = tmp25 < tmp25;
                            auto tmp27 = [&]
                            {
                                auto tmp29 = at::vec::VecMask<float,1>::from(tmp26);
                                auto tmp30 = tmp9 & tmp29;
                                auto tmp28 = [&]
                                {
                                    auto tmp31 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp30.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp32 = static_cast<int64_t>(512);
                                    auto tmp33 = at::vec::VectorizedN<int64_t,2>(tmp32);
                                    auto tmp34 = at::vec::VecMask<int64_t,2>(tmp31 < tmp33);
                                    auto tmp36 = tmp34 & tmp30;
                                    auto tmp35 = [&]
                                    {
                                        auto tmp37 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp36.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp38 = at::vec::convert<float>(tmp37);
                                        return tmp38;
                                    }
                                    ;
                                    auto tmp41 =
                                    [&]
                                    {
                                        if (tmp36.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp39 = tmp35();
                                            auto tmp40 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp39)::blendv(tmp40, tmp39, tmp36.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp41;
                                }
                                ;
                                auto tmp44 =
                                [&]
                                {
                                    if (tmp30.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp42 = tmp28();
                                        auto tmp43 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp42)::blendv(tmp43, tmp42, tmp30.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp45 = static_cast<float>(0.0);
                                auto tmp46 = at::vec::Vectorized<float>(tmp45);
                                auto tmp47 = decltype(tmp44)::blendv(tmp46, tmp44, tmp9.template cast<float,1>());
                                return tmp47;
                            }
                            ;
                            auto tmp48 = tmp26 ? tmp27() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp49 = static_cast<float>(0.0);
                            auto tmp50 = at::vec::VecMask<float,1>::from(tmp26);
                            auto tmp51 = at::vec::Vectorized<float>(tmp49);
                            auto tmp52 = decltype(tmp48)::blendv(tmp51, tmp48, tmp50.template cast<float,1>());
                            auto tmp53 = decltype(tmp24)::blendv(tmp52, tmp24, tmp9.template cast<float,1>());
                            auto tmp54 = c10::convert<int64_t>(tmp0);
                            auto tmp55 = tmp54 < tmp25;
                            auto tmp56 = [&]
                            {
                                auto tmp58 = at::vec::VecMask<float,1>::from(tmp55);
                                auto tmp59 = tmp9 & tmp58;
                                auto tmp57 = [&]
                                {
                                    auto tmp60 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp59.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp61 = static_cast<int64_t>(512);
                                    auto tmp62 = at::vec::VectorizedN<int64_t,2>(tmp61);
                                    auto tmp63 = at::vec::VecMask<int64_t,2>(tmp60 < tmp62);
                                    auto tmp65 = tmp63 & tmp59;
                                    auto tmp64 = [&]
                                    {
                                        auto tmp66 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp65.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp67 = at::vec::convert<float>(tmp66);
                                        return tmp67;
                                    }
                                    ;
                                    auto tmp70 =
                                    [&]
                                    {
                                        if (tmp65.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp68 = tmp64();
                                            auto tmp69 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp68)::blendv(tmp69, tmp68, tmp65.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp70;
                                }
                                ;
                                auto tmp73 =
                                [&]
                                {
                                    if (tmp59.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp71 = tmp57();
                                        auto tmp72 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp71)::blendv(tmp72, tmp71, tmp59.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp74 = decltype(tmp73)::blendv(tmp51, tmp73, tmp9.template cast<float,1>());
                                return tmp74;
                            }
                            ;
                            auto tmp75 = tmp55 ? tmp56() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp76 = at::vec::VecMask<float,1>::from(tmp55);
                            auto tmp77 = decltype(tmp75)::blendv(tmp51, tmp75, tmp76.template cast<float,1>());
                            auto tmp78 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp79 = decltype(tmp53)::blendv(tmp77, tmp53, tmp78.template cast<float,1>());
                            auto tmp80 = at::vec::convert<bfloat16>(tmp79);
                            tmp80.store(out_ptr0 + static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(256);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + (513L*x1))), static_cast<int64_t>(512L)));
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = static_cast<int64_t>(512);
                                auto tmp12 = tmp10 < tmp11;
                                auto tmp13 = [&]
                                {
                                    auto tmp14 = in_ptr0[static_cast<int64_t>(131072L + x3 + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                    auto tmp15 = c10::convert<float>(tmp14);
                                    return tmp15;
                                }
                                ;
                                auto tmp16 = tmp12 ? tmp13() : static_cast<decltype(tmp13())>(0.0);
                                return tmp16;
                            }
                            ;
                            auto tmp17 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp18 = static_cast<int64_t>(1);
                            auto tmp19 = tmp18 < tmp18;
                            auto tmp20 = [&]
                            {
                                auto tmp21 = [&]
                                {
                                    auto tmp22 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp23 = c10::convert<int64_t>(tmp22);
                                    auto tmp24 = static_cast<int64_t>(512);
                                    auto tmp25 = tmp23 < tmp24;
                                    auto tmp26 = [&]
                                    {
                                        auto tmp27 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                        auto tmp28 = c10::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp29 = tmp25 ? tmp26() : static_cast<decltype(tmp26())>(0.0);
                                    return tmp29;
                                }
                                ;
                                auto tmp30 = tmp7 ? tmp21() : static_cast<decltype(tmp21())>(0.0);
                                auto tmp31 = static_cast<float>(0.0);
                                auto tmp32 = tmp7 ? tmp30 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                            auto tmp34 = static_cast<float>(0.0);
                            auto tmp35 = tmp19 ? tmp33 : tmp34;
                            auto tmp36 = tmp7 ? tmp17 : tmp35;
                            auto tmp37 = c10::convert<int64_t>(tmp0);
                            auto tmp38 = tmp37 < tmp18;
                            auto tmp39 = [&]
                            {
                                auto tmp40 = [&]
                                {
                                    auto tmp41 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp42 = c10::convert<int64_t>(tmp41);
                                    auto tmp43 = static_cast<int64_t>(512);
                                    auto tmp44 = tmp42 < tmp43;
                                    auto tmp45 = [&]
                                    {
                                        auto tmp46 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                        auto tmp47 = c10::convert<float>(tmp46);
                                        return tmp47;
                                    }
                                    ;
                                    auto tmp48 = tmp44 ? tmp45() : static_cast<decltype(tmp45())>(0.0);
                                    return tmp48;
                                }
                                ;
                                auto tmp49 = tmp7 ? tmp40() : static_cast<decltype(tmp40())>(0.0);
                                auto tmp50 = tmp7 ? tmp49 : tmp34;
                                return tmp50;
                            }
                            ;
                            auto tmp51 = tmp38 ? tmp39() : static_cast<decltype(tmp39())>(0.0);
                            auto tmp52 = tmp38 ? tmp51 : tmp34;
                            auto tmp53 = tmp3 ? tmp36 : tmp52;
                            auto tmp54 = c10::convert<bfloat16>(tmp53);
                            out_ptr0[static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0))] = tmp54;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(256L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp96 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp132 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = at::vec::VectorizedN<int64_t,2>::arange(tmp10, 1);
                                auto tmp12 = at::vec::VectorizedN<int64_t,2>(tmp6);
                                auto tmp13 = at::vec::VecMask<int64_t,2>(tmp11 >= tmp12);
                                auto tmp14 = static_cast<int64_t>(256);
                                auto tmp15 = at::vec::VectorizedN<int64_t,2>(tmp14);
                                auto tmp16 = at::vec::VecMask<int64_t,2>(tmp11 < tmp15);
                                auto tmp17 = tmp13 & tmp16;
                                auto tmp19 = at::vec::VecMask<float,1>::from(tmp7);
                                auto tmp20 = tmp17 & tmp19;
                                auto tmp18 = [&]
                                {
                                    auto tmp21 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp20.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp22 = static_cast<int64_t>(512);
                                    auto tmp23 = at::vec::VectorizedN<int64_t,2>(tmp22);
                                    auto tmp24 = at::vec::VecMask<int64_t,2>(tmp21 < tmp23);
                                    auto tmp26 = tmp24 & tmp20;
                                    auto tmp25 = [&]
                                    {
                                        auto tmp27 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp26.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp28 = at::vec::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp31 =
                                    [&]
                                    {
                                        if (tmp26.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp29 = tmp25();
                                            auto tmp30 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp31;
                                }
                                ;
                                auto tmp34 =
                                [&]
                                {
                                    if (tmp20.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp32 = tmp18();
                                        auto tmp33 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp32)::blendv(tmp33, tmp32, tmp20.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp35 = static_cast<int64_t>(0);
                                auto tmp36 = tmp35 >= tmp6;
                                auto tmp38 = tmp36 & tmp7;
                                auto tmp37 = [&]
                                {
                                    auto tmp40 = at::vec::VecMask<float,1>::from(tmp38);
                                    auto tmp41 = tmp16 & tmp40;
                                    auto tmp39 = [&]
                                    {
                                        auto tmp42 =
                                        [&]
                                        {
                                            __at_align__ std::array<int64_t, 16> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp41.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                                }
                                            }
                                            return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp43 = static_cast<int64_t>(512);
                                        auto tmp44 = at::vec::VectorizedN<int64_t,2>(tmp43);
                                        auto tmp45 = at::vec::VecMask<int64_t,2>(tmp42 < tmp44);
                                        auto tmp47 = tmp45 & tmp41;
                                        auto tmp46 = [&]
                                        {
                                            auto tmp48 =
                                            [&]
                                            {
                                                __at_align__ std::array<bfloat16, 32> tmpbuf;
                                                #pragma GCC unroll 16
                                                for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                                {
                                                    if (tmp47.is_masked(x3_inner))
                                                    {
                                                        tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                    }
                                                }
                                                return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                            }
                                            ()
                                            ;
                                            auto tmp49 = at::vec::convert<float>(tmp48);
                                            return tmp49;
                                        }
                                        ;
                                        auto tmp52 =
                                        [&]
                                        {
                                            if (tmp47.all_zero())
                                            {
                                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            }
                                            else
                                            {
                                                auto tmp50 = tmp46();
                                                auto tmp51 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                                return decltype(tmp50)::blendv(tmp51, tmp50, tmp47.template cast<float,1>());
                                            }
                                        }
                                        ()
                                        ;
                                        return tmp52;
                                    }
                                    ;
                                    auto tmp55 =
                                    [&]
                                    {
                                        if (tmp41.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp53 = tmp39();
                                            auto tmp54 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp53)::blendv(tmp54, tmp53, tmp41.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    auto tmp56 = at::vec::VecMask<float,1>::from(tmp38).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                    auto tmp57 = at::vec::convert<float>(tmp56);
                                    auto tmp58 = decltype(tmp55)::blendv(tmp57, tmp55, tmp16.template cast<float,1>());
                                    return tmp58;
                                }
                                ;
                                auto tmp59 = tmp36 ? tmp37() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                                auto tmp60 = at::vec::VecMask<float,1>::from(tmp7).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp61 = at::vec::convert<float>(tmp60);
                                auto tmp62 = at::vec::VecMask<float,1>::from(tmp36);
                                auto tmp63 = decltype(tmp59)::blendv(tmp61, tmp59, tmp62.template cast<float,1>());
                                auto tmp64 = decltype(tmp34)::blendv(tmp63, tmp34, tmp17.template cast<float,1>());
                                return tmp64;
                            }
                            ;
                            auto tmp65 = tmp7 ? tmp8() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp66 = static_cast<int64_t>(0);
                            auto tmp67 = tmp66 >= tmp6;
                            auto tmp68 = [&]
                            {
                                auto tmp69 = x3;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(256);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 < tmp73);
                                auto tmp76 = at::vec::VecMask<float,1>::from(tmp67);
                                auto tmp77 = tmp74 & tmp76;
                                auto tmp75 = [&]
                                {
                                    auto tmp78 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp77.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp79 = static_cast<int64_t>(512);
                                    auto tmp80 = at::vec::VectorizedN<int64_t,2>(tmp79);
                                    auto tmp81 = at::vec::VecMask<int64_t,2>(tmp78 < tmp80);
                                    auto tmp83 = tmp81 & tmp77;
                                    auto tmp82 = [&]
                                    {
                                        auto tmp84 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp83.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp85 = at::vec::convert<float>(tmp84);
                                        return tmp85;
                                    }
                                    ;
                                    auto tmp88 =
                                    [&]
                                    {
                                        if (tmp83.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp86 = tmp82();
                                            auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp86)::blendv(tmp87, tmp86, tmp83.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp88;
                                }
                                ;
                                auto tmp91 =
                                [&]
                                {
                                    if (tmp77.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp89 = tmp75();
                                        auto tmp90 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp89)::blendv(tmp90, tmp89, tmp77.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp92 = at::vec::VecMask<float,1>::from(tmp67).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp93 = at::vec::convert<float>(tmp92);
                                auto tmp94 = decltype(tmp91)::blendv(tmp93, tmp91, tmp74.template cast<float,1>());
                                return tmp94;
                            }
                            ;
                            auto tmp95 = tmp67 ? tmp68() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp97 = at::vec::convert<float>(tmp96);
                            auto tmp98 = at::vec::VecMask<float,1>::from(tmp67);
                            auto tmp99 = decltype(tmp95)::blendv(tmp97, tmp95, tmp98.template cast<float,1>());
                            auto tmp100 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp101 = decltype(tmp65)::blendv(tmp99, tmp65, tmp100.template cast<float,1>());
                            auto tmp102 = c10::convert<int64_t>(tmp0);
                            auto tmp103 = tmp102 >= tmp6;
                            auto tmp104 = [&]
                            {
                                auto tmp105 = x3;
                                auto tmp106 = c10::convert<int64_t>(tmp105);
                                auto tmp107 = at::vec::VectorizedN<int64_t,2>::arange(tmp106, 1);
                                auto tmp108 = static_cast<int64_t>(256);
                                auto tmp109 = at::vec::VectorizedN<int64_t,2>(tmp108);
                                auto tmp110 = at::vec::VecMask<int64_t,2>(tmp107 < tmp109);
                                auto tmp112 = at::vec::VecMask<float,1>::from(tmp103);
                                auto tmp113 = tmp110 & tmp112;
                                auto tmp111 = [&]
                                {
                                    auto tmp114 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp113.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp115 = static_cast<int64_t>(512);
                                    auto tmp116 = at::vec::VectorizedN<int64_t,2>(tmp115);
                                    auto tmp117 = at::vec::VecMask<int64_t,2>(tmp114 < tmp116);
                                    auto tmp119 = tmp117 & tmp113;
                                    auto tmp118 = [&]
                                    {
                                        auto tmp120 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp119.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp121 = at::vec::convert<float>(tmp120);
                                        return tmp121;
                                    }
                                    ;
                                    auto tmp124 =
                                    [&]
                                    {
                                        if (tmp119.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp122 = tmp118();
                                            auto tmp123 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp122)::blendv(tmp123, tmp122, tmp119.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp124;
                                }
                                ;
                                auto tmp127 =
                                [&]
                                {
                                    if (tmp113.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp125 = tmp111();
                                        auto tmp126 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp125)::blendv(tmp126, tmp125, tmp113.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp128 = at::vec::VecMask<float,1>::from(tmp103).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp129 = at::vec::convert<float>(tmp128);
                                auto tmp130 = decltype(tmp127)::blendv(tmp129, tmp127, tmp110.template cast<float,1>());
                                return tmp130;
                            }
                            ;
                            auto tmp131 = tmp103 ? tmp104() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp133 = at::vec::convert<float>(tmp132);
                            auto tmp134 = at::vec::VecMask<float,1>::from(tmp103);
                            auto tmp135 = decltype(tmp131)::blendv(tmp133, tmp131, tmp134.template cast<float,1>());
                            auto tmp136 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp137 = decltype(tmp101)::blendv(tmp135, tmp101, tmp136.template cast<float,1>());
                            auto tmp138 = at::vec::convert<bfloat16>(tmp137);
                            tmp138.store(out_ptr1 + static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp68 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                            auto tmp93 = out_ptr0[static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0))];
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = tmp10 >= tmp6;
                                auto tmp12 = static_cast<int64_t>(256);
                                auto tmp13 = tmp10 < tmp12;
                                auto tmp14 = tmp11 & tmp13;
                                auto tmp15 = [&]
                                {
                                    auto tmp16 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp17 = c10::convert<int64_t>(tmp16);
                                    auto tmp18 = static_cast<int64_t>(512);
                                    auto tmp19 = tmp17 < tmp18;
                                    auto tmp20 = [&]
                                    {
                                        auto tmp21 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                        auto tmp22 = c10::convert<float>(tmp21);
                                        return tmp22;
                                    }
                                    ;
                                    auto tmp23 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                                    return tmp23;
                                }
                                ;
                                auto tmp24 = tmp14 ? tmp15() : static_cast<decltype(tmp15())>(0.0);
                                auto tmp25 = static_cast<int64_t>(0);
                                auto tmp26 = tmp25 >= tmp6;
                                auto tmp27 = [&]
                                {
                                    auto tmp28 = [&]
                                    {
                                        auto tmp29 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                        auto tmp30 = c10::convert<int64_t>(tmp29);
                                        auto tmp31 = static_cast<int64_t>(512);
                                        auto tmp32 = tmp30 < tmp31;
                                        auto tmp33 = [&]
                                        {
                                            auto tmp34 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                            auto tmp35 = c10::convert<float>(tmp34);
                                            return tmp35;
                                        }
                                        ;
                                        auto tmp36 = tmp32 ? tmp33() : static_cast<decltype(tmp33())>(0.0);
                                        return tmp36;
                                    }
                                    ;
                                    auto tmp37 = tmp13 ? tmp28() : static_cast<decltype(tmp28())>(0.0);
                                    auto tmp38 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                    auto tmp39 = c10::convert<float>(tmp38);
                                    auto tmp40 = tmp13 ? tmp37 : tmp39;
                                    return tmp40;
                                }
                                ;
                                auto tmp41 = tmp26 ? tmp27() : static_cast<decltype(tmp27())>(0.0);
                                auto tmp42 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp43 = c10::convert<float>(tmp42);
                                auto tmp44 = tmp26 ? tmp41 : tmp43;
                                auto tmp45 = tmp14 ? tmp24 : tmp44;
                                return tmp45;
                            }
                            ;
                            auto tmp46 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp47 = static_cast<int64_t>(0);
                            auto tmp48 = tmp47 >= tmp6;
                            auto tmp49 = [&]
                            {
                                auto tmp50 = x3;
                                auto tmp51 = c10::convert<int64_t>(tmp50);
                                auto tmp52 = static_cast<int64_t>(256);
                                auto tmp53 = tmp51 < tmp52;
                                auto tmp54 = [&]
                                {
                                    auto tmp55 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp56 = c10::convert<int64_t>(tmp55);
                                    auto tmp57 = static_cast<int64_t>(512);
                                    auto tmp58 = tmp56 < tmp57;
                                    auto tmp59 = [&]
                                    {
                                        auto tmp60 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp61 = c10::convert<float>(tmp60);
                                        return tmp61;
                                    }
                                    ;
                                    auto tmp62 = tmp58 ? tmp59() : static_cast<decltype(tmp59())>(0.0);
                                    return tmp62;
                                }
                                ;
                                auto tmp63 = tmp53 ? tmp54() : static_cast<decltype(tmp54())>(0.0);
                                auto tmp64 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp65 = c10::convert<float>(tmp64);
                                auto tmp66 = tmp53 ? tmp63 : tmp65;
                                return tmp66;
                            }
                            ;
                            auto tmp67 = tmp48 ? tmp49() : static_cast<decltype(tmp49())>(0.0);
                            auto tmp69 = c10::convert<float>(tmp68);
                            auto tmp70 = tmp48 ? tmp67 : tmp69;
                            auto tmp71 = tmp7 ? tmp46 : tmp70;
                            auto tmp72 = c10::convert<int64_t>(tmp0);
                            auto tmp73 = tmp72 >= tmp6;
                            auto tmp74 = [&]
                            {
                                auto tmp75 = x3;
                                auto tmp76 = c10::convert<int64_t>(tmp75);
                                auto tmp77 = static_cast<int64_t>(256);
                                auto tmp78 = tmp76 < tmp77;
                                auto tmp79 = [&]
                                {
                                    auto tmp80 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp81 = c10::convert<int64_t>(tmp80);
                                    auto tmp82 = static_cast<int64_t>(512);
                                    auto tmp83 = tmp81 < tmp82;
                                    auto tmp84 = [&]
                                    {
                                        auto tmp85 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp86 = c10::convert<float>(tmp85);
                                        return tmp86;
                                    }
                                    ;
                                    auto tmp87 = tmp83 ? tmp84() : static_cast<decltype(tmp84())>(0.0);
                                    return tmp87;
                                }
                                ;
                                auto tmp88 = tmp78 ? tmp79() : static_cast<decltype(tmp79())>(0.0);
                                auto tmp89 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp90 = c10::convert<float>(tmp89);
                                auto tmp91 = tmp78 ? tmp88 : tmp90;
                                return tmp91;
                            }
                            ;
                            auto tmp92 = tmp73 ? tmp74() : static_cast<decltype(tmp74())>(0.0);
                            auto tmp94 = c10::convert<float>(tmp93);
                            auto tmp95 = tmp73 ? tmp92 : tmp94;
                            auto tmp96 = tmp3 ? tmp71 : tmp95;
                            auto tmp97 = c10::convert<bfloat16>(tmp96);
                            out_ptr1[static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0))] = tmp97;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp93 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)), 16);
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(256);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 >= tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp8 = c10::convert<int64_t>(tmp7);
                            auto tmp9 = at::vec::VectorizedN<int64_t,2>::arange(tmp8, -1);
                            auto tmp10 = static_cast<int64_t>(0);
                            auto tmp11 = at::vec::VectorizedN<int64_t,2>(tmp10);
                            auto tmp12 = at::vec::VecMask<int64_t,2>(tmp9 <= tmp11);
                            auto tmp13 = static_cast<float>(1.0);
                            auto tmp14 = static_cast<float>(0.0);
                            auto tmp15 = at::vec::Vectorized<float>(tmp13);
                            auto tmp16 = at::vec::Vectorized<float>(tmp14);
                            auto tmp17 = decltype(tmp15)::blendv(tmp16, tmp15, tmp12.template cast<float,1>());
                            auto tmp18 = at::vec::VecMask<float,1>::from<float,1>(tmp17);
                            auto tmp19 = 256L + x1;
                            auto tmp20 = c10::convert<int64_t>(tmp19);
                            auto tmp21 = tmp20 < tmp3;
                            auto tmp23 = at::vec::VecMask<float,1>::from(tmp21);
                            auto tmp24 = tmp23 & tmp5;
                            auto tmp22 = [&]
                            {
                                auto tmp25 = static_cast<int64_t>(257);
                                auto tmp26 = at::vec::VectorizedN<int64_t,2>(tmp25);
                                auto tmp27 = at::vec::VecMask<int64_t,2>(tmp2 < tmp26);
                                auto tmp29 = tmp27 & tmp24;
                                auto tmp28 = [&]
                                {
                                    auto tmp30 = 1L + x1 + x2;
                                    auto tmp31 = c10::convert<int64_t>(tmp30);
                                    auto tmp32 = at::vec::VectorizedN<int64_t,2>::arange(tmp31, 1);
                                    auto tmp33 = at::vec::VecMask<int64_t,2>(tmp32 <= tmp11);
                                    auto tmp34 = decltype(tmp15)::blendv(tmp16, tmp15, tmp33.template cast<float,1>());
                                    auto tmp35 = at::vec::VecMask<float,1>::from<float,1>(tmp34);
                                    auto tmp36 = tmp29.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                    auto tmp37 = at::vec::convert<float>(tmp36);
                                    auto tmp38 = -std::numeric_limits<float>::infinity();
                                    auto tmp39 = at::vec::Vectorized<float>(tmp38);
                                    auto tmp40 = decltype(tmp39)::blendv(tmp37, tmp39, tmp35.template cast<float,1>());
                                    return tmp40;
                                }
                                ;
                                auto tmp43 =
                                [&]
                                {
                                    if (tmp29.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp41 = tmp28();
                                        auto tmp42 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp41)::blendv(tmp42, tmp41, tmp29.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp44 = tmp24.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp45 = at::vec::convert<float>(tmp44);
                                auto tmp46 = decltype(tmp43)::blendv(tmp45, tmp43, tmp27.template cast<float,1>());
                                return tmp46;
                            }
                            ;
                            auto tmp49 =
                            [&]
                            {
                                if (tmp24.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp47 = tmp22();
                                    auto tmp48 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp47)::blendv(tmp48, tmp47, tmp24.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp50 = tmp5.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp51 = at::vec::convert<float>(tmp50);
                            auto tmp52 = decltype(tmp49)::blendv(tmp51, tmp49, tmp23.template cast<float,1>());
                            auto tmp53 = -std::numeric_limits<float>::infinity();
                            auto tmp54 = at::vec::Vectorized<float>(tmp53);
                            auto tmp55 = decltype(tmp54)::blendv(tmp52, tmp54, tmp18.template cast<float,1>());
                            return tmp55;
                        }
                        ;
                        auto tmp58 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp56 = tmp6();
                                auto tmp57 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp56)::blendv(tmp57, tmp56, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp59 = 256L + x1;
                        auto tmp60 = c10::convert<int64_t>(tmp59);
                        auto tmp61 = tmp60 < tmp3;
                        auto tmp62 = [&]
                        {
                            auto tmp63 = static_cast<int64_t>(257);
                            auto tmp64 = at::vec::VectorizedN<int64_t,2>(tmp63);
                            auto tmp65 = at::vec::VecMask<int64_t,2>(tmp2 < tmp64);
                            auto tmp67 = at::vec::VecMask<float,1>::from(tmp61);
                            auto tmp68 = tmp65 & tmp67;
                            auto tmp66 = [&]
                            {
                                auto tmp69 = 1L + x1 + x2;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(0);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 <= tmp73);
                                auto tmp75 = static_cast<float>(1.0);
                                auto tmp76 = static_cast<float>(0.0);
                                auto tmp77 = at::vec::Vectorized<float>(tmp75);
                                auto tmp78 = at::vec::Vectorized<float>(tmp76);
                                auto tmp79 = decltype(tmp77)::blendv(tmp78, tmp77, tmp74.template cast<float,1>());
                                auto tmp80 = at::vec::VecMask<float,1>::from<float,1>(tmp79);
                                auto tmp81 = tmp68.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp82 = at::vec::convert<float>(tmp81);
                                auto tmp83 = -std::numeric_limits<float>::infinity();
                                auto tmp84 = at::vec::Vectorized<float>(tmp83);
                                auto tmp85 = decltype(tmp84)::blendv(tmp82, tmp84, tmp80.template cast<float,1>());
                                return tmp85;
                            }
                            ;
                            auto tmp88 =
                            [&]
                            {
                                if (tmp68.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp86 = tmp66();
                                    auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp86)::blendv(tmp87, tmp86, tmp68.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp89 = at::vec::VecMask<float,1>::from(tmp61).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp90 = at::vec::convert<float>(tmp89);
                            auto tmp91 = decltype(tmp88)::blendv(tmp90, tmp88, tmp65.template cast<float,1>());
                            return tmp91;
                        }
                        ;
                        auto tmp92 = tmp61 ? tmp62() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp94 = at::vec::convert<float>(tmp93);
                        auto tmp95 = at::vec::VecMask<float,1>::from(tmp61);
                        auto tmp96 = decltype(tmp92)::blendv(tmp94, tmp92, tmp95.template cast<float,1>());
                        auto tmp97 = decltype(tmp58)::blendv(tmp96, tmp58, tmp5.template cast<float,1>());
                        auto tmp98 = at::vec::convert<bfloat16>(tmp97);
                        tmp98.store(out_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp64 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp6 = c10::convert<int64_t>(tmp5);
                            auto tmp7 = static_cast<int64_t>(0);
                            auto tmp8 = tmp6 <= tmp7;
                            auto tmp9 = static_cast<float>(1.0);
                            auto tmp10 = static_cast<float>(0.0);
                            auto tmp11 = tmp8 ? tmp9 : tmp10;
                            auto tmp12 = c10::convert<bool>(tmp11);
                            auto tmp13 = 256L + x1;
                            auto tmp14 = c10::convert<int64_t>(tmp13);
                            auto tmp15 = tmp14 < tmp2;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = static_cast<int64_t>(257);
                                auto tmp18 = tmp1 < tmp17;
                                auto tmp19 = [&]
                                {
                                    auto tmp20 = 1L + x1 + x2;
                                    auto tmp21 = c10::convert<int64_t>(tmp20);
                                    auto tmp22 = tmp21 <= tmp7;
                                    auto tmp23 = tmp22 ? tmp9 : tmp10;
                                    auto tmp24 = c10::convert<bool>(tmp23);
                                    auto tmp25 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                    auto tmp26 = c10::convert<float>(tmp25);
                                    auto tmp27 = -std::numeric_limits<float>::infinity();
                                    auto tmp28 = tmp24 ? tmp27 : tmp26;
                                    return tmp28;
                                }
                                ;
                                auto tmp29 = tmp18 ? tmp19() : static_cast<decltype(tmp19())>(0.0);
                                auto tmp30 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp31 = c10::convert<float>(tmp30);
                                auto tmp32 = tmp18 ? tmp29 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp34 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp35 = c10::convert<float>(tmp34);
                            auto tmp36 = tmp15 ? tmp33 : tmp35;
                            auto tmp37 = -std::numeric_limits<float>::infinity();
                            auto tmp38 = tmp12 ? tmp37 : tmp36;
                            return tmp38;
                        }
                        ;
                        auto tmp39 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp40 = 256L + x1;
                        auto tmp41 = c10::convert<int64_t>(tmp40);
                        auto tmp42 = tmp41 < tmp2;
                        auto tmp43 = [&]
                        {
                            auto tmp44 = static_cast<int64_t>(257);
                            auto tmp45 = tmp1 < tmp44;
                            auto tmp46 = [&]
                            {
                                auto tmp47 = 1L + x1 + x2;
                                auto tmp48 = c10::convert<int64_t>(tmp47);
                                auto tmp49 = static_cast<int64_t>(0);
                                auto tmp50 = tmp48 <= tmp49;
                                auto tmp51 = static_cast<float>(1.0);
                                auto tmp52 = static_cast<float>(0.0);
                                auto tmp53 = tmp50 ? tmp51 : tmp52;
                                auto tmp54 = c10::convert<bool>(tmp53);
                                auto tmp55 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp56 = c10::convert<float>(tmp55);
                                auto tmp57 = -std::numeric_limits<float>::infinity();
                                auto tmp58 = tmp54 ? tmp57 : tmp56;
                                return tmp58;
                            }
                            ;
                            auto tmp59 = tmp45 ? tmp46() : static_cast<decltype(tmp46())>(0.0);
                            auto tmp60 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp61 = c10::convert<float>(tmp60);
                            auto tmp62 = tmp45 ? tmp59 : tmp61;
                            return tmp62;
                        }
                        ;
                        auto tmp63 = tmp42 ? tmp43() : static_cast<decltype(tmp43())>(0.0);
                        auto tmp65 = c10::convert<float>(tmp64);
                        auto tmp66 = tmp42 ? tmp63 : tmp65;
                        auto tmp67 = tmp3 ? tmp39 : tmp66;
                        auto tmp68 = c10::convert<bfloat16>(tmp67);
                        out_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0))] = tmp68;
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp45 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)), 16);
                        auto tmp83 = at::vec::Vectorized<bfloat16>::loadu(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)), 16);
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr2 + static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0)));
                            auto tmp6 = at::vec::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = at::vec::VectorizedN<int64_t,2>::arange(tmp13, 1);
                            auto tmp15 = static_cast<int64_t>(257);
                            auto tmp16 = at::vec::VectorizedN<int64_t,2>(tmp15);
                            auto tmp17 = at::vec::VecMask<int64_t,2>(tmp14 < tmp16);
                            auto tmp19 = at::vec::VecMask<float,1>::from(tmp10);
                            auto tmp20 = tmp17 & tmp19;
                            auto tmp18 = [&]
                            {
                                auto tmp21 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp22 = c10::convert<int64_t>(tmp21);
                                auto tmp23 = at::vec::VectorizedN<int64_t,2>::arange(tmp22, 1);
                                auto tmp24 = static_cast<int64_t>(0);
                                auto tmp25 = at::vec::VectorizedN<int64_t,2>(tmp24);
                                auto tmp26 = at::vec::VecMask<int64_t,2>(tmp23 <= tmp25);
                                auto tmp27 = static_cast<float>(1.0);
                                auto tmp28 = static_cast<float>(0.0);
                                auto tmp29 = at::vec::Vectorized<float>(tmp27);
                                auto tmp30 = at::vec::Vectorized<float>(tmp28);
                                auto tmp31 = decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                auto tmp32 = at::vec::VecMask<float,1>::from<float,1>(tmp31);
                                auto tmp33 = tmp20.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                                auto tmp34 = at::vec::convert<float>(tmp33);
                                auto tmp35 = -std::numeric_limits<float>::infinity();
                                auto tmp36 = at::vec::Vectorized<float>(tmp35);
                                auto tmp37 = decltype(tmp36)::blendv(tmp34, tmp36, tmp32.template cast<float,1>());
                                return tmp37;
                            }
                            ;
                            auto tmp40 =
                            [&]
                            {
                                if (tmp20.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp38 = tmp18();
                                    auto tmp39 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp38)::blendv(tmp39, tmp38, tmp20.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp41 = at::vec::VecMask<float,1>::from(tmp10).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                            auto tmp42 = at::vec::convert<float>(tmp41);
                            auto tmp43 = decltype(tmp40)::blendv(tmp42, tmp40, tmp17.template cast<float,1>());
                            return tmp43;
                        }
                        ;
                        auto tmp44 = tmp10 ? tmp11() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp46 = at::vec::convert<float>(tmp45);
                        auto tmp47 = at::vec::VecMask<float,1>::from(tmp10);
                        auto tmp48 = decltype(tmp44)::blendv(tmp46, tmp44, tmp47.template cast<float,1>());
                        auto tmp49 = at::vec::VecMask<float,1>::from(tmp3);
                        auto tmp50 = decltype(tmp7)::blendv(tmp48, tmp7, tmp49.template cast<float,1>());
                        auto tmp51 = [&]
                        {
                            auto tmp52 = x2;
                            auto tmp53 = c10::convert<int64_t>(tmp52);
                            auto tmp54 = at::vec::VectorizedN<int64_t,2>::arange(tmp53, 1);
                            auto tmp55 = at::vec::VectorizedN<int64_t,2>(tmp2);
                            auto tmp56 = at::vec::VecMask<int64_t,2>(tmp54 >= tmp55);
                            auto tmp58 = tmp56 & tmp49;
                            auto tmp57 = [&]
                            {
                                auto tmp59 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp60 = c10::convert<int64_t>(tmp59);
                                auto tmp61 = at::vec::VectorizedN<int64_t,2>::arange(tmp60, -1);
                                auto tmp62 = static_cast<int64_t>(0);
                                auto tmp63 = at::vec::VectorizedN<int64_t,2>(tmp62);
                                auto tmp64 = at::vec::VecMask<int64_t,2>(tmp61 <= tmp63);
                                auto tmp65 = static_cast<float>(1.0);
                                auto tmp66 = static_cast<float>(0.0);
                                auto tmp67 = at::vec::Vectorized<float>(tmp65);
                                auto tmp68 = at::vec::Vectorized<float>(tmp66);
                                auto tmp69 = decltype(tmp67)::blendv(tmp68, tmp67, tmp64.template cast<float,1>());
                                auto tmp70 = at::vec::VecMask<float,1>::from<float,1>(tmp69);
                                auto tmp71 = tmp58.template cast<float,1>().template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                                auto tmp72 = at::vec::convert<float>(tmp71);
                                auto tmp73 = -std::numeric_limits<float>::infinity();
                                auto tmp74 = at::vec::Vectorized<float>(tmp73);
                                auto tmp75 = decltype(tmp74)::blendv(tmp72, tmp74, tmp70.template cast<float,1>());
                                return tmp75;
                            }
                            ;
                            auto tmp78 =
                            [&]
                            {
                                if (tmp58.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp76 = tmp57();
                                    auto tmp77 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp76)::blendv(tmp77, tmp76, tmp58.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp79 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                            auto tmp80 = at::vec::convert<float>(tmp79);
                            auto tmp81 = decltype(tmp78)::blendv(tmp80, tmp78, tmp56.template cast<float,1>());
                            return tmp81;
                        }
                        ;
                        auto tmp82 = tmp3 ? tmp51() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp84 = at::vec::convert<float>(tmp83);
                        auto tmp85 = decltype(tmp82)::blendv(tmp84, tmp82, tmp49.template cast<float,1>());
                        auto tmp86 = tmp50 + tmp85;
                        auto tmp87 = at::vec::convert<bfloat16>(tmp86);
                        tmp87.store(out_ptr3 + static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp34 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                        auto tmp60 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = out_ptr2[static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0))];
                            auto tmp6 = c10::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = static_cast<int64_t>(257);
                            auto tmp15 = tmp13 < tmp14;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp18 = c10::convert<int64_t>(tmp17);
                                auto tmp19 = static_cast<int64_t>(0);
                                auto tmp20 = tmp18 <= tmp19;
                                auto tmp21 = static_cast<float>(1.0);
                                auto tmp22 = static_cast<float>(0.0);
                                auto tmp23 = tmp20 ? tmp21 : tmp22;
                                auto tmp24 = c10::convert<bool>(tmp23);
                                auto tmp25 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                                auto tmp26 = c10::convert<float>(tmp25);
                                auto tmp27 = -std::numeric_limits<float>::infinity();
                                auto tmp28 = tmp24 ? tmp27 : tmp26;
                                return tmp28;
                            }
                            ;
                            auto tmp29 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp30 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                            auto tmp31 = c10::convert<float>(tmp30);
                            auto tmp32 = tmp15 ? tmp29 : tmp31;
                            return tmp32;
                        }
                        ;
                        auto tmp33 = tmp10 ? tmp11() : static_cast<decltype(tmp11())>(0.0);
                        auto tmp35 = c10::convert<float>(tmp34);
                        auto tmp36 = tmp10 ? tmp33 : tmp35;
                        auto tmp37 = tmp3 ? tmp7 : tmp36;
                        auto tmp38 = [&]
                        {
                            auto tmp39 = x2;
                            auto tmp40 = c10::convert<int64_t>(tmp39);
                            auto tmp41 = tmp40 >= tmp2;
                            auto tmp42 = [&]
                            {
                                auto tmp43 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp44 = c10::convert<int64_t>(tmp43);
                                auto tmp45 = static_cast<int64_t>(0);
                                auto tmp46 = tmp44 <= tmp45;
                                auto tmp47 = static_cast<float>(1.0);
                                auto tmp48 = static_cast<float>(0.0);
                                auto tmp49 = tmp46 ? tmp47 : tmp48;
                                auto tmp50 = c10::convert<bool>(tmp49);
                                auto tmp51 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                                auto tmp52 = c10::convert<float>(tmp51);
                                auto tmp53 = -std::numeric_limits<float>::infinity();
                                auto tmp54 = tmp50 ? tmp53 : tmp52;
                                return tmp54;
                            }
                            ;
                            auto tmp55 = tmp41 ? tmp42() : static_cast<decltype(tmp42())>(0.0);
                            auto tmp56 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                            auto tmp57 = c10::convert<float>(tmp56);
                            auto tmp58 = tmp41 ? tmp55 : tmp57;
                            return tmp58;
                        }
                        ;
                        auto tmp59 = tmp3 ? tmp38() : static_cast<decltype(tmp38())>(0.0);
                        auto tmp61 = c10::convert<float>(tmp60);
                        auto tmp62 = tmp3 ? tmp59 : tmp61;
                        auto tmp63 = decltype(tmp37)(tmp37 + tmp62);
                        auto tmp64 = c10::convert<bfloat16>(tmp63);
                        out_ptr3[static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1))] = tmp64;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(6144L); x0+=static_cast<int64_t>(1L))
            {
                {
                    float tmp_acc0 = -std::numeric_limits<float>::infinity();
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(-std::numeric_limits<float>::infinity());
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        tmp_acc0_vec = at::vec::maximum(tmp_acc0_vec, tmp1);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp1 = c10::convert<float>(tmp0);
                        tmp_acc0 = max_propagate_nan(tmp_acc0, tmp1);
                    }
                    tmp_acc0 = max_propagate_nan(tmp_acc0, at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return at::vec::maximum(x, y); }, tmp_acc0_vec));
                    out_ptr4[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
                {
                    float tmp_acc0 = 0;
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(0);
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = at::vec::Vectorized<float>(tmp2);
                        auto tmp4 = tmp1 - tmp3;
                        auto tmp5 = tmp4.exp();
                        tmp5.store(out_ptr5 + static_cast<int64_t>(x1 + (513L*x0)));
                        tmp_acc0_vec = tmp_acc0_vec + tmp5;
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = c10::convert<float>(tmp0);
                        auto tmp3 = decltype(tmp1)(tmp1 - tmp2);
                        auto tmp4 = std::exp(tmp3);
                        out_ptr5[static_cast<int64_t>(x1 + (513L*x0))] = tmp4;
                        tmp_acc0 = tmp_acc0 + tmp4;
                    }
                    tmp_acc0 = tmp_acc0 + at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return x + y; }, tmp_acc0_vec);
                    out_ptr6[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
            }
        }
    }
}
''')


cpp_fused_clone_constant_pad_nd_18 = async_compile.cpp_pybinding(['const bfloat16*', 'const bool*', 'const float*', 'const float*', 'bfloat16*', 'bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bool* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(1024L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = (-256L) + x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(0);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = static_cast<int64_t>(512);
                        auto tmp5 = tmp1 < tmp4;
                        auto tmp6 = tmp3 & tmp5;
                        auto tmp7 = [&]
                        {
                            auto tmp8 = at::vec::VecMask<float,1>::from(tmp6).template loadu<bfloat16,1>(in_ptr0 + static_cast<int64_t>((-196608L) + x2 + (64L*x0) + (768L*x1)));
                            auto tmp9 = at::vec::convert<float>(tmp8);
                            return tmp9;
                        }
                        ;
                        auto tmp10 = tmp6 ? tmp7() : at::vec::Vectorized<float>(static_cast<float>(-1.0));
                        auto tmp11 = at::vec::convert<bfloat16>(tmp10);
                        tmp11.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (65536L*x0)), 16);
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(768L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(513);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 < tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp8 = tmp5.template cast<float,1>().template loadu<float,1>(in_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0)));
                            auto tmp9 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp10 = at::vec::Vectorized<float>(tmp9);
                            auto tmp11 = tmp8 / tmp10;
                            auto tmp12 = static_cast<float>(0.0);
                            auto tmp13 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp14 = at::vec::Vectorized<float>(tmp12);
                            auto tmp15 = decltype(tmp14)::blendv(tmp11, tmp14, tmp13.template cast<float,1>());
                            auto tmp16 = (tmp15);
                            return tmp16;
                        }
                        ;
                        auto tmp19 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp17 = tmp6();
                                auto tmp18 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp17)::blendv(tmp18, tmp17, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp20 = at::vec::convert<bfloat16>(tmp19);
                        tmp20.store(out_ptr1 + static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(768L); x2<static_cast<int64_t>(770L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(513);
                        auto tmp3 = tmp1 < tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp6 = in_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0))];
                            auto tmp7 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp8 = tmp6 / tmp7;
                            auto tmp9 = static_cast<float>(0.0);
                            auto tmp10 = tmp5 ? tmp9 : tmp8;
                            auto tmp11 = c10::convert<float>(tmp10);
                            return tmp11;
                        }
                        ;
                        auto tmp12 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp13 = c10::convert<bfloat16>(tmp12);
                        out_ptr1[static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1))] = tmp13;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(49152L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x2 + (16384L*x1) + (65536L*x0)), 32);
                        tmp0.store(out_ptr2 + static_cast<int64_t>(x2 + (49152L*x1) + (98304L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused_clone_19 = async_compile.cpp_pybinding(['const bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       bfloat16* out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x2 + (64L*x0) + (32768L*x1)), 32);
                        tmp0.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (768L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_20 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    auto tmp19 = at::vec::convert<bfloat16>(tmp18);
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                    tmp19.store(out_ptr3 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_21 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<float>::loadu(out_ptr2 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<bfloat16>(tmp0);
                tmp1.store(out_ptr3 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_22 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<float>(tmp0);
                auto tmp2 = static_cast<float>(0.125);
                auto tmp3 = at::vec::Vectorized<float>(tmp2);
                auto tmp4 = tmp1 * tmp3;
                auto tmp5 = at::vec::convert<bfloat16>(tmp4);
                tmp5.store(in_out_ptr0 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_23 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(32L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 32);
                tmp0.store(in_out_ptr0 + static_cast<int64_t>(x0), 32);
            }
        }
    }
}
''')


cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_24 = async_compile.cpp_pybinding(['const bfloat16*', 'const bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'float*', 'float*', 'float*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bfloat16* in_ptr1,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2,
                       bfloat16* out_ptr3,
                       float* out_ptr4,
                       float* out_ptr5,
                       float* out_ptr6)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(2L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = at::vec::VectorizedN<int64_t,2>::arange(tmp5, 1);
                            auto tmp7 = static_cast<int64_t>(256);
                            auto tmp8 = at::vec::VectorizedN<int64_t,2>(tmp7);
                            auto tmp9 = at::vec::VecMask<int64_t,2>(tmp6 >= tmp8);
                            auto tmp10 = [&]
                            {
                                auto tmp11 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                    {
                                        if (tmp9.is_masked(x3_inner))
                                        {
                                            tmpbuf[x3_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp12 = static_cast<int64_t>(512);
                                auto tmp13 = at::vec::VectorizedN<int64_t,2>(tmp12);
                                auto tmp14 = at::vec::VecMask<int64_t,2>(tmp11 < tmp13);
                                auto tmp16 = tmp14 & tmp9;
                                auto tmp15 = [&]
                                {
                                    auto tmp17 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp16.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>(131072L + x3 + x3_inner + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp18 = at::vec::convert<float>(tmp17);
                                    return tmp18;
                                }
                                ;
                                auto tmp21 =
                                [&]
                                {
                                    if (tmp16.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp19 = tmp15();
                                        auto tmp20 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp19)::blendv(tmp20, tmp19, tmp16.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp21;
                            }
                            ;
                            auto tmp24 =
                            [&]
                            {
                                if (tmp9.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp22 = tmp10();
                                    auto tmp23 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp22)::blendv(tmp23, tmp22, tmp9.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp25 = static_cast<int64_t>(1);
                            auto tmp26 = tmp25 < tmp25;
                            auto tmp27 = [&]
                            {
                                auto tmp29 = at::vec::VecMask<float,1>::from(tmp26);
                                auto tmp30 = tmp9 & tmp29;
                                auto tmp28 = [&]
                                {
                                    auto tmp31 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp30.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp32 = static_cast<int64_t>(512);
                                    auto tmp33 = at::vec::VectorizedN<int64_t,2>(tmp32);
                                    auto tmp34 = at::vec::VecMask<int64_t,2>(tmp31 < tmp33);
                                    auto tmp36 = tmp34 & tmp30;
                                    auto tmp35 = [&]
                                    {
                                        auto tmp37 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp36.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp38 = at::vec::convert<float>(tmp37);
                                        return tmp38;
                                    }
                                    ;
                                    auto tmp41 =
                                    [&]
                                    {
                                        if (tmp36.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp39 = tmp35();
                                            auto tmp40 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp39)::blendv(tmp40, tmp39, tmp36.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp41;
                                }
                                ;
                                auto tmp44 =
                                [&]
                                {
                                    if (tmp30.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp42 = tmp28();
                                        auto tmp43 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp42)::blendv(tmp43, tmp42, tmp30.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp45 = static_cast<float>(0.0);
                                auto tmp46 = at::vec::Vectorized<float>(tmp45);
                                auto tmp47 = decltype(tmp44)::blendv(tmp46, tmp44, tmp9.template cast<float,1>());
                                return tmp47;
                            }
                            ;
                            auto tmp48 = tmp26 ? tmp27() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp49 = static_cast<float>(0.0);
                            auto tmp50 = at::vec::VecMask<float,1>::from(tmp26);
                            auto tmp51 = at::vec::Vectorized<float>(tmp49);
                            auto tmp52 = decltype(tmp48)::blendv(tmp51, tmp48, tmp50.template cast<float,1>());
                            auto tmp53 = decltype(tmp24)::blendv(tmp52, tmp24, tmp9.template cast<float,1>());
                            auto tmp54 = c10::convert<int64_t>(tmp0);
                            auto tmp55 = tmp54 < tmp25;
                            auto tmp56 = [&]
                            {
                                auto tmp58 = at::vec::VecMask<float,1>::from(tmp55);
                                auto tmp59 = tmp9 & tmp58;
                                auto tmp57 = [&]
                                {
                                    auto tmp60 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp59.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp61 = static_cast<int64_t>(512);
                                    auto tmp62 = at::vec::VectorizedN<int64_t,2>(tmp61);
                                    auto tmp63 = at::vec::VecMask<int64_t,2>(tmp60 < tmp62);
                                    auto tmp65 = tmp63 & tmp59;
                                    auto tmp64 = [&]
                                    {
                                        auto tmp66 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp65.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp67 = at::vec::convert<float>(tmp66);
                                        return tmp67;
                                    }
                                    ;
                                    auto tmp70 =
                                    [&]
                                    {
                                        if (tmp65.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp68 = tmp64();
                                            auto tmp69 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp68)::blendv(tmp69, tmp68, tmp65.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp70;
                                }
                                ;
                                auto tmp73 =
                                [&]
                                {
                                    if (tmp59.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp71 = tmp57();
                                        auto tmp72 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp71)::blendv(tmp72, tmp71, tmp59.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp74 = decltype(tmp73)::blendv(tmp51, tmp73, tmp9.template cast<float,1>());
                                return tmp74;
                            }
                            ;
                            auto tmp75 = tmp55 ? tmp56() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp76 = at::vec::VecMask<float,1>::from(tmp55);
                            auto tmp77 = decltype(tmp75)::blendv(tmp51, tmp75, tmp76.template cast<float,1>());
                            auto tmp78 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp79 = decltype(tmp53)::blendv(tmp77, tmp53, tmp78.template cast<float,1>());
                            auto tmp80 = at::vec::convert<bfloat16>(tmp79);
                            tmp80.store(out_ptr0 + static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(256);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + (513L*x1))), static_cast<int64_t>(512L)));
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = static_cast<int64_t>(512);
                                auto tmp12 = tmp10 < tmp11;
                                auto tmp13 = [&]
                                {
                                    auto tmp14 = in_ptr0[static_cast<int64_t>(131072L + x3 + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                    auto tmp15 = c10::convert<float>(tmp14);
                                    return tmp15;
                                }
                                ;
                                auto tmp16 = tmp12 ? tmp13() : static_cast<decltype(tmp13())>(0.0);
                                return tmp16;
                            }
                            ;
                            auto tmp17 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp18 = static_cast<int64_t>(1);
                            auto tmp19 = tmp18 < tmp18;
                            auto tmp20 = [&]
                            {
                                auto tmp21 = [&]
                                {
                                    auto tmp22 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp23 = c10::convert<int64_t>(tmp22);
                                    auto tmp24 = static_cast<int64_t>(512);
                                    auto tmp25 = tmp23 < tmp24;
                                    auto tmp26 = [&]
                                    {
                                        auto tmp27 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                        auto tmp28 = c10::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp29 = tmp25 ? tmp26() : static_cast<decltype(tmp26())>(0.0);
                                    return tmp29;
                                }
                                ;
                                auto tmp30 = tmp7 ? tmp21() : static_cast<decltype(tmp21())>(0.0);
                                auto tmp31 = static_cast<float>(0.0);
                                auto tmp32 = tmp7 ? tmp30 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                            auto tmp34 = static_cast<float>(0.0);
                            auto tmp35 = tmp19 ? tmp33 : tmp34;
                            auto tmp36 = tmp7 ? tmp17 : tmp35;
                            auto tmp37 = c10::convert<int64_t>(tmp0);
                            auto tmp38 = tmp37 < tmp18;
                            auto tmp39 = [&]
                            {
                                auto tmp40 = [&]
                                {
                                    auto tmp41 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp42 = c10::convert<int64_t>(tmp41);
                                    auto tmp43 = static_cast<int64_t>(512);
                                    auto tmp44 = tmp42 < tmp43;
                                    auto tmp45 = [&]
                                    {
                                        auto tmp46 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                        auto tmp47 = c10::convert<float>(tmp46);
                                        return tmp47;
                                    }
                                    ;
                                    auto tmp48 = tmp44 ? tmp45() : static_cast<decltype(tmp45())>(0.0);
                                    return tmp48;
                                }
                                ;
                                auto tmp49 = tmp7 ? tmp40() : static_cast<decltype(tmp40())>(0.0);
                                auto tmp50 = tmp7 ? tmp49 : tmp34;
                                return tmp50;
                            }
                            ;
                            auto tmp51 = tmp38 ? tmp39() : static_cast<decltype(tmp39())>(0.0);
                            auto tmp52 = tmp38 ? tmp51 : tmp34;
                            auto tmp53 = tmp3 ? tmp36 : tmp52;
                            auto tmp54 = c10::convert<bfloat16>(tmp53);
                            out_ptr0[static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0))] = tmp54;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(256L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp96 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp132 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = at::vec::VectorizedN<int64_t,2>::arange(tmp10, 1);
                                auto tmp12 = at::vec::VectorizedN<int64_t,2>(tmp6);
                                auto tmp13 = at::vec::VecMask<int64_t,2>(tmp11 >= tmp12);
                                auto tmp14 = static_cast<int64_t>(256);
                                auto tmp15 = at::vec::VectorizedN<int64_t,2>(tmp14);
                                auto tmp16 = at::vec::VecMask<int64_t,2>(tmp11 < tmp15);
                                auto tmp17 = tmp13 & tmp16;
                                auto tmp19 = at::vec::VecMask<float,1>::from(tmp7);
                                auto tmp20 = tmp17 & tmp19;
                                auto tmp18 = [&]
                                {
                                    auto tmp21 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp20.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp22 = static_cast<int64_t>(512);
                                    auto tmp23 = at::vec::VectorizedN<int64_t,2>(tmp22);
                                    auto tmp24 = at::vec::VecMask<int64_t,2>(tmp21 < tmp23);
                                    auto tmp26 = tmp24 & tmp20;
                                    auto tmp25 = [&]
                                    {
                                        auto tmp27 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp26.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp28 = at::vec::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp31 =
                                    [&]
                                    {
                                        if (tmp26.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp29 = tmp25();
                                            auto tmp30 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp31;
                                }
                                ;
                                auto tmp34 =
                                [&]
                                {
                                    if (tmp20.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp32 = tmp18();
                                        auto tmp33 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp32)::blendv(tmp33, tmp32, tmp20.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp35 = static_cast<int64_t>(0);
                                auto tmp36 = tmp35 >= tmp6;
                                auto tmp38 = tmp36 & tmp7;
                                auto tmp37 = [&]
                                {
                                    auto tmp40 = at::vec::VecMask<float,1>::from(tmp38);
                                    auto tmp41 = tmp16 & tmp40;
                                    auto tmp39 = [&]
                                    {
                                        auto tmp42 =
                                        [&]
                                        {
                                            __at_align__ std::array<int64_t, 16> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp41.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                                }
                                            }
                                            return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp43 = static_cast<int64_t>(512);
                                        auto tmp44 = at::vec::VectorizedN<int64_t,2>(tmp43);
                                        auto tmp45 = at::vec::VecMask<int64_t,2>(tmp42 < tmp44);
                                        auto tmp47 = tmp45 & tmp41;
                                        auto tmp46 = [&]
                                        {
                                            auto tmp48 =
                                            [&]
                                            {
                                                __at_align__ std::array<bfloat16, 32> tmpbuf;
                                                #pragma GCC unroll 16
                                                for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                                {
                                                    if (tmp47.is_masked(x3_inner))
                                                    {
                                                        tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                    }
                                                }
                                                return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                            }
                                            ()
                                            ;
                                            auto tmp49 = at::vec::convert<float>(tmp48);
                                            return tmp49;
                                        }
                                        ;
                                        auto tmp52 =
                                        [&]
                                        {
                                            if (tmp47.all_zero())
                                            {
                                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            }
                                            else
                                            {
                                                auto tmp50 = tmp46();
                                                auto tmp51 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                                return decltype(tmp50)::blendv(tmp51, tmp50, tmp47.template cast<float,1>());
                                            }
                                        }
                                        ()
                                        ;
                                        return tmp52;
                                    }
                                    ;
                                    auto tmp55 =
                                    [&]
                                    {
                                        if (tmp41.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp53 = tmp39();
                                            auto tmp54 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp53)::blendv(tmp54, tmp53, tmp41.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    auto tmp56 = at::vec::VecMask<float,1>::from(tmp38).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                    auto tmp57 = at::vec::convert<float>(tmp56);
                                    auto tmp58 = decltype(tmp55)::blendv(tmp57, tmp55, tmp16.template cast<float,1>());
                                    return tmp58;
                                }
                                ;
                                auto tmp59 = tmp36 ? tmp37() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                                auto tmp60 = at::vec::VecMask<float,1>::from(tmp7).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp61 = at::vec::convert<float>(tmp60);
                                auto tmp62 = at::vec::VecMask<float,1>::from(tmp36);
                                auto tmp63 = decltype(tmp59)::blendv(tmp61, tmp59, tmp62.template cast<float,1>());
                                auto tmp64 = decltype(tmp34)::blendv(tmp63, tmp34, tmp17.template cast<float,1>());
                                return tmp64;
                            }
                            ;
                            auto tmp65 = tmp7 ? tmp8() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp66 = static_cast<int64_t>(0);
                            auto tmp67 = tmp66 >= tmp6;
                            auto tmp68 = [&]
                            {
                                auto tmp69 = x3;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(256);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 < tmp73);
                                auto tmp76 = at::vec::VecMask<float,1>::from(tmp67);
                                auto tmp77 = tmp74 & tmp76;
                                auto tmp75 = [&]
                                {
                                    auto tmp78 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp77.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp79 = static_cast<int64_t>(512);
                                    auto tmp80 = at::vec::VectorizedN<int64_t,2>(tmp79);
                                    auto tmp81 = at::vec::VecMask<int64_t,2>(tmp78 < tmp80);
                                    auto tmp83 = tmp81 & tmp77;
                                    auto tmp82 = [&]
                                    {
                                        auto tmp84 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp83.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp85 = at::vec::convert<float>(tmp84);
                                        return tmp85;
                                    }
                                    ;
                                    auto tmp88 =
                                    [&]
                                    {
                                        if (tmp83.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp86 = tmp82();
                                            auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp86)::blendv(tmp87, tmp86, tmp83.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp88;
                                }
                                ;
                                auto tmp91 =
                                [&]
                                {
                                    if (tmp77.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp89 = tmp75();
                                        auto tmp90 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp89)::blendv(tmp90, tmp89, tmp77.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp92 = at::vec::VecMask<float,1>::from(tmp67).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp93 = at::vec::convert<float>(tmp92);
                                auto tmp94 = decltype(tmp91)::blendv(tmp93, tmp91, tmp74.template cast<float,1>());
                                return tmp94;
                            }
                            ;
                            auto tmp95 = tmp67 ? tmp68() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp97 = at::vec::convert<float>(tmp96);
                            auto tmp98 = at::vec::VecMask<float,1>::from(tmp67);
                            auto tmp99 = decltype(tmp95)::blendv(tmp97, tmp95, tmp98.template cast<float,1>());
                            auto tmp100 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp101 = decltype(tmp65)::blendv(tmp99, tmp65, tmp100.template cast<float,1>());
                            auto tmp102 = c10::convert<int64_t>(tmp0);
                            auto tmp103 = tmp102 >= tmp6;
                            auto tmp104 = [&]
                            {
                                auto tmp105 = x3;
                                auto tmp106 = c10::convert<int64_t>(tmp105);
                                auto tmp107 = at::vec::VectorizedN<int64_t,2>::arange(tmp106, 1);
                                auto tmp108 = static_cast<int64_t>(256);
                                auto tmp109 = at::vec::VectorizedN<int64_t,2>(tmp108);
                                auto tmp110 = at::vec::VecMask<int64_t,2>(tmp107 < tmp109);
                                auto tmp112 = at::vec::VecMask<float,1>::from(tmp103);
                                auto tmp113 = tmp110 & tmp112;
                                auto tmp111 = [&]
                                {
                                    auto tmp114 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp113.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp115 = static_cast<int64_t>(512);
                                    auto tmp116 = at::vec::VectorizedN<int64_t,2>(tmp115);
                                    auto tmp117 = at::vec::VecMask<int64_t,2>(tmp114 < tmp116);
                                    auto tmp119 = tmp117 & tmp113;
                                    auto tmp118 = [&]
                                    {
                                        auto tmp120 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp119.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp121 = at::vec::convert<float>(tmp120);
                                        return tmp121;
                                    }
                                    ;
                                    auto tmp124 =
                                    [&]
                                    {
                                        if (tmp119.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp122 = tmp118();
                                            auto tmp123 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp122)::blendv(tmp123, tmp122, tmp119.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp124;
                                }
                                ;
                                auto tmp127 =
                                [&]
                                {
                                    if (tmp113.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp125 = tmp111();
                                        auto tmp126 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp125)::blendv(tmp126, tmp125, tmp113.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp128 = at::vec::VecMask<float,1>::from(tmp103).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp129 = at::vec::convert<float>(tmp128);
                                auto tmp130 = decltype(tmp127)::blendv(tmp129, tmp127, tmp110.template cast<float,1>());
                                return tmp130;
                            }
                            ;
                            auto tmp131 = tmp103 ? tmp104() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp133 = at::vec::convert<float>(tmp132);
                            auto tmp134 = at::vec::VecMask<float,1>::from(tmp103);
                            auto tmp135 = decltype(tmp131)::blendv(tmp133, tmp131, tmp134.template cast<float,1>());
                            auto tmp136 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp137 = decltype(tmp101)::blendv(tmp135, tmp101, tmp136.template cast<float,1>());
                            auto tmp138 = at::vec::convert<bfloat16>(tmp137);
                            tmp138.store(out_ptr1 + static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp68 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                            auto tmp93 = out_ptr0[static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0))];
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = tmp10 >= tmp6;
                                auto tmp12 = static_cast<int64_t>(256);
                                auto tmp13 = tmp10 < tmp12;
                                auto tmp14 = tmp11 & tmp13;
                                auto tmp15 = [&]
                                {
                                    auto tmp16 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp17 = c10::convert<int64_t>(tmp16);
                                    auto tmp18 = static_cast<int64_t>(512);
                                    auto tmp19 = tmp17 < tmp18;
                                    auto tmp20 = [&]
                                    {
                                        auto tmp21 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                        auto tmp22 = c10::convert<float>(tmp21);
                                        return tmp22;
                                    }
                                    ;
                                    auto tmp23 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                                    return tmp23;
                                }
                                ;
                                auto tmp24 = tmp14 ? tmp15() : static_cast<decltype(tmp15())>(0.0);
                                auto tmp25 = static_cast<int64_t>(0);
                                auto tmp26 = tmp25 >= tmp6;
                                auto tmp27 = [&]
                                {
                                    auto tmp28 = [&]
                                    {
                                        auto tmp29 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                        auto tmp30 = c10::convert<int64_t>(tmp29);
                                        auto tmp31 = static_cast<int64_t>(512);
                                        auto tmp32 = tmp30 < tmp31;
                                        auto tmp33 = [&]
                                        {
                                            auto tmp34 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                            auto tmp35 = c10::convert<float>(tmp34);
                                            return tmp35;
                                        }
                                        ;
                                        auto tmp36 = tmp32 ? tmp33() : static_cast<decltype(tmp33())>(0.0);
                                        return tmp36;
                                    }
                                    ;
                                    auto tmp37 = tmp13 ? tmp28() : static_cast<decltype(tmp28())>(0.0);
                                    auto tmp38 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                    auto tmp39 = c10::convert<float>(tmp38);
                                    auto tmp40 = tmp13 ? tmp37 : tmp39;
                                    return tmp40;
                                }
                                ;
                                auto tmp41 = tmp26 ? tmp27() : static_cast<decltype(tmp27())>(0.0);
                                auto tmp42 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp43 = c10::convert<float>(tmp42);
                                auto tmp44 = tmp26 ? tmp41 : tmp43;
                                auto tmp45 = tmp14 ? tmp24 : tmp44;
                                return tmp45;
                            }
                            ;
                            auto tmp46 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp47 = static_cast<int64_t>(0);
                            auto tmp48 = tmp47 >= tmp6;
                            auto tmp49 = [&]
                            {
                                auto tmp50 = x3;
                                auto tmp51 = c10::convert<int64_t>(tmp50);
                                auto tmp52 = static_cast<int64_t>(256);
                                auto tmp53 = tmp51 < tmp52;
                                auto tmp54 = [&]
                                {
                                    auto tmp55 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp56 = c10::convert<int64_t>(tmp55);
                                    auto tmp57 = static_cast<int64_t>(512);
                                    auto tmp58 = tmp56 < tmp57;
                                    auto tmp59 = [&]
                                    {
                                        auto tmp60 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp61 = c10::convert<float>(tmp60);
                                        return tmp61;
                                    }
                                    ;
                                    auto tmp62 = tmp58 ? tmp59() : static_cast<decltype(tmp59())>(0.0);
                                    return tmp62;
                                }
                                ;
                                auto tmp63 = tmp53 ? tmp54() : static_cast<decltype(tmp54())>(0.0);
                                auto tmp64 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp65 = c10::convert<float>(tmp64);
                                auto tmp66 = tmp53 ? tmp63 : tmp65;
                                return tmp66;
                            }
                            ;
                            auto tmp67 = tmp48 ? tmp49() : static_cast<decltype(tmp49())>(0.0);
                            auto tmp69 = c10::convert<float>(tmp68);
                            auto tmp70 = tmp48 ? tmp67 : tmp69;
                            auto tmp71 = tmp7 ? tmp46 : tmp70;
                            auto tmp72 = c10::convert<int64_t>(tmp0);
                            auto tmp73 = tmp72 >= tmp6;
                            auto tmp74 = [&]
                            {
                                auto tmp75 = x3;
                                auto tmp76 = c10::convert<int64_t>(tmp75);
                                auto tmp77 = static_cast<int64_t>(256);
                                auto tmp78 = tmp76 < tmp77;
                                auto tmp79 = [&]
                                {
                                    auto tmp80 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp81 = c10::convert<int64_t>(tmp80);
                                    auto tmp82 = static_cast<int64_t>(512);
                                    auto tmp83 = tmp81 < tmp82;
                                    auto tmp84 = [&]
                                    {
                                        auto tmp85 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp86 = c10::convert<float>(tmp85);
                                        return tmp86;
                                    }
                                    ;
                                    auto tmp87 = tmp83 ? tmp84() : static_cast<decltype(tmp84())>(0.0);
                                    return tmp87;
                                }
                                ;
                                auto tmp88 = tmp78 ? tmp79() : static_cast<decltype(tmp79())>(0.0);
                                auto tmp89 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp90 = c10::convert<float>(tmp89);
                                auto tmp91 = tmp78 ? tmp88 : tmp90;
                                return tmp91;
                            }
                            ;
                            auto tmp92 = tmp73 ? tmp74() : static_cast<decltype(tmp74())>(0.0);
                            auto tmp94 = c10::convert<float>(tmp93);
                            auto tmp95 = tmp73 ? tmp92 : tmp94;
                            auto tmp96 = tmp3 ? tmp71 : tmp95;
                            auto tmp97 = c10::convert<bfloat16>(tmp96);
                            out_ptr1[static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0))] = tmp97;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp93 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)), 16);
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(256);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 >= tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp8 = c10::convert<int64_t>(tmp7);
                            auto tmp9 = at::vec::VectorizedN<int64_t,2>::arange(tmp8, -1);
                            auto tmp10 = static_cast<int64_t>(0);
                            auto tmp11 = at::vec::VectorizedN<int64_t,2>(tmp10);
                            auto tmp12 = at::vec::VecMask<int64_t,2>(tmp9 <= tmp11);
                            auto tmp13 = static_cast<float>(1.0);
                            auto tmp14 = static_cast<float>(0.0);
                            auto tmp15 = at::vec::Vectorized<float>(tmp13);
                            auto tmp16 = at::vec::Vectorized<float>(tmp14);
                            auto tmp17 = decltype(tmp15)::blendv(tmp16, tmp15, tmp12.template cast<float,1>());
                            auto tmp18 = at::vec::VecMask<float,1>::from<float,1>(tmp17);
                            auto tmp19 = 256L + x1;
                            auto tmp20 = c10::convert<int64_t>(tmp19);
                            auto tmp21 = tmp20 < tmp3;
                            auto tmp23 = at::vec::VecMask<float,1>::from(tmp21);
                            auto tmp24 = tmp23 & tmp5;
                            auto tmp22 = [&]
                            {
                                auto tmp25 = static_cast<int64_t>(257);
                                auto tmp26 = at::vec::VectorizedN<int64_t,2>(tmp25);
                                auto tmp27 = at::vec::VecMask<int64_t,2>(tmp2 < tmp26);
                                auto tmp29 = tmp27 & tmp24;
                                auto tmp28 = [&]
                                {
                                    auto tmp30 = 1L + x1 + x2;
                                    auto tmp31 = c10::convert<int64_t>(tmp30);
                                    auto tmp32 = at::vec::VectorizedN<int64_t,2>::arange(tmp31, 1);
                                    auto tmp33 = at::vec::VecMask<int64_t,2>(tmp32 <= tmp11);
                                    auto tmp34 = decltype(tmp15)::blendv(tmp16, tmp15, tmp33.template cast<float,1>());
                                    auto tmp35 = at::vec::VecMask<float,1>::from<float,1>(tmp34);
                                    auto tmp36 = tmp29.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                    auto tmp37 = at::vec::convert<float>(tmp36);
                                    auto tmp38 = -std::numeric_limits<float>::infinity();
                                    auto tmp39 = at::vec::Vectorized<float>(tmp38);
                                    auto tmp40 = decltype(tmp39)::blendv(tmp37, tmp39, tmp35.template cast<float,1>());
                                    return tmp40;
                                }
                                ;
                                auto tmp43 =
                                [&]
                                {
                                    if (tmp29.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp41 = tmp28();
                                        auto tmp42 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp41)::blendv(tmp42, tmp41, tmp29.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp44 = tmp24.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp45 = at::vec::convert<float>(tmp44);
                                auto tmp46 = decltype(tmp43)::blendv(tmp45, tmp43, tmp27.template cast<float,1>());
                                return tmp46;
                            }
                            ;
                            auto tmp49 =
                            [&]
                            {
                                if (tmp24.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp47 = tmp22();
                                    auto tmp48 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp47)::blendv(tmp48, tmp47, tmp24.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp50 = tmp5.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp51 = at::vec::convert<float>(tmp50);
                            auto tmp52 = decltype(tmp49)::blendv(tmp51, tmp49, tmp23.template cast<float,1>());
                            auto tmp53 = -std::numeric_limits<float>::infinity();
                            auto tmp54 = at::vec::Vectorized<float>(tmp53);
                            auto tmp55 = decltype(tmp54)::blendv(tmp52, tmp54, tmp18.template cast<float,1>());
                            return tmp55;
                        }
                        ;
                        auto tmp58 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp56 = tmp6();
                                auto tmp57 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp56)::blendv(tmp57, tmp56, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp59 = 256L + x1;
                        auto tmp60 = c10::convert<int64_t>(tmp59);
                        auto tmp61 = tmp60 < tmp3;
                        auto tmp62 = [&]
                        {
                            auto tmp63 = static_cast<int64_t>(257);
                            auto tmp64 = at::vec::VectorizedN<int64_t,2>(tmp63);
                            auto tmp65 = at::vec::VecMask<int64_t,2>(tmp2 < tmp64);
                            auto tmp67 = at::vec::VecMask<float,1>::from(tmp61);
                            auto tmp68 = tmp65 & tmp67;
                            auto tmp66 = [&]
                            {
                                auto tmp69 = 1L + x1 + x2;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(0);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 <= tmp73);
                                auto tmp75 = static_cast<float>(1.0);
                                auto tmp76 = static_cast<float>(0.0);
                                auto tmp77 = at::vec::Vectorized<float>(tmp75);
                                auto tmp78 = at::vec::Vectorized<float>(tmp76);
                                auto tmp79 = decltype(tmp77)::blendv(tmp78, tmp77, tmp74.template cast<float,1>());
                                auto tmp80 = at::vec::VecMask<float,1>::from<float,1>(tmp79);
                                auto tmp81 = tmp68.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp82 = at::vec::convert<float>(tmp81);
                                auto tmp83 = -std::numeric_limits<float>::infinity();
                                auto tmp84 = at::vec::Vectorized<float>(tmp83);
                                auto tmp85 = decltype(tmp84)::blendv(tmp82, tmp84, tmp80.template cast<float,1>());
                                return tmp85;
                            }
                            ;
                            auto tmp88 =
                            [&]
                            {
                                if (tmp68.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp86 = tmp66();
                                    auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp86)::blendv(tmp87, tmp86, tmp68.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp89 = at::vec::VecMask<float,1>::from(tmp61).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp90 = at::vec::convert<float>(tmp89);
                            auto tmp91 = decltype(tmp88)::blendv(tmp90, tmp88, tmp65.template cast<float,1>());
                            return tmp91;
                        }
                        ;
                        auto tmp92 = tmp61 ? tmp62() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp94 = at::vec::convert<float>(tmp93);
                        auto tmp95 = at::vec::VecMask<float,1>::from(tmp61);
                        auto tmp96 = decltype(tmp92)::blendv(tmp94, tmp92, tmp95.template cast<float,1>());
                        auto tmp97 = decltype(tmp58)::blendv(tmp96, tmp58, tmp5.template cast<float,1>());
                        auto tmp98 = at::vec::convert<bfloat16>(tmp97);
                        tmp98.store(out_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp64 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp6 = c10::convert<int64_t>(tmp5);
                            auto tmp7 = static_cast<int64_t>(0);
                            auto tmp8 = tmp6 <= tmp7;
                            auto tmp9 = static_cast<float>(1.0);
                            auto tmp10 = static_cast<float>(0.0);
                            auto tmp11 = tmp8 ? tmp9 : tmp10;
                            auto tmp12 = c10::convert<bool>(tmp11);
                            auto tmp13 = 256L + x1;
                            auto tmp14 = c10::convert<int64_t>(tmp13);
                            auto tmp15 = tmp14 < tmp2;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = static_cast<int64_t>(257);
                                auto tmp18 = tmp1 < tmp17;
                                auto tmp19 = [&]
                                {
                                    auto tmp20 = 1L + x1 + x2;
                                    auto tmp21 = c10::convert<int64_t>(tmp20);
                                    auto tmp22 = tmp21 <= tmp7;
                                    auto tmp23 = tmp22 ? tmp9 : tmp10;
                                    auto tmp24 = c10::convert<bool>(tmp23);
                                    auto tmp25 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                    auto tmp26 = c10::convert<float>(tmp25);
                                    auto tmp27 = -std::numeric_limits<float>::infinity();
                                    auto tmp28 = tmp24 ? tmp27 : tmp26;
                                    return tmp28;
                                }
                                ;
                                auto tmp29 = tmp18 ? tmp19() : static_cast<decltype(tmp19())>(0.0);
                                auto tmp30 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp31 = c10::convert<float>(tmp30);
                                auto tmp32 = tmp18 ? tmp29 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp34 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp35 = c10::convert<float>(tmp34);
                            auto tmp36 = tmp15 ? tmp33 : tmp35;
                            auto tmp37 = -std::numeric_limits<float>::infinity();
                            auto tmp38 = tmp12 ? tmp37 : tmp36;
                            return tmp38;
                        }
                        ;
                        auto tmp39 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp40 = 256L + x1;
                        auto tmp41 = c10::convert<int64_t>(tmp40);
                        auto tmp42 = tmp41 < tmp2;
                        auto tmp43 = [&]
                        {
                            auto tmp44 = static_cast<int64_t>(257);
                            auto tmp45 = tmp1 < tmp44;
                            auto tmp46 = [&]
                            {
                                auto tmp47 = 1L + x1 + x2;
                                auto tmp48 = c10::convert<int64_t>(tmp47);
                                auto tmp49 = static_cast<int64_t>(0);
                                auto tmp50 = tmp48 <= tmp49;
                                auto tmp51 = static_cast<float>(1.0);
                                auto tmp52 = static_cast<float>(0.0);
                                auto tmp53 = tmp50 ? tmp51 : tmp52;
                                auto tmp54 = c10::convert<bool>(tmp53);
                                auto tmp55 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp56 = c10::convert<float>(tmp55);
                                auto tmp57 = -std::numeric_limits<float>::infinity();
                                auto tmp58 = tmp54 ? tmp57 : tmp56;
                                return tmp58;
                            }
                            ;
                            auto tmp59 = tmp45 ? tmp46() : static_cast<decltype(tmp46())>(0.0);
                            auto tmp60 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp61 = c10::convert<float>(tmp60);
                            auto tmp62 = tmp45 ? tmp59 : tmp61;
                            return tmp62;
                        }
                        ;
                        auto tmp63 = tmp42 ? tmp43() : static_cast<decltype(tmp43())>(0.0);
                        auto tmp65 = c10::convert<float>(tmp64);
                        auto tmp66 = tmp42 ? tmp63 : tmp65;
                        auto tmp67 = tmp3 ? tmp39 : tmp66;
                        auto tmp68 = c10::convert<bfloat16>(tmp67);
                        out_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0))] = tmp68;
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp45 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)), 16);
                        auto tmp83 = at::vec::Vectorized<bfloat16>::loadu(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)), 16);
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr2 + static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0)));
                            auto tmp6 = at::vec::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = at::vec::VectorizedN<int64_t,2>::arange(tmp13, 1);
                            auto tmp15 = static_cast<int64_t>(257);
                            auto tmp16 = at::vec::VectorizedN<int64_t,2>(tmp15);
                            auto tmp17 = at::vec::VecMask<int64_t,2>(tmp14 < tmp16);
                            auto tmp19 = at::vec::VecMask<float,1>::from(tmp10);
                            auto tmp20 = tmp17 & tmp19;
                            auto tmp18 = [&]
                            {
                                auto tmp21 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp22 = c10::convert<int64_t>(tmp21);
                                auto tmp23 = at::vec::VectorizedN<int64_t,2>::arange(tmp22, 1);
                                auto tmp24 = static_cast<int64_t>(0);
                                auto tmp25 = at::vec::VectorizedN<int64_t,2>(tmp24);
                                auto tmp26 = at::vec::VecMask<int64_t,2>(tmp23 <= tmp25);
                                auto tmp27 = static_cast<float>(1.0);
                                auto tmp28 = static_cast<float>(0.0);
                                auto tmp29 = at::vec::Vectorized<float>(tmp27);
                                auto tmp30 = at::vec::Vectorized<float>(tmp28);
                                auto tmp31 = decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                auto tmp32 = at::vec::VecMask<float,1>::from<float,1>(tmp31);
                                auto tmp33 = tmp20.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                                auto tmp34 = at::vec::convert<float>(tmp33);
                                auto tmp35 = -std::numeric_limits<float>::infinity();
                                auto tmp36 = at::vec::Vectorized<float>(tmp35);
                                auto tmp37 = decltype(tmp36)::blendv(tmp34, tmp36, tmp32.template cast<float,1>());
                                return tmp37;
                            }
                            ;
                            auto tmp40 =
                            [&]
                            {
                                if (tmp20.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp38 = tmp18();
                                    auto tmp39 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp38)::blendv(tmp39, tmp38, tmp20.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp41 = at::vec::VecMask<float,1>::from(tmp10).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                            auto tmp42 = at::vec::convert<float>(tmp41);
                            auto tmp43 = decltype(tmp40)::blendv(tmp42, tmp40, tmp17.template cast<float,1>());
                            return tmp43;
                        }
                        ;
                        auto tmp44 = tmp10 ? tmp11() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp46 = at::vec::convert<float>(tmp45);
                        auto tmp47 = at::vec::VecMask<float,1>::from(tmp10);
                        auto tmp48 = decltype(tmp44)::blendv(tmp46, tmp44, tmp47.template cast<float,1>());
                        auto tmp49 = at::vec::VecMask<float,1>::from(tmp3);
                        auto tmp50 = decltype(tmp7)::blendv(tmp48, tmp7, tmp49.template cast<float,1>());
                        auto tmp51 = [&]
                        {
                            auto tmp52 = x2;
                            auto tmp53 = c10::convert<int64_t>(tmp52);
                            auto tmp54 = at::vec::VectorizedN<int64_t,2>::arange(tmp53, 1);
                            auto tmp55 = at::vec::VectorizedN<int64_t,2>(tmp2);
                            auto tmp56 = at::vec::VecMask<int64_t,2>(tmp54 >= tmp55);
                            auto tmp58 = tmp56 & tmp49;
                            auto tmp57 = [&]
                            {
                                auto tmp59 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp60 = c10::convert<int64_t>(tmp59);
                                auto tmp61 = at::vec::VectorizedN<int64_t,2>::arange(tmp60, -1);
                                auto tmp62 = static_cast<int64_t>(0);
                                auto tmp63 = at::vec::VectorizedN<int64_t,2>(tmp62);
                                auto tmp64 = at::vec::VecMask<int64_t,2>(tmp61 <= tmp63);
                                auto tmp65 = static_cast<float>(1.0);
                                auto tmp66 = static_cast<float>(0.0);
                                auto tmp67 = at::vec::Vectorized<float>(tmp65);
                                auto tmp68 = at::vec::Vectorized<float>(tmp66);
                                auto tmp69 = decltype(tmp67)::blendv(tmp68, tmp67, tmp64.template cast<float,1>());
                                auto tmp70 = at::vec::VecMask<float,1>::from<float,1>(tmp69);
                                auto tmp71 = tmp58.template cast<float,1>().template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                                auto tmp72 = at::vec::convert<float>(tmp71);
                                auto tmp73 = -std::numeric_limits<float>::infinity();
                                auto tmp74 = at::vec::Vectorized<float>(tmp73);
                                auto tmp75 = decltype(tmp74)::blendv(tmp72, tmp74, tmp70.template cast<float,1>());
                                return tmp75;
                            }
                            ;
                            auto tmp78 =
                            [&]
                            {
                                if (tmp58.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp76 = tmp57();
                                    auto tmp77 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp76)::blendv(tmp77, tmp76, tmp58.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp79 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                            auto tmp80 = at::vec::convert<float>(tmp79);
                            auto tmp81 = decltype(tmp78)::blendv(tmp80, tmp78, tmp56.template cast<float,1>());
                            return tmp81;
                        }
                        ;
                        auto tmp82 = tmp3 ? tmp51() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp84 = at::vec::convert<float>(tmp83);
                        auto tmp85 = decltype(tmp82)::blendv(tmp84, tmp82, tmp49.template cast<float,1>());
                        auto tmp86 = tmp50 + tmp85;
                        auto tmp87 = at::vec::convert<bfloat16>(tmp86);
                        tmp87.store(out_ptr3 + static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp34 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                        auto tmp60 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = out_ptr2[static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0))];
                            auto tmp6 = c10::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = static_cast<int64_t>(257);
                            auto tmp15 = tmp13 < tmp14;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp18 = c10::convert<int64_t>(tmp17);
                                auto tmp19 = static_cast<int64_t>(0);
                                auto tmp20 = tmp18 <= tmp19;
                                auto tmp21 = static_cast<float>(1.0);
                                auto tmp22 = static_cast<float>(0.0);
                                auto tmp23 = tmp20 ? tmp21 : tmp22;
                                auto tmp24 = c10::convert<bool>(tmp23);
                                auto tmp25 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                                auto tmp26 = c10::convert<float>(tmp25);
                                auto tmp27 = -std::numeric_limits<float>::infinity();
                                auto tmp28 = tmp24 ? tmp27 : tmp26;
                                return tmp28;
                            }
                            ;
                            auto tmp29 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp30 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                            auto tmp31 = c10::convert<float>(tmp30);
                            auto tmp32 = tmp15 ? tmp29 : tmp31;
                            return tmp32;
                        }
                        ;
                        auto tmp33 = tmp10 ? tmp11() : static_cast<decltype(tmp11())>(0.0);
                        auto tmp35 = c10::convert<float>(tmp34);
                        auto tmp36 = tmp10 ? tmp33 : tmp35;
                        auto tmp37 = tmp3 ? tmp7 : tmp36;
                        auto tmp38 = [&]
                        {
                            auto tmp39 = x2;
                            auto tmp40 = c10::convert<int64_t>(tmp39);
                            auto tmp41 = tmp40 >= tmp2;
                            auto tmp42 = [&]
                            {
                                auto tmp43 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp44 = c10::convert<int64_t>(tmp43);
                                auto tmp45 = static_cast<int64_t>(0);
                                auto tmp46 = tmp44 <= tmp45;
                                auto tmp47 = static_cast<float>(1.0);
                                auto tmp48 = static_cast<float>(0.0);
                                auto tmp49 = tmp46 ? tmp47 : tmp48;
                                auto tmp50 = c10::convert<bool>(tmp49);
                                auto tmp51 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                                auto tmp52 = c10::convert<float>(tmp51);
                                auto tmp53 = -std::numeric_limits<float>::infinity();
                                auto tmp54 = tmp50 ? tmp53 : tmp52;
                                return tmp54;
                            }
                            ;
                            auto tmp55 = tmp41 ? tmp42() : static_cast<decltype(tmp42())>(0.0);
                            auto tmp56 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                            auto tmp57 = c10::convert<float>(tmp56);
                            auto tmp58 = tmp41 ? tmp55 : tmp57;
                            return tmp58;
                        }
                        ;
                        auto tmp59 = tmp3 ? tmp38() : static_cast<decltype(tmp38())>(0.0);
                        auto tmp61 = c10::convert<float>(tmp60);
                        auto tmp62 = tmp3 ? tmp59 : tmp61;
                        auto tmp63 = decltype(tmp37)(tmp37 + tmp62);
                        auto tmp64 = c10::convert<bfloat16>(tmp63);
                        out_ptr3[static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1))] = tmp64;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(6144L); x0+=static_cast<int64_t>(1L))
            {
                {
                    float tmp_acc0 = -std::numeric_limits<float>::infinity();
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(-std::numeric_limits<float>::infinity());
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        tmp_acc0_vec = at::vec::maximum(tmp_acc0_vec, tmp1);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp1 = c10::convert<float>(tmp0);
                        tmp_acc0 = max_propagate_nan(tmp_acc0, tmp1);
                    }
                    tmp_acc0 = max_propagate_nan(tmp_acc0, at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return at::vec::maximum(x, y); }, tmp_acc0_vec));
                    out_ptr4[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
                {
                    float tmp_acc0 = 0;
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(0);
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = at::vec::Vectorized<float>(tmp2);
                        auto tmp4 = tmp1 - tmp3;
                        auto tmp5 = tmp4.exp();
                        tmp5.store(out_ptr5 + static_cast<int64_t>(x1 + (513L*x0)));
                        tmp_acc0_vec = tmp_acc0_vec + tmp5;
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = c10::convert<float>(tmp0);
                        auto tmp3 = decltype(tmp1)(tmp1 - tmp2);
                        auto tmp4 = std::exp(tmp3);
                        out_ptr5[static_cast<int64_t>(x1 + (513L*x0))] = tmp4;
                        tmp_acc0 = tmp_acc0 + tmp4;
                    }
                    tmp_acc0 = tmp_acc0 + at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return x + y; }, tmp_acc0_vec);
                    out_ptr6[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
            }
        }
    }
}
''')


cpp_fused_clone_constant_pad_nd_25 = async_compile.cpp_pybinding(['const bfloat16*', 'const bool*', 'const float*', 'const float*', 'bfloat16*', 'bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bool* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(1024L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = (-256L) + x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(0);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = static_cast<int64_t>(512);
                        auto tmp5 = tmp1 < tmp4;
                        auto tmp6 = tmp3 & tmp5;
                        auto tmp7 = [&]
                        {
                            auto tmp8 = at::vec::VecMask<float,1>::from(tmp6).template loadu<bfloat16,1>(in_ptr0 + static_cast<int64_t>((-196608L) + x2 + (64L*x0) + (768L*x1)));
                            auto tmp9 = at::vec::convert<float>(tmp8);
                            return tmp9;
                        }
                        ;
                        auto tmp10 = tmp6 ? tmp7() : at::vec::Vectorized<float>(static_cast<float>(-1.0));
                        auto tmp11 = at::vec::convert<bfloat16>(tmp10);
                        tmp11.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (65536L*x0)), 16);
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(768L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(513);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 < tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp8 = tmp5.template cast<float,1>().template loadu<float,1>(in_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0)));
                            auto tmp9 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp10 = at::vec::Vectorized<float>(tmp9);
                            auto tmp11 = tmp8 / tmp10;
                            auto tmp12 = static_cast<float>(0.0);
                            auto tmp13 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp14 = at::vec::Vectorized<float>(tmp12);
                            auto tmp15 = decltype(tmp14)::blendv(tmp11, tmp14, tmp13.template cast<float,1>());
                            auto tmp16 = (tmp15);
                            return tmp16;
                        }
                        ;
                        auto tmp19 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp17 = tmp6();
                                auto tmp18 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp17)::blendv(tmp18, tmp17, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp20 = at::vec::convert<bfloat16>(tmp19);
                        tmp20.store(out_ptr1 + static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(768L); x2<static_cast<int64_t>(770L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(513);
                        auto tmp3 = tmp1 < tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp6 = in_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0))];
                            auto tmp7 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp8 = tmp6 / tmp7;
                            auto tmp9 = static_cast<float>(0.0);
                            auto tmp10 = tmp5 ? tmp9 : tmp8;
                            auto tmp11 = c10::convert<float>(tmp10);
                            return tmp11;
                        }
                        ;
                        auto tmp12 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp13 = c10::convert<bfloat16>(tmp12);
                        out_ptr1[static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1))] = tmp13;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(49152L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x2 + (16384L*x1) + (65536L*x0)), 32);
                        tmp0.store(out_ptr2 + static_cast<int64_t>(x2 + (49152L*x1) + (98304L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused_clone_26 = async_compile.cpp_pybinding(['const bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       bfloat16* out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x2 + (64L*x0) + (32768L*x1)), 32);
                        tmp0.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (768L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_27 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    auto tmp19 = at::vec::convert<bfloat16>(tmp18);
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                    tmp19.store(out_ptr3 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_28 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<float>::loadu(out_ptr2 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<bfloat16>(tmp0);
                tmp1.store(out_ptr3 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_29 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<float>(tmp0);
                auto tmp2 = static_cast<float>(0.125);
                auto tmp3 = at::vec::Vectorized<float>(tmp2);
                auto tmp4 = tmp1 * tmp3;
                auto tmp5 = at::vec::convert<bfloat16>(tmp4);
                tmp5.store(in_out_ptr0 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_30 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(32L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 32);
                tmp0.store(in_out_ptr0 + static_cast<int64_t>(x0), 32);
            }
        }
    }
}
''')


cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_31 = async_compile.cpp_pybinding(['const bfloat16*', 'const bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'float*', 'float*', 'float*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bfloat16* in_ptr1,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2,
                       bfloat16* out_ptr3,
                       float* out_ptr4,
                       float* out_ptr5,
                       float* out_ptr6)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(2L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = at::vec::VectorizedN<int64_t,2>::arange(tmp5, 1);
                            auto tmp7 = static_cast<int64_t>(256);
                            auto tmp8 = at::vec::VectorizedN<int64_t,2>(tmp7);
                            auto tmp9 = at::vec::VecMask<int64_t,2>(tmp6 >= tmp8);
                            auto tmp10 = [&]
                            {
                                auto tmp11 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                    {
                                        if (tmp9.is_masked(x3_inner))
                                        {
                                            tmpbuf[x3_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp12 = static_cast<int64_t>(512);
                                auto tmp13 = at::vec::VectorizedN<int64_t,2>(tmp12);
                                auto tmp14 = at::vec::VecMask<int64_t,2>(tmp11 < tmp13);
                                auto tmp16 = tmp14 & tmp9;
                                auto tmp15 = [&]
                                {
                                    auto tmp17 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp16.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>(131072L + x3 + x3_inner + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp18 = at::vec::convert<float>(tmp17);
                                    return tmp18;
                                }
                                ;
                                auto tmp21 =
                                [&]
                                {
                                    if (tmp16.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp19 = tmp15();
                                        auto tmp20 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp19)::blendv(tmp20, tmp19, tmp16.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp21;
                            }
                            ;
                            auto tmp24 =
                            [&]
                            {
                                if (tmp9.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp22 = tmp10();
                                    auto tmp23 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp22)::blendv(tmp23, tmp22, tmp9.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp25 = static_cast<int64_t>(1);
                            auto tmp26 = tmp25 < tmp25;
                            auto tmp27 = [&]
                            {
                                auto tmp29 = at::vec::VecMask<float,1>::from(tmp26);
                                auto tmp30 = tmp9 & tmp29;
                                auto tmp28 = [&]
                                {
                                    auto tmp31 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp30.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp32 = static_cast<int64_t>(512);
                                    auto tmp33 = at::vec::VectorizedN<int64_t,2>(tmp32);
                                    auto tmp34 = at::vec::VecMask<int64_t,2>(tmp31 < tmp33);
                                    auto tmp36 = tmp34 & tmp30;
                                    auto tmp35 = [&]
                                    {
                                        auto tmp37 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp36.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp38 = at::vec::convert<float>(tmp37);
                                        return tmp38;
                                    }
                                    ;
                                    auto tmp41 =
                                    [&]
                                    {
                                        if (tmp36.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp39 = tmp35();
                                            auto tmp40 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp39)::blendv(tmp40, tmp39, tmp36.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp41;
                                }
                                ;
                                auto tmp44 =
                                [&]
                                {
                                    if (tmp30.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp42 = tmp28();
                                        auto tmp43 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp42)::blendv(tmp43, tmp42, tmp30.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp45 = static_cast<float>(0.0);
                                auto tmp46 = at::vec::Vectorized<float>(tmp45);
                                auto tmp47 = decltype(tmp44)::blendv(tmp46, tmp44, tmp9.template cast<float,1>());
                                return tmp47;
                            }
                            ;
                            auto tmp48 = tmp26 ? tmp27() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp49 = static_cast<float>(0.0);
                            auto tmp50 = at::vec::VecMask<float,1>::from(tmp26);
                            auto tmp51 = at::vec::Vectorized<float>(tmp49);
                            auto tmp52 = decltype(tmp48)::blendv(tmp51, tmp48, tmp50.template cast<float,1>());
                            auto tmp53 = decltype(tmp24)::blendv(tmp52, tmp24, tmp9.template cast<float,1>());
                            auto tmp54 = c10::convert<int64_t>(tmp0);
                            auto tmp55 = tmp54 < tmp25;
                            auto tmp56 = [&]
                            {
                                auto tmp58 = at::vec::VecMask<float,1>::from(tmp55);
                                auto tmp59 = tmp9 & tmp58;
                                auto tmp57 = [&]
                                {
                                    auto tmp60 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp59.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp61 = static_cast<int64_t>(512);
                                    auto tmp62 = at::vec::VectorizedN<int64_t,2>(tmp61);
                                    auto tmp63 = at::vec::VecMask<int64_t,2>(tmp60 < tmp62);
                                    auto tmp65 = tmp63 & tmp59;
                                    auto tmp64 = [&]
                                    {
                                        auto tmp66 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp65.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp67 = at::vec::convert<float>(tmp66);
                                        return tmp67;
                                    }
                                    ;
                                    auto tmp70 =
                                    [&]
                                    {
                                        if (tmp65.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp68 = tmp64();
                                            auto tmp69 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp68)::blendv(tmp69, tmp68, tmp65.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp70;
                                }
                                ;
                                auto tmp73 =
                                [&]
                                {
                                    if (tmp59.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp71 = tmp57();
                                        auto tmp72 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp71)::blendv(tmp72, tmp71, tmp59.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp74 = decltype(tmp73)::blendv(tmp51, tmp73, tmp9.template cast<float,1>());
                                return tmp74;
                            }
                            ;
                            auto tmp75 = tmp55 ? tmp56() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp76 = at::vec::VecMask<float,1>::from(tmp55);
                            auto tmp77 = decltype(tmp75)::blendv(tmp51, tmp75, tmp76.template cast<float,1>());
                            auto tmp78 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp79 = decltype(tmp53)::blendv(tmp77, tmp53, tmp78.template cast<float,1>());
                            auto tmp80 = at::vec::convert<bfloat16>(tmp79);
                            tmp80.store(out_ptr0 + static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(256);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + (513L*x1))), static_cast<int64_t>(512L)));
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = static_cast<int64_t>(512);
                                auto tmp12 = tmp10 < tmp11;
                                auto tmp13 = [&]
                                {
                                    auto tmp14 = in_ptr0[static_cast<int64_t>(131072L + x3 + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                    auto tmp15 = c10::convert<float>(tmp14);
                                    return tmp15;
                                }
                                ;
                                auto tmp16 = tmp12 ? tmp13() : static_cast<decltype(tmp13())>(0.0);
                                return tmp16;
                            }
                            ;
                            auto tmp17 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp18 = static_cast<int64_t>(1);
                            auto tmp19 = tmp18 < tmp18;
                            auto tmp20 = [&]
                            {
                                auto tmp21 = [&]
                                {
                                    auto tmp22 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp23 = c10::convert<int64_t>(tmp22);
                                    auto tmp24 = static_cast<int64_t>(512);
                                    auto tmp25 = tmp23 < tmp24;
                                    auto tmp26 = [&]
                                    {
                                        auto tmp27 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                        auto tmp28 = c10::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp29 = tmp25 ? tmp26() : static_cast<decltype(tmp26())>(0.0);
                                    return tmp29;
                                }
                                ;
                                auto tmp30 = tmp7 ? tmp21() : static_cast<decltype(tmp21())>(0.0);
                                auto tmp31 = static_cast<float>(0.0);
                                auto tmp32 = tmp7 ? tmp30 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                            auto tmp34 = static_cast<float>(0.0);
                            auto tmp35 = tmp19 ? tmp33 : tmp34;
                            auto tmp36 = tmp7 ? tmp17 : tmp35;
                            auto tmp37 = c10::convert<int64_t>(tmp0);
                            auto tmp38 = tmp37 < tmp18;
                            auto tmp39 = [&]
                            {
                                auto tmp40 = [&]
                                {
                                    auto tmp41 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp42 = c10::convert<int64_t>(tmp41);
                                    auto tmp43 = static_cast<int64_t>(512);
                                    auto tmp44 = tmp42 < tmp43;
                                    auto tmp45 = [&]
                                    {
                                        auto tmp46 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                        auto tmp47 = c10::convert<float>(tmp46);
                                        return tmp47;
                                    }
                                    ;
                                    auto tmp48 = tmp44 ? tmp45() : static_cast<decltype(tmp45())>(0.0);
                                    return tmp48;
                                }
                                ;
                                auto tmp49 = tmp7 ? tmp40() : static_cast<decltype(tmp40())>(0.0);
                                auto tmp50 = tmp7 ? tmp49 : tmp34;
                                return tmp50;
                            }
                            ;
                            auto tmp51 = tmp38 ? tmp39() : static_cast<decltype(tmp39())>(0.0);
                            auto tmp52 = tmp38 ? tmp51 : tmp34;
                            auto tmp53 = tmp3 ? tmp36 : tmp52;
                            auto tmp54 = c10::convert<bfloat16>(tmp53);
                            out_ptr0[static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0))] = tmp54;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(256L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp96 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp132 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = at::vec::VectorizedN<int64_t,2>::arange(tmp10, 1);
                                auto tmp12 = at::vec::VectorizedN<int64_t,2>(tmp6);
                                auto tmp13 = at::vec::VecMask<int64_t,2>(tmp11 >= tmp12);
                                auto tmp14 = static_cast<int64_t>(256);
                                auto tmp15 = at::vec::VectorizedN<int64_t,2>(tmp14);
                                auto tmp16 = at::vec::VecMask<int64_t,2>(tmp11 < tmp15);
                                auto tmp17 = tmp13 & tmp16;
                                auto tmp19 = at::vec::VecMask<float,1>::from(tmp7);
                                auto tmp20 = tmp17 & tmp19;
                                auto tmp18 = [&]
                                {
                                    auto tmp21 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp20.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp22 = static_cast<int64_t>(512);
                                    auto tmp23 = at::vec::VectorizedN<int64_t,2>(tmp22);
                                    auto tmp24 = at::vec::VecMask<int64_t,2>(tmp21 < tmp23);
                                    auto tmp26 = tmp24 & tmp20;
                                    auto tmp25 = [&]
                                    {
                                        auto tmp27 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp26.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp28 = at::vec::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp31 =
                                    [&]
                                    {
                                        if (tmp26.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp29 = tmp25();
                                            auto tmp30 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp31;
                                }
                                ;
                                auto tmp34 =
                                [&]
                                {
                                    if (tmp20.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp32 = tmp18();
                                        auto tmp33 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp32)::blendv(tmp33, tmp32, tmp20.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp35 = static_cast<int64_t>(0);
                                auto tmp36 = tmp35 >= tmp6;
                                auto tmp38 = tmp36 & tmp7;
                                auto tmp37 = [&]
                                {
                                    auto tmp40 = at::vec::VecMask<float,1>::from(tmp38);
                                    auto tmp41 = tmp16 & tmp40;
                                    auto tmp39 = [&]
                                    {
                                        auto tmp42 =
                                        [&]
                                        {
                                            __at_align__ std::array<int64_t, 16> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp41.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                                }
                                            }
                                            return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp43 = static_cast<int64_t>(512);
                                        auto tmp44 = at::vec::VectorizedN<int64_t,2>(tmp43);
                                        auto tmp45 = at::vec::VecMask<int64_t,2>(tmp42 < tmp44);
                                        auto tmp47 = tmp45 & tmp41;
                                        auto tmp46 = [&]
                                        {
                                            auto tmp48 =
                                            [&]
                                            {
                                                __at_align__ std::array<bfloat16, 32> tmpbuf;
                                                #pragma GCC unroll 16
                                                for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                                {
                                                    if (tmp47.is_masked(x3_inner))
                                                    {
                                                        tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                    }
                                                }
                                                return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                            }
                                            ()
                                            ;
                                            auto tmp49 = at::vec::convert<float>(tmp48);
                                            return tmp49;
                                        }
                                        ;
                                        auto tmp52 =
                                        [&]
                                        {
                                            if (tmp47.all_zero())
                                            {
                                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            }
                                            else
                                            {
                                                auto tmp50 = tmp46();
                                                auto tmp51 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                                return decltype(tmp50)::blendv(tmp51, tmp50, tmp47.template cast<float,1>());
                                            }
                                        }
                                        ()
                                        ;
                                        return tmp52;
                                    }
                                    ;
                                    auto tmp55 =
                                    [&]
                                    {
                                        if (tmp41.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp53 = tmp39();
                                            auto tmp54 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp53)::blendv(tmp54, tmp53, tmp41.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    auto tmp56 = at::vec::VecMask<float,1>::from(tmp38).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                    auto tmp57 = at::vec::convert<float>(tmp56);
                                    auto tmp58 = decltype(tmp55)::blendv(tmp57, tmp55, tmp16.template cast<float,1>());
                                    return tmp58;
                                }
                                ;
                                auto tmp59 = tmp36 ? tmp37() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                                auto tmp60 = at::vec::VecMask<float,1>::from(tmp7).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp61 = at::vec::convert<float>(tmp60);
                                auto tmp62 = at::vec::VecMask<float,1>::from(tmp36);
                                auto tmp63 = decltype(tmp59)::blendv(tmp61, tmp59, tmp62.template cast<float,1>());
                                auto tmp64 = decltype(tmp34)::blendv(tmp63, tmp34, tmp17.template cast<float,1>());
                                return tmp64;
                            }
                            ;
                            auto tmp65 = tmp7 ? tmp8() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp66 = static_cast<int64_t>(0);
                            auto tmp67 = tmp66 >= tmp6;
                            auto tmp68 = [&]
                            {
                                auto tmp69 = x3;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(256);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 < tmp73);
                                auto tmp76 = at::vec::VecMask<float,1>::from(tmp67);
                                auto tmp77 = tmp74 & tmp76;
                                auto tmp75 = [&]
                                {
                                    auto tmp78 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp77.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp79 = static_cast<int64_t>(512);
                                    auto tmp80 = at::vec::VectorizedN<int64_t,2>(tmp79);
                                    auto tmp81 = at::vec::VecMask<int64_t,2>(tmp78 < tmp80);
                                    auto tmp83 = tmp81 & tmp77;
                                    auto tmp82 = [&]
                                    {
                                        auto tmp84 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp83.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp85 = at::vec::convert<float>(tmp84);
                                        return tmp85;
                                    }
                                    ;
                                    auto tmp88 =
                                    [&]
                                    {
                                        if (tmp83.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp86 = tmp82();
                                            auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp86)::blendv(tmp87, tmp86, tmp83.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp88;
                                }
                                ;
                                auto tmp91 =
                                [&]
                                {
                                    if (tmp77.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp89 = tmp75();
                                        auto tmp90 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp89)::blendv(tmp90, tmp89, tmp77.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp92 = at::vec::VecMask<float,1>::from(tmp67).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp93 = at::vec::convert<float>(tmp92);
                                auto tmp94 = decltype(tmp91)::blendv(tmp93, tmp91, tmp74.template cast<float,1>());
                                return tmp94;
                            }
                            ;
                            auto tmp95 = tmp67 ? tmp68() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp97 = at::vec::convert<float>(tmp96);
                            auto tmp98 = at::vec::VecMask<float,1>::from(tmp67);
                            auto tmp99 = decltype(tmp95)::blendv(tmp97, tmp95, tmp98.template cast<float,1>());
                            auto tmp100 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp101 = decltype(tmp65)::blendv(tmp99, tmp65, tmp100.template cast<float,1>());
                            auto tmp102 = c10::convert<int64_t>(tmp0);
                            auto tmp103 = tmp102 >= tmp6;
                            auto tmp104 = [&]
                            {
                                auto tmp105 = x3;
                                auto tmp106 = c10::convert<int64_t>(tmp105);
                                auto tmp107 = at::vec::VectorizedN<int64_t,2>::arange(tmp106, 1);
                                auto tmp108 = static_cast<int64_t>(256);
                                auto tmp109 = at::vec::VectorizedN<int64_t,2>(tmp108);
                                auto tmp110 = at::vec::VecMask<int64_t,2>(tmp107 < tmp109);
                                auto tmp112 = at::vec::VecMask<float,1>::from(tmp103);
                                auto tmp113 = tmp110 & tmp112;
                                auto tmp111 = [&]
                                {
                                    auto tmp114 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp113.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp115 = static_cast<int64_t>(512);
                                    auto tmp116 = at::vec::VectorizedN<int64_t,2>(tmp115);
                                    auto tmp117 = at::vec::VecMask<int64_t,2>(tmp114 < tmp116);
                                    auto tmp119 = tmp117 & tmp113;
                                    auto tmp118 = [&]
                                    {
                                        auto tmp120 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp119.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp121 = at::vec::convert<float>(tmp120);
                                        return tmp121;
                                    }
                                    ;
                                    auto tmp124 =
                                    [&]
                                    {
                                        if (tmp119.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp122 = tmp118();
                                            auto tmp123 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp122)::blendv(tmp123, tmp122, tmp119.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp124;
                                }
                                ;
                                auto tmp127 =
                                [&]
                                {
                                    if (tmp113.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp125 = tmp111();
                                        auto tmp126 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp125)::blendv(tmp126, tmp125, tmp113.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp128 = at::vec::VecMask<float,1>::from(tmp103).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp129 = at::vec::convert<float>(tmp128);
                                auto tmp130 = decltype(tmp127)::blendv(tmp129, tmp127, tmp110.template cast<float,1>());
                                return tmp130;
                            }
                            ;
                            auto tmp131 = tmp103 ? tmp104() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp133 = at::vec::convert<float>(tmp132);
                            auto tmp134 = at::vec::VecMask<float,1>::from(tmp103);
                            auto tmp135 = decltype(tmp131)::blendv(tmp133, tmp131, tmp134.template cast<float,1>());
                            auto tmp136 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp137 = decltype(tmp101)::blendv(tmp135, tmp101, tmp136.template cast<float,1>());
                            auto tmp138 = at::vec::convert<bfloat16>(tmp137);
                            tmp138.store(out_ptr1 + static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp68 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                            auto tmp93 = out_ptr0[static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0))];
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = tmp10 >= tmp6;
                                auto tmp12 = static_cast<int64_t>(256);
                                auto tmp13 = tmp10 < tmp12;
                                auto tmp14 = tmp11 & tmp13;
                                auto tmp15 = [&]
                                {
                                    auto tmp16 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp17 = c10::convert<int64_t>(tmp16);
                                    auto tmp18 = static_cast<int64_t>(512);
                                    auto tmp19 = tmp17 < tmp18;
                                    auto tmp20 = [&]
                                    {
                                        auto tmp21 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                        auto tmp22 = c10::convert<float>(tmp21);
                                        return tmp22;
                                    }
                                    ;
                                    auto tmp23 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                                    return tmp23;
                                }
                                ;
                                auto tmp24 = tmp14 ? tmp15() : static_cast<decltype(tmp15())>(0.0);
                                auto tmp25 = static_cast<int64_t>(0);
                                auto tmp26 = tmp25 >= tmp6;
                                auto tmp27 = [&]
                                {
                                    auto tmp28 = [&]
                                    {
                                        auto tmp29 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                        auto tmp30 = c10::convert<int64_t>(tmp29);
                                        auto tmp31 = static_cast<int64_t>(512);
                                        auto tmp32 = tmp30 < tmp31;
                                        auto tmp33 = [&]
                                        {
                                            auto tmp34 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                            auto tmp35 = c10::convert<float>(tmp34);
                                            return tmp35;
                                        }
                                        ;
                                        auto tmp36 = tmp32 ? tmp33() : static_cast<decltype(tmp33())>(0.0);
                                        return tmp36;
                                    }
                                    ;
                                    auto tmp37 = tmp13 ? tmp28() : static_cast<decltype(tmp28())>(0.0);
                                    auto tmp38 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                    auto tmp39 = c10::convert<float>(tmp38);
                                    auto tmp40 = tmp13 ? tmp37 : tmp39;
                                    return tmp40;
                                }
                                ;
                                auto tmp41 = tmp26 ? tmp27() : static_cast<decltype(tmp27())>(0.0);
                                auto tmp42 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp43 = c10::convert<float>(tmp42);
                                auto tmp44 = tmp26 ? tmp41 : tmp43;
                                auto tmp45 = tmp14 ? tmp24 : tmp44;
                                return tmp45;
                            }
                            ;
                            auto tmp46 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp47 = static_cast<int64_t>(0);
                            auto tmp48 = tmp47 >= tmp6;
                            auto tmp49 = [&]
                            {
                                auto tmp50 = x3;
                                auto tmp51 = c10::convert<int64_t>(tmp50);
                                auto tmp52 = static_cast<int64_t>(256);
                                auto tmp53 = tmp51 < tmp52;
                                auto tmp54 = [&]
                                {
                                    auto tmp55 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp56 = c10::convert<int64_t>(tmp55);
                                    auto tmp57 = static_cast<int64_t>(512);
                                    auto tmp58 = tmp56 < tmp57;
                                    auto tmp59 = [&]
                                    {
                                        auto tmp60 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp61 = c10::convert<float>(tmp60);
                                        return tmp61;
                                    }
                                    ;
                                    auto tmp62 = tmp58 ? tmp59() : static_cast<decltype(tmp59())>(0.0);
                                    return tmp62;
                                }
                                ;
                                auto tmp63 = tmp53 ? tmp54() : static_cast<decltype(tmp54())>(0.0);
                                auto tmp64 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp65 = c10::convert<float>(tmp64);
                                auto tmp66 = tmp53 ? tmp63 : tmp65;
                                return tmp66;
                            }
                            ;
                            auto tmp67 = tmp48 ? tmp49() : static_cast<decltype(tmp49())>(0.0);
                            auto tmp69 = c10::convert<float>(tmp68);
                            auto tmp70 = tmp48 ? tmp67 : tmp69;
                            auto tmp71 = tmp7 ? tmp46 : tmp70;
                            auto tmp72 = c10::convert<int64_t>(tmp0);
                            auto tmp73 = tmp72 >= tmp6;
                            auto tmp74 = [&]
                            {
                                auto tmp75 = x3;
                                auto tmp76 = c10::convert<int64_t>(tmp75);
                                auto tmp77 = static_cast<int64_t>(256);
                                auto tmp78 = tmp76 < tmp77;
                                auto tmp79 = [&]
                                {
                                    auto tmp80 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp81 = c10::convert<int64_t>(tmp80);
                                    auto tmp82 = static_cast<int64_t>(512);
                                    auto tmp83 = tmp81 < tmp82;
                                    auto tmp84 = [&]
                                    {
                                        auto tmp85 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp86 = c10::convert<float>(tmp85);
                                        return tmp86;
                                    }
                                    ;
                                    auto tmp87 = tmp83 ? tmp84() : static_cast<decltype(tmp84())>(0.0);
                                    return tmp87;
                                }
                                ;
                                auto tmp88 = tmp78 ? tmp79() : static_cast<decltype(tmp79())>(0.0);
                                auto tmp89 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp90 = c10::convert<float>(tmp89);
                                auto tmp91 = tmp78 ? tmp88 : tmp90;
                                return tmp91;
                            }
                            ;
                            auto tmp92 = tmp73 ? tmp74() : static_cast<decltype(tmp74())>(0.0);
                            auto tmp94 = c10::convert<float>(tmp93);
                            auto tmp95 = tmp73 ? tmp92 : tmp94;
                            auto tmp96 = tmp3 ? tmp71 : tmp95;
                            auto tmp97 = c10::convert<bfloat16>(tmp96);
                            out_ptr1[static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0))] = tmp97;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp93 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)), 16);
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(256);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 >= tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp8 = c10::convert<int64_t>(tmp7);
                            auto tmp9 = at::vec::VectorizedN<int64_t,2>::arange(tmp8, -1);
                            auto tmp10 = static_cast<int64_t>(0);
                            auto tmp11 = at::vec::VectorizedN<int64_t,2>(tmp10);
                            auto tmp12 = at::vec::VecMask<int64_t,2>(tmp9 <= tmp11);
                            auto tmp13 = static_cast<float>(1.0);
                            auto tmp14 = static_cast<float>(0.0);
                            auto tmp15 = at::vec::Vectorized<float>(tmp13);
                            auto tmp16 = at::vec::Vectorized<float>(tmp14);
                            auto tmp17 = decltype(tmp15)::blendv(tmp16, tmp15, tmp12.template cast<float,1>());
                            auto tmp18 = at::vec::VecMask<float,1>::from<float,1>(tmp17);
                            auto tmp19 = 256L + x1;
                            auto tmp20 = c10::convert<int64_t>(tmp19);
                            auto tmp21 = tmp20 < tmp3;
                            auto tmp23 = at::vec::VecMask<float,1>::from(tmp21);
                            auto tmp24 = tmp23 & tmp5;
                            auto tmp22 = [&]
                            {
                                auto tmp25 = static_cast<int64_t>(257);
                                auto tmp26 = at::vec::VectorizedN<int64_t,2>(tmp25);
                                auto tmp27 = at::vec::VecMask<int64_t,2>(tmp2 < tmp26);
                                auto tmp29 = tmp27 & tmp24;
                                auto tmp28 = [&]
                                {
                                    auto tmp30 = 1L + x1 + x2;
                                    auto tmp31 = c10::convert<int64_t>(tmp30);
                                    auto tmp32 = at::vec::VectorizedN<int64_t,2>::arange(tmp31, 1);
                                    auto tmp33 = at::vec::VecMask<int64_t,2>(tmp32 <= tmp11);
                                    auto tmp34 = decltype(tmp15)::blendv(tmp16, tmp15, tmp33.template cast<float,1>());
                                    auto tmp35 = at::vec::VecMask<float,1>::from<float,1>(tmp34);
                                    auto tmp36 = tmp29.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                    auto tmp37 = at::vec::convert<float>(tmp36);
                                    auto tmp38 = -std::numeric_limits<float>::infinity();
                                    auto tmp39 = at::vec::Vectorized<float>(tmp38);
                                    auto tmp40 = decltype(tmp39)::blendv(tmp37, tmp39, tmp35.template cast<float,1>());
                                    return tmp40;
                                }
                                ;
                                auto tmp43 =
                                [&]
                                {
                                    if (tmp29.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp41 = tmp28();
                                        auto tmp42 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp41)::blendv(tmp42, tmp41, tmp29.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp44 = tmp24.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp45 = at::vec::convert<float>(tmp44);
                                auto tmp46 = decltype(tmp43)::blendv(tmp45, tmp43, tmp27.template cast<float,1>());
                                return tmp46;
                            }
                            ;
                            auto tmp49 =
                            [&]
                            {
                                if (tmp24.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp47 = tmp22();
                                    auto tmp48 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp47)::blendv(tmp48, tmp47, tmp24.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp50 = tmp5.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp51 = at::vec::convert<float>(tmp50);
                            auto tmp52 = decltype(tmp49)::blendv(tmp51, tmp49, tmp23.template cast<float,1>());
                            auto tmp53 = -std::numeric_limits<float>::infinity();
                            auto tmp54 = at::vec::Vectorized<float>(tmp53);
                            auto tmp55 = decltype(tmp54)::blendv(tmp52, tmp54, tmp18.template cast<float,1>());
                            return tmp55;
                        }
                        ;
                        auto tmp58 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp56 = tmp6();
                                auto tmp57 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp56)::blendv(tmp57, tmp56, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp59 = 256L + x1;
                        auto tmp60 = c10::convert<int64_t>(tmp59);
                        auto tmp61 = tmp60 < tmp3;
                        auto tmp62 = [&]
                        {
                            auto tmp63 = static_cast<int64_t>(257);
                            auto tmp64 = at::vec::VectorizedN<int64_t,2>(tmp63);
                            auto tmp65 = at::vec::VecMask<int64_t,2>(tmp2 < tmp64);
                            auto tmp67 = at::vec::VecMask<float,1>::from(tmp61);
                            auto tmp68 = tmp65 & tmp67;
                            auto tmp66 = [&]
                            {
                                auto tmp69 = 1L + x1 + x2;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(0);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 <= tmp73);
                                auto tmp75 = static_cast<float>(1.0);
                                auto tmp76 = static_cast<float>(0.0);
                                auto tmp77 = at::vec::Vectorized<float>(tmp75);
                                auto tmp78 = at::vec::Vectorized<float>(tmp76);
                                auto tmp79 = decltype(tmp77)::blendv(tmp78, tmp77, tmp74.template cast<float,1>());
                                auto tmp80 = at::vec::VecMask<float,1>::from<float,1>(tmp79);
                                auto tmp81 = tmp68.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp82 = at::vec::convert<float>(tmp81);
                                auto tmp83 = -std::numeric_limits<float>::infinity();
                                auto tmp84 = at::vec::Vectorized<float>(tmp83);
                                auto tmp85 = decltype(tmp84)::blendv(tmp82, tmp84, tmp80.template cast<float,1>());
                                return tmp85;
                            }
                            ;
                            auto tmp88 =
                            [&]
                            {
                                if (tmp68.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp86 = tmp66();
                                    auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp86)::blendv(tmp87, tmp86, tmp68.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp89 = at::vec::VecMask<float,1>::from(tmp61).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp90 = at::vec::convert<float>(tmp89);
                            auto tmp91 = decltype(tmp88)::blendv(tmp90, tmp88, tmp65.template cast<float,1>());
                            return tmp91;
                        }
                        ;
                        auto tmp92 = tmp61 ? tmp62() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp94 = at::vec::convert<float>(tmp93);
                        auto tmp95 = at::vec::VecMask<float,1>::from(tmp61);
                        auto tmp96 = decltype(tmp92)::blendv(tmp94, tmp92, tmp95.template cast<float,1>());
                        auto tmp97 = decltype(tmp58)::blendv(tmp96, tmp58, tmp5.template cast<float,1>());
                        auto tmp98 = at::vec::convert<bfloat16>(tmp97);
                        tmp98.store(out_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp64 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp6 = c10::convert<int64_t>(tmp5);
                            auto tmp7 = static_cast<int64_t>(0);
                            auto tmp8 = tmp6 <= tmp7;
                            auto tmp9 = static_cast<float>(1.0);
                            auto tmp10 = static_cast<float>(0.0);
                            auto tmp11 = tmp8 ? tmp9 : tmp10;
                            auto tmp12 = c10::convert<bool>(tmp11);
                            auto tmp13 = 256L + x1;
                            auto tmp14 = c10::convert<int64_t>(tmp13);
                            auto tmp15 = tmp14 < tmp2;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = static_cast<int64_t>(257);
                                auto tmp18 = tmp1 < tmp17;
                                auto tmp19 = [&]
                                {
                                    auto tmp20 = 1L + x1 + x2;
                                    auto tmp21 = c10::convert<int64_t>(tmp20);
                                    auto tmp22 = tmp21 <= tmp7;
                                    auto tmp23 = tmp22 ? tmp9 : tmp10;
                                    auto tmp24 = c10::convert<bool>(tmp23);
                                    auto tmp25 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                    auto tmp26 = c10::convert<float>(tmp25);
                                    auto tmp27 = -std::numeric_limits<float>::infinity();
                                    auto tmp28 = tmp24 ? tmp27 : tmp26;
                                    return tmp28;
                                }
                                ;
                                auto tmp29 = tmp18 ? tmp19() : static_cast<decltype(tmp19())>(0.0);
                                auto tmp30 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp31 = c10::convert<float>(tmp30);
                                auto tmp32 = tmp18 ? tmp29 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp34 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp35 = c10::convert<float>(tmp34);
                            auto tmp36 = tmp15 ? tmp33 : tmp35;
                            auto tmp37 = -std::numeric_limits<float>::infinity();
                            auto tmp38 = tmp12 ? tmp37 : tmp36;
                            return tmp38;
                        }
                        ;
                        auto tmp39 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp40 = 256L + x1;
                        auto tmp41 = c10::convert<int64_t>(tmp40);
                        auto tmp42 = tmp41 < tmp2;
                        auto tmp43 = [&]
                        {
                            auto tmp44 = static_cast<int64_t>(257);
                            auto tmp45 = tmp1 < tmp44;
                            auto tmp46 = [&]
                            {
                                auto tmp47 = 1L + x1 + x2;
                                auto tmp48 = c10::convert<int64_t>(tmp47);
                                auto tmp49 = static_cast<int64_t>(0);
                                auto tmp50 = tmp48 <= tmp49;
                                auto tmp51 = static_cast<float>(1.0);
                                auto tmp52 = static_cast<float>(0.0);
                                auto tmp53 = tmp50 ? tmp51 : tmp52;
                                auto tmp54 = c10::convert<bool>(tmp53);
                                auto tmp55 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp56 = c10::convert<float>(tmp55);
                                auto tmp57 = -std::numeric_limits<float>::infinity();
                                auto tmp58 = tmp54 ? tmp57 : tmp56;
                                return tmp58;
                            }
                            ;
                            auto tmp59 = tmp45 ? tmp46() : static_cast<decltype(tmp46())>(0.0);
                            auto tmp60 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp61 = c10::convert<float>(tmp60);
                            auto tmp62 = tmp45 ? tmp59 : tmp61;
                            return tmp62;
                        }
                        ;
                        auto tmp63 = tmp42 ? tmp43() : static_cast<decltype(tmp43())>(0.0);
                        auto tmp65 = c10::convert<float>(tmp64);
                        auto tmp66 = tmp42 ? tmp63 : tmp65;
                        auto tmp67 = tmp3 ? tmp39 : tmp66;
                        auto tmp68 = c10::convert<bfloat16>(tmp67);
                        out_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0))] = tmp68;
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp45 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)), 16);
                        auto tmp83 = at::vec::Vectorized<bfloat16>::loadu(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)), 16);
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr2 + static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0)));
                            auto tmp6 = at::vec::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = at::vec::VectorizedN<int64_t,2>::arange(tmp13, 1);
                            auto tmp15 = static_cast<int64_t>(257);
                            auto tmp16 = at::vec::VectorizedN<int64_t,2>(tmp15);
                            auto tmp17 = at::vec::VecMask<int64_t,2>(tmp14 < tmp16);
                            auto tmp19 = at::vec::VecMask<float,1>::from(tmp10);
                            auto tmp20 = tmp17 & tmp19;
                            auto tmp18 = [&]
                            {
                                auto tmp21 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp22 = c10::convert<int64_t>(tmp21);
                                auto tmp23 = at::vec::VectorizedN<int64_t,2>::arange(tmp22, 1);
                                auto tmp24 = static_cast<int64_t>(0);
                                auto tmp25 = at::vec::VectorizedN<int64_t,2>(tmp24);
                                auto tmp26 = at::vec::VecMask<int64_t,2>(tmp23 <= tmp25);
                                auto tmp27 = static_cast<float>(1.0);
                                auto tmp28 = static_cast<float>(0.0);
                                auto tmp29 = at::vec::Vectorized<float>(tmp27);
                                auto tmp30 = at::vec::Vectorized<float>(tmp28);
                                auto tmp31 = decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                auto tmp32 = at::vec::VecMask<float,1>::from<float,1>(tmp31);
                                auto tmp33 = tmp20.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                                auto tmp34 = at::vec::convert<float>(tmp33);
                                auto tmp35 = -std::numeric_limits<float>::infinity();
                                auto tmp36 = at::vec::Vectorized<float>(tmp35);
                                auto tmp37 = decltype(tmp36)::blendv(tmp34, tmp36, tmp32.template cast<float,1>());
                                return tmp37;
                            }
                            ;
                            auto tmp40 =
                            [&]
                            {
                                if (tmp20.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp38 = tmp18();
                                    auto tmp39 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp38)::blendv(tmp39, tmp38, tmp20.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp41 = at::vec::VecMask<float,1>::from(tmp10).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                            auto tmp42 = at::vec::convert<float>(tmp41);
                            auto tmp43 = decltype(tmp40)::blendv(tmp42, tmp40, tmp17.template cast<float,1>());
                            return tmp43;
                        }
                        ;
                        auto tmp44 = tmp10 ? tmp11() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp46 = at::vec::convert<float>(tmp45);
                        auto tmp47 = at::vec::VecMask<float,1>::from(tmp10);
                        auto tmp48 = decltype(tmp44)::blendv(tmp46, tmp44, tmp47.template cast<float,1>());
                        auto tmp49 = at::vec::VecMask<float,1>::from(tmp3);
                        auto tmp50 = decltype(tmp7)::blendv(tmp48, tmp7, tmp49.template cast<float,1>());
                        auto tmp51 = [&]
                        {
                            auto tmp52 = x2;
                            auto tmp53 = c10::convert<int64_t>(tmp52);
                            auto tmp54 = at::vec::VectorizedN<int64_t,2>::arange(tmp53, 1);
                            auto tmp55 = at::vec::VectorizedN<int64_t,2>(tmp2);
                            auto tmp56 = at::vec::VecMask<int64_t,2>(tmp54 >= tmp55);
                            auto tmp58 = tmp56 & tmp49;
                            auto tmp57 = [&]
                            {
                                auto tmp59 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp60 = c10::convert<int64_t>(tmp59);
                                auto tmp61 = at::vec::VectorizedN<int64_t,2>::arange(tmp60, -1);
                                auto tmp62 = static_cast<int64_t>(0);
                                auto tmp63 = at::vec::VectorizedN<int64_t,2>(tmp62);
                                auto tmp64 = at::vec::VecMask<int64_t,2>(tmp61 <= tmp63);
                                auto tmp65 = static_cast<float>(1.0);
                                auto tmp66 = static_cast<float>(0.0);
                                auto tmp67 = at::vec::Vectorized<float>(tmp65);
                                auto tmp68 = at::vec::Vectorized<float>(tmp66);
                                auto tmp69 = decltype(tmp67)::blendv(tmp68, tmp67, tmp64.template cast<float,1>());
                                auto tmp70 = at::vec::VecMask<float,1>::from<float,1>(tmp69);
                                auto tmp71 = tmp58.template cast<float,1>().template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                                auto tmp72 = at::vec::convert<float>(tmp71);
                                auto tmp73 = -std::numeric_limits<float>::infinity();
                                auto tmp74 = at::vec::Vectorized<float>(tmp73);
                                auto tmp75 = decltype(tmp74)::blendv(tmp72, tmp74, tmp70.template cast<float,1>());
                                return tmp75;
                            }
                            ;
                            auto tmp78 =
                            [&]
                            {
                                if (tmp58.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp76 = tmp57();
                                    auto tmp77 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp76)::blendv(tmp77, tmp76, tmp58.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp79 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                            auto tmp80 = at::vec::convert<float>(tmp79);
                            auto tmp81 = decltype(tmp78)::blendv(tmp80, tmp78, tmp56.template cast<float,1>());
                            return tmp81;
                        }
                        ;
                        auto tmp82 = tmp3 ? tmp51() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp84 = at::vec::convert<float>(tmp83);
                        auto tmp85 = decltype(tmp82)::blendv(tmp84, tmp82, tmp49.template cast<float,1>());
                        auto tmp86 = tmp50 + tmp85;
                        auto tmp87 = at::vec::convert<bfloat16>(tmp86);
                        tmp87.store(out_ptr3 + static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp34 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                        auto tmp60 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = out_ptr2[static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0))];
                            auto tmp6 = c10::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = static_cast<int64_t>(257);
                            auto tmp15 = tmp13 < tmp14;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp18 = c10::convert<int64_t>(tmp17);
                                auto tmp19 = static_cast<int64_t>(0);
                                auto tmp20 = tmp18 <= tmp19;
                                auto tmp21 = static_cast<float>(1.0);
                                auto tmp22 = static_cast<float>(0.0);
                                auto tmp23 = tmp20 ? tmp21 : tmp22;
                                auto tmp24 = c10::convert<bool>(tmp23);
                                auto tmp25 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                                auto tmp26 = c10::convert<float>(tmp25);
                                auto tmp27 = -std::numeric_limits<float>::infinity();
                                auto tmp28 = tmp24 ? tmp27 : tmp26;
                                return tmp28;
                            }
                            ;
                            auto tmp29 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp30 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                            auto tmp31 = c10::convert<float>(tmp30);
                            auto tmp32 = tmp15 ? tmp29 : tmp31;
                            return tmp32;
                        }
                        ;
                        auto tmp33 = tmp10 ? tmp11() : static_cast<decltype(tmp11())>(0.0);
                        auto tmp35 = c10::convert<float>(tmp34);
                        auto tmp36 = tmp10 ? tmp33 : tmp35;
                        auto tmp37 = tmp3 ? tmp7 : tmp36;
                        auto tmp38 = [&]
                        {
                            auto tmp39 = x2;
                            auto tmp40 = c10::convert<int64_t>(tmp39);
                            auto tmp41 = tmp40 >= tmp2;
                            auto tmp42 = [&]
                            {
                                auto tmp43 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp44 = c10::convert<int64_t>(tmp43);
                                auto tmp45 = static_cast<int64_t>(0);
                                auto tmp46 = tmp44 <= tmp45;
                                auto tmp47 = static_cast<float>(1.0);
                                auto tmp48 = static_cast<float>(0.0);
                                auto tmp49 = tmp46 ? tmp47 : tmp48;
                                auto tmp50 = c10::convert<bool>(tmp49);
                                auto tmp51 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                                auto tmp52 = c10::convert<float>(tmp51);
                                auto tmp53 = -std::numeric_limits<float>::infinity();
                                auto tmp54 = tmp50 ? tmp53 : tmp52;
                                return tmp54;
                            }
                            ;
                            auto tmp55 = tmp41 ? tmp42() : static_cast<decltype(tmp42())>(0.0);
                            auto tmp56 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                            auto tmp57 = c10::convert<float>(tmp56);
                            auto tmp58 = tmp41 ? tmp55 : tmp57;
                            return tmp58;
                        }
                        ;
                        auto tmp59 = tmp3 ? tmp38() : static_cast<decltype(tmp38())>(0.0);
                        auto tmp61 = c10::convert<float>(tmp60);
                        auto tmp62 = tmp3 ? tmp59 : tmp61;
                        auto tmp63 = decltype(tmp37)(tmp37 + tmp62);
                        auto tmp64 = c10::convert<bfloat16>(tmp63);
                        out_ptr3[static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1))] = tmp64;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(6144L); x0+=static_cast<int64_t>(1L))
            {
                {
                    float tmp_acc0 = -std::numeric_limits<float>::infinity();
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(-std::numeric_limits<float>::infinity());
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        tmp_acc0_vec = at::vec::maximum(tmp_acc0_vec, tmp1);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp1 = c10::convert<float>(tmp0);
                        tmp_acc0 = max_propagate_nan(tmp_acc0, tmp1);
                    }
                    tmp_acc0 = max_propagate_nan(tmp_acc0, at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return at::vec::maximum(x, y); }, tmp_acc0_vec));
                    out_ptr4[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
                {
                    float tmp_acc0 = 0;
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(0);
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = at::vec::Vectorized<float>(tmp2);
                        auto tmp4 = tmp1 - tmp3;
                        auto tmp5 = tmp4.exp();
                        tmp5.store(out_ptr5 + static_cast<int64_t>(x1 + (513L*x0)));
                        tmp_acc0_vec = tmp_acc0_vec + tmp5;
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = c10::convert<float>(tmp0);
                        auto tmp3 = decltype(tmp1)(tmp1 - tmp2);
                        auto tmp4 = std::exp(tmp3);
                        out_ptr5[static_cast<int64_t>(x1 + (513L*x0))] = tmp4;
                        tmp_acc0 = tmp_acc0 + tmp4;
                    }
                    tmp_acc0 = tmp_acc0 + at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return x + y; }, tmp_acc0_vec);
                    out_ptr6[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
            }
        }
    }
}
''')


cpp_fused_clone_constant_pad_nd_32 = async_compile.cpp_pybinding(['const bfloat16*', 'const bool*', 'const float*', 'const float*', 'bfloat16*', 'bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bool* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(1024L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = (-256L) + x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(0);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = static_cast<int64_t>(512);
                        auto tmp5 = tmp1 < tmp4;
                        auto tmp6 = tmp3 & tmp5;
                        auto tmp7 = [&]
                        {
                            auto tmp8 = at::vec::VecMask<float,1>::from(tmp6).template loadu<bfloat16,1>(in_ptr0 + static_cast<int64_t>((-196608L) + x2 + (64L*x0) + (768L*x1)));
                            auto tmp9 = at::vec::convert<float>(tmp8);
                            return tmp9;
                        }
                        ;
                        auto tmp10 = tmp6 ? tmp7() : at::vec::Vectorized<float>(static_cast<float>(-1.0));
                        auto tmp11 = at::vec::convert<bfloat16>(tmp10);
                        tmp11.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (65536L*x0)), 16);
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(768L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(513);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 < tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp8 = tmp5.template cast<float,1>().template loadu<float,1>(in_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0)));
                            auto tmp9 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp10 = at::vec::Vectorized<float>(tmp9);
                            auto tmp11 = tmp8 / tmp10;
                            auto tmp12 = static_cast<float>(0.0);
                            auto tmp13 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp14 = at::vec::Vectorized<float>(tmp12);
                            auto tmp15 = decltype(tmp14)::blendv(tmp11, tmp14, tmp13.template cast<float,1>());
                            auto tmp16 = (tmp15);
                            return tmp16;
                        }
                        ;
                        auto tmp19 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp17 = tmp6();
                                auto tmp18 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp17)::blendv(tmp18, tmp17, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp20 = at::vec::convert<bfloat16>(tmp19);
                        tmp20.store(out_ptr1 + static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(768L); x2<static_cast<int64_t>(770L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(513);
                        auto tmp3 = tmp1 < tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp6 = in_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0))];
                            auto tmp7 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp8 = tmp6 / tmp7;
                            auto tmp9 = static_cast<float>(0.0);
                            auto tmp10 = tmp5 ? tmp9 : tmp8;
                            auto tmp11 = c10::convert<float>(tmp10);
                            return tmp11;
                        }
                        ;
                        auto tmp12 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp13 = c10::convert<bfloat16>(tmp12);
                        out_ptr1[static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1))] = tmp13;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(49152L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x2 + (16384L*x1) + (65536L*x0)), 32);
                        tmp0.store(out_ptr2 + static_cast<int64_t>(x2 + (49152L*x1) + (98304L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused_clone_33 = async_compile.cpp_pybinding(['const bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       bfloat16* out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x2 + (64L*x0) + (32768L*x1)), 32);
                        tmp0.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (768L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_34 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    auto tmp19 = at::vec::convert<bfloat16>(tmp18);
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                    tmp19.store(out_ptr3 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_35 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<float>::loadu(out_ptr2 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<bfloat16>(tmp0);
                tmp1.store(out_ptr3 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_36 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<float>(tmp0);
                auto tmp2 = static_cast<float>(0.125);
                auto tmp3 = at::vec::Vectorized<float>(tmp2);
                auto tmp4 = tmp1 * tmp3;
                auto tmp5 = at::vec::convert<bfloat16>(tmp4);
                tmp5.store(in_out_ptr0 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_37 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(32L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 32);
                tmp0.store(in_out_ptr0 + static_cast<int64_t>(x0), 32);
            }
        }
    }
}
''')


cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_38 = async_compile.cpp_pybinding(['const bfloat16*', 'const bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'float*', 'float*', 'float*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bfloat16* in_ptr1,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2,
                       bfloat16* out_ptr3,
                       float* out_ptr4,
                       float* out_ptr5,
                       float* out_ptr6)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(2L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = at::vec::VectorizedN<int64_t,2>::arange(tmp5, 1);
                            auto tmp7 = static_cast<int64_t>(256);
                            auto tmp8 = at::vec::VectorizedN<int64_t,2>(tmp7);
                            auto tmp9 = at::vec::VecMask<int64_t,2>(tmp6 >= tmp8);
                            auto tmp10 = [&]
                            {
                                auto tmp11 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                    {
                                        if (tmp9.is_masked(x3_inner))
                                        {
                                            tmpbuf[x3_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp12 = static_cast<int64_t>(512);
                                auto tmp13 = at::vec::VectorizedN<int64_t,2>(tmp12);
                                auto tmp14 = at::vec::VecMask<int64_t,2>(tmp11 < tmp13);
                                auto tmp16 = tmp14 & tmp9;
                                auto tmp15 = [&]
                                {
                                    auto tmp17 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp16.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>(131072L + x3 + x3_inner + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp18 = at::vec::convert<float>(tmp17);
                                    return tmp18;
                                }
                                ;
                                auto tmp21 =
                                [&]
                                {
                                    if (tmp16.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp19 = tmp15();
                                        auto tmp20 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp19)::blendv(tmp20, tmp19, tmp16.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp21;
                            }
                            ;
                            auto tmp24 =
                            [&]
                            {
                                if (tmp9.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp22 = tmp10();
                                    auto tmp23 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp22)::blendv(tmp23, tmp22, tmp9.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp25 = static_cast<int64_t>(1);
                            auto tmp26 = tmp25 < tmp25;
                            auto tmp27 = [&]
                            {
                                auto tmp29 = at::vec::VecMask<float,1>::from(tmp26);
                                auto tmp30 = tmp9 & tmp29;
                                auto tmp28 = [&]
                                {
                                    auto tmp31 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp30.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp32 = static_cast<int64_t>(512);
                                    auto tmp33 = at::vec::VectorizedN<int64_t,2>(tmp32);
                                    auto tmp34 = at::vec::VecMask<int64_t,2>(tmp31 < tmp33);
                                    auto tmp36 = tmp34 & tmp30;
                                    auto tmp35 = [&]
                                    {
                                        auto tmp37 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp36.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp38 = at::vec::convert<float>(tmp37);
                                        return tmp38;
                                    }
                                    ;
                                    auto tmp41 =
                                    [&]
                                    {
                                        if (tmp36.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp39 = tmp35();
                                            auto tmp40 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp39)::blendv(tmp40, tmp39, tmp36.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp41;
                                }
                                ;
                                auto tmp44 =
                                [&]
                                {
                                    if (tmp30.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp42 = tmp28();
                                        auto tmp43 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp42)::blendv(tmp43, tmp42, tmp30.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp45 = static_cast<float>(0.0);
                                auto tmp46 = at::vec::Vectorized<float>(tmp45);
                                auto tmp47 = decltype(tmp44)::blendv(tmp46, tmp44, tmp9.template cast<float,1>());
                                return tmp47;
                            }
                            ;
                            auto tmp48 = tmp26 ? tmp27() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp49 = static_cast<float>(0.0);
                            auto tmp50 = at::vec::VecMask<float,1>::from(tmp26);
                            auto tmp51 = at::vec::Vectorized<float>(tmp49);
                            auto tmp52 = decltype(tmp48)::blendv(tmp51, tmp48, tmp50.template cast<float,1>());
                            auto tmp53 = decltype(tmp24)::blendv(tmp52, tmp24, tmp9.template cast<float,1>());
                            auto tmp54 = c10::convert<int64_t>(tmp0);
                            auto tmp55 = tmp54 < tmp25;
                            auto tmp56 = [&]
                            {
                                auto tmp58 = at::vec::VecMask<float,1>::from(tmp55);
                                auto tmp59 = tmp9 & tmp58;
                                auto tmp57 = [&]
                                {
                                    auto tmp60 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp59.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp61 = static_cast<int64_t>(512);
                                    auto tmp62 = at::vec::VectorizedN<int64_t,2>(tmp61);
                                    auto tmp63 = at::vec::VecMask<int64_t,2>(tmp60 < tmp62);
                                    auto tmp65 = tmp63 & tmp59;
                                    auto tmp64 = [&]
                                    {
                                        auto tmp66 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp65.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp67 = at::vec::convert<float>(tmp66);
                                        return tmp67;
                                    }
                                    ;
                                    auto tmp70 =
                                    [&]
                                    {
                                        if (tmp65.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp68 = tmp64();
                                            auto tmp69 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp68)::blendv(tmp69, tmp68, tmp65.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp70;
                                }
                                ;
                                auto tmp73 =
                                [&]
                                {
                                    if (tmp59.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp71 = tmp57();
                                        auto tmp72 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp71)::blendv(tmp72, tmp71, tmp59.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp74 = decltype(tmp73)::blendv(tmp51, tmp73, tmp9.template cast<float,1>());
                                return tmp74;
                            }
                            ;
                            auto tmp75 = tmp55 ? tmp56() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp76 = at::vec::VecMask<float,1>::from(tmp55);
                            auto tmp77 = decltype(tmp75)::blendv(tmp51, tmp75, tmp76.template cast<float,1>());
                            auto tmp78 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp79 = decltype(tmp53)::blendv(tmp77, tmp53, tmp78.template cast<float,1>());
                            auto tmp80 = at::vec::convert<bfloat16>(tmp79);
                            tmp80.store(out_ptr0 + static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(256);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + (513L*x1))), static_cast<int64_t>(512L)));
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = static_cast<int64_t>(512);
                                auto tmp12 = tmp10 < tmp11;
                                auto tmp13 = [&]
                                {
                                    auto tmp14 = in_ptr0[static_cast<int64_t>(131072L + x3 + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                    auto tmp15 = c10::convert<float>(tmp14);
                                    return tmp15;
                                }
                                ;
                                auto tmp16 = tmp12 ? tmp13() : static_cast<decltype(tmp13())>(0.0);
                                return tmp16;
                            }
                            ;
                            auto tmp17 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp18 = static_cast<int64_t>(1);
                            auto tmp19 = tmp18 < tmp18;
                            auto tmp20 = [&]
                            {
                                auto tmp21 = [&]
                                {
                                    auto tmp22 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp23 = c10::convert<int64_t>(tmp22);
                                    auto tmp24 = static_cast<int64_t>(512);
                                    auto tmp25 = tmp23 < tmp24;
                                    auto tmp26 = [&]
                                    {
                                        auto tmp27 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                        auto tmp28 = c10::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp29 = tmp25 ? tmp26() : static_cast<decltype(tmp26())>(0.0);
                                    return tmp29;
                                }
                                ;
                                auto tmp30 = tmp7 ? tmp21() : static_cast<decltype(tmp21())>(0.0);
                                auto tmp31 = static_cast<float>(0.0);
                                auto tmp32 = tmp7 ? tmp30 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                            auto tmp34 = static_cast<float>(0.0);
                            auto tmp35 = tmp19 ? tmp33 : tmp34;
                            auto tmp36 = tmp7 ? tmp17 : tmp35;
                            auto tmp37 = c10::convert<int64_t>(tmp0);
                            auto tmp38 = tmp37 < tmp18;
                            auto tmp39 = [&]
                            {
                                auto tmp40 = [&]
                                {
                                    auto tmp41 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp42 = c10::convert<int64_t>(tmp41);
                                    auto tmp43 = static_cast<int64_t>(512);
                                    auto tmp44 = tmp42 < tmp43;
                                    auto tmp45 = [&]
                                    {
                                        auto tmp46 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                        auto tmp47 = c10::convert<float>(tmp46);
                                        return tmp47;
                                    }
                                    ;
                                    auto tmp48 = tmp44 ? tmp45() : static_cast<decltype(tmp45())>(0.0);
                                    return tmp48;
                                }
                                ;
                                auto tmp49 = tmp7 ? tmp40() : static_cast<decltype(tmp40())>(0.0);
                                auto tmp50 = tmp7 ? tmp49 : tmp34;
                                return tmp50;
                            }
                            ;
                            auto tmp51 = tmp38 ? tmp39() : static_cast<decltype(tmp39())>(0.0);
                            auto tmp52 = tmp38 ? tmp51 : tmp34;
                            auto tmp53 = tmp3 ? tmp36 : tmp52;
                            auto tmp54 = c10::convert<bfloat16>(tmp53);
                            out_ptr0[static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0))] = tmp54;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(256L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp96 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp132 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = at::vec::VectorizedN<int64_t,2>::arange(tmp10, 1);
                                auto tmp12 = at::vec::VectorizedN<int64_t,2>(tmp6);
                                auto tmp13 = at::vec::VecMask<int64_t,2>(tmp11 >= tmp12);
                                auto tmp14 = static_cast<int64_t>(256);
                                auto tmp15 = at::vec::VectorizedN<int64_t,2>(tmp14);
                                auto tmp16 = at::vec::VecMask<int64_t,2>(tmp11 < tmp15);
                                auto tmp17 = tmp13 & tmp16;
                                auto tmp19 = at::vec::VecMask<float,1>::from(tmp7);
                                auto tmp20 = tmp17 & tmp19;
                                auto tmp18 = [&]
                                {
                                    auto tmp21 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp20.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp22 = static_cast<int64_t>(512);
                                    auto tmp23 = at::vec::VectorizedN<int64_t,2>(tmp22);
                                    auto tmp24 = at::vec::VecMask<int64_t,2>(tmp21 < tmp23);
                                    auto tmp26 = tmp24 & tmp20;
                                    auto tmp25 = [&]
                                    {
                                        auto tmp27 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp26.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp28 = at::vec::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp31 =
                                    [&]
                                    {
                                        if (tmp26.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp29 = tmp25();
                                            auto tmp30 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp31;
                                }
                                ;
                                auto tmp34 =
                                [&]
                                {
                                    if (tmp20.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp32 = tmp18();
                                        auto tmp33 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp32)::blendv(tmp33, tmp32, tmp20.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp35 = static_cast<int64_t>(0);
                                auto tmp36 = tmp35 >= tmp6;
                                auto tmp38 = tmp36 & tmp7;
                                auto tmp37 = [&]
                                {
                                    auto tmp40 = at::vec::VecMask<float,1>::from(tmp38);
                                    auto tmp41 = tmp16 & tmp40;
                                    auto tmp39 = [&]
                                    {
                                        auto tmp42 =
                                        [&]
                                        {
                                            __at_align__ std::array<int64_t, 16> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp41.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                                }
                                            }
                                            return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp43 = static_cast<int64_t>(512);
                                        auto tmp44 = at::vec::VectorizedN<int64_t,2>(tmp43);
                                        auto tmp45 = at::vec::VecMask<int64_t,2>(tmp42 < tmp44);
                                        auto tmp47 = tmp45 & tmp41;
                                        auto tmp46 = [&]
                                        {
                                            auto tmp48 =
                                            [&]
                                            {
                                                __at_align__ std::array<bfloat16, 32> tmpbuf;
                                                #pragma GCC unroll 16
                                                for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                                {
                                                    if (tmp47.is_masked(x3_inner))
                                                    {
                                                        tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                    }
                                                }
                                                return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                            }
                                            ()
                                            ;
                                            auto tmp49 = at::vec::convert<float>(tmp48);
                                            return tmp49;
                                        }
                                        ;
                                        auto tmp52 =
                                        [&]
                                        {
                                            if (tmp47.all_zero())
                                            {
                                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            }
                                            else
                                            {
                                                auto tmp50 = tmp46();
                                                auto tmp51 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                                return decltype(tmp50)::blendv(tmp51, tmp50, tmp47.template cast<float,1>());
                                            }
                                        }
                                        ()
                                        ;
                                        return tmp52;
                                    }
                                    ;
                                    auto tmp55 =
                                    [&]
                                    {
                                        if (tmp41.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp53 = tmp39();
                                            auto tmp54 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp53)::blendv(tmp54, tmp53, tmp41.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    auto tmp56 = at::vec::VecMask<float,1>::from(tmp38).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                    auto tmp57 = at::vec::convert<float>(tmp56);
                                    auto tmp58 = decltype(tmp55)::blendv(tmp57, tmp55, tmp16.template cast<float,1>());
                                    return tmp58;
                                }
                                ;
                                auto tmp59 = tmp36 ? tmp37() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                                auto tmp60 = at::vec::VecMask<float,1>::from(tmp7).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp61 = at::vec::convert<float>(tmp60);
                                auto tmp62 = at::vec::VecMask<float,1>::from(tmp36);
                                auto tmp63 = decltype(tmp59)::blendv(tmp61, tmp59, tmp62.template cast<float,1>());
                                auto tmp64 = decltype(tmp34)::blendv(tmp63, tmp34, tmp17.template cast<float,1>());
                                return tmp64;
                            }
                            ;
                            auto tmp65 = tmp7 ? tmp8() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp66 = static_cast<int64_t>(0);
                            auto tmp67 = tmp66 >= tmp6;
                            auto tmp68 = [&]
                            {
                                auto tmp69 = x3;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(256);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 < tmp73);
                                auto tmp76 = at::vec::VecMask<float,1>::from(tmp67);
                                auto tmp77 = tmp74 & tmp76;
                                auto tmp75 = [&]
                                {
                                    auto tmp78 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp77.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp79 = static_cast<int64_t>(512);
                                    auto tmp80 = at::vec::VectorizedN<int64_t,2>(tmp79);
                                    auto tmp81 = at::vec::VecMask<int64_t,2>(tmp78 < tmp80);
                                    auto tmp83 = tmp81 & tmp77;
                                    auto tmp82 = [&]
                                    {
                                        auto tmp84 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp83.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp85 = at::vec::convert<float>(tmp84);
                                        return tmp85;
                                    }
                                    ;
                                    auto tmp88 =
                                    [&]
                                    {
                                        if (tmp83.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp86 = tmp82();
                                            auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp86)::blendv(tmp87, tmp86, tmp83.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp88;
                                }
                                ;
                                auto tmp91 =
                                [&]
                                {
                                    if (tmp77.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp89 = tmp75();
                                        auto tmp90 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp89)::blendv(tmp90, tmp89, tmp77.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp92 = at::vec::VecMask<float,1>::from(tmp67).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp93 = at::vec::convert<float>(tmp92);
                                auto tmp94 = decltype(tmp91)::blendv(tmp93, tmp91, tmp74.template cast<float,1>());
                                return tmp94;
                            }
                            ;
                            auto tmp95 = tmp67 ? tmp68() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp97 = at::vec::convert<float>(tmp96);
                            auto tmp98 = at::vec::VecMask<float,1>::from(tmp67);
                            auto tmp99 = decltype(tmp95)::blendv(tmp97, tmp95, tmp98.template cast<float,1>());
                            auto tmp100 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp101 = decltype(tmp65)::blendv(tmp99, tmp65, tmp100.template cast<float,1>());
                            auto tmp102 = c10::convert<int64_t>(tmp0);
                            auto tmp103 = tmp102 >= tmp6;
                            auto tmp104 = [&]
                            {
                                auto tmp105 = x3;
                                auto tmp106 = c10::convert<int64_t>(tmp105);
                                auto tmp107 = at::vec::VectorizedN<int64_t,2>::arange(tmp106, 1);
                                auto tmp108 = static_cast<int64_t>(256);
                                auto tmp109 = at::vec::VectorizedN<int64_t,2>(tmp108);
                                auto tmp110 = at::vec::VecMask<int64_t,2>(tmp107 < tmp109);
                                auto tmp112 = at::vec::VecMask<float,1>::from(tmp103);
                                auto tmp113 = tmp110 & tmp112;
                                auto tmp111 = [&]
                                {
                                    auto tmp114 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp113.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp115 = static_cast<int64_t>(512);
                                    auto tmp116 = at::vec::VectorizedN<int64_t,2>(tmp115);
                                    auto tmp117 = at::vec::VecMask<int64_t,2>(tmp114 < tmp116);
                                    auto tmp119 = tmp117 & tmp113;
                                    auto tmp118 = [&]
                                    {
                                        auto tmp120 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp119.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp121 = at::vec::convert<float>(tmp120);
                                        return tmp121;
                                    }
                                    ;
                                    auto tmp124 =
                                    [&]
                                    {
                                        if (tmp119.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp122 = tmp118();
                                            auto tmp123 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp122)::blendv(tmp123, tmp122, tmp119.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp124;
                                }
                                ;
                                auto tmp127 =
                                [&]
                                {
                                    if (tmp113.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp125 = tmp111();
                                        auto tmp126 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp125)::blendv(tmp126, tmp125, tmp113.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp128 = at::vec::VecMask<float,1>::from(tmp103).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp129 = at::vec::convert<float>(tmp128);
                                auto tmp130 = decltype(tmp127)::blendv(tmp129, tmp127, tmp110.template cast<float,1>());
                                return tmp130;
                            }
                            ;
                            auto tmp131 = tmp103 ? tmp104() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp133 = at::vec::convert<float>(tmp132);
                            auto tmp134 = at::vec::VecMask<float,1>::from(tmp103);
                            auto tmp135 = decltype(tmp131)::blendv(tmp133, tmp131, tmp134.template cast<float,1>());
                            auto tmp136 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp137 = decltype(tmp101)::blendv(tmp135, tmp101, tmp136.template cast<float,1>());
                            auto tmp138 = at::vec::convert<bfloat16>(tmp137);
                            tmp138.store(out_ptr1 + static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp68 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                            auto tmp93 = out_ptr0[static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0))];
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = tmp10 >= tmp6;
                                auto tmp12 = static_cast<int64_t>(256);
                                auto tmp13 = tmp10 < tmp12;
                                auto tmp14 = tmp11 & tmp13;
                                auto tmp15 = [&]
                                {
                                    auto tmp16 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp17 = c10::convert<int64_t>(tmp16);
                                    auto tmp18 = static_cast<int64_t>(512);
                                    auto tmp19 = tmp17 < tmp18;
                                    auto tmp20 = [&]
                                    {
                                        auto tmp21 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                        auto tmp22 = c10::convert<float>(tmp21);
                                        return tmp22;
                                    }
                                    ;
                                    auto tmp23 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                                    return tmp23;
                                }
                                ;
                                auto tmp24 = tmp14 ? tmp15() : static_cast<decltype(tmp15())>(0.0);
                                auto tmp25 = static_cast<int64_t>(0);
                                auto tmp26 = tmp25 >= tmp6;
                                auto tmp27 = [&]
                                {
                                    auto tmp28 = [&]
                                    {
                                        auto tmp29 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                        auto tmp30 = c10::convert<int64_t>(tmp29);
                                        auto tmp31 = static_cast<int64_t>(512);
                                        auto tmp32 = tmp30 < tmp31;
                                        auto tmp33 = [&]
                                        {
                                            auto tmp34 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                            auto tmp35 = c10::convert<float>(tmp34);
                                            return tmp35;
                                        }
                                        ;
                                        auto tmp36 = tmp32 ? tmp33() : static_cast<decltype(tmp33())>(0.0);
                                        return tmp36;
                                    }
                                    ;
                                    auto tmp37 = tmp13 ? tmp28() : static_cast<decltype(tmp28())>(0.0);
                                    auto tmp38 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                    auto tmp39 = c10::convert<float>(tmp38);
                                    auto tmp40 = tmp13 ? tmp37 : tmp39;
                                    return tmp40;
                                }
                                ;
                                auto tmp41 = tmp26 ? tmp27() : static_cast<decltype(tmp27())>(0.0);
                                auto tmp42 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp43 = c10::convert<float>(tmp42);
                                auto tmp44 = tmp26 ? tmp41 : tmp43;
                                auto tmp45 = tmp14 ? tmp24 : tmp44;
                                return tmp45;
                            }
                            ;
                            auto tmp46 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp47 = static_cast<int64_t>(0);
                            auto tmp48 = tmp47 >= tmp6;
                            auto tmp49 = [&]
                            {
                                auto tmp50 = x3;
                                auto tmp51 = c10::convert<int64_t>(tmp50);
                                auto tmp52 = static_cast<int64_t>(256);
                                auto tmp53 = tmp51 < tmp52;
                                auto tmp54 = [&]
                                {
                                    auto tmp55 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp56 = c10::convert<int64_t>(tmp55);
                                    auto tmp57 = static_cast<int64_t>(512);
                                    auto tmp58 = tmp56 < tmp57;
                                    auto tmp59 = [&]
                                    {
                                        auto tmp60 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp61 = c10::convert<float>(tmp60);
                                        return tmp61;
                                    }
                                    ;
                                    auto tmp62 = tmp58 ? tmp59() : static_cast<decltype(tmp59())>(0.0);
                                    return tmp62;
                                }
                                ;
                                auto tmp63 = tmp53 ? tmp54() : static_cast<decltype(tmp54())>(0.0);
                                auto tmp64 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp65 = c10::convert<float>(tmp64);
                                auto tmp66 = tmp53 ? tmp63 : tmp65;
                                return tmp66;
                            }
                            ;
                            auto tmp67 = tmp48 ? tmp49() : static_cast<decltype(tmp49())>(0.0);
                            auto tmp69 = c10::convert<float>(tmp68);
                            auto tmp70 = tmp48 ? tmp67 : tmp69;
                            auto tmp71 = tmp7 ? tmp46 : tmp70;
                            auto tmp72 = c10::convert<int64_t>(tmp0);
                            auto tmp73 = tmp72 >= tmp6;
                            auto tmp74 = [&]
                            {
                                auto tmp75 = x3;
                                auto tmp76 = c10::convert<int64_t>(tmp75);
                                auto tmp77 = static_cast<int64_t>(256);
                                auto tmp78 = tmp76 < tmp77;
                                auto tmp79 = [&]
                                {
                                    auto tmp80 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp81 = c10::convert<int64_t>(tmp80);
                                    auto tmp82 = static_cast<int64_t>(512);
                                    auto tmp83 = tmp81 < tmp82;
                                    auto tmp84 = [&]
                                    {
                                        auto tmp85 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp86 = c10::convert<float>(tmp85);
                                        return tmp86;
                                    }
                                    ;
                                    auto tmp87 = tmp83 ? tmp84() : static_cast<decltype(tmp84())>(0.0);
                                    return tmp87;
                                }
                                ;
                                auto tmp88 = tmp78 ? tmp79() : static_cast<decltype(tmp79())>(0.0);
                                auto tmp89 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp90 = c10::convert<float>(tmp89);
                                auto tmp91 = tmp78 ? tmp88 : tmp90;
                                return tmp91;
                            }
                            ;
                            auto tmp92 = tmp73 ? tmp74() : static_cast<decltype(tmp74())>(0.0);
                            auto tmp94 = c10::convert<float>(tmp93);
                            auto tmp95 = tmp73 ? tmp92 : tmp94;
                            auto tmp96 = tmp3 ? tmp71 : tmp95;
                            auto tmp97 = c10::convert<bfloat16>(tmp96);
                            out_ptr1[static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0))] = tmp97;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp93 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)), 16);
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(256);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 >= tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp8 = c10::convert<int64_t>(tmp7);
                            auto tmp9 = at::vec::VectorizedN<int64_t,2>::arange(tmp8, -1);
                            auto tmp10 = static_cast<int64_t>(0);
                            auto tmp11 = at::vec::VectorizedN<int64_t,2>(tmp10);
                            auto tmp12 = at::vec::VecMask<int64_t,2>(tmp9 <= tmp11);
                            auto tmp13 = static_cast<float>(1.0);
                            auto tmp14 = static_cast<float>(0.0);
                            auto tmp15 = at::vec::Vectorized<float>(tmp13);
                            auto tmp16 = at::vec::Vectorized<float>(tmp14);
                            auto tmp17 = decltype(tmp15)::blendv(tmp16, tmp15, tmp12.template cast<float,1>());
                            auto tmp18 = at::vec::VecMask<float,1>::from<float,1>(tmp17);
                            auto tmp19 = 256L + x1;
                            auto tmp20 = c10::convert<int64_t>(tmp19);
                            auto tmp21 = tmp20 < tmp3;
                            auto tmp23 = at::vec::VecMask<float,1>::from(tmp21);
                            auto tmp24 = tmp23 & tmp5;
                            auto tmp22 = [&]
                            {
                                auto tmp25 = static_cast<int64_t>(257);
                                auto tmp26 = at::vec::VectorizedN<int64_t,2>(tmp25);
                                auto tmp27 = at::vec::VecMask<int64_t,2>(tmp2 < tmp26);
                                auto tmp29 = tmp27 & tmp24;
                                auto tmp28 = [&]
                                {
                                    auto tmp30 = 1L + x1 + x2;
                                    auto tmp31 = c10::convert<int64_t>(tmp30);
                                    auto tmp32 = at::vec::VectorizedN<int64_t,2>::arange(tmp31, 1);
                                    auto tmp33 = at::vec::VecMask<int64_t,2>(tmp32 <= tmp11);
                                    auto tmp34 = decltype(tmp15)::blendv(tmp16, tmp15, tmp33.template cast<float,1>());
                                    auto tmp35 = at::vec::VecMask<float,1>::from<float,1>(tmp34);
                                    auto tmp36 = tmp29.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                    auto tmp37 = at::vec::convert<float>(tmp36);
                                    auto tmp38 = -std::numeric_limits<float>::infinity();
                                    auto tmp39 = at::vec::Vectorized<float>(tmp38);
                                    auto tmp40 = decltype(tmp39)::blendv(tmp37, tmp39, tmp35.template cast<float,1>());
                                    return tmp40;
                                }
                                ;
                                auto tmp43 =
                                [&]
                                {
                                    if (tmp29.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp41 = tmp28();
                                        auto tmp42 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp41)::blendv(tmp42, tmp41, tmp29.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp44 = tmp24.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp45 = at::vec::convert<float>(tmp44);
                                auto tmp46 = decltype(tmp43)::blendv(tmp45, tmp43, tmp27.template cast<float,1>());
                                return tmp46;
                            }
                            ;
                            auto tmp49 =
                            [&]
                            {
                                if (tmp24.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp47 = tmp22();
                                    auto tmp48 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp47)::blendv(tmp48, tmp47, tmp24.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp50 = tmp5.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp51 = at::vec::convert<float>(tmp50);
                            auto tmp52 = decltype(tmp49)::blendv(tmp51, tmp49, tmp23.template cast<float,1>());
                            auto tmp53 = -std::numeric_limits<float>::infinity();
                            auto tmp54 = at::vec::Vectorized<float>(tmp53);
                            auto tmp55 = decltype(tmp54)::blendv(tmp52, tmp54, tmp18.template cast<float,1>());
                            return tmp55;
                        }
                        ;
                        auto tmp58 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp56 = tmp6();
                                auto tmp57 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp56)::blendv(tmp57, tmp56, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp59 = 256L + x1;
                        auto tmp60 = c10::convert<int64_t>(tmp59);
                        auto tmp61 = tmp60 < tmp3;
                        auto tmp62 = [&]
                        {
                            auto tmp63 = static_cast<int64_t>(257);
                            auto tmp64 = at::vec::VectorizedN<int64_t,2>(tmp63);
                            auto tmp65 = at::vec::VecMask<int64_t,2>(tmp2 < tmp64);
                            auto tmp67 = at::vec::VecMask<float,1>::from(tmp61);
                            auto tmp68 = tmp65 & tmp67;
                            auto tmp66 = [&]
                            {
                                auto tmp69 = 1L + x1 + x2;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(0);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 <= tmp73);
                                auto tmp75 = static_cast<float>(1.0);
                                auto tmp76 = static_cast<float>(0.0);
                                auto tmp77 = at::vec::Vectorized<float>(tmp75);
                                auto tmp78 = at::vec::Vectorized<float>(tmp76);
                                auto tmp79 = decltype(tmp77)::blendv(tmp78, tmp77, tmp74.template cast<float,1>());
                                auto tmp80 = at::vec::VecMask<float,1>::from<float,1>(tmp79);
                                auto tmp81 = tmp68.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp82 = at::vec::convert<float>(tmp81);
                                auto tmp83 = -std::numeric_limits<float>::infinity();
                                auto tmp84 = at::vec::Vectorized<float>(tmp83);
                                auto tmp85 = decltype(tmp84)::blendv(tmp82, tmp84, tmp80.template cast<float,1>());
                                return tmp85;
                            }
                            ;
                            auto tmp88 =
                            [&]
                            {
                                if (tmp68.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp86 = tmp66();
                                    auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp86)::blendv(tmp87, tmp86, tmp68.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp89 = at::vec::VecMask<float,1>::from(tmp61).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp90 = at::vec::convert<float>(tmp89);
                            auto tmp91 = decltype(tmp88)::blendv(tmp90, tmp88, tmp65.template cast<float,1>());
                            return tmp91;
                        }
                        ;
                        auto tmp92 = tmp61 ? tmp62() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp94 = at::vec::convert<float>(tmp93);
                        auto tmp95 = at::vec::VecMask<float,1>::from(tmp61);
                        auto tmp96 = decltype(tmp92)::blendv(tmp94, tmp92, tmp95.template cast<float,1>());
                        auto tmp97 = decltype(tmp58)::blendv(tmp96, tmp58, tmp5.template cast<float,1>());
                        auto tmp98 = at::vec::convert<bfloat16>(tmp97);
                        tmp98.store(out_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp64 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp6 = c10::convert<int64_t>(tmp5);
                            auto tmp7 = static_cast<int64_t>(0);
                            auto tmp8 = tmp6 <= tmp7;
                            auto tmp9 = static_cast<float>(1.0);
                            auto tmp10 = static_cast<float>(0.0);
                            auto tmp11 = tmp8 ? tmp9 : tmp10;
                            auto tmp12 = c10::convert<bool>(tmp11);
                            auto tmp13 = 256L + x1;
                            auto tmp14 = c10::convert<int64_t>(tmp13);
                            auto tmp15 = tmp14 < tmp2;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = static_cast<int64_t>(257);
                                auto tmp18 = tmp1 < tmp17;
                                auto tmp19 = [&]
                                {
                                    auto tmp20 = 1L + x1 + x2;
                                    auto tmp21 = c10::convert<int64_t>(tmp20);
                                    auto tmp22 = tmp21 <= tmp7;
                                    auto tmp23 = tmp22 ? tmp9 : tmp10;
                                    auto tmp24 = c10::convert<bool>(tmp23);
                                    auto tmp25 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                    auto tmp26 = c10::convert<float>(tmp25);
                                    auto tmp27 = -std::numeric_limits<float>::infinity();
                                    auto tmp28 = tmp24 ? tmp27 : tmp26;
                                    return tmp28;
                                }
                                ;
                                auto tmp29 = tmp18 ? tmp19() : static_cast<decltype(tmp19())>(0.0);
                                auto tmp30 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp31 = c10::convert<float>(tmp30);
                                auto tmp32 = tmp18 ? tmp29 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp34 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp35 = c10::convert<float>(tmp34);
                            auto tmp36 = tmp15 ? tmp33 : tmp35;
                            auto tmp37 = -std::numeric_limits<float>::infinity();
                            auto tmp38 = tmp12 ? tmp37 : tmp36;
                            return tmp38;
                        }
                        ;
                        auto tmp39 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp40 = 256L + x1;
                        auto tmp41 = c10::convert<int64_t>(tmp40);
                        auto tmp42 = tmp41 < tmp2;
                        auto tmp43 = [&]
                        {
                            auto tmp44 = static_cast<int64_t>(257);
                            auto tmp45 = tmp1 < tmp44;
                            auto tmp46 = [&]
                            {
                                auto tmp47 = 1L + x1 + x2;
                                auto tmp48 = c10::convert<int64_t>(tmp47);
                                auto tmp49 = static_cast<int64_t>(0);
                                auto tmp50 = tmp48 <= tmp49;
                                auto tmp51 = static_cast<float>(1.0);
                                auto tmp52 = static_cast<float>(0.0);
                                auto tmp53 = tmp50 ? tmp51 : tmp52;
                                auto tmp54 = c10::convert<bool>(tmp53);
                                auto tmp55 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp56 = c10::convert<float>(tmp55);
                                auto tmp57 = -std::numeric_limits<float>::infinity();
                                auto tmp58 = tmp54 ? tmp57 : tmp56;
                                return tmp58;
                            }
                            ;
                            auto tmp59 = tmp45 ? tmp46() : static_cast<decltype(tmp46())>(0.0);
                            auto tmp60 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp61 = c10::convert<float>(tmp60);
                            auto tmp62 = tmp45 ? tmp59 : tmp61;
                            return tmp62;
                        }
                        ;
                        auto tmp63 = tmp42 ? tmp43() : static_cast<decltype(tmp43())>(0.0);
                        auto tmp65 = c10::convert<float>(tmp64);
                        auto tmp66 = tmp42 ? tmp63 : tmp65;
                        auto tmp67 = tmp3 ? tmp39 : tmp66;
                        auto tmp68 = c10::convert<bfloat16>(tmp67);
                        out_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0))] = tmp68;
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp45 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)), 16);
                        auto tmp83 = at::vec::Vectorized<bfloat16>::loadu(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)), 16);
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr2 + static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0)));
                            auto tmp6 = at::vec::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = at::vec::VectorizedN<int64_t,2>::arange(tmp13, 1);
                            auto tmp15 = static_cast<int64_t>(257);
                            auto tmp16 = at::vec::VectorizedN<int64_t,2>(tmp15);
                            auto tmp17 = at::vec::VecMask<int64_t,2>(tmp14 < tmp16);
                            auto tmp19 = at::vec::VecMask<float,1>::from(tmp10);
                            auto tmp20 = tmp17 & tmp19;
                            auto tmp18 = [&]
                            {
                                auto tmp21 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp22 = c10::convert<int64_t>(tmp21);
                                auto tmp23 = at::vec::VectorizedN<int64_t,2>::arange(tmp22, 1);
                                auto tmp24 = static_cast<int64_t>(0);
                                auto tmp25 = at::vec::VectorizedN<int64_t,2>(tmp24);
                                auto tmp26 = at::vec::VecMask<int64_t,2>(tmp23 <= tmp25);
                                auto tmp27 = static_cast<float>(1.0);
                                auto tmp28 = static_cast<float>(0.0);
                                auto tmp29 = at::vec::Vectorized<float>(tmp27);
                                auto tmp30 = at::vec::Vectorized<float>(tmp28);
                                auto tmp31 = decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                auto tmp32 = at::vec::VecMask<float,1>::from<float,1>(tmp31);
                                auto tmp33 = tmp20.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                                auto tmp34 = at::vec::convert<float>(tmp33);
                                auto tmp35 = -std::numeric_limits<float>::infinity();
                                auto tmp36 = at::vec::Vectorized<float>(tmp35);
                                auto tmp37 = decltype(tmp36)::blendv(tmp34, tmp36, tmp32.template cast<float,1>());
                                return tmp37;
                            }
                            ;
                            auto tmp40 =
                            [&]
                            {
                                if (tmp20.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp38 = tmp18();
                                    auto tmp39 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp38)::blendv(tmp39, tmp38, tmp20.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp41 = at::vec::VecMask<float,1>::from(tmp10).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                            auto tmp42 = at::vec::convert<float>(tmp41);
                            auto tmp43 = decltype(tmp40)::blendv(tmp42, tmp40, tmp17.template cast<float,1>());
                            return tmp43;
                        }
                        ;
                        auto tmp44 = tmp10 ? tmp11() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp46 = at::vec::convert<float>(tmp45);
                        auto tmp47 = at::vec::VecMask<float,1>::from(tmp10);
                        auto tmp48 = decltype(tmp44)::blendv(tmp46, tmp44, tmp47.template cast<float,1>());
                        auto tmp49 = at::vec::VecMask<float,1>::from(tmp3);
                        auto tmp50 = decltype(tmp7)::blendv(tmp48, tmp7, tmp49.template cast<float,1>());
                        auto tmp51 = [&]
                        {
                            auto tmp52 = x2;
                            auto tmp53 = c10::convert<int64_t>(tmp52);
                            auto tmp54 = at::vec::VectorizedN<int64_t,2>::arange(tmp53, 1);
                            auto tmp55 = at::vec::VectorizedN<int64_t,2>(tmp2);
                            auto tmp56 = at::vec::VecMask<int64_t,2>(tmp54 >= tmp55);
                            auto tmp58 = tmp56 & tmp49;
                            auto tmp57 = [&]
                            {
                                auto tmp59 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp60 = c10::convert<int64_t>(tmp59);
                                auto tmp61 = at::vec::VectorizedN<int64_t,2>::arange(tmp60, -1);
                                auto tmp62 = static_cast<int64_t>(0);
                                auto tmp63 = at::vec::VectorizedN<int64_t,2>(tmp62);
                                auto tmp64 = at::vec::VecMask<int64_t,2>(tmp61 <= tmp63);
                                auto tmp65 = static_cast<float>(1.0);
                                auto tmp66 = static_cast<float>(0.0);
                                auto tmp67 = at::vec::Vectorized<float>(tmp65);
                                auto tmp68 = at::vec::Vectorized<float>(tmp66);
                                auto tmp69 = decltype(tmp67)::blendv(tmp68, tmp67, tmp64.template cast<float,1>());
                                auto tmp70 = at::vec::VecMask<float,1>::from<float,1>(tmp69);
                                auto tmp71 = tmp58.template cast<float,1>().template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                                auto tmp72 = at::vec::convert<float>(tmp71);
                                auto tmp73 = -std::numeric_limits<float>::infinity();
                                auto tmp74 = at::vec::Vectorized<float>(tmp73);
                                auto tmp75 = decltype(tmp74)::blendv(tmp72, tmp74, tmp70.template cast<float,1>());
                                return tmp75;
                            }
                            ;
                            auto tmp78 =
                            [&]
                            {
                                if (tmp58.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp76 = tmp57();
                                    auto tmp77 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp76)::blendv(tmp77, tmp76, tmp58.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp79 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                            auto tmp80 = at::vec::convert<float>(tmp79);
                            auto tmp81 = decltype(tmp78)::blendv(tmp80, tmp78, tmp56.template cast<float,1>());
                            return tmp81;
                        }
                        ;
                        auto tmp82 = tmp3 ? tmp51() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp84 = at::vec::convert<float>(tmp83);
                        auto tmp85 = decltype(tmp82)::blendv(tmp84, tmp82, tmp49.template cast<float,1>());
                        auto tmp86 = tmp50 + tmp85;
                        auto tmp87 = at::vec::convert<bfloat16>(tmp86);
                        tmp87.store(out_ptr3 + static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp34 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                        auto tmp60 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = out_ptr2[static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0))];
                            auto tmp6 = c10::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = static_cast<int64_t>(257);
                            auto tmp15 = tmp13 < tmp14;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp18 = c10::convert<int64_t>(tmp17);
                                auto tmp19 = static_cast<int64_t>(0);
                                auto tmp20 = tmp18 <= tmp19;
                                auto tmp21 = static_cast<float>(1.0);
                                auto tmp22 = static_cast<float>(0.0);
                                auto tmp23 = tmp20 ? tmp21 : tmp22;
                                auto tmp24 = c10::convert<bool>(tmp23);
                                auto tmp25 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                                auto tmp26 = c10::convert<float>(tmp25);
                                auto tmp27 = -std::numeric_limits<float>::infinity();
                                auto tmp28 = tmp24 ? tmp27 : tmp26;
                                return tmp28;
                            }
                            ;
                            auto tmp29 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp30 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                            auto tmp31 = c10::convert<float>(tmp30);
                            auto tmp32 = tmp15 ? tmp29 : tmp31;
                            return tmp32;
                        }
                        ;
                        auto tmp33 = tmp10 ? tmp11() : static_cast<decltype(tmp11())>(0.0);
                        auto tmp35 = c10::convert<float>(tmp34);
                        auto tmp36 = tmp10 ? tmp33 : tmp35;
                        auto tmp37 = tmp3 ? tmp7 : tmp36;
                        auto tmp38 = [&]
                        {
                            auto tmp39 = x2;
                            auto tmp40 = c10::convert<int64_t>(tmp39);
                            auto tmp41 = tmp40 >= tmp2;
                            auto tmp42 = [&]
                            {
                                auto tmp43 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp44 = c10::convert<int64_t>(tmp43);
                                auto tmp45 = static_cast<int64_t>(0);
                                auto tmp46 = tmp44 <= tmp45;
                                auto tmp47 = static_cast<float>(1.0);
                                auto tmp48 = static_cast<float>(0.0);
                                auto tmp49 = tmp46 ? tmp47 : tmp48;
                                auto tmp50 = c10::convert<bool>(tmp49);
                                auto tmp51 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                                auto tmp52 = c10::convert<float>(tmp51);
                                auto tmp53 = -std::numeric_limits<float>::infinity();
                                auto tmp54 = tmp50 ? tmp53 : tmp52;
                                return tmp54;
                            }
                            ;
                            auto tmp55 = tmp41 ? tmp42() : static_cast<decltype(tmp42())>(0.0);
                            auto tmp56 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                            auto tmp57 = c10::convert<float>(tmp56);
                            auto tmp58 = tmp41 ? tmp55 : tmp57;
                            return tmp58;
                        }
                        ;
                        auto tmp59 = tmp3 ? tmp38() : static_cast<decltype(tmp38())>(0.0);
                        auto tmp61 = c10::convert<float>(tmp60);
                        auto tmp62 = tmp3 ? tmp59 : tmp61;
                        auto tmp63 = decltype(tmp37)(tmp37 + tmp62);
                        auto tmp64 = c10::convert<bfloat16>(tmp63);
                        out_ptr3[static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1))] = tmp64;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(6144L); x0+=static_cast<int64_t>(1L))
            {
                {
                    float tmp_acc0 = -std::numeric_limits<float>::infinity();
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(-std::numeric_limits<float>::infinity());
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        tmp_acc0_vec = at::vec::maximum(tmp_acc0_vec, tmp1);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp1 = c10::convert<float>(tmp0);
                        tmp_acc0 = max_propagate_nan(tmp_acc0, tmp1);
                    }
                    tmp_acc0 = max_propagate_nan(tmp_acc0, at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return at::vec::maximum(x, y); }, tmp_acc0_vec));
                    out_ptr4[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
                {
                    float tmp_acc0 = 0;
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(0);
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = at::vec::Vectorized<float>(tmp2);
                        auto tmp4 = tmp1 - tmp3;
                        auto tmp5 = tmp4.exp();
                        tmp5.store(out_ptr5 + static_cast<int64_t>(x1 + (513L*x0)));
                        tmp_acc0_vec = tmp_acc0_vec + tmp5;
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = c10::convert<float>(tmp0);
                        auto tmp3 = decltype(tmp1)(tmp1 - tmp2);
                        auto tmp4 = std::exp(tmp3);
                        out_ptr5[static_cast<int64_t>(x1 + (513L*x0))] = tmp4;
                        tmp_acc0 = tmp_acc0 + tmp4;
                    }
                    tmp_acc0 = tmp_acc0 + at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return x + y; }, tmp_acc0_vec);
                    out_ptr6[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
            }
        }
    }
}
''')


cpp_fused_clone_constant_pad_nd_39 = async_compile.cpp_pybinding(['const bfloat16*', 'const bool*', 'const float*', 'const float*', 'bfloat16*', 'bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bool* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(1024L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = (-256L) + x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(0);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = static_cast<int64_t>(512);
                        auto tmp5 = tmp1 < tmp4;
                        auto tmp6 = tmp3 & tmp5;
                        auto tmp7 = [&]
                        {
                            auto tmp8 = at::vec::VecMask<float,1>::from(tmp6).template loadu<bfloat16,1>(in_ptr0 + static_cast<int64_t>((-196608L) + x2 + (64L*x0) + (768L*x1)));
                            auto tmp9 = at::vec::convert<float>(tmp8);
                            return tmp9;
                        }
                        ;
                        auto tmp10 = tmp6 ? tmp7() : at::vec::Vectorized<float>(static_cast<float>(-1.0));
                        auto tmp11 = at::vec::convert<bfloat16>(tmp10);
                        tmp11.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (65536L*x0)), 16);
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(768L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(513);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 < tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp8 = tmp5.template cast<float,1>().template loadu<float,1>(in_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0)));
                            auto tmp9 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp10 = at::vec::Vectorized<float>(tmp9);
                            auto tmp11 = tmp8 / tmp10;
                            auto tmp12 = static_cast<float>(0.0);
                            auto tmp13 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp14 = at::vec::Vectorized<float>(tmp12);
                            auto tmp15 = decltype(tmp14)::blendv(tmp11, tmp14, tmp13.template cast<float,1>());
                            auto tmp16 = (tmp15);
                            return tmp16;
                        }
                        ;
                        auto tmp19 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp17 = tmp6();
                                auto tmp18 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp17)::blendv(tmp18, tmp17, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp20 = at::vec::convert<bfloat16>(tmp19);
                        tmp20.store(out_ptr1 + static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(768L); x2<static_cast<int64_t>(770L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(513);
                        auto tmp3 = tmp1 < tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp6 = in_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0))];
                            auto tmp7 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp8 = tmp6 / tmp7;
                            auto tmp9 = static_cast<float>(0.0);
                            auto tmp10 = tmp5 ? tmp9 : tmp8;
                            auto tmp11 = c10::convert<float>(tmp10);
                            return tmp11;
                        }
                        ;
                        auto tmp12 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp13 = c10::convert<bfloat16>(tmp12);
                        out_ptr1[static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1))] = tmp13;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(49152L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x2 + (16384L*x1) + (65536L*x0)), 32);
                        tmp0.store(out_ptr2 + static_cast<int64_t>(x2 + (49152L*x1) + (98304L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused_clone_40 = async_compile.cpp_pybinding(['const bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       bfloat16* out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x2 + (64L*x0) + (32768L*x1)), 32);
                        tmp0.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (768L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_41 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    auto tmp19 = at::vec::convert<bfloat16>(tmp18);
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                    tmp19.store(out_ptr3 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_42 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<float>::loadu(out_ptr2 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<bfloat16>(tmp0);
                tmp1.store(out_ptr3 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_43 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<float>(tmp0);
                auto tmp2 = static_cast<float>(0.125);
                auto tmp3 = at::vec::Vectorized<float>(tmp2);
                auto tmp4 = tmp1 * tmp3;
                auto tmp5 = at::vec::convert<bfloat16>(tmp4);
                tmp5.store(in_out_ptr0 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_44 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(32L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 32);
                tmp0.store(in_out_ptr0 + static_cast<int64_t>(x0), 32);
            }
        }
    }
}
''')


cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_45 = async_compile.cpp_pybinding(['const bfloat16*', 'const bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'float*', 'float*', 'float*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bfloat16* in_ptr1,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2,
                       bfloat16* out_ptr3,
                       float* out_ptr4,
                       float* out_ptr5,
                       float* out_ptr6)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(2L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = at::vec::VectorizedN<int64_t,2>::arange(tmp5, 1);
                            auto tmp7 = static_cast<int64_t>(256);
                            auto tmp8 = at::vec::VectorizedN<int64_t,2>(tmp7);
                            auto tmp9 = at::vec::VecMask<int64_t,2>(tmp6 >= tmp8);
                            auto tmp10 = [&]
                            {
                                auto tmp11 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                    {
                                        if (tmp9.is_masked(x3_inner))
                                        {
                                            tmpbuf[x3_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp12 = static_cast<int64_t>(512);
                                auto tmp13 = at::vec::VectorizedN<int64_t,2>(tmp12);
                                auto tmp14 = at::vec::VecMask<int64_t,2>(tmp11 < tmp13);
                                auto tmp16 = tmp14 & tmp9;
                                auto tmp15 = [&]
                                {
                                    auto tmp17 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp16.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>(131072L + x3 + x3_inner + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp18 = at::vec::convert<float>(tmp17);
                                    return tmp18;
                                }
                                ;
                                auto tmp21 =
                                [&]
                                {
                                    if (tmp16.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp19 = tmp15();
                                        auto tmp20 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp19)::blendv(tmp20, tmp19, tmp16.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp21;
                            }
                            ;
                            auto tmp24 =
                            [&]
                            {
                                if (tmp9.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp22 = tmp10();
                                    auto tmp23 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp22)::blendv(tmp23, tmp22, tmp9.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp25 = static_cast<int64_t>(1);
                            auto tmp26 = tmp25 < tmp25;
                            auto tmp27 = [&]
                            {
                                auto tmp29 = at::vec::VecMask<float,1>::from(tmp26);
                                auto tmp30 = tmp9 & tmp29;
                                auto tmp28 = [&]
                                {
                                    auto tmp31 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp30.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp32 = static_cast<int64_t>(512);
                                    auto tmp33 = at::vec::VectorizedN<int64_t,2>(tmp32);
                                    auto tmp34 = at::vec::VecMask<int64_t,2>(tmp31 < tmp33);
                                    auto tmp36 = tmp34 & tmp30;
                                    auto tmp35 = [&]
                                    {
                                        auto tmp37 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp36.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp38 = at::vec::convert<float>(tmp37);
                                        return tmp38;
                                    }
                                    ;
                                    auto tmp41 =
                                    [&]
                                    {
                                        if (tmp36.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp39 = tmp35();
                                            auto tmp40 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp39)::blendv(tmp40, tmp39, tmp36.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp41;
                                }
                                ;
                                auto tmp44 =
                                [&]
                                {
                                    if (tmp30.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp42 = tmp28();
                                        auto tmp43 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp42)::blendv(tmp43, tmp42, tmp30.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp45 = static_cast<float>(0.0);
                                auto tmp46 = at::vec::Vectorized<float>(tmp45);
                                auto tmp47 = decltype(tmp44)::blendv(tmp46, tmp44, tmp9.template cast<float,1>());
                                return tmp47;
                            }
                            ;
                            auto tmp48 = tmp26 ? tmp27() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp49 = static_cast<float>(0.0);
                            auto tmp50 = at::vec::VecMask<float,1>::from(tmp26);
                            auto tmp51 = at::vec::Vectorized<float>(tmp49);
                            auto tmp52 = decltype(tmp48)::blendv(tmp51, tmp48, tmp50.template cast<float,1>());
                            auto tmp53 = decltype(tmp24)::blendv(tmp52, tmp24, tmp9.template cast<float,1>());
                            auto tmp54 = c10::convert<int64_t>(tmp0);
                            auto tmp55 = tmp54 < tmp25;
                            auto tmp56 = [&]
                            {
                                auto tmp58 = at::vec::VecMask<float,1>::from(tmp55);
                                auto tmp59 = tmp9 & tmp58;
                                auto tmp57 = [&]
                                {
                                    auto tmp60 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp59.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp61 = static_cast<int64_t>(512);
                                    auto tmp62 = at::vec::VectorizedN<int64_t,2>(tmp61);
                                    auto tmp63 = at::vec::VecMask<int64_t,2>(tmp60 < tmp62);
                                    auto tmp65 = tmp63 & tmp59;
                                    auto tmp64 = [&]
                                    {
                                        auto tmp66 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp65.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp67 = at::vec::convert<float>(tmp66);
                                        return tmp67;
                                    }
                                    ;
                                    auto tmp70 =
                                    [&]
                                    {
                                        if (tmp65.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp68 = tmp64();
                                            auto tmp69 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp68)::blendv(tmp69, tmp68, tmp65.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp70;
                                }
                                ;
                                auto tmp73 =
                                [&]
                                {
                                    if (tmp59.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp71 = tmp57();
                                        auto tmp72 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp71)::blendv(tmp72, tmp71, tmp59.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp74 = decltype(tmp73)::blendv(tmp51, tmp73, tmp9.template cast<float,1>());
                                return tmp74;
                            }
                            ;
                            auto tmp75 = tmp55 ? tmp56() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp76 = at::vec::VecMask<float,1>::from(tmp55);
                            auto tmp77 = decltype(tmp75)::blendv(tmp51, tmp75, tmp76.template cast<float,1>());
                            auto tmp78 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp79 = decltype(tmp53)::blendv(tmp77, tmp53, tmp78.template cast<float,1>());
                            auto tmp80 = at::vec::convert<bfloat16>(tmp79);
                            tmp80.store(out_ptr0 + static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(256);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + (513L*x1))), static_cast<int64_t>(512L)));
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = static_cast<int64_t>(512);
                                auto tmp12 = tmp10 < tmp11;
                                auto tmp13 = [&]
                                {
                                    auto tmp14 = in_ptr0[static_cast<int64_t>(131072L + x3 + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                    auto tmp15 = c10::convert<float>(tmp14);
                                    return tmp15;
                                }
                                ;
                                auto tmp16 = tmp12 ? tmp13() : static_cast<decltype(tmp13())>(0.0);
                                return tmp16;
                            }
                            ;
                            auto tmp17 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp18 = static_cast<int64_t>(1);
                            auto tmp19 = tmp18 < tmp18;
                            auto tmp20 = [&]
                            {
                                auto tmp21 = [&]
                                {
                                    auto tmp22 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp23 = c10::convert<int64_t>(tmp22);
                                    auto tmp24 = static_cast<int64_t>(512);
                                    auto tmp25 = tmp23 < tmp24;
                                    auto tmp26 = [&]
                                    {
                                        auto tmp27 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                        auto tmp28 = c10::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp29 = tmp25 ? tmp26() : static_cast<decltype(tmp26())>(0.0);
                                    return tmp29;
                                }
                                ;
                                auto tmp30 = tmp7 ? tmp21() : static_cast<decltype(tmp21())>(0.0);
                                auto tmp31 = static_cast<float>(0.0);
                                auto tmp32 = tmp7 ? tmp30 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                            auto tmp34 = static_cast<float>(0.0);
                            auto tmp35 = tmp19 ? tmp33 : tmp34;
                            auto tmp36 = tmp7 ? tmp17 : tmp35;
                            auto tmp37 = c10::convert<int64_t>(tmp0);
                            auto tmp38 = tmp37 < tmp18;
                            auto tmp39 = [&]
                            {
                                auto tmp40 = [&]
                                {
                                    auto tmp41 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp42 = c10::convert<int64_t>(tmp41);
                                    auto tmp43 = static_cast<int64_t>(512);
                                    auto tmp44 = tmp42 < tmp43;
                                    auto tmp45 = [&]
                                    {
                                        auto tmp46 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                        auto tmp47 = c10::convert<float>(tmp46);
                                        return tmp47;
                                    }
                                    ;
                                    auto tmp48 = tmp44 ? tmp45() : static_cast<decltype(tmp45())>(0.0);
                                    return tmp48;
                                }
                                ;
                                auto tmp49 = tmp7 ? tmp40() : static_cast<decltype(tmp40())>(0.0);
                                auto tmp50 = tmp7 ? tmp49 : tmp34;
                                return tmp50;
                            }
                            ;
                            auto tmp51 = tmp38 ? tmp39() : static_cast<decltype(tmp39())>(0.0);
                            auto tmp52 = tmp38 ? tmp51 : tmp34;
                            auto tmp53 = tmp3 ? tmp36 : tmp52;
                            auto tmp54 = c10::convert<bfloat16>(tmp53);
                            out_ptr0[static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0))] = tmp54;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(256L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp96 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp132 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = at::vec::VectorizedN<int64_t,2>::arange(tmp10, 1);
                                auto tmp12 = at::vec::VectorizedN<int64_t,2>(tmp6);
                                auto tmp13 = at::vec::VecMask<int64_t,2>(tmp11 >= tmp12);
                                auto tmp14 = static_cast<int64_t>(256);
                                auto tmp15 = at::vec::VectorizedN<int64_t,2>(tmp14);
                                auto tmp16 = at::vec::VecMask<int64_t,2>(tmp11 < tmp15);
                                auto tmp17 = tmp13 & tmp16;
                                auto tmp19 = at::vec::VecMask<float,1>::from(tmp7);
                                auto tmp20 = tmp17 & tmp19;
                                auto tmp18 = [&]
                                {
                                    auto tmp21 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp20.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp22 = static_cast<int64_t>(512);
                                    auto tmp23 = at::vec::VectorizedN<int64_t,2>(tmp22);
                                    auto tmp24 = at::vec::VecMask<int64_t,2>(tmp21 < tmp23);
                                    auto tmp26 = tmp24 & tmp20;
                                    auto tmp25 = [&]
                                    {
                                        auto tmp27 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp26.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp28 = at::vec::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp31 =
                                    [&]
                                    {
                                        if (tmp26.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp29 = tmp25();
                                            auto tmp30 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp31;
                                }
                                ;
                                auto tmp34 =
                                [&]
                                {
                                    if (tmp20.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp32 = tmp18();
                                        auto tmp33 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp32)::blendv(tmp33, tmp32, tmp20.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp35 = static_cast<int64_t>(0);
                                auto tmp36 = tmp35 >= tmp6;
                                auto tmp38 = tmp36 & tmp7;
                                auto tmp37 = [&]
                                {
                                    auto tmp40 = at::vec::VecMask<float,1>::from(tmp38);
                                    auto tmp41 = tmp16 & tmp40;
                                    auto tmp39 = [&]
                                    {
                                        auto tmp42 =
                                        [&]
                                        {
                                            __at_align__ std::array<int64_t, 16> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp41.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                                }
                                            }
                                            return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp43 = static_cast<int64_t>(512);
                                        auto tmp44 = at::vec::VectorizedN<int64_t,2>(tmp43);
                                        auto tmp45 = at::vec::VecMask<int64_t,2>(tmp42 < tmp44);
                                        auto tmp47 = tmp45 & tmp41;
                                        auto tmp46 = [&]
                                        {
                                            auto tmp48 =
                                            [&]
                                            {
                                                __at_align__ std::array<bfloat16, 32> tmpbuf;
                                                #pragma GCC unroll 16
                                                for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                                {
                                                    if (tmp47.is_masked(x3_inner))
                                                    {
                                                        tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                    }
                                                }
                                                return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                            }
                                            ()
                                            ;
                                            auto tmp49 = at::vec::convert<float>(tmp48);
                                            return tmp49;
                                        }
                                        ;
                                        auto tmp52 =
                                        [&]
                                        {
                                            if (tmp47.all_zero())
                                            {
                                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            }
                                            else
                                            {
                                                auto tmp50 = tmp46();
                                                auto tmp51 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                                return decltype(tmp50)::blendv(tmp51, tmp50, tmp47.template cast<float,1>());
                                            }
                                        }
                                        ()
                                        ;
                                        return tmp52;
                                    }
                                    ;
                                    auto tmp55 =
                                    [&]
                                    {
                                        if (tmp41.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp53 = tmp39();
                                            auto tmp54 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp53)::blendv(tmp54, tmp53, tmp41.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    auto tmp56 = at::vec::VecMask<float,1>::from(tmp38).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                    auto tmp57 = at::vec::convert<float>(tmp56);
                                    auto tmp58 = decltype(tmp55)::blendv(tmp57, tmp55, tmp16.template cast<float,1>());
                                    return tmp58;
                                }
                                ;
                                auto tmp59 = tmp36 ? tmp37() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                                auto tmp60 = at::vec::VecMask<float,1>::from(tmp7).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp61 = at::vec::convert<float>(tmp60);
                                auto tmp62 = at::vec::VecMask<float,1>::from(tmp36);
                                auto tmp63 = decltype(tmp59)::blendv(tmp61, tmp59, tmp62.template cast<float,1>());
                                auto tmp64 = decltype(tmp34)::blendv(tmp63, tmp34, tmp17.template cast<float,1>());
                                return tmp64;
                            }
                            ;
                            auto tmp65 = tmp7 ? tmp8() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp66 = static_cast<int64_t>(0);
                            auto tmp67 = tmp66 >= tmp6;
                            auto tmp68 = [&]
                            {
                                auto tmp69 = x3;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(256);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 < tmp73);
                                auto tmp76 = at::vec::VecMask<float,1>::from(tmp67);
                                auto tmp77 = tmp74 & tmp76;
                                auto tmp75 = [&]
                                {
                                    auto tmp78 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp77.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp79 = static_cast<int64_t>(512);
                                    auto tmp80 = at::vec::VectorizedN<int64_t,2>(tmp79);
                                    auto tmp81 = at::vec::VecMask<int64_t,2>(tmp78 < tmp80);
                                    auto tmp83 = tmp81 & tmp77;
                                    auto tmp82 = [&]
                                    {
                                        auto tmp84 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp83.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp85 = at::vec::convert<float>(tmp84);
                                        return tmp85;
                                    }
                                    ;
                                    auto tmp88 =
                                    [&]
                                    {
                                        if (tmp83.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp86 = tmp82();
                                            auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp86)::blendv(tmp87, tmp86, tmp83.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp88;
                                }
                                ;
                                auto tmp91 =
                                [&]
                                {
                                    if (tmp77.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp89 = tmp75();
                                        auto tmp90 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp89)::blendv(tmp90, tmp89, tmp77.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp92 = at::vec::VecMask<float,1>::from(tmp67).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp93 = at::vec::convert<float>(tmp92);
                                auto tmp94 = decltype(tmp91)::blendv(tmp93, tmp91, tmp74.template cast<float,1>());
                                return tmp94;
                            }
                            ;
                            auto tmp95 = tmp67 ? tmp68() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp97 = at::vec::convert<float>(tmp96);
                            auto tmp98 = at::vec::VecMask<float,1>::from(tmp67);
                            auto tmp99 = decltype(tmp95)::blendv(tmp97, tmp95, tmp98.template cast<float,1>());
                            auto tmp100 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp101 = decltype(tmp65)::blendv(tmp99, tmp65, tmp100.template cast<float,1>());
                            auto tmp102 = c10::convert<int64_t>(tmp0);
                            auto tmp103 = tmp102 >= tmp6;
                            auto tmp104 = [&]
                            {
                                auto tmp105 = x3;
                                auto tmp106 = c10::convert<int64_t>(tmp105);
                                auto tmp107 = at::vec::VectorizedN<int64_t,2>::arange(tmp106, 1);
                                auto tmp108 = static_cast<int64_t>(256);
                                auto tmp109 = at::vec::VectorizedN<int64_t,2>(tmp108);
                                auto tmp110 = at::vec::VecMask<int64_t,2>(tmp107 < tmp109);
                                auto tmp112 = at::vec::VecMask<float,1>::from(tmp103);
                                auto tmp113 = tmp110 & tmp112;
                                auto tmp111 = [&]
                                {
                                    auto tmp114 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp113.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp115 = static_cast<int64_t>(512);
                                    auto tmp116 = at::vec::VectorizedN<int64_t,2>(tmp115);
                                    auto tmp117 = at::vec::VecMask<int64_t,2>(tmp114 < tmp116);
                                    auto tmp119 = tmp117 & tmp113;
                                    auto tmp118 = [&]
                                    {
                                        auto tmp120 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp119.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp121 = at::vec::convert<float>(tmp120);
                                        return tmp121;
                                    }
                                    ;
                                    auto tmp124 =
                                    [&]
                                    {
                                        if (tmp119.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp122 = tmp118();
                                            auto tmp123 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp122)::blendv(tmp123, tmp122, tmp119.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp124;
                                }
                                ;
                                auto tmp127 =
                                [&]
                                {
                                    if (tmp113.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp125 = tmp111();
                                        auto tmp126 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp125)::blendv(tmp126, tmp125, tmp113.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp128 = at::vec::VecMask<float,1>::from(tmp103).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp129 = at::vec::convert<float>(tmp128);
                                auto tmp130 = decltype(tmp127)::blendv(tmp129, tmp127, tmp110.template cast<float,1>());
                                return tmp130;
                            }
                            ;
                            auto tmp131 = tmp103 ? tmp104() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp133 = at::vec::convert<float>(tmp132);
                            auto tmp134 = at::vec::VecMask<float,1>::from(tmp103);
                            auto tmp135 = decltype(tmp131)::blendv(tmp133, tmp131, tmp134.template cast<float,1>());
                            auto tmp136 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp137 = decltype(tmp101)::blendv(tmp135, tmp101, tmp136.template cast<float,1>());
                            auto tmp138 = at::vec::convert<bfloat16>(tmp137);
                            tmp138.store(out_ptr1 + static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp68 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                            auto tmp93 = out_ptr0[static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0))];
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = tmp10 >= tmp6;
                                auto tmp12 = static_cast<int64_t>(256);
                                auto tmp13 = tmp10 < tmp12;
                                auto tmp14 = tmp11 & tmp13;
                                auto tmp15 = [&]
                                {
                                    auto tmp16 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp17 = c10::convert<int64_t>(tmp16);
                                    auto tmp18 = static_cast<int64_t>(512);
                                    auto tmp19 = tmp17 < tmp18;
                                    auto tmp20 = [&]
                                    {
                                        auto tmp21 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                        auto tmp22 = c10::convert<float>(tmp21);
                                        return tmp22;
                                    }
                                    ;
                                    auto tmp23 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                                    return tmp23;
                                }
                                ;
                                auto tmp24 = tmp14 ? tmp15() : static_cast<decltype(tmp15())>(0.0);
                                auto tmp25 = static_cast<int64_t>(0);
                                auto tmp26 = tmp25 >= tmp6;
                                auto tmp27 = [&]
                                {
                                    auto tmp28 = [&]
                                    {
                                        auto tmp29 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                        auto tmp30 = c10::convert<int64_t>(tmp29);
                                        auto tmp31 = static_cast<int64_t>(512);
                                        auto tmp32 = tmp30 < tmp31;
                                        auto tmp33 = [&]
                                        {
                                            auto tmp34 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                            auto tmp35 = c10::convert<float>(tmp34);
                                            return tmp35;
                                        }
                                        ;
                                        auto tmp36 = tmp32 ? tmp33() : static_cast<decltype(tmp33())>(0.0);
                                        return tmp36;
                                    }
                                    ;
                                    auto tmp37 = tmp13 ? tmp28() : static_cast<decltype(tmp28())>(0.0);
                                    auto tmp38 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                    auto tmp39 = c10::convert<float>(tmp38);
                                    auto tmp40 = tmp13 ? tmp37 : tmp39;
                                    return tmp40;
                                }
                                ;
                                auto tmp41 = tmp26 ? tmp27() : static_cast<decltype(tmp27())>(0.0);
                                auto tmp42 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp43 = c10::convert<float>(tmp42);
                                auto tmp44 = tmp26 ? tmp41 : tmp43;
                                auto tmp45 = tmp14 ? tmp24 : tmp44;
                                return tmp45;
                            }
                            ;
                            auto tmp46 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp47 = static_cast<int64_t>(0);
                            auto tmp48 = tmp47 >= tmp6;
                            auto tmp49 = [&]
                            {
                                auto tmp50 = x3;
                                auto tmp51 = c10::convert<int64_t>(tmp50);
                                auto tmp52 = static_cast<int64_t>(256);
                                auto tmp53 = tmp51 < tmp52;
                                auto tmp54 = [&]
                                {
                                    auto tmp55 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp56 = c10::convert<int64_t>(tmp55);
                                    auto tmp57 = static_cast<int64_t>(512);
                                    auto tmp58 = tmp56 < tmp57;
                                    auto tmp59 = [&]
                                    {
                                        auto tmp60 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp61 = c10::convert<float>(tmp60);
                                        return tmp61;
                                    }
                                    ;
                                    auto tmp62 = tmp58 ? tmp59() : static_cast<decltype(tmp59())>(0.0);
                                    return tmp62;
                                }
                                ;
                                auto tmp63 = tmp53 ? tmp54() : static_cast<decltype(tmp54())>(0.0);
                                auto tmp64 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp65 = c10::convert<float>(tmp64);
                                auto tmp66 = tmp53 ? tmp63 : tmp65;
                                return tmp66;
                            }
                            ;
                            auto tmp67 = tmp48 ? tmp49() : static_cast<decltype(tmp49())>(0.0);
                            auto tmp69 = c10::convert<float>(tmp68);
                            auto tmp70 = tmp48 ? tmp67 : tmp69;
                            auto tmp71 = tmp7 ? tmp46 : tmp70;
                            auto tmp72 = c10::convert<int64_t>(tmp0);
                            auto tmp73 = tmp72 >= tmp6;
                            auto tmp74 = [&]
                            {
                                auto tmp75 = x3;
                                auto tmp76 = c10::convert<int64_t>(tmp75);
                                auto tmp77 = static_cast<int64_t>(256);
                                auto tmp78 = tmp76 < tmp77;
                                auto tmp79 = [&]
                                {
                                    auto tmp80 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp81 = c10::convert<int64_t>(tmp80);
                                    auto tmp82 = static_cast<int64_t>(512);
                                    auto tmp83 = tmp81 < tmp82;
                                    auto tmp84 = [&]
                                    {
                                        auto tmp85 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp86 = c10::convert<float>(tmp85);
                                        return tmp86;
                                    }
                                    ;
                                    auto tmp87 = tmp83 ? tmp84() : static_cast<decltype(tmp84())>(0.0);
                                    return tmp87;
                                }
                                ;
                                auto tmp88 = tmp78 ? tmp79() : static_cast<decltype(tmp79())>(0.0);
                                auto tmp89 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp90 = c10::convert<float>(tmp89);
                                auto tmp91 = tmp78 ? tmp88 : tmp90;
                                return tmp91;
                            }
                            ;
                            auto tmp92 = tmp73 ? tmp74() : static_cast<decltype(tmp74())>(0.0);
                            auto tmp94 = c10::convert<float>(tmp93);
                            auto tmp95 = tmp73 ? tmp92 : tmp94;
                            auto tmp96 = tmp3 ? tmp71 : tmp95;
                            auto tmp97 = c10::convert<bfloat16>(tmp96);
                            out_ptr1[static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0))] = tmp97;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp93 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)), 16);
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(256);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 >= tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp8 = c10::convert<int64_t>(tmp7);
                            auto tmp9 = at::vec::VectorizedN<int64_t,2>::arange(tmp8, -1);
                            auto tmp10 = static_cast<int64_t>(0);
                            auto tmp11 = at::vec::VectorizedN<int64_t,2>(tmp10);
                            auto tmp12 = at::vec::VecMask<int64_t,2>(tmp9 <= tmp11);
                            auto tmp13 = static_cast<float>(1.0);
                            auto tmp14 = static_cast<float>(0.0);
                            auto tmp15 = at::vec::Vectorized<float>(tmp13);
                            auto tmp16 = at::vec::Vectorized<float>(tmp14);
                            auto tmp17 = decltype(tmp15)::blendv(tmp16, tmp15, tmp12.template cast<float,1>());
                            auto tmp18 = at::vec::VecMask<float,1>::from<float,1>(tmp17);
                            auto tmp19 = 256L + x1;
                            auto tmp20 = c10::convert<int64_t>(tmp19);
                            auto tmp21 = tmp20 < tmp3;
                            auto tmp23 = at::vec::VecMask<float,1>::from(tmp21);
                            auto tmp24 = tmp23 & tmp5;
                            auto tmp22 = [&]
                            {
                                auto tmp25 = static_cast<int64_t>(257);
                                auto tmp26 = at::vec::VectorizedN<int64_t,2>(tmp25);
                                auto tmp27 = at::vec::VecMask<int64_t,2>(tmp2 < tmp26);
                                auto tmp29 = tmp27 & tmp24;
                                auto tmp28 = [&]
                                {
                                    auto tmp30 = 1L + x1 + x2;
                                    auto tmp31 = c10::convert<int64_t>(tmp30);
                                    auto tmp32 = at::vec::VectorizedN<int64_t,2>::arange(tmp31, 1);
                                    auto tmp33 = at::vec::VecMask<int64_t,2>(tmp32 <= tmp11);
                                    auto tmp34 = decltype(tmp15)::blendv(tmp16, tmp15, tmp33.template cast<float,1>());
                                    auto tmp35 = at::vec::VecMask<float,1>::from<float,1>(tmp34);
                                    auto tmp36 = tmp29.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                    auto tmp37 = at::vec::convert<float>(tmp36);
                                    auto tmp38 = -std::numeric_limits<float>::infinity();
                                    auto tmp39 = at::vec::Vectorized<float>(tmp38);
                                    auto tmp40 = decltype(tmp39)::blendv(tmp37, tmp39, tmp35.template cast<float,1>());
                                    return tmp40;
                                }
                                ;
                                auto tmp43 =
                                [&]
                                {
                                    if (tmp29.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp41 = tmp28();
                                        auto tmp42 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp41)::blendv(tmp42, tmp41, tmp29.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp44 = tmp24.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp45 = at::vec::convert<float>(tmp44);
                                auto tmp46 = decltype(tmp43)::blendv(tmp45, tmp43, tmp27.template cast<float,1>());
                                return tmp46;
                            }
                            ;
                            auto tmp49 =
                            [&]
                            {
                                if (tmp24.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp47 = tmp22();
                                    auto tmp48 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp47)::blendv(tmp48, tmp47, tmp24.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp50 = tmp5.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp51 = at::vec::convert<float>(tmp50);
                            auto tmp52 = decltype(tmp49)::blendv(tmp51, tmp49, tmp23.template cast<float,1>());
                            auto tmp53 = -std::numeric_limits<float>::infinity();
                            auto tmp54 = at::vec::Vectorized<float>(tmp53);
                            auto tmp55 = decltype(tmp54)::blendv(tmp52, tmp54, tmp18.template cast<float,1>());
                            return tmp55;
                        }
                        ;
                        auto tmp58 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp56 = tmp6();
                                auto tmp57 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp56)::blendv(tmp57, tmp56, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp59 = 256L + x1;
                        auto tmp60 = c10::convert<int64_t>(tmp59);
                        auto tmp61 = tmp60 < tmp3;
                        auto tmp62 = [&]
                        {
                            auto tmp63 = static_cast<int64_t>(257);
                            auto tmp64 = at::vec::VectorizedN<int64_t,2>(tmp63);
                            auto tmp65 = at::vec::VecMask<int64_t,2>(tmp2 < tmp64);
                            auto tmp67 = at::vec::VecMask<float,1>::from(tmp61);
                            auto tmp68 = tmp65 & tmp67;
                            auto tmp66 = [&]
                            {
                                auto tmp69 = 1L + x1 + x2;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(0);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 <= tmp73);
                                auto tmp75 = static_cast<float>(1.0);
                                auto tmp76 = static_cast<float>(0.0);
                                auto tmp77 = at::vec::Vectorized<float>(tmp75);
                                auto tmp78 = at::vec::Vectorized<float>(tmp76);
                                auto tmp79 = decltype(tmp77)::blendv(tmp78, tmp77, tmp74.template cast<float,1>());
                                auto tmp80 = at::vec::VecMask<float,1>::from<float,1>(tmp79);
                                auto tmp81 = tmp68.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp82 = at::vec::convert<float>(tmp81);
                                auto tmp83 = -std::numeric_limits<float>::infinity();
                                auto tmp84 = at::vec::Vectorized<float>(tmp83);
                                auto tmp85 = decltype(tmp84)::blendv(tmp82, tmp84, tmp80.template cast<float,1>());
                                return tmp85;
                            }
                            ;
                            auto tmp88 =
                            [&]
                            {
                                if (tmp68.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp86 = tmp66();
                                    auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp86)::blendv(tmp87, tmp86, tmp68.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp89 = at::vec::VecMask<float,1>::from(tmp61).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp90 = at::vec::convert<float>(tmp89);
                            auto tmp91 = decltype(tmp88)::blendv(tmp90, tmp88, tmp65.template cast<float,1>());
                            return tmp91;
                        }
                        ;
                        auto tmp92 = tmp61 ? tmp62() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp94 = at::vec::convert<float>(tmp93);
                        auto tmp95 = at::vec::VecMask<float,1>::from(tmp61);
                        auto tmp96 = decltype(tmp92)::blendv(tmp94, tmp92, tmp95.template cast<float,1>());
                        auto tmp97 = decltype(tmp58)::blendv(tmp96, tmp58, tmp5.template cast<float,1>());
                        auto tmp98 = at::vec::convert<bfloat16>(tmp97);
                        tmp98.store(out_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp64 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp6 = c10::convert<int64_t>(tmp5);
                            auto tmp7 = static_cast<int64_t>(0);
                            auto tmp8 = tmp6 <= tmp7;
                            auto tmp9 = static_cast<float>(1.0);
                            auto tmp10 = static_cast<float>(0.0);
                            auto tmp11 = tmp8 ? tmp9 : tmp10;
                            auto tmp12 = c10::convert<bool>(tmp11);
                            auto tmp13 = 256L + x1;
                            auto tmp14 = c10::convert<int64_t>(tmp13);
                            auto tmp15 = tmp14 < tmp2;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = static_cast<int64_t>(257);
                                auto tmp18 = tmp1 < tmp17;
                                auto tmp19 = [&]
                                {
                                    auto tmp20 = 1L + x1 + x2;
                                    auto tmp21 = c10::convert<int64_t>(tmp20);
                                    auto tmp22 = tmp21 <= tmp7;
                                    auto tmp23 = tmp22 ? tmp9 : tmp10;
                                    auto tmp24 = c10::convert<bool>(tmp23);
                                    auto tmp25 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                    auto tmp26 = c10::convert<float>(tmp25);
                                    auto tmp27 = -std::numeric_limits<float>::infinity();
                                    auto tmp28 = tmp24 ? tmp27 : tmp26;
                                    return tmp28;
                                }
                                ;
                                auto tmp29 = tmp18 ? tmp19() : static_cast<decltype(tmp19())>(0.0);
                                auto tmp30 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp31 = c10::convert<float>(tmp30);
                                auto tmp32 = tmp18 ? tmp29 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp34 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp35 = c10::convert<float>(tmp34);
                            auto tmp36 = tmp15 ? tmp33 : tmp35;
                            auto tmp37 = -std::numeric_limits<float>::infinity();
                            auto tmp38 = tmp12 ? tmp37 : tmp36;
                            return tmp38;
                        }
                        ;
                        auto tmp39 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp40 = 256L + x1;
                        auto tmp41 = c10::convert<int64_t>(tmp40);
                        auto tmp42 = tmp41 < tmp2;
                        auto tmp43 = [&]
                        {
                            auto tmp44 = static_cast<int64_t>(257);
                            auto tmp45 = tmp1 < tmp44;
                            auto tmp46 = [&]
                            {
                                auto tmp47 = 1L + x1 + x2;
                                auto tmp48 = c10::convert<int64_t>(tmp47);
                                auto tmp49 = static_cast<int64_t>(0);
                                auto tmp50 = tmp48 <= tmp49;
                                auto tmp51 = static_cast<float>(1.0);
                                auto tmp52 = static_cast<float>(0.0);
                                auto tmp53 = tmp50 ? tmp51 : tmp52;
                                auto tmp54 = c10::convert<bool>(tmp53);
                                auto tmp55 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp56 = c10::convert<float>(tmp55);
                                auto tmp57 = -std::numeric_limits<float>::infinity();
                                auto tmp58 = tmp54 ? tmp57 : tmp56;
                                return tmp58;
                            }
                            ;
                            auto tmp59 = tmp45 ? tmp46() : static_cast<decltype(tmp46())>(0.0);
                            auto tmp60 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp61 = c10::convert<float>(tmp60);
                            auto tmp62 = tmp45 ? tmp59 : tmp61;
                            return tmp62;
                        }
                        ;
                        auto tmp63 = tmp42 ? tmp43() : static_cast<decltype(tmp43())>(0.0);
                        auto tmp65 = c10::convert<float>(tmp64);
                        auto tmp66 = tmp42 ? tmp63 : tmp65;
                        auto tmp67 = tmp3 ? tmp39 : tmp66;
                        auto tmp68 = c10::convert<bfloat16>(tmp67);
                        out_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0))] = tmp68;
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp45 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)), 16);
                        auto tmp83 = at::vec::Vectorized<bfloat16>::loadu(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)), 16);
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr2 + static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0)));
                            auto tmp6 = at::vec::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = at::vec::VectorizedN<int64_t,2>::arange(tmp13, 1);
                            auto tmp15 = static_cast<int64_t>(257);
                            auto tmp16 = at::vec::VectorizedN<int64_t,2>(tmp15);
                            auto tmp17 = at::vec::VecMask<int64_t,2>(tmp14 < tmp16);
                            auto tmp19 = at::vec::VecMask<float,1>::from(tmp10);
                            auto tmp20 = tmp17 & tmp19;
                            auto tmp18 = [&]
                            {
                                auto tmp21 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp22 = c10::convert<int64_t>(tmp21);
                                auto tmp23 = at::vec::VectorizedN<int64_t,2>::arange(tmp22, 1);
                                auto tmp24 = static_cast<int64_t>(0);
                                auto tmp25 = at::vec::VectorizedN<int64_t,2>(tmp24);
                                auto tmp26 = at::vec::VecMask<int64_t,2>(tmp23 <= tmp25);
                                auto tmp27 = static_cast<float>(1.0);
                                auto tmp28 = static_cast<float>(0.0);
                                auto tmp29 = at::vec::Vectorized<float>(tmp27);
                                auto tmp30 = at::vec::Vectorized<float>(tmp28);
                                auto tmp31 = decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                auto tmp32 = at::vec::VecMask<float,1>::from<float,1>(tmp31);
                                auto tmp33 = tmp20.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                                auto tmp34 = at::vec::convert<float>(tmp33);
                                auto tmp35 = -std::numeric_limits<float>::infinity();
                                auto tmp36 = at::vec::Vectorized<float>(tmp35);
                                auto tmp37 = decltype(tmp36)::blendv(tmp34, tmp36, tmp32.template cast<float,1>());
                                return tmp37;
                            }
                            ;
                            auto tmp40 =
                            [&]
                            {
                                if (tmp20.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp38 = tmp18();
                                    auto tmp39 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp38)::blendv(tmp39, tmp38, tmp20.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp41 = at::vec::VecMask<float,1>::from(tmp10).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                            auto tmp42 = at::vec::convert<float>(tmp41);
                            auto tmp43 = decltype(tmp40)::blendv(tmp42, tmp40, tmp17.template cast<float,1>());
                            return tmp43;
                        }
                        ;
                        auto tmp44 = tmp10 ? tmp11() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp46 = at::vec::convert<float>(tmp45);
                        auto tmp47 = at::vec::VecMask<float,1>::from(tmp10);
                        auto tmp48 = decltype(tmp44)::blendv(tmp46, tmp44, tmp47.template cast<float,1>());
                        auto tmp49 = at::vec::VecMask<float,1>::from(tmp3);
                        auto tmp50 = decltype(tmp7)::blendv(tmp48, tmp7, tmp49.template cast<float,1>());
                        auto tmp51 = [&]
                        {
                            auto tmp52 = x2;
                            auto tmp53 = c10::convert<int64_t>(tmp52);
                            auto tmp54 = at::vec::VectorizedN<int64_t,2>::arange(tmp53, 1);
                            auto tmp55 = at::vec::VectorizedN<int64_t,2>(tmp2);
                            auto tmp56 = at::vec::VecMask<int64_t,2>(tmp54 >= tmp55);
                            auto tmp58 = tmp56 & tmp49;
                            auto tmp57 = [&]
                            {
                                auto tmp59 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp60 = c10::convert<int64_t>(tmp59);
                                auto tmp61 = at::vec::VectorizedN<int64_t,2>::arange(tmp60, -1);
                                auto tmp62 = static_cast<int64_t>(0);
                                auto tmp63 = at::vec::VectorizedN<int64_t,2>(tmp62);
                                auto tmp64 = at::vec::VecMask<int64_t,2>(tmp61 <= tmp63);
                                auto tmp65 = static_cast<float>(1.0);
                                auto tmp66 = static_cast<float>(0.0);
                                auto tmp67 = at::vec::Vectorized<float>(tmp65);
                                auto tmp68 = at::vec::Vectorized<float>(tmp66);
                                auto tmp69 = decltype(tmp67)::blendv(tmp68, tmp67, tmp64.template cast<float,1>());
                                auto tmp70 = at::vec::VecMask<float,1>::from<float,1>(tmp69);
                                auto tmp71 = tmp58.template cast<float,1>().template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                                auto tmp72 = at::vec::convert<float>(tmp71);
                                auto tmp73 = -std::numeric_limits<float>::infinity();
                                auto tmp74 = at::vec::Vectorized<float>(tmp73);
                                auto tmp75 = decltype(tmp74)::blendv(tmp72, tmp74, tmp70.template cast<float,1>());
                                return tmp75;
                            }
                            ;
                            auto tmp78 =
                            [&]
                            {
                                if (tmp58.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp76 = tmp57();
                                    auto tmp77 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp76)::blendv(tmp77, tmp76, tmp58.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp79 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                            auto tmp80 = at::vec::convert<float>(tmp79);
                            auto tmp81 = decltype(tmp78)::blendv(tmp80, tmp78, tmp56.template cast<float,1>());
                            return tmp81;
                        }
                        ;
                        auto tmp82 = tmp3 ? tmp51() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp84 = at::vec::convert<float>(tmp83);
                        auto tmp85 = decltype(tmp82)::blendv(tmp84, tmp82, tmp49.template cast<float,1>());
                        auto tmp86 = tmp50 + tmp85;
                        auto tmp87 = at::vec::convert<bfloat16>(tmp86);
                        tmp87.store(out_ptr3 + static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp34 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                        auto tmp60 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = out_ptr2[static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0))];
                            auto tmp6 = c10::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = static_cast<int64_t>(257);
                            auto tmp15 = tmp13 < tmp14;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp18 = c10::convert<int64_t>(tmp17);
                                auto tmp19 = static_cast<int64_t>(0);
                                auto tmp20 = tmp18 <= tmp19;
                                auto tmp21 = static_cast<float>(1.0);
                                auto tmp22 = static_cast<float>(0.0);
                                auto tmp23 = tmp20 ? tmp21 : tmp22;
                                auto tmp24 = c10::convert<bool>(tmp23);
                                auto tmp25 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                                auto tmp26 = c10::convert<float>(tmp25);
                                auto tmp27 = -std::numeric_limits<float>::infinity();
                                auto tmp28 = tmp24 ? tmp27 : tmp26;
                                return tmp28;
                            }
                            ;
                            auto tmp29 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp30 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                            auto tmp31 = c10::convert<float>(tmp30);
                            auto tmp32 = tmp15 ? tmp29 : tmp31;
                            return tmp32;
                        }
                        ;
                        auto tmp33 = tmp10 ? tmp11() : static_cast<decltype(tmp11())>(0.0);
                        auto tmp35 = c10::convert<float>(tmp34);
                        auto tmp36 = tmp10 ? tmp33 : tmp35;
                        auto tmp37 = tmp3 ? tmp7 : tmp36;
                        auto tmp38 = [&]
                        {
                            auto tmp39 = x2;
                            auto tmp40 = c10::convert<int64_t>(tmp39);
                            auto tmp41 = tmp40 >= tmp2;
                            auto tmp42 = [&]
                            {
                                auto tmp43 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp44 = c10::convert<int64_t>(tmp43);
                                auto tmp45 = static_cast<int64_t>(0);
                                auto tmp46 = tmp44 <= tmp45;
                                auto tmp47 = static_cast<float>(1.0);
                                auto tmp48 = static_cast<float>(0.0);
                                auto tmp49 = tmp46 ? tmp47 : tmp48;
                                auto tmp50 = c10::convert<bool>(tmp49);
                                auto tmp51 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                                auto tmp52 = c10::convert<float>(tmp51);
                                auto tmp53 = -std::numeric_limits<float>::infinity();
                                auto tmp54 = tmp50 ? tmp53 : tmp52;
                                return tmp54;
                            }
                            ;
                            auto tmp55 = tmp41 ? tmp42() : static_cast<decltype(tmp42())>(0.0);
                            auto tmp56 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                            auto tmp57 = c10::convert<float>(tmp56);
                            auto tmp58 = tmp41 ? tmp55 : tmp57;
                            return tmp58;
                        }
                        ;
                        auto tmp59 = tmp3 ? tmp38() : static_cast<decltype(tmp38())>(0.0);
                        auto tmp61 = c10::convert<float>(tmp60);
                        auto tmp62 = tmp3 ? tmp59 : tmp61;
                        auto tmp63 = decltype(tmp37)(tmp37 + tmp62);
                        auto tmp64 = c10::convert<bfloat16>(tmp63);
                        out_ptr3[static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1))] = tmp64;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(6144L); x0+=static_cast<int64_t>(1L))
            {
                {
                    float tmp_acc0 = -std::numeric_limits<float>::infinity();
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(-std::numeric_limits<float>::infinity());
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        tmp_acc0_vec = at::vec::maximum(tmp_acc0_vec, tmp1);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp1 = c10::convert<float>(tmp0);
                        tmp_acc0 = max_propagate_nan(tmp_acc0, tmp1);
                    }
                    tmp_acc0 = max_propagate_nan(tmp_acc0, at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return at::vec::maximum(x, y); }, tmp_acc0_vec));
                    out_ptr4[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
                {
                    float tmp_acc0 = 0;
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(0);
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = at::vec::Vectorized<float>(tmp2);
                        auto tmp4 = tmp1 - tmp3;
                        auto tmp5 = tmp4.exp();
                        tmp5.store(out_ptr5 + static_cast<int64_t>(x1 + (513L*x0)));
                        tmp_acc0_vec = tmp_acc0_vec + tmp5;
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = c10::convert<float>(tmp0);
                        auto tmp3 = decltype(tmp1)(tmp1 - tmp2);
                        auto tmp4 = std::exp(tmp3);
                        out_ptr5[static_cast<int64_t>(x1 + (513L*x0))] = tmp4;
                        tmp_acc0 = tmp_acc0 + tmp4;
                    }
                    tmp_acc0 = tmp_acc0 + at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return x + y; }, tmp_acc0_vec);
                    out_ptr6[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
            }
        }
    }
}
''')


cpp_fused_clone_constant_pad_nd_46 = async_compile.cpp_pybinding(['const bfloat16*', 'const bool*', 'const float*', 'const float*', 'bfloat16*', 'bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bool* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(1024L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = (-256L) + x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(0);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = static_cast<int64_t>(512);
                        auto tmp5 = tmp1 < tmp4;
                        auto tmp6 = tmp3 & tmp5;
                        auto tmp7 = [&]
                        {
                            auto tmp8 = at::vec::VecMask<float,1>::from(tmp6).template loadu<bfloat16,1>(in_ptr0 + static_cast<int64_t>((-196608L) + x2 + (64L*x0) + (768L*x1)));
                            auto tmp9 = at::vec::convert<float>(tmp8);
                            return tmp9;
                        }
                        ;
                        auto tmp10 = tmp6 ? tmp7() : at::vec::Vectorized<float>(static_cast<float>(-1.0));
                        auto tmp11 = at::vec::convert<bfloat16>(tmp10);
                        tmp11.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (65536L*x0)), 16);
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(768L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(513);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 < tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp8 = tmp5.template cast<float,1>().template loadu<float,1>(in_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0)));
                            auto tmp9 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp10 = at::vec::Vectorized<float>(tmp9);
                            auto tmp11 = tmp8 / tmp10;
                            auto tmp12 = static_cast<float>(0.0);
                            auto tmp13 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp14 = at::vec::Vectorized<float>(tmp12);
                            auto tmp15 = decltype(tmp14)::blendv(tmp11, tmp14, tmp13.template cast<float,1>());
                            auto tmp16 = (tmp15);
                            return tmp16;
                        }
                        ;
                        auto tmp19 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp17 = tmp6();
                                auto tmp18 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp17)::blendv(tmp18, tmp17, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp20 = at::vec::convert<bfloat16>(tmp19);
                        tmp20.store(out_ptr1 + static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(768L); x2<static_cast<int64_t>(770L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(513);
                        auto tmp3 = tmp1 < tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp6 = in_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0))];
                            auto tmp7 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp8 = tmp6 / tmp7;
                            auto tmp9 = static_cast<float>(0.0);
                            auto tmp10 = tmp5 ? tmp9 : tmp8;
                            auto tmp11 = c10::convert<float>(tmp10);
                            return tmp11;
                        }
                        ;
                        auto tmp12 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp13 = c10::convert<bfloat16>(tmp12);
                        out_ptr1[static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1))] = tmp13;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(49152L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x2 + (16384L*x1) + (65536L*x0)), 32);
                        tmp0.store(out_ptr2 + static_cast<int64_t>(x2 + (49152L*x1) + (98304L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused_clone_47 = async_compile.cpp_pybinding(['const bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       bfloat16* out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x2 + (64L*x0) + (32768L*x1)), 32);
                        tmp0.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (768L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_48 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    auto tmp19 = at::vec::convert<bfloat16>(tmp18);
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                    tmp19.store(out_ptr3 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_49 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<float>::loadu(out_ptr2 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<bfloat16>(tmp0);
                tmp1.store(out_ptr3 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_50 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<float>(tmp0);
                auto tmp2 = static_cast<float>(0.125);
                auto tmp3 = at::vec::Vectorized<float>(tmp2);
                auto tmp4 = tmp1 * tmp3;
                auto tmp5 = at::vec::convert<bfloat16>(tmp4);
                tmp5.store(in_out_ptr0 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_51 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(32L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 32);
                tmp0.store(in_out_ptr0 + static_cast<int64_t>(x0), 32);
            }
        }
    }
}
''')


cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_52 = async_compile.cpp_pybinding(['const bfloat16*', 'const bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'float*', 'float*', 'float*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bfloat16* in_ptr1,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2,
                       bfloat16* out_ptr3,
                       float* out_ptr4,
                       float* out_ptr5,
                       float* out_ptr6)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(2L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = at::vec::VectorizedN<int64_t,2>::arange(tmp5, 1);
                            auto tmp7 = static_cast<int64_t>(256);
                            auto tmp8 = at::vec::VectorizedN<int64_t,2>(tmp7);
                            auto tmp9 = at::vec::VecMask<int64_t,2>(tmp6 >= tmp8);
                            auto tmp10 = [&]
                            {
                                auto tmp11 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                    {
                                        if (tmp9.is_masked(x3_inner))
                                        {
                                            tmpbuf[x3_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp12 = static_cast<int64_t>(512);
                                auto tmp13 = at::vec::VectorizedN<int64_t,2>(tmp12);
                                auto tmp14 = at::vec::VecMask<int64_t,2>(tmp11 < tmp13);
                                auto tmp16 = tmp14 & tmp9;
                                auto tmp15 = [&]
                                {
                                    auto tmp17 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp16.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>(131072L + x3 + x3_inner + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp18 = at::vec::convert<float>(tmp17);
                                    return tmp18;
                                }
                                ;
                                auto tmp21 =
                                [&]
                                {
                                    if (tmp16.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp19 = tmp15();
                                        auto tmp20 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp19)::blendv(tmp20, tmp19, tmp16.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp21;
                            }
                            ;
                            auto tmp24 =
                            [&]
                            {
                                if (tmp9.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp22 = tmp10();
                                    auto tmp23 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp22)::blendv(tmp23, tmp22, tmp9.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp25 = static_cast<int64_t>(1);
                            auto tmp26 = tmp25 < tmp25;
                            auto tmp27 = [&]
                            {
                                auto tmp29 = at::vec::VecMask<float,1>::from(tmp26);
                                auto tmp30 = tmp9 & tmp29;
                                auto tmp28 = [&]
                                {
                                    auto tmp31 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp30.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp32 = static_cast<int64_t>(512);
                                    auto tmp33 = at::vec::VectorizedN<int64_t,2>(tmp32);
                                    auto tmp34 = at::vec::VecMask<int64_t,2>(tmp31 < tmp33);
                                    auto tmp36 = tmp34 & tmp30;
                                    auto tmp35 = [&]
                                    {
                                        auto tmp37 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp36.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp38 = at::vec::convert<float>(tmp37);
                                        return tmp38;
                                    }
                                    ;
                                    auto tmp41 =
                                    [&]
                                    {
                                        if (tmp36.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp39 = tmp35();
                                            auto tmp40 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp39)::blendv(tmp40, tmp39, tmp36.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp41;
                                }
                                ;
                                auto tmp44 =
                                [&]
                                {
                                    if (tmp30.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp42 = tmp28();
                                        auto tmp43 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp42)::blendv(tmp43, tmp42, tmp30.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp45 = static_cast<float>(0.0);
                                auto tmp46 = at::vec::Vectorized<float>(tmp45);
                                auto tmp47 = decltype(tmp44)::blendv(tmp46, tmp44, tmp9.template cast<float,1>());
                                return tmp47;
                            }
                            ;
                            auto tmp48 = tmp26 ? tmp27() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp49 = static_cast<float>(0.0);
                            auto tmp50 = at::vec::VecMask<float,1>::from(tmp26);
                            auto tmp51 = at::vec::Vectorized<float>(tmp49);
                            auto tmp52 = decltype(tmp48)::blendv(tmp51, tmp48, tmp50.template cast<float,1>());
                            auto tmp53 = decltype(tmp24)::blendv(tmp52, tmp24, tmp9.template cast<float,1>());
                            auto tmp54 = c10::convert<int64_t>(tmp0);
                            auto tmp55 = tmp54 < tmp25;
                            auto tmp56 = [&]
                            {
                                auto tmp58 = at::vec::VecMask<float,1>::from(tmp55);
                                auto tmp59 = tmp9 & tmp58;
                                auto tmp57 = [&]
                                {
                                    auto tmp60 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp59.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp61 = static_cast<int64_t>(512);
                                    auto tmp62 = at::vec::VectorizedN<int64_t,2>(tmp61);
                                    auto tmp63 = at::vec::VecMask<int64_t,2>(tmp60 < tmp62);
                                    auto tmp65 = tmp63 & tmp59;
                                    auto tmp64 = [&]
                                    {
                                        auto tmp66 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp65.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp67 = at::vec::convert<float>(tmp66);
                                        return tmp67;
                                    }
                                    ;
                                    auto tmp70 =
                                    [&]
                                    {
                                        if (tmp65.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp68 = tmp64();
                                            auto tmp69 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp68)::blendv(tmp69, tmp68, tmp65.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp70;
                                }
                                ;
                                auto tmp73 =
                                [&]
                                {
                                    if (tmp59.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp71 = tmp57();
                                        auto tmp72 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp71)::blendv(tmp72, tmp71, tmp59.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp74 = decltype(tmp73)::blendv(tmp51, tmp73, tmp9.template cast<float,1>());
                                return tmp74;
                            }
                            ;
                            auto tmp75 = tmp55 ? tmp56() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp76 = at::vec::VecMask<float,1>::from(tmp55);
                            auto tmp77 = decltype(tmp75)::blendv(tmp51, tmp75, tmp76.template cast<float,1>());
                            auto tmp78 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp79 = decltype(tmp53)::blendv(tmp77, tmp53, tmp78.template cast<float,1>());
                            auto tmp80 = at::vec::convert<bfloat16>(tmp79);
                            tmp80.store(out_ptr0 + static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(256);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + (513L*x1))), static_cast<int64_t>(512L)));
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = static_cast<int64_t>(512);
                                auto tmp12 = tmp10 < tmp11;
                                auto tmp13 = [&]
                                {
                                    auto tmp14 = in_ptr0[static_cast<int64_t>(131072L + x3 + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                    auto tmp15 = c10::convert<float>(tmp14);
                                    return tmp15;
                                }
                                ;
                                auto tmp16 = tmp12 ? tmp13() : static_cast<decltype(tmp13())>(0.0);
                                return tmp16;
                            }
                            ;
                            auto tmp17 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp18 = static_cast<int64_t>(1);
                            auto tmp19 = tmp18 < tmp18;
                            auto tmp20 = [&]
                            {
                                auto tmp21 = [&]
                                {
                                    auto tmp22 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp23 = c10::convert<int64_t>(tmp22);
                                    auto tmp24 = static_cast<int64_t>(512);
                                    auto tmp25 = tmp23 < tmp24;
                                    auto tmp26 = [&]
                                    {
                                        auto tmp27 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                        auto tmp28 = c10::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp29 = tmp25 ? tmp26() : static_cast<decltype(tmp26())>(0.0);
                                    return tmp29;
                                }
                                ;
                                auto tmp30 = tmp7 ? tmp21() : static_cast<decltype(tmp21())>(0.0);
                                auto tmp31 = static_cast<float>(0.0);
                                auto tmp32 = tmp7 ? tmp30 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                            auto tmp34 = static_cast<float>(0.0);
                            auto tmp35 = tmp19 ? tmp33 : tmp34;
                            auto tmp36 = tmp7 ? tmp17 : tmp35;
                            auto tmp37 = c10::convert<int64_t>(tmp0);
                            auto tmp38 = tmp37 < tmp18;
                            auto tmp39 = [&]
                            {
                                auto tmp40 = [&]
                                {
                                    auto tmp41 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp42 = c10::convert<int64_t>(tmp41);
                                    auto tmp43 = static_cast<int64_t>(512);
                                    auto tmp44 = tmp42 < tmp43;
                                    auto tmp45 = [&]
                                    {
                                        auto tmp46 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                        auto tmp47 = c10::convert<float>(tmp46);
                                        return tmp47;
                                    }
                                    ;
                                    auto tmp48 = tmp44 ? tmp45() : static_cast<decltype(tmp45())>(0.0);
                                    return tmp48;
                                }
                                ;
                                auto tmp49 = tmp7 ? tmp40() : static_cast<decltype(tmp40())>(0.0);
                                auto tmp50 = tmp7 ? tmp49 : tmp34;
                                return tmp50;
                            }
                            ;
                            auto tmp51 = tmp38 ? tmp39() : static_cast<decltype(tmp39())>(0.0);
                            auto tmp52 = tmp38 ? tmp51 : tmp34;
                            auto tmp53 = tmp3 ? tmp36 : tmp52;
                            auto tmp54 = c10::convert<bfloat16>(tmp53);
                            out_ptr0[static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0))] = tmp54;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(256L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp96 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp132 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = at::vec::VectorizedN<int64_t,2>::arange(tmp10, 1);
                                auto tmp12 = at::vec::VectorizedN<int64_t,2>(tmp6);
                                auto tmp13 = at::vec::VecMask<int64_t,2>(tmp11 >= tmp12);
                                auto tmp14 = static_cast<int64_t>(256);
                                auto tmp15 = at::vec::VectorizedN<int64_t,2>(tmp14);
                                auto tmp16 = at::vec::VecMask<int64_t,2>(tmp11 < tmp15);
                                auto tmp17 = tmp13 & tmp16;
                                auto tmp19 = at::vec::VecMask<float,1>::from(tmp7);
                                auto tmp20 = tmp17 & tmp19;
                                auto tmp18 = [&]
                                {
                                    auto tmp21 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp20.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp22 = static_cast<int64_t>(512);
                                    auto tmp23 = at::vec::VectorizedN<int64_t,2>(tmp22);
                                    auto tmp24 = at::vec::VecMask<int64_t,2>(tmp21 < tmp23);
                                    auto tmp26 = tmp24 & tmp20;
                                    auto tmp25 = [&]
                                    {
                                        auto tmp27 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp26.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp28 = at::vec::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp31 =
                                    [&]
                                    {
                                        if (tmp26.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp29 = tmp25();
                                            auto tmp30 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp31;
                                }
                                ;
                                auto tmp34 =
                                [&]
                                {
                                    if (tmp20.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp32 = tmp18();
                                        auto tmp33 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp32)::blendv(tmp33, tmp32, tmp20.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp35 = static_cast<int64_t>(0);
                                auto tmp36 = tmp35 >= tmp6;
                                auto tmp38 = tmp36 & tmp7;
                                auto tmp37 = [&]
                                {
                                    auto tmp40 = at::vec::VecMask<float,1>::from(tmp38);
                                    auto tmp41 = tmp16 & tmp40;
                                    auto tmp39 = [&]
                                    {
                                        auto tmp42 =
                                        [&]
                                        {
                                            __at_align__ std::array<int64_t, 16> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp41.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                                }
                                            }
                                            return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp43 = static_cast<int64_t>(512);
                                        auto tmp44 = at::vec::VectorizedN<int64_t,2>(tmp43);
                                        auto tmp45 = at::vec::VecMask<int64_t,2>(tmp42 < tmp44);
                                        auto tmp47 = tmp45 & tmp41;
                                        auto tmp46 = [&]
                                        {
                                            auto tmp48 =
                                            [&]
                                            {
                                                __at_align__ std::array<bfloat16, 32> tmpbuf;
                                                #pragma GCC unroll 16
                                                for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                                {
                                                    if (tmp47.is_masked(x3_inner))
                                                    {
                                                        tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                    }
                                                }
                                                return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                            }
                                            ()
                                            ;
                                            auto tmp49 = at::vec::convert<float>(tmp48);
                                            return tmp49;
                                        }
                                        ;
                                        auto tmp52 =
                                        [&]
                                        {
                                            if (tmp47.all_zero())
                                            {
                                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            }
                                            else
                                            {
                                                auto tmp50 = tmp46();
                                                auto tmp51 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                                return decltype(tmp50)::blendv(tmp51, tmp50, tmp47.template cast<float,1>());
                                            }
                                        }
                                        ()
                                        ;
                                        return tmp52;
                                    }
                                    ;
                                    auto tmp55 =
                                    [&]
                                    {
                                        if (tmp41.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp53 = tmp39();
                                            auto tmp54 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp53)::blendv(tmp54, tmp53, tmp41.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    auto tmp56 = at::vec::VecMask<float,1>::from(tmp38).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                    auto tmp57 = at::vec::convert<float>(tmp56);
                                    auto tmp58 = decltype(tmp55)::blendv(tmp57, tmp55, tmp16.template cast<float,1>());
                                    return tmp58;
                                }
                                ;
                                auto tmp59 = tmp36 ? tmp37() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                                auto tmp60 = at::vec::VecMask<float,1>::from(tmp7).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp61 = at::vec::convert<float>(tmp60);
                                auto tmp62 = at::vec::VecMask<float,1>::from(tmp36);
                                auto tmp63 = decltype(tmp59)::blendv(tmp61, tmp59, tmp62.template cast<float,1>());
                                auto tmp64 = decltype(tmp34)::blendv(tmp63, tmp34, tmp17.template cast<float,1>());
                                return tmp64;
                            }
                            ;
                            auto tmp65 = tmp7 ? tmp8() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp66 = static_cast<int64_t>(0);
                            auto tmp67 = tmp66 >= tmp6;
                            auto tmp68 = [&]
                            {
                                auto tmp69 = x3;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(256);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 < tmp73);
                                auto tmp76 = at::vec::VecMask<float,1>::from(tmp67);
                                auto tmp77 = tmp74 & tmp76;
                                auto tmp75 = [&]
                                {
                                    auto tmp78 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp77.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp79 = static_cast<int64_t>(512);
                                    auto tmp80 = at::vec::VectorizedN<int64_t,2>(tmp79);
                                    auto tmp81 = at::vec::VecMask<int64_t,2>(tmp78 < tmp80);
                                    auto tmp83 = tmp81 & tmp77;
                                    auto tmp82 = [&]
                                    {
                                        auto tmp84 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp83.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp85 = at::vec::convert<float>(tmp84);
                                        return tmp85;
                                    }
                                    ;
                                    auto tmp88 =
                                    [&]
                                    {
                                        if (tmp83.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp86 = tmp82();
                                            auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp86)::blendv(tmp87, tmp86, tmp83.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp88;
                                }
                                ;
                                auto tmp91 =
                                [&]
                                {
                                    if (tmp77.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp89 = tmp75();
                                        auto tmp90 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp89)::blendv(tmp90, tmp89, tmp77.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp92 = at::vec::VecMask<float,1>::from(tmp67).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp93 = at::vec::convert<float>(tmp92);
                                auto tmp94 = decltype(tmp91)::blendv(tmp93, tmp91, tmp74.template cast<float,1>());
                                return tmp94;
                            }
                            ;
                            auto tmp95 = tmp67 ? tmp68() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp97 = at::vec::convert<float>(tmp96);
                            auto tmp98 = at::vec::VecMask<float,1>::from(tmp67);
                            auto tmp99 = decltype(tmp95)::blendv(tmp97, tmp95, tmp98.template cast<float,1>());
                            auto tmp100 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp101 = decltype(tmp65)::blendv(tmp99, tmp65, tmp100.template cast<float,1>());
                            auto tmp102 = c10::convert<int64_t>(tmp0);
                            auto tmp103 = tmp102 >= tmp6;
                            auto tmp104 = [&]
                            {
                                auto tmp105 = x3;
                                auto tmp106 = c10::convert<int64_t>(tmp105);
                                auto tmp107 = at::vec::VectorizedN<int64_t,2>::arange(tmp106, 1);
                                auto tmp108 = static_cast<int64_t>(256);
                                auto tmp109 = at::vec::VectorizedN<int64_t,2>(tmp108);
                                auto tmp110 = at::vec::VecMask<int64_t,2>(tmp107 < tmp109);
                                auto tmp112 = at::vec::VecMask<float,1>::from(tmp103);
                                auto tmp113 = tmp110 & tmp112;
                                auto tmp111 = [&]
                                {
                                    auto tmp114 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp113.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp115 = static_cast<int64_t>(512);
                                    auto tmp116 = at::vec::VectorizedN<int64_t,2>(tmp115);
                                    auto tmp117 = at::vec::VecMask<int64_t,2>(tmp114 < tmp116);
                                    auto tmp119 = tmp117 & tmp113;
                                    auto tmp118 = [&]
                                    {
                                        auto tmp120 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp119.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp121 = at::vec::convert<float>(tmp120);
                                        return tmp121;
                                    }
                                    ;
                                    auto tmp124 =
                                    [&]
                                    {
                                        if (tmp119.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp122 = tmp118();
                                            auto tmp123 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp122)::blendv(tmp123, tmp122, tmp119.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp124;
                                }
                                ;
                                auto tmp127 =
                                [&]
                                {
                                    if (tmp113.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp125 = tmp111();
                                        auto tmp126 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp125)::blendv(tmp126, tmp125, tmp113.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp128 = at::vec::VecMask<float,1>::from(tmp103).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp129 = at::vec::convert<float>(tmp128);
                                auto tmp130 = decltype(tmp127)::blendv(tmp129, tmp127, tmp110.template cast<float,1>());
                                return tmp130;
                            }
                            ;
                            auto tmp131 = tmp103 ? tmp104() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp133 = at::vec::convert<float>(tmp132);
                            auto tmp134 = at::vec::VecMask<float,1>::from(tmp103);
                            auto tmp135 = decltype(tmp131)::blendv(tmp133, tmp131, tmp134.template cast<float,1>());
                            auto tmp136 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp137 = decltype(tmp101)::blendv(tmp135, tmp101, tmp136.template cast<float,1>());
                            auto tmp138 = at::vec::convert<bfloat16>(tmp137);
                            tmp138.store(out_ptr1 + static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp68 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                            auto tmp93 = out_ptr0[static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0))];
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = tmp10 >= tmp6;
                                auto tmp12 = static_cast<int64_t>(256);
                                auto tmp13 = tmp10 < tmp12;
                                auto tmp14 = tmp11 & tmp13;
                                auto tmp15 = [&]
                                {
                                    auto tmp16 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp17 = c10::convert<int64_t>(tmp16);
                                    auto tmp18 = static_cast<int64_t>(512);
                                    auto tmp19 = tmp17 < tmp18;
                                    auto tmp20 = [&]
                                    {
                                        auto tmp21 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                        auto tmp22 = c10::convert<float>(tmp21);
                                        return tmp22;
                                    }
                                    ;
                                    auto tmp23 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                                    return tmp23;
                                }
                                ;
                                auto tmp24 = tmp14 ? tmp15() : static_cast<decltype(tmp15())>(0.0);
                                auto tmp25 = static_cast<int64_t>(0);
                                auto tmp26 = tmp25 >= tmp6;
                                auto tmp27 = [&]
                                {
                                    auto tmp28 = [&]
                                    {
                                        auto tmp29 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                        auto tmp30 = c10::convert<int64_t>(tmp29);
                                        auto tmp31 = static_cast<int64_t>(512);
                                        auto tmp32 = tmp30 < tmp31;
                                        auto tmp33 = [&]
                                        {
                                            auto tmp34 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                            auto tmp35 = c10::convert<float>(tmp34);
                                            return tmp35;
                                        }
                                        ;
                                        auto tmp36 = tmp32 ? tmp33() : static_cast<decltype(tmp33())>(0.0);
                                        return tmp36;
                                    }
                                    ;
                                    auto tmp37 = tmp13 ? tmp28() : static_cast<decltype(tmp28())>(0.0);
                                    auto tmp38 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                    auto tmp39 = c10::convert<float>(tmp38);
                                    auto tmp40 = tmp13 ? tmp37 : tmp39;
                                    return tmp40;
                                }
                                ;
                                auto tmp41 = tmp26 ? tmp27() : static_cast<decltype(tmp27())>(0.0);
                                auto tmp42 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp43 = c10::convert<float>(tmp42);
                                auto tmp44 = tmp26 ? tmp41 : tmp43;
                                auto tmp45 = tmp14 ? tmp24 : tmp44;
                                return tmp45;
                            }
                            ;
                            auto tmp46 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp47 = static_cast<int64_t>(0);
                            auto tmp48 = tmp47 >= tmp6;
                            auto tmp49 = [&]
                            {
                                auto tmp50 = x3;
                                auto tmp51 = c10::convert<int64_t>(tmp50);
                                auto tmp52 = static_cast<int64_t>(256);
                                auto tmp53 = tmp51 < tmp52;
                                auto tmp54 = [&]
                                {
                                    auto tmp55 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp56 = c10::convert<int64_t>(tmp55);
                                    auto tmp57 = static_cast<int64_t>(512);
                                    auto tmp58 = tmp56 < tmp57;
                                    auto tmp59 = [&]
                                    {
                                        auto tmp60 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp61 = c10::convert<float>(tmp60);
                                        return tmp61;
                                    }
                                    ;
                                    auto tmp62 = tmp58 ? tmp59() : static_cast<decltype(tmp59())>(0.0);
                                    return tmp62;
                                }
                                ;
                                auto tmp63 = tmp53 ? tmp54() : static_cast<decltype(tmp54())>(0.0);
                                auto tmp64 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp65 = c10::convert<float>(tmp64);
                                auto tmp66 = tmp53 ? tmp63 : tmp65;
                                return tmp66;
                            }
                            ;
                            auto tmp67 = tmp48 ? tmp49() : static_cast<decltype(tmp49())>(0.0);
                            auto tmp69 = c10::convert<float>(tmp68);
                            auto tmp70 = tmp48 ? tmp67 : tmp69;
                            auto tmp71 = tmp7 ? tmp46 : tmp70;
                            auto tmp72 = c10::convert<int64_t>(tmp0);
                            auto tmp73 = tmp72 >= tmp6;
                            auto tmp74 = [&]
                            {
                                auto tmp75 = x3;
                                auto tmp76 = c10::convert<int64_t>(tmp75);
                                auto tmp77 = static_cast<int64_t>(256);
                                auto tmp78 = tmp76 < tmp77;
                                auto tmp79 = [&]
                                {
                                    auto tmp80 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp81 = c10::convert<int64_t>(tmp80);
                                    auto tmp82 = static_cast<int64_t>(512);
                                    auto tmp83 = tmp81 < tmp82;
                                    auto tmp84 = [&]
                                    {
                                        auto tmp85 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp86 = c10::convert<float>(tmp85);
                                        return tmp86;
                                    }
                                    ;
                                    auto tmp87 = tmp83 ? tmp84() : static_cast<decltype(tmp84())>(0.0);
                                    return tmp87;
                                }
                                ;
                                auto tmp88 = tmp78 ? tmp79() : static_cast<decltype(tmp79())>(0.0);
                                auto tmp89 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp90 = c10::convert<float>(tmp89);
                                auto tmp91 = tmp78 ? tmp88 : tmp90;
                                return tmp91;
                            }
                            ;
                            auto tmp92 = tmp73 ? tmp74() : static_cast<decltype(tmp74())>(0.0);
                            auto tmp94 = c10::convert<float>(tmp93);
                            auto tmp95 = tmp73 ? tmp92 : tmp94;
                            auto tmp96 = tmp3 ? tmp71 : tmp95;
                            auto tmp97 = c10::convert<bfloat16>(tmp96);
                            out_ptr1[static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0))] = tmp97;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp93 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)), 16);
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(256);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 >= tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp8 = c10::convert<int64_t>(tmp7);
                            auto tmp9 = at::vec::VectorizedN<int64_t,2>::arange(tmp8, -1);
                            auto tmp10 = static_cast<int64_t>(0);
                            auto tmp11 = at::vec::VectorizedN<int64_t,2>(tmp10);
                            auto tmp12 = at::vec::VecMask<int64_t,2>(tmp9 <= tmp11);
                            auto tmp13 = static_cast<float>(1.0);
                            auto tmp14 = static_cast<float>(0.0);
                            auto tmp15 = at::vec::Vectorized<float>(tmp13);
                            auto tmp16 = at::vec::Vectorized<float>(tmp14);
                            auto tmp17 = decltype(tmp15)::blendv(tmp16, tmp15, tmp12.template cast<float,1>());
                            auto tmp18 = at::vec::VecMask<float,1>::from<float,1>(tmp17);
                            auto tmp19 = 256L + x1;
                            auto tmp20 = c10::convert<int64_t>(tmp19);
                            auto tmp21 = tmp20 < tmp3;
                            auto tmp23 = at::vec::VecMask<float,1>::from(tmp21);
                            auto tmp24 = tmp23 & tmp5;
                            auto tmp22 = [&]
                            {
                                auto tmp25 = static_cast<int64_t>(257);
                                auto tmp26 = at::vec::VectorizedN<int64_t,2>(tmp25);
                                auto tmp27 = at::vec::VecMask<int64_t,2>(tmp2 < tmp26);
                                auto tmp29 = tmp27 & tmp24;
                                auto tmp28 = [&]
                                {
                                    auto tmp30 = 1L + x1 + x2;
                                    auto tmp31 = c10::convert<int64_t>(tmp30);
                                    auto tmp32 = at::vec::VectorizedN<int64_t,2>::arange(tmp31, 1);
                                    auto tmp33 = at::vec::VecMask<int64_t,2>(tmp32 <= tmp11);
                                    auto tmp34 = decltype(tmp15)::blendv(tmp16, tmp15, tmp33.template cast<float,1>());
                                    auto tmp35 = at::vec::VecMask<float,1>::from<float,1>(tmp34);
                                    auto tmp36 = tmp29.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                    auto tmp37 = at::vec::convert<float>(tmp36);
                                    auto tmp38 = -std::numeric_limits<float>::infinity();
                                    auto tmp39 = at::vec::Vectorized<float>(tmp38);
                                    auto tmp40 = decltype(tmp39)::blendv(tmp37, tmp39, tmp35.template cast<float,1>());
                                    return tmp40;
                                }
                                ;
                                auto tmp43 =
                                [&]
                                {
                                    if (tmp29.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp41 = tmp28();
                                        auto tmp42 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp41)::blendv(tmp42, tmp41, tmp29.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp44 = tmp24.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp45 = at::vec::convert<float>(tmp44);
                                auto tmp46 = decltype(tmp43)::blendv(tmp45, tmp43, tmp27.template cast<float,1>());
                                return tmp46;
                            }
                            ;
                            auto tmp49 =
                            [&]
                            {
                                if (tmp24.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp47 = tmp22();
                                    auto tmp48 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp47)::blendv(tmp48, tmp47, tmp24.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp50 = tmp5.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp51 = at::vec::convert<float>(tmp50);
                            auto tmp52 = decltype(tmp49)::blendv(tmp51, tmp49, tmp23.template cast<float,1>());
                            auto tmp53 = -std::numeric_limits<float>::infinity();
                            auto tmp54 = at::vec::Vectorized<float>(tmp53);
                            auto tmp55 = decltype(tmp54)::blendv(tmp52, tmp54, tmp18.template cast<float,1>());
                            return tmp55;
                        }
                        ;
                        auto tmp58 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp56 = tmp6();
                                auto tmp57 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp56)::blendv(tmp57, tmp56, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp59 = 256L + x1;
                        auto tmp60 = c10::convert<int64_t>(tmp59);
                        auto tmp61 = tmp60 < tmp3;
                        auto tmp62 = [&]
                        {
                            auto tmp63 = static_cast<int64_t>(257);
                            auto tmp64 = at::vec::VectorizedN<int64_t,2>(tmp63);
                            auto tmp65 = at::vec::VecMask<int64_t,2>(tmp2 < tmp64);
                            auto tmp67 = at::vec::VecMask<float,1>::from(tmp61);
                            auto tmp68 = tmp65 & tmp67;
                            auto tmp66 = [&]
                            {
                                auto tmp69 = 1L + x1 + x2;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(0);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 <= tmp73);
                                auto tmp75 = static_cast<float>(1.0);
                                auto tmp76 = static_cast<float>(0.0);
                                auto tmp77 = at::vec::Vectorized<float>(tmp75);
                                auto tmp78 = at::vec::Vectorized<float>(tmp76);
                                auto tmp79 = decltype(tmp77)::blendv(tmp78, tmp77, tmp74.template cast<float,1>());
                                auto tmp80 = at::vec::VecMask<float,1>::from<float,1>(tmp79);
                                auto tmp81 = tmp68.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp82 = at::vec::convert<float>(tmp81);
                                auto tmp83 = -std::numeric_limits<float>::infinity();
                                auto tmp84 = at::vec::Vectorized<float>(tmp83);
                                auto tmp85 = decltype(tmp84)::blendv(tmp82, tmp84, tmp80.template cast<float,1>());
                                return tmp85;
                            }
                            ;
                            auto tmp88 =
                            [&]
                            {
                                if (tmp68.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp86 = tmp66();
                                    auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp86)::blendv(tmp87, tmp86, tmp68.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp89 = at::vec::VecMask<float,1>::from(tmp61).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp90 = at::vec::convert<float>(tmp89);
                            auto tmp91 = decltype(tmp88)::blendv(tmp90, tmp88, tmp65.template cast<float,1>());
                            return tmp91;
                        }
                        ;
                        auto tmp92 = tmp61 ? tmp62() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp94 = at::vec::convert<float>(tmp93);
                        auto tmp95 = at::vec::VecMask<float,1>::from(tmp61);
                        auto tmp96 = decltype(tmp92)::blendv(tmp94, tmp92, tmp95.template cast<float,1>());
                        auto tmp97 = decltype(tmp58)::blendv(tmp96, tmp58, tmp5.template cast<float,1>());
                        auto tmp98 = at::vec::convert<bfloat16>(tmp97);
                        tmp98.store(out_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp64 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp6 = c10::convert<int64_t>(tmp5);
                            auto tmp7 = static_cast<int64_t>(0);
                            auto tmp8 = tmp6 <= tmp7;
                            auto tmp9 = static_cast<float>(1.0);
                            auto tmp10 = static_cast<float>(0.0);
                            auto tmp11 = tmp8 ? tmp9 : tmp10;
                            auto tmp12 = c10::convert<bool>(tmp11);
                            auto tmp13 = 256L + x1;
                            auto tmp14 = c10::convert<int64_t>(tmp13);
                            auto tmp15 = tmp14 < tmp2;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = static_cast<int64_t>(257);
                                auto tmp18 = tmp1 < tmp17;
                                auto tmp19 = [&]
                                {
                                    auto tmp20 = 1L + x1 + x2;
                                    auto tmp21 = c10::convert<int64_t>(tmp20);
                                    auto tmp22 = tmp21 <= tmp7;
                                    auto tmp23 = tmp22 ? tmp9 : tmp10;
                                    auto tmp24 = c10::convert<bool>(tmp23);
                                    auto tmp25 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                    auto tmp26 = c10::convert<float>(tmp25);
                                    auto tmp27 = -std::numeric_limits<float>::infinity();
                                    auto tmp28 = tmp24 ? tmp27 : tmp26;
                                    return tmp28;
                                }
                                ;
                                auto tmp29 = tmp18 ? tmp19() : static_cast<decltype(tmp19())>(0.0);
                                auto tmp30 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp31 = c10::convert<float>(tmp30);
                                auto tmp32 = tmp18 ? tmp29 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp34 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp35 = c10::convert<float>(tmp34);
                            auto tmp36 = tmp15 ? tmp33 : tmp35;
                            auto tmp37 = -std::numeric_limits<float>::infinity();
                            auto tmp38 = tmp12 ? tmp37 : tmp36;
                            return tmp38;
                        }
                        ;
                        auto tmp39 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp40 = 256L + x1;
                        auto tmp41 = c10::convert<int64_t>(tmp40);
                        auto tmp42 = tmp41 < tmp2;
                        auto tmp43 = [&]
                        {
                            auto tmp44 = static_cast<int64_t>(257);
                            auto tmp45 = tmp1 < tmp44;
                            auto tmp46 = [&]
                            {
                                auto tmp47 = 1L + x1 + x2;
                                auto tmp48 = c10::convert<int64_t>(tmp47);
                                auto tmp49 = static_cast<int64_t>(0);
                                auto tmp50 = tmp48 <= tmp49;
                                auto tmp51 = static_cast<float>(1.0);
                                auto tmp52 = static_cast<float>(0.0);
                                auto tmp53 = tmp50 ? tmp51 : tmp52;
                                auto tmp54 = c10::convert<bool>(tmp53);
                                auto tmp55 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp56 = c10::convert<float>(tmp55);
                                auto tmp57 = -std::numeric_limits<float>::infinity();
                                auto tmp58 = tmp54 ? tmp57 : tmp56;
                                return tmp58;
                            }
                            ;
                            auto tmp59 = tmp45 ? tmp46() : static_cast<decltype(tmp46())>(0.0);
                            auto tmp60 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp61 = c10::convert<float>(tmp60);
                            auto tmp62 = tmp45 ? tmp59 : tmp61;
                            return tmp62;
                        }
                        ;
                        auto tmp63 = tmp42 ? tmp43() : static_cast<decltype(tmp43())>(0.0);
                        auto tmp65 = c10::convert<float>(tmp64);
                        auto tmp66 = tmp42 ? tmp63 : tmp65;
                        auto tmp67 = tmp3 ? tmp39 : tmp66;
                        auto tmp68 = c10::convert<bfloat16>(tmp67);
                        out_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0))] = tmp68;
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp45 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)), 16);
                        auto tmp83 = at::vec::Vectorized<bfloat16>::loadu(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)), 16);
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr2 + static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0)));
                            auto tmp6 = at::vec::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = at::vec::VectorizedN<int64_t,2>::arange(tmp13, 1);
                            auto tmp15 = static_cast<int64_t>(257);
                            auto tmp16 = at::vec::VectorizedN<int64_t,2>(tmp15);
                            auto tmp17 = at::vec::VecMask<int64_t,2>(tmp14 < tmp16);
                            auto tmp19 = at::vec::VecMask<float,1>::from(tmp10);
                            auto tmp20 = tmp17 & tmp19;
                            auto tmp18 = [&]
                            {
                                auto tmp21 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp22 = c10::convert<int64_t>(tmp21);
                                auto tmp23 = at::vec::VectorizedN<int64_t,2>::arange(tmp22, 1);
                                auto tmp24 = static_cast<int64_t>(0);
                                auto tmp25 = at::vec::VectorizedN<int64_t,2>(tmp24);
                                auto tmp26 = at::vec::VecMask<int64_t,2>(tmp23 <= tmp25);
                                auto tmp27 = static_cast<float>(1.0);
                                auto tmp28 = static_cast<float>(0.0);
                                auto tmp29 = at::vec::Vectorized<float>(tmp27);
                                auto tmp30 = at::vec::Vectorized<float>(tmp28);
                                auto tmp31 = decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                auto tmp32 = at::vec::VecMask<float,1>::from<float,1>(tmp31);
                                auto tmp33 = tmp20.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                                auto tmp34 = at::vec::convert<float>(tmp33);
                                auto tmp35 = -std::numeric_limits<float>::infinity();
                                auto tmp36 = at::vec::Vectorized<float>(tmp35);
                                auto tmp37 = decltype(tmp36)::blendv(tmp34, tmp36, tmp32.template cast<float,1>());
                                return tmp37;
                            }
                            ;
                            auto tmp40 =
                            [&]
                            {
                                if (tmp20.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp38 = tmp18();
                                    auto tmp39 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp38)::blendv(tmp39, tmp38, tmp20.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp41 = at::vec::VecMask<float,1>::from(tmp10).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                            auto tmp42 = at::vec::convert<float>(tmp41);
                            auto tmp43 = decltype(tmp40)::blendv(tmp42, tmp40, tmp17.template cast<float,1>());
                            return tmp43;
                        }
                        ;
                        auto tmp44 = tmp10 ? tmp11() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp46 = at::vec::convert<float>(tmp45);
                        auto tmp47 = at::vec::VecMask<float,1>::from(tmp10);
                        auto tmp48 = decltype(tmp44)::blendv(tmp46, tmp44, tmp47.template cast<float,1>());
                        auto tmp49 = at::vec::VecMask<float,1>::from(tmp3);
                        auto tmp50 = decltype(tmp7)::blendv(tmp48, tmp7, tmp49.template cast<float,1>());
                        auto tmp51 = [&]
                        {
                            auto tmp52 = x2;
                            auto tmp53 = c10::convert<int64_t>(tmp52);
                            auto tmp54 = at::vec::VectorizedN<int64_t,2>::arange(tmp53, 1);
                            auto tmp55 = at::vec::VectorizedN<int64_t,2>(tmp2);
                            auto tmp56 = at::vec::VecMask<int64_t,2>(tmp54 >= tmp55);
                            auto tmp58 = tmp56 & tmp49;
                            auto tmp57 = [&]
                            {
                                auto tmp59 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp60 = c10::convert<int64_t>(tmp59);
                                auto tmp61 = at::vec::VectorizedN<int64_t,2>::arange(tmp60, -1);
                                auto tmp62 = static_cast<int64_t>(0);
                                auto tmp63 = at::vec::VectorizedN<int64_t,2>(tmp62);
                                auto tmp64 = at::vec::VecMask<int64_t,2>(tmp61 <= tmp63);
                                auto tmp65 = static_cast<float>(1.0);
                                auto tmp66 = static_cast<float>(0.0);
                                auto tmp67 = at::vec::Vectorized<float>(tmp65);
                                auto tmp68 = at::vec::Vectorized<float>(tmp66);
                                auto tmp69 = decltype(tmp67)::blendv(tmp68, tmp67, tmp64.template cast<float,1>());
                                auto tmp70 = at::vec::VecMask<float,1>::from<float,1>(tmp69);
                                auto tmp71 = tmp58.template cast<float,1>().template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                                auto tmp72 = at::vec::convert<float>(tmp71);
                                auto tmp73 = -std::numeric_limits<float>::infinity();
                                auto tmp74 = at::vec::Vectorized<float>(tmp73);
                                auto tmp75 = decltype(tmp74)::blendv(tmp72, tmp74, tmp70.template cast<float,1>());
                                return tmp75;
                            }
                            ;
                            auto tmp78 =
                            [&]
                            {
                                if (tmp58.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp76 = tmp57();
                                    auto tmp77 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp76)::blendv(tmp77, tmp76, tmp58.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp79 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                            auto tmp80 = at::vec::convert<float>(tmp79);
                            auto tmp81 = decltype(tmp78)::blendv(tmp80, tmp78, tmp56.template cast<float,1>());
                            return tmp81;
                        }
                        ;
                        auto tmp82 = tmp3 ? tmp51() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp84 = at::vec::convert<float>(tmp83);
                        auto tmp85 = decltype(tmp82)::blendv(tmp84, tmp82, tmp49.template cast<float,1>());
                        auto tmp86 = tmp50 + tmp85;
                        auto tmp87 = at::vec::convert<bfloat16>(tmp86);
                        tmp87.store(out_ptr3 + static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp34 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                        auto tmp60 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = out_ptr2[static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0))];
                            auto tmp6 = c10::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = static_cast<int64_t>(257);
                            auto tmp15 = tmp13 < tmp14;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp18 = c10::convert<int64_t>(tmp17);
                                auto tmp19 = static_cast<int64_t>(0);
                                auto tmp20 = tmp18 <= tmp19;
                                auto tmp21 = static_cast<float>(1.0);
                                auto tmp22 = static_cast<float>(0.0);
                                auto tmp23 = tmp20 ? tmp21 : tmp22;
                                auto tmp24 = c10::convert<bool>(tmp23);
                                auto tmp25 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                                auto tmp26 = c10::convert<float>(tmp25);
                                auto tmp27 = -std::numeric_limits<float>::infinity();
                                auto tmp28 = tmp24 ? tmp27 : tmp26;
                                return tmp28;
                            }
                            ;
                            auto tmp29 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp30 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                            auto tmp31 = c10::convert<float>(tmp30);
                            auto tmp32 = tmp15 ? tmp29 : tmp31;
                            return tmp32;
                        }
                        ;
                        auto tmp33 = tmp10 ? tmp11() : static_cast<decltype(tmp11())>(0.0);
                        auto tmp35 = c10::convert<float>(tmp34);
                        auto tmp36 = tmp10 ? tmp33 : tmp35;
                        auto tmp37 = tmp3 ? tmp7 : tmp36;
                        auto tmp38 = [&]
                        {
                            auto tmp39 = x2;
                            auto tmp40 = c10::convert<int64_t>(tmp39);
                            auto tmp41 = tmp40 >= tmp2;
                            auto tmp42 = [&]
                            {
                                auto tmp43 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp44 = c10::convert<int64_t>(tmp43);
                                auto tmp45 = static_cast<int64_t>(0);
                                auto tmp46 = tmp44 <= tmp45;
                                auto tmp47 = static_cast<float>(1.0);
                                auto tmp48 = static_cast<float>(0.0);
                                auto tmp49 = tmp46 ? tmp47 : tmp48;
                                auto tmp50 = c10::convert<bool>(tmp49);
                                auto tmp51 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                                auto tmp52 = c10::convert<float>(tmp51);
                                auto tmp53 = -std::numeric_limits<float>::infinity();
                                auto tmp54 = tmp50 ? tmp53 : tmp52;
                                return tmp54;
                            }
                            ;
                            auto tmp55 = tmp41 ? tmp42() : static_cast<decltype(tmp42())>(0.0);
                            auto tmp56 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                            auto tmp57 = c10::convert<float>(tmp56);
                            auto tmp58 = tmp41 ? tmp55 : tmp57;
                            return tmp58;
                        }
                        ;
                        auto tmp59 = tmp3 ? tmp38() : static_cast<decltype(tmp38())>(0.0);
                        auto tmp61 = c10::convert<float>(tmp60);
                        auto tmp62 = tmp3 ? tmp59 : tmp61;
                        auto tmp63 = decltype(tmp37)(tmp37 + tmp62);
                        auto tmp64 = c10::convert<bfloat16>(tmp63);
                        out_ptr3[static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1))] = tmp64;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(6144L); x0+=static_cast<int64_t>(1L))
            {
                {
                    float tmp_acc0 = -std::numeric_limits<float>::infinity();
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(-std::numeric_limits<float>::infinity());
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        tmp_acc0_vec = at::vec::maximum(tmp_acc0_vec, tmp1);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp1 = c10::convert<float>(tmp0);
                        tmp_acc0 = max_propagate_nan(tmp_acc0, tmp1);
                    }
                    tmp_acc0 = max_propagate_nan(tmp_acc0, at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return at::vec::maximum(x, y); }, tmp_acc0_vec));
                    out_ptr4[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
                {
                    float tmp_acc0 = 0;
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(0);
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = at::vec::Vectorized<float>(tmp2);
                        auto tmp4 = tmp1 - tmp3;
                        auto tmp5 = tmp4.exp();
                        tmp5.store(out_ptr5 + static_cast<int64_t>(x1 + (513L*x0)));
                        tmp_acc0_vec = tmp_acc0_vec + tmp5;
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = c10::convert<float>(tmp0);
                        auto tmp3 = decltype(tmp1)(tmp1 - tmp2);
                        auto tmp4 = std::exp(tmp3);
                        out_ptr5[static_cast<int64_t>(x1 + (513L*x0))] = tmp4;
                        tmp_acc0 = tmp_acc0 + tmp4;
                    }
                    tmp_acc0 = tmp_acc0 + at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return x + y; }, tmp_acc0_vec);
                    out_ptr6[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
            }
        }
    }
}
''')


cpp_fused_clone_constant_pad_nd_53 = async_compile.cpp_pybinding(['const bfloat16*', 'const bool*', 'const float*', 'const float*', 'bfloat16*', 'bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bool* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(1024L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = (-256L) + x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(0);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = static_cast<int64_t>(512);
                        auto tmp5 = tmp1 < tmp4;
                        auto tmp6 = tmp3 & tmp5;
                        auto tmp7 = [&]
                        {
                            auto tmp8 = at::vec::VecMask<float,1>::from(tmp6).template loadu<bfloat16,1>(in_ptr0 + static_cast<int64_t>((-196608L) + x2 + (64L*x0) + (768L*x1)));
                            auto tmp9 = at::vec::convert<float>(tmp8);
                            return tmp9;
                        }
                        ;
                        auto tmp10 = tmp6 ? tmp7() : at::vec::Vectorized<float>(static_cast<float>(-1.0));
                        auto tmp11 = at::vec::convert<bfloat16>(tmp10);
                        tmp11.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (65536L*x0)), 16);
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(768L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(513);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 < tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp8 = tmp5.template cast<float,1>().template loadu<float,1>(in_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0)));
                            auto tmp9 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp10 = at::vec::Vectorized<float>(tmp9);
                            auto tmp11 = tmp8 / tmp10;
                            auto tmp12 = static_cast<float>(0.0);
                            auto tmp13 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp14 = at::vec::Vectorized<float>(tmp12);
                            auto tmp15 = decltype(tmp14)::blendv(tmp11, tmp14, tmp13.template cast<float,1>());
                            auto tmp16 = (tmp15);
                            return tmp16;
                        }
                        ;
                        auto tmp19 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp17 = tmp6();
                                auto tmp18 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp17)::blendv(tmp18, tmp17, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp20 = at::vec::convert<bfloat16>(tmp19);
                        tmp20.store(out_ptr1 + static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(768L); x2<static_cast<int64_t>(770L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(513);
                        auto tmp3 = tmp1 < tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp6 = in_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0))];
                            auto tmp7 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp8 = tmp6 / tmp7;
                            auto tmp9 = static_cast<float>(0.0);
                            auto tmp10 = tmp5 ? tmp9 : tmp8;
                            auto tmp11 = c10::convert<float>(tmp10);
                            return tmp11;
                        }
                        ;
                        auto tmp12 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp13 = c10::convert<bfloat16>(tmp12);
                        out_ptr1[static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1))] = tmp13;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(49152L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x2 + (16384L*x1) + (65536L*x0)), 32);
                        tmp0.store(out_ptr2 + static_cast<int64_t>(x2 + (49152L*x1) + (98304L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused_clone_54 = async_compile.cpp_pybinding(['const bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       bfloat16* out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x2 + (64L*x0) + (32768L*x1)), 32);
                        tmp0.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (768L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_55 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    auto tmp19 = at::vec::convert<bfloat16>(tmp18);
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                    tmp19.store(out_ptr3 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_56 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<float>::loadu(out_ptr2 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<bfloat16>(tmp0);
                tmp1.store(out_ptr3 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_57 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<float>(tmp0);
                auto tmp2 = static_cast<float>(0.125);
                auto tmp3 = at::vec::Vectorized<float>(tmp2);
                auto tmp4 = tmp1 * tmp3;
                auto tmp5 = at::vec::convert<bfloat16>(tmp4);
                tmp5.store(in_out_ptr0 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_58 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(32L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 32);
                tmp0.store(in_out_ptr0 + static_cast<int64_t>(x0), 32);
            }
        }
    }
}
''')


cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_59 = async_compile.cpp_pybinding(['const bfloat16*', 'const bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'float*', 'float*', 'float*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bfloat16* in_ptr1,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2,
                       bfloat16* out_ptr3,
                       float* out_ptr4,
                       float* out_ptr5,
                       float* out_ptr6)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(2L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = at::vec::VectorizedN<int64_t,2>::arange(tmp5, 1);
                            auto tmp7 = static_cast<int64_t>(256);
                            auto tmp8 = at::vec::VectorizedN<int64_t,2>(tmp7);
                            auto tmp9 = at::vec::VecMask<int64_t,2>(tmp6 >= tmp8);
                            auto tmp10 = [&]
                            {
                                auto tmp11 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                    {
                                        if (tmp9.is_masked(x3_inner))
                                        {
                                            tmpbuf[x3_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp12 = static_cast<int64_t>(512);
                                auto tmp13 = at::vec::VectorizedN<int64_t,2>(tmp12);
                                auto tmp14 = at::vec::VecMask<int64_t,2>(tmp11 < tmp13);
                                auto tmp16 = tmp14 & tmp9;
                                auto tmp15 = [&]
                                {
                                    auto tmp17 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp16.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>(131072L + x3 + x3_inner + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp18 = at::vec::convert<float>(tmp17);
                                    return tmp18;
                                }
                                ;
                                auto tmp21 =
                                [&]
                                {
                                    if (tmp16.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp19 = tmp15();
                                        auto tmp20 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp19)::blendv(tmp20, tmp19, tmp16.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp21;
                            }
                            ;
                            auto tmp24 =
                            [&]
                            {
                                if (tmp9.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp22 = tmp10();
                                    auto tmp23 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp22)::blendv(tmp23, tmp22, tmp9.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp25 = static_cast<int64_t>(1);
                            auto tmp26 = tmp25 < tmp25;
                            auto tmp27 = [&]
                            {
                                auto tmp29 = at::vec::VecMask<float,1>::from(tmp26);
                                auto tmp30 = tmp9 & tmp29;
                                auto tmp28 = [&]
                                {
                                    auto tmp31 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp30.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp32 = static_cast<int64_t>(512);
                                    auto tmp33 = at::vec::VectorizedN<int64_t,2>(tmp32);
                                    auto tmp34 = at::vec::VecMask<int64_t,2>(tmp31 < tmp33);
                                    auto tmp36 = tmp34 & tmp30;
                                    auto tmp35 = [&]
                                    {
                                        auto tmp37 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp36.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp38 = at::vec::convert<float>(tmp37);
                                        return tmp38;
                                    }
                                    ;
                                    auto tmp41 =
                                    [&]
                                    {
                                        if (tmp36.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp39 = tmp35();
                                            auto tmp40 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp39)::blendv(tmp40, tmp39, tmp36.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp41;
                                }
                                ;
                                auto tmp44 =
                                [&]
                                {
                                    if (tmp30.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp42 = tmp28();
                                        auto tmp43 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp42)::blendv(tmp43, tmp42, tmp30.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp45 = static_cast<float>(0.0);
                                auto tmp46 = at::vec::Vectorized<float>(tmp45);
                                auto tmp47 = decltype(tmp44)::blendv(tmp46, tmp44, tmp9.template cast<float,1>());
                                return tmp47;
                            }
                            ;
                            auto tmp48 = tmp26 ? tmp27() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp49 = static_cast<float>(0.0);
                            auto tmp50 = at::vec::VecMask<float,1>::from(tmp26);
                            auto tmp51 = at::vec::Vectorized<float>(tmp49);
                            auto tmp52 = decltype(tmp48)::blendv(tmp51, tmp48, tmp50.template cast<float,1>());
                            auto tmp53 = decltype(tmp24)::blendv(tmp52, tmp24, tmp9.template cast<float,1>());
                            auto tmp54 = c10::convert<int64_t>(tmp0);
                            auto tmp55 = tmp54 < tmp25;
                            auto tmp56 = [&]
                            {
                                auto tmp58 = at::vec::VecMask<float,1>::from(tmp55);
                                auto tmp59 = tmp9 & tmp58;
                                auto tmp57 = [&]
                                {
                                    auto tmp60 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp59.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp61 = static_cast<int64_t>(512);
                                    auto tmp62 = at::vec::VectorizedN<int64_t,2>(tmp61);
                                    auto tmp63 = at::vec::VecMask<int64_t,2>(tmp60 < tmp62);
                                    auto tmp65 = tmp63 & tmp59;
                                    auto tmp64 = [&]
                                    {
                                        auto tmp66 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp65.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp67 = at::vec::convert<float>(tmp66);
                                        return tmp67;
                                    }
                                    ;
                                    auto tmp70 =
                                    [&]
                                    {
                                        if (tmp65.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp68 = tmp64();
                                            auto tmp69 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp68)::blendv(tmp69, tmp68, tmp65.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp70;
                                }
                                ;
                                auto tmp73 =
                                [&]
                                {
                                    if (tmp59.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp71 = tmp57();
                                        auto tmp72 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp71)::blendv(tmp72, tmp71, tmp59.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp74 = decltype(tmp73)::blendv(tmp51, tmp73, tmp9.template cast<float,1>());
                                return tmp74;
                            }
                            ;
                            auto tmp75 = tmp55 ? tmp56() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp76 = at::vec::VecMask<float,1>::from(tmp55);
                            auto tmp77 = decltype(tmp75)::blendv(tmp51, tmp75, tmp76.template cast<float,1>());
                            auto tmp78 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp79 = decltype(tmp53)::blendv(tmp77, tmp53, tmp78.template cast<float,1>());
                            auto tmp80 = at::vec::convert<bfloat16>(tmp79);
                            tmp80.store(out_ptr0 + static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(256);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + (513L*x1))), static_cast<int64_t>(512L)));
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = static_cast<int64_t>(512);
                                auto tmp12 = tmp10 < tmp11;
                                auto tmp13 = [&]
                                {
                                    auto tmp14 = in_ptr0[static_cast<int64_t>(131072L + x3 + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                    auto tmp15 = c10::convert<float>(tmp14);
                                    return tmp15;
                                }
                                ;
                                auto tmp16 = tmp12 ? tmp13() : static_cast<decltype(tmp13())>(0.0);
                                return tmp16;
                            }
                            ;
                            auto tmp17 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp18 = static_cast<int64_t>(1);
                            auto tmp19 = tmp18 < tmp18;
                            auto tmp20 = [&]
                            {
                                auto tmp21 = [&]
                                {
                                    auto tmp22 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp23 = c10::convert<int64_t>(tmp22);
                                    auto tmp24 = static_cast<int64_t>(512);
                                    auto tmp25 = tmp23 < tmp24;
                                    auto tmp26 = [&]
                                    {
                                        auto tmp27 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                        auto tmp28 = c10::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp29 = tmp25 ? tmp26() : static_cast<decltype(tmp26())>(0.0);
                                    return tmp29;
                                }
                                ;
                                auto tmp30 = tmp7 ? tmp21() : static_cast<decltype(tmp21())>(0.0);
                                auto tmp31 = static_cast<float>(0.0);
                                auto tmp32 = tmp7 ? tmp30 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                            auto tmp34 = static_cast<float>(0.0);
                            auto tmp35 = tmp19 ? tmp33 : tmp34;
                            auto tmp36 = tmp7 ? tmp17 : tmp35;
                            auto tmp37 = c10::convert<int64_t>(tmp0);
                            auto tmp38 = tmp37 < tmp18;
                            auto tmp39 = [&]
                            {
                                auto tmp40 = [&]
                                {
                                    auto tmp41 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp42 = c10::convert<int64_t>(tmp41);
                                    auto tmp43 = static_cast<int64_t>(512);
                                    auto tmp44 = tmp42 < tmp43;
                                    auto tmp45 = [&]
                                    {
                                        auto tmp46 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                        auto tmp47 = c10::convert<float>(tmp46);
                                        return tmp47;
                                    }
                                    ;
                                    auto tmp48 = tmp44 ? tmp45() : static_cast<decltype(tmp45())>(0.0);
                                    return tmp48;
                                }
                                ;
                                auto tmp49 = tmp7 ? tmp40() : static_cast<decltype(tmp40())>(0.0);
                                auto tmp50 = tmp7 ? tmp49 : tmp34;
                                return tmp50;
                            }
                            ;
                            auto tmp51 = tmp38 ? tmp39() : static_cast<decltype(tmp39())>(0.0);
                            auto tmp52 = tmp38 ? tmp51 : tmp34;
                            auto tmp53 = tmp3 ? tmp36 : tmp52;
                            auto tmp54 = c10::convert<bfloat16>(tmp53);
                            out_ptr0[static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0))] = tmp54;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(256L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp96 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp132 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = at::vec::VectorizedN<int64_t,2>::arange(tmp10, 1);
                                auto tmp12 = at::vec::VectorizedN<int64_t,2>(tmp6);
                                auto tmp13 = at::vec::VecMask<int64_t,2>(tmp11 >= tmp12);
                                auto tmp14 = static_cast<int64_t>(256);
                                auto tmp15 = at::vec::VectorizedN<int64_t,2>(tmp14);
                                auto tmp16 = at::vec::VecMask<int64_t,2>(tmp11 < tmp15);
                                auto tmp17 = tmp13 & tmp16;
                                auto tmp19 = at::vec::VecMask<float,1>::from(tmp7);
                                auto tmp20 = tmp17 & tmp19;
                                auto tmp18 = [&]
                                {
                                    auto tmp21 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp20.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp22 = static_cast<int64_t>(512);
                                    auto tmp23 = at::vec::VectorizedN<int64_t,2>(tmp22);
                                    auto tmp24 = at::vec::VecMask<int64_t,2>(tmp21 < tmp23);
                                    auto tmp26 = tmp24 & tmp20;
                                    auto tmp25 = [&]
                                    {
                                        auto tmp27 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp26.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp28 = at::vec::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp31 =
                                    [&]
                                    {
                                        if (tmp26.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp29 = tmp25();
                                            auto tmp30 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp31;
                                }
                                ;
                                auto tmp34 =
                                [&]
                                {
                                    if (tmp20.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp32 = tmp18();
                                        auto tmp33 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp32)::blendv(tmp33, tmp32, tmp20.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp35 = static_cast<int64_t>(0);
                                auto tmp36 = tmp35 >= tmp6;
                                auto tmp38 = tmp36 & tmp7;
                                auto tmp37 = [&]
                                {
                                    auto tmp40 = at::vec::VecMask<float,1>::from(tmp38);
                                    auto tmp41 = tmp16 & tmp40;
                                    auto tmp39 = [&]
                                    {
                                        auto tmp42 =
                                        [&]
                                        {
                                            __at_align__ std::array<int64_t, 16> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp41.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                                }
                                            }
                                            return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp43 = static_cast<int64_t>(512);
                                        auto tmp44 = at::vec::VectorizedN<int64_t,2>(tmp43);
                                        auto tmp45 = at::vec::VecMask<int64_t,2>(tmp42 < tmp44);
                                        auto tmp47 = tmp45 & tmp41;
                                        auto tmp46 = [&]
                                        {
                                            auto tmp48 =
                                            [&]
                                            {
                                                __at_align__ std::array<bfloat16, 32> tmpbuf;
                                                #pragma GCC unroll 16
                                                for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                                {
                                                    if (tmp47.is_masked(x3_inner))
                                                    {
                                                        tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                    }
                                                }
                                                return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                            }
                                            ()
                                            ;
                                            auto tmp49 = at::vec::convert<float>(tmp48);
                                            return tmp49;
                                        }
                                        ;
                                        auto tmp52 =
                                        [&]
                                        {
                                            if (tmp47.all_zero())
                                            {
                                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            }
                                            else
                                            {
                                                auto tmp50 = tmp46();
                                                auto tmp51 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                                return decltype(tmp50)::blendv(tmp51, tmp50, tmp47.template cast<float,1>());
                                            }
                                        }
                                        ()
                                        ;
                                        return tmp52;
                                    }
                                    ;
                                    auto tmp55 =
                                    [&]
                                    {
                                        if (tmp41.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp53 = tmp39();
                                            auto tmp54 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp53)::blendv(tmp54, tmp53, tmp41.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    auto tmp56 = at::vec::VecMask<float,1>::from(tmp38).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                    auto tmp57 = at::vec::convert<float>(tmp56);
                                    auto tmp58 = decltype(tmp55)::blendv(tmp57, tmp55, tmp16.template cast<float,1>());
                                    return tmp58;
                                }
                                ;
                                auto tmp59 = tmp36 ? tmp37() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                                auto tmp60 = at::vec::VecMask<float,1>::from(tmp7).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp61 = at::vec::convert<float>(tmp60);
                                auto tmp62 = at::vec::VecMask<float,1>::from(tmp36);
                                auto tmp63 = decltype(tmp59)::blendv(tmp61, tmp59, tmp62.template cast<float,1>());
                                auto tmp64 = decltype(tmp34)::blendv(tmp63, tmp34, tmp17.template cast<float,1>());
                                return tmp64;
                            }
                            ;
                            auto tmp65 = tmp7 ? tmp8() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp66 = static_cast<int64_t>(0);
                            auto tmp67 = tmp66 >= tmp6;
                            auto tmp68 = [&]
                            {
                                auto tmp69 = x3;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(256);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 < tmp73);
                                auto tmp76 = at::vec::VecMask<float,1>::from(tmp67);
                                auto tmp77 = tmp74 & tmp76;
                                auto tmp75 = [&]
                                {
                                    auto tmp78 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp77.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp79 = static_cast<int64_t>(512);
                                    auto tmp80 = at::vec::VectorizedN<int64_t,2>(tmp79);
                                    auto tmp81 = at::vec::VecMask<int64_t,2>(tmp78 < tmp80);
                                    auto tmp83 = tmp81 & tmp77;
                                    auto tmp82 = [&]
                                    {
                                        auto tmp84 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp83.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp85 = at::vec::convert<float>(tmp84);
                                        return tmp85;
                                    }
                                    ;
                                    auto tmp88 =
                                    [&]
                                    {
                                        if (tmp83.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp86 = tmp82();
                                            auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp86)::blendv(tmp87, tmp86, tmp83.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp88;
                                }
                                ;
                                auto tmp91 =
                                [&]
                                {
                                    if (tmp77.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp89 = tmp75();
                                        auto tmp90 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp89)::blendv(tmp90, tmp89, tmp77.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp92 = at::vec::VecMask<float,1>::from(tmp67).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp93 = at::vec::convert<float>(tmp92);
                                auto tmp94 = decltype(tmp91)::blendv(tmp93, tmp91, tmp74.template cast<float,1>());
                                return tmp94;
                            }
                            ;
                            auto tmp95 = tmp67 ? tmp68() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp97 = at::vec::convert<float>(tmp96);
                            auto tmp98 = at::vec::VecMask<float,1>::from(tmp67);
                            auto tmp99 = decltype(tmp95)::blendv(tmp97, tmp95, tmp98.template cast<float,1>());
                            auto tmp100 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp101 = decltype(tmp65)::blendv(tmp99, tmp65, tmp100.template cast<float,1>());
                            auto tmp102 = c10::convert<int64_t>(tmp0);
                            auto tmp103 = tmp102 >= tmp6;
                            auto tmp104 = [&]
                            {
                                auto tmp105 = x3;
                                auto tmp106 = c10::convert<int64_t>(tmp105);
                                auto tmp107 = at::vec::VectorizedN<int64_t,2>::arange(tmp106, 1);
                                auto tmp108 = static_cast<int64_t>(256);
                                auto tmp109 = at::vec::VectorizedN<int64_t,2>(tmp108);
                                auto tmp110 = at::vec::VecMask<int64_t,2>(tmp107 < tmp109);
                                auto tmp112 = at::vec::VecMask<float,1>::from(tmp103);
                                auto tmp113 = tmp110 & tmp112;
                                auto tmp111 = [&]
                                {
                                    auto tmp114 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp113.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp115 = static_cast<int64_t>(512);
                                    auto tmp116 = at::vec::VectorizedN<int64_t,2>(tmp115);
                                    auto tmp117 = at::vec::VecMask<int64_t,2>(tmp114 < tmp116);
                                    auto tmp119 = tmp117 & tmp113;
                                    auto tmp118 = [&]
                                    {
                                        auto tmp120 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp119.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp121 = at::vec::convert<float>(tmp120);
                                        return tmp121;
                                    }
                                    ;
                                    auto tmp124 =
                                    [&]
                                    {
                                        if (tmp119.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp122 = tmp118();
                                            auto tmp123 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp122)::blendv(tmp123, tmp122, tmp119.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp124;
                                }
                                ;
                                auto tmp127 =
                                [&]
                                {
                                    if (tmp113.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp125 = tmp111();
                                        auto tmp126 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp125)::blendv(tmp126, tmp125, tmp113.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp128 = at::vec::VecMask<float,1>::from(tmp103).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp129 = at::vec::convert<float>(tmp128);
                                auto tmp130 = decltype(tmp127)::blendv(tmp129, tmp127, tmp110.template cast<float,1>());
                                return tmp130;
                            }
                            ;
                            auto tmp131 = tmp103 ? tmp104() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp133 = at::vec::convert<float>(tmp132);
                            auto tmp134 = at::vec::VecMask<float,1>::from(tmp103);
                            auto tmp135 = decltype(tmp131)::blendv(tmp133, tmp131, tmp134.template cast<float,1>());
                            auto tmp136 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp137 = decltype(tmp101)::blendv(tmp135, tmp101, tmp136.template cast<float,1>());
                            auto tmp138 = at::vec::convert<bfloat16>(tmp137);
                            tmp138.store(out_ptr1 + static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp68 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                            auto tmp93 = out_ptr0[static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0))];
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = tmp10 >= tmp6;
                                auto tmp12 = static_cast<int64_t>(256);
                                auto tmp13 = tmp10 < tmp12;
                                auto tmp14 = tmp11 & tmp13;
                                auto tmp15 = [&]
                                {
                                    auto tmp16 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp17 = c10::convert<int64_t>(tmp16);
                                    auto tmp18 = static_cast<int64_t>(512);
                                    auto tmp19 = tmp17 < tmp18;
                                    auto tmp20 = [&]
                                    {
                                        auto tmp21 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                        auto tmp22 = c10::convert<float>(tmp21);
                                        return tmp22;
                                    }
                                    ;
                                    auto tmp23 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                                    return tmp23;
                                }
                                ;
                                auto tmp24 = tmp14 ? tmp15() : static_cast<decltype(tmp15())>(0.0);
                                auto tmp25 = static_cast<int64_t>(0);
                                auto tmp26 = tmp25 >= tmp6;
                                auto tmp27 = [&]
                                {
                                    auto tmp28 = [&]
                                    {
                                        auto tmp29 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                        auto tmp30 = c10::convert<int64_t>(tmp29);
                                        auto tmp31 = static_cast<int64_t>(512);
                                        auto tmp32 = tmp30 < tmp31;
                                        auto tmp33 = [&]
                                        {
                                            auto tmp34 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                            auto tmp35 = c10::convert<float>(tmp34);
                                            return tmp35;
                                        }
                                        ;
                                        auto tmp36 = tmp32 ? tmp33() : static_cast<decltype(tmp33())>(0.0);
                                        return tmp36;
                                    }
                                    ;
                                    auto tmp37 = tmp13 ? tmp28() : static_cast<decltype(tmp28())>(0.0);
                                    auto tmp38 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                    auto tmp39 = c10::convert<float>(tmp38);
                                    auto tmp40 = tmp13 ? tmp37 : tmp39;
                                    return tmp40;
                                }
                                ;
                                auto tmp41 = tmp26 ? tmp27() : static_cast<decltype(tmp27())>(0.0);
                                auto tmp42 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp43 = c10::convert<float>(tmp42);
                                auto tmp44 = tmp26 ? tmp41 : tmp43;
                                auto tmp45 = tmp14 ? tmp24 : tmp44;
                                return tmp45;
                            }
                            ;
                            auto tmp46 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp47 = static_cast<int64_t>(0);
                            auto tmp48 = tmp47 >= tmp6;
                            auto tmp49 = [&]
                            {
                                auto tmp50 = x3;
                                auto tmp51 = c10::convert<int64_t>(tmp50);
                                auto tmp52 = static_cast<int64_t>(256);
                                auto tmp53 = tmp51 < tmp52;
                                auto tmp54 = [&]
                                {
                                    auto tmp55 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp56 = c10::convert<int64_t>(tmp55);
                                    auto tmp57 = static_cast<int64_t>(512);
                                    auto tmp58 = tmp56 < tmp57;
                                    auto tmp59 = [&]
                                    {
                                        auto tmp60 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp61 = c10::convert<float>(tmp60);
                                        return tmp61;
                                    }
                                    ;
                                    auto tmp62 = tmp58 ? tmp59() : static_cast<decltype(tmp59())>(0.0);
                                    return tmp62;
                                }
                                ;
                                auto tmp63 = tmp53 ? tmp54() : static_cast<decltype(tmp54())>(0.0);
                                auto tmp64 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp65 = c10::convert<float>(tmp64);
                                auto tmp66 = tmp53 ? tmp63 : tmp65;
                                return tmp66;
                            }
                            ;
                            auto tmp67 = tmp48 ? tmp49() : static_cast<decltype(tmp49())>(0.0);
                            auto tmp69 = c10::convert<float>(tmp68);
                            auto tmp70 = tmp48 ? tmp67 : tmp69;
                            auto tmp71 = tmp7 ? tmp46 : tmp70;
                            auto tmp72 = c10::convert<int64_t>(tmp0);
                            auto tmp73 = tmp72 >= tmp6;
                            auto tmp74 = [&]
                            {
                                auto tmp75 = x3;
                                auto tmp76 = c10::convert<int64_t>(tmp75);
                                auto tmp77 = static_cast<int64_t>(256);
                                auto tmp78 = tmp76 < tmp77;
                                auto tmp79 = [&]
                                {
                                    auto tmp80 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp81 = c10::convert<int64_t>(tmp80);
                                    auto tmp82 = static_cast<int64_t>(512);
                                    auto tmp83 = tmp81 < tmp82;
                                    auto tmp84 = [&]
                                    {
                                        auto tmp85 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp86 = c10::convert<float>(tmp85);
                                        return tmp86;
                                    }
                                    ;
                                    auto tmp87 = tmp83 ? tmp84() : static_cast<decltype(tmp84())>(0.0);
                                    return tmp87;
                                }
                                ;
                                auto tmp88 = tmp78 ? tmp79() : static_cast<decltype(tmp79())>(0.0);
                                auto tmp89 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp90 = c10::convert<float>(tmp89);
                                auto tmp91 = tmp78 ? tmp88 : tmp90;
                                return tmp91;
                            }
                            ;
                            auto tmp92 = tmp73 ? tmp74() : static_cast<decltype(tmp74())>(0.0);
                            auto tmp94 = c10::convert<float>(tmp93);
                            auto tmp95 = tmp73 ? tmp92 : tmp94;
                            auto tmp96 = tmp3 ? tmp71 : tmp95;
                            auto tmp97 = c10::convert<bfloat16>(tmp96);
                            out_ptr1[static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0))] = tmp97;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp93 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)), 16);
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(256);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 >= tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp8 = c10::convert<int64_t>(tmp7);
                            auto tmp9 = at::vec::VectorizedN<int64_t,2>::arange(tmp8, -1);
                            auto tmp10 = static_cast<int64_t>(0);
                            auto tmp11 = at::vec::VectorizedN<int64_t,2>(tmp10);
                            auto tmp12 = at::vec::VecMask<int64_t,2>(tmp9 <= tmp11);
                            auto tmp13 = static_cast<float>(1.0);
                            auto tmp14 = static_cast<float>(0.0);
                            auto tmp15 = at::vec::Vectorized<float>(tmp13);
                            auto tmp16 = at::vec::Vectorized<float>(tmp14);
                            auto tmp17 = decltype(tmp15)::blendv(tmp16, tmp15, tmp12.template cast<float,1>());
                            auto tmp18 = at::vec::VecMask<float,1>::from<float,1>(tmp17);
                            auto tmp19 = 256L + x1;
                            auto tmp20 = c10::convert<int64_t>(tmp19);
                            auto tmp21 = tmp20 < tmp3;
                            auto tmp23 = at::vec::VecMask<float,1>::from(tmp21);
                            auto tmp24 = tmp23 & tmp5;
                            auto tmp22 = [&]
                            {
                                auto tmp25 = static_cast<int64_t>(257);
                                auto tmp26 = at::vec::VectorizedN<int64_t,2>(tmp25);
                                auto tmp27 = at::vec::VecMask<int64_t,2>(tmp2 < tmp26);
                                auto tmp29 = tmp27 & tmp24;
                                auto tmp28 = [&]
                                {
                                    auto tmp30 = 1L + x1 + x2;
                                    auto tmp31 = c10::convert<int64_t>(tmp30);
                                    auto tmp32 = at::vec::VectorizedN<int64_t,2>::arange(tmp31, 1);
                                    auto tmp33 = at::vec::VecMask<int64_t,2>(tmp32 <= tmp11);
                                    auto tmp34 = decltype(tmp15)::blendv(tmp16, tmp15, tmp33.template cast<float,1>());
                                    auto tmp35 = at::vec::VecMask<float,1>::from<float,1>(tmp34);
                                    auto tmp36 = tmp29.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                    auto tmp37 = at::vec::convert<float>(tmp36);
                                    auto tmp38 = -std::numeric_limits<float>::infinity();
                                    auto tmp39 = at::vec::Vectorized<float>(tmp38);
                                    auto tmp40 = decltype(tmp39)::blendv(tmp37, tmp39, tmp35.template cast<float,1>());
                                    return tmp40;
                                }
                                ;
                                auto tmp43 =
                                [&]
                                {
                                    if (tmp29.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp41 = tmp28();
                                        auto tmp42 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp41)::blendv(tmp42, tmp41, tmp29.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp44 = tmp24.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp45 = at::vec::convert<float>(tmp44);
                                auto tmp46 = decltype(tmp43)::blendv(tmp45, tmp43, tmp27.template cast<float,1>());
                                return tmp46;
                            }
                            ;
                            auto tmp49 =
                            [&]
                            {
                                if (tmp24.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp47 = tmp22();
                                    auto tmp48 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp47)::blendv(tmp48, tmp47, tmp24.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp50 = tmp5.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp51 = at::vec::convert<float>(tmp50);
                            auto tmp52 = decltype(tmp49)::blendv(tmp51, tmp49, tmp23.template cast<float,1>());
                            auto tmp53 = -std::numeric_limits<float>::infinity();
                            auto tmp54 = at::vec::Vectorized<float>(tmp53);
                            auto tmp55 = decltype(tmp54)::blendv(tmp52, tmp54, tmp18.template cast<float,1>());
                            return tmp55;
                        }
                        ;
                        auto tmp58 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp56 = tmp6();
                                auto tmp57 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp56)::blendv(tmp57, tmp56, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp59 = 256L + x1;
                        auto tmp60 = c10::convert<int64_t>(tmp59);
                        auto tmp61 = tmp60 < tmp3;
                        auto tmp62 = [&]
                        {
                            auto tmp63 = static_cast<int64_t>(257);
                            auto tmp64 = at::vec::VectorizedN<int64_t,2>(tmp63);
                            auto tmp65 = at::vec::VecMask<int64_t,2>(tmp2 < tmp64);
                            auto tmp67 = at::vec::VecMask<float,1>::from(tmp61);
                            auto tmp68 = tmp65 & tmp67;
                            auto tmp66 = [&]
                            {
                                auto tmp69 = 1L + x1 + x2;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(0);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 <= tmp73);
                                auto tmp75 = static_cast<float>(1.0);
                                auto tmp76 = static_cast<float>(0.0);
                                auto tmp77 = at::vec::Vectorized<float>(tmp75);
                                auto tmp78 = at::vec::Vectorized<float>(tmp76);
                                auto tmp79 = decltype(tmp77)::blendv(tmp78, tmp77, tmp74.template cast<float,1>());
                                auto tmp80 = at::vec::VecMask<float,1>::from<float,1>(tmp79);
                                auto tmp81 = tmp68.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp82 = at::vec::convert<float>(tmp81);
                                auto tmp83 = -std::numeric_limits<float>::infinity();
                                auto tmp84 = at::vec::Vectorized<float>(tmp83);
                                auto tmp85 = decltype(tmp84)::blendv(tmp82, tmp84, tmp80.template cast<float,1>());
                                return tmp85;
                            }
                            ;
                            auto tmp88 =
                            [&]
                            {
                                if (tmp68.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp86 = tmp66();
                                    auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp86)::blendv(tmp87, tmp86, tmp68.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp89 = at::vec::VecMask<float,1>::from(tmp61).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp90 = at::vec::convert<float>(tmp89);
                            auto tmp91 = decltype(tmp88)::blendv(tmp90, tmp88, tmp65.template cast<float,1>());
                            return tmp91;
                        }
                        ;
                        auto tmp92 = tmp61 ? tmp62() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp94 = at::vec::convert<float>(tmp93);
                        auto tmp95 = at::vec::VecMask<float,1>::from(tmp61);
                        auto tmp96 = decltype(tmp92)::blendv(tmp94, tmp92, tmp95.template cast<float,1>());
                        auto tmp97 = decltype(tmp58)::blendv(tmp96, tmp58, tmp5.template cast<float,1>());
                        auto tmp98 = at::vec::convert<bfloat16>(tmp97);
                        tmp98.store(out_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp64 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp6 = c10::convert<int64_t>(tmp5);
                            auto tmp7 = static_cast<int64_t>(0);
                            auto tmp8 = tmp6 <= tmp7;
                            auto tmp9 = static_cast<float>(1.0);
                            auto tmp10 = static_cast<float>(0.0);
                            auto tmp11 = tmp8 ? tmp9 : tmp10;
                            auto tmp12 = c10::convert<bool>(tmp11);
                            auto tmp13 = 256L + x1;
                            auto tmp14 = c10::convert<int64_t>(tmp13);
                            auto tmp15 = tmp14 < tmp2;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = static_cast<int64_t>(257);
                                auto tmp18 = tmp1 < tmp17;
                                auto tmp19 = [&]
                                {
                                    auto tmp20 = 1L + x1 + x2;
                                    auto tmp21 = c10::convert<int64_t>(tmp20);
                                    auto tmp22 = tmp21 <= tmp7;
                                    auto tmp23 = tmp22 ? tmp9 : tmp10;
                                    auto tmp24 = c10::convert<bool>(tmp23);
                                    auto tmp25 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                    auto tmp26 = c10::convert<float>(tmp25);
                                    auto tmp27 = -std::numeric_limits<float>::infinity();
                                    auto tmp28 = tmp24 ? tmp27 : tmp26;
                                    return tmp28;
                                }
                                ;
                                auto tmp29 = tmp18 ? tmp19() : static_cast<decltype(tmp19())>(0.0);
                                auto tmp30 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp31 = c10::convert<float>(tmp30);
                                auto tmp32 = tmp18 ? tmp29 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp34 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp35 = c10::convert<float>(tmp34);
                            auto tmp36 = tmp15 ? tmp33 : tmp35;
                            auto tmp37 = -std::numeric_limits<float>::infinity();
                            auto tmp38 = tmp12 ? tmp37 : tmp36;
                            return tmp38;
                        }
                        ;
                        auto tmp39 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp40 = 256L + x1;
                        auto tmp41 = c10::convert<int64_t>(tmp40);
                        auto tmp42 = tmp41 < tmp2;
                        auto tmp43 = [&]
                        {
                            auto tmp44 = static_cast<int64_t>(257);
                            auto tmp45 = tmp1 < tmp44;
                            auto tmp46 = [&]
                            {
                                auto tmp47 = 1L + x1 + x2;
                                auto tmp48 = c10::convert<int64_t>(tmp47);
                                auto tmp49 = static_cast<int64_t>(0);
                                auto tmp50 = tmp48 <= tmp49;
                                auto tmp51 = static_cast<float>(1.0);
                                auto tmp52 = static_cast<float>(0.0);
                                auto tmp53 = tmp50 ? tmp51 : tmp52;
                                auto tmp54 = c10::convert<bool>(tmp53);
                                auto tmp55 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp56 = c10::convert<float>(tmp55);
                                auto tmp57 = -std::numeric_limits<float>::infinity();
                                auto tmp58 = tmp54 ? tmp57 : tmp56;
                                return tmp58;
                            }
                            ;
                            auto tmp59 = tmp45 ? tmp46() : static_cast<decltype(tmp46())>(0.0);
                            auto tmp60 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp61 = c10::convert<float>(tmp60);
                            auto tmp62 = tmp45 ? tmp59 : tmp61;
                            return tmp62;
                        }
                        ;
                        auto tmp63 = tmp42 ? tmp43() : static_cast<decltype(tmp43())>(0.0);
                        auto tmp65 = c10::convert<float>(tmp64);
                        auto tmp66 = tmp42 ? tmp63 : tmp65;
                        auto tmp67 = tmp3 ? tmp39 : tmp66;
                        auto tmp68 = c10::convert<bfloat16>(tmp67);
                        out_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0))] = tmp68;
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp45 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)), 16);
                        auto tmp83 = at::vec::Vectorized<bfloat16>::loadu(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)), 16);
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr2 + static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0)));
                            auto tmp6 = at::vec::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = at::vec::VectorizedN<int64_t,2>::arange(tmp13, 1);
                            auto tmp15 = static_cast<int64_t>(257);
                            auto tmp16 = at::vec::VectorizedN<int64_t,2>(tmp15);
                            auto tmp17 = at::vec::VecMask<int64_t,2>(tmp14 < tmp16);
                            auto tmp19 = at::vec::VecMask<float,1>::from(tmp10);
                            auto tmp20 = tmp17 & tmp19;
                            auto tmp18 = [&]
                            {
                                auto tmp21 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp22 = c10::convert<int64_t>(tmp21);
                                auto tmp23 = at::vec::VectorizedN<int64_t,2>::arange(tmp22, 1);
                                auto tmp24 = static_cast<int64_t>(0);
                                auto tmp25 = at::vec::VectorizedN<int64_t,2>(tmp24);
                                auto tmp26 = at::vec::VecMask<int64_t,2>(tmp23 <= tmp25);
                                auto tmp27 = static_cast<float>(1.0);
                                auto tmp28 = static_cast<float>(0.0);
                                auto tmp29 = at::vec::Vectorized<float>(tmp27);
                                auto tmp30 = at::vec::Vectorized<float>(tmp28);
                                auto tmp31 = decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                auto tmp32 = at::vec::VecMask<float,1>::from<float,1>(tmp31);
                                auto tmp33 = tmp20.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                                auto tmp34 = at::vec::convert<float>(tmp33);
                                auto tmp35 = -std::numeric_limits<float>::infinity();
                                auto tmp36 = at::vec::Vectorized<float>(tmp35);
                                auto tmp37 = decltype(tmp36)::blendv(tmp34, tmp36, tmp32.template cast<float,1>());
                                return tmp37;
                            }
                            ;
                            auto tmp40 =
                            [&]
                            {
                                if (tmp20.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp38 = tmp18();
                                    auto tmp39 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp38)::blendv(tmp39, tmp38, tmp20.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp41 = at::vec::VecMask<float,1>::from(tmp10).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                            auto tmp42 = at::vec::convert<float>(tmp41);
                            auto tmp43 = decltype(tmp40)::blendv(tmp42, tmp40, tmp17.template cast<float,1>());
                            return tmp43;
                        }
                        ;
                        auto tmp44 = tmp10 ? tmp11() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp46 = at::vec::convert<float>(tmp45);
                        auto tmp47 = at::vec::VecMask<float,1>::from(tmp10);
                        auto tmp48 = decltype(tmp44)::blendv(tmp46, tmp44, tmp47.template cast<float,1>());
                        auto tmp49 = at::vec::VecMask<float,1>::from(tmp3);
                        auto tmp50 = decltype(tmp7)::blendv(tmp48, tmp7, tmp49.template cast<float,1>());
                        auto tmp51 = [&]
                        {
                            auto tmp52 = x2;
                            auto tmp53 = c10::convert<int64_t>(tmp52);
                            auto tmp54 = at::vec::VectorizedN<int64_t,2>::arange(tmp53, 1);
                            auto tmp55 = at::vec::VectorizedN<int64_t,2>(tmp2);
                            auto tmp56 = at::vec::VecMask<int64_t,2>(tmp54 >= tmp55);
                            auto tmp58 = tmp56 & tmp49;
                            auto tmp57 = [&]
                            {
                                auto tmp59 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp60 = c10::convert<int64_t>(tmp59);
                                auto tmp61 = at::vec::VectorizedN<int64_t,2>::arange(tmp60, -1);
                                auto tmp62 = static_cast<int64_t>(0);
                                auto tmp63 = at::vec::VectorizedN<int64_t,2>(tmp62);
                                auto tmp64 = at::vec::VecMask<int64_t,2>(tmp61 <= tmp63);
                                auto tmp65 = static_cast<float>(1.0);
                                auto tmp66 = static_cast<float>(0.0);
                                auto tmp67 = at::vec::Vectorized<float>(tmp65);
                                auto tmp68 = at::vec::Vectorized<float>(tmp66);
                                auto tmp69 = decltype(tmp67)::blendv(tmp68, tmp67, tmp64.template cast<float,1>());
                                auto tmp70 = at::vec::VecMask<float,1>::from<float,1>(tmp69);
                                auto tmp71 = tmp58.template cast<float,1>().template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                                auto tmp72 = at::vec::convert<float>(tmp71);
                                auto tmp73 = -std::numeric_limits<float>::infinity();
                                auto tmp74 = at::vec::Vectorized<float>(tmp73);
                                auto tmp75 = decltype(tmp74)::blendv(tmp72, tmp74, tmp70.template cast<float,1>());
                                return tmp75;
                            }
                            ;
                            auto tmp78 =
                            [&]
                            {
                                if (tmp58.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp76 = tmp57();
                                    auto tmp77 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp76)::blendv(tmp77, tmp76, tmp58.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp79 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                            auto tmp80 = at::vec::convert<float>(tmp79);
                            auto tmp81 = decltype(tmp78)::blendv(tmp80, tmp78, tmp56.template cast<float,1>());
                            return tmp81;
                        }
                        ;
                        auto tmp82 = tmp3 ? tmp51() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp84 = at::vec::convert<float>(tmp83);
                        auto tmp85 = decltype(tmp82)::blendv(tmp84, tmp82, tmp49.template cast<float,1>());
                        auto tmp86 = tmp50 + tmp85;
                        auto tmp87 = at::vec::convert<bfloat16>(tmp86);
                        tmp87.store(out_ptr3 + static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp34 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                        auto tmp60 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = out_ptr2[static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0))];
                            auto tmp6 = c10::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = static_cast<int64_t>(257);
                            auto tmp15 = tmp13 < tmp14;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp18 = c10::convert<int64_t>(tmp17);
                                auto tmp19 = static_cast<int64_t>(0);
                                auto tmp20 = tmp18 <= tmp19;
                                auto tmp21 = static_cast<float>(1.0);
                                auto tmp22 = static_cast<float>(0.0);
                                auto tmp23 = tmp20 ? tmp21 : tmp22;
                                auto tmp24 = c10::convert<bool>(tmp23);
                                auto tmp25 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                                auto tmp26 = c10::convert<float>(tmp25);
                                auto tmp27 = -std::numeric_limits<float>::infinity();
                                auto tmp28 = tmp24 ? tmp27 : tmp26;
                                return tmp28;
                            }
                            ;
                            auto tmp29 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp30 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                            auto tmp31 = c10::convert<float>(tmp30);
                            auto tmp32 = tmp15 ? tmp29 : tmp31;
                            return tmp32;
                        }
                        ;
                        auto tmp33 = tmp10 ? tmp11() : static_cast<decltype(tmp11())>(0.0);
                        auto tmp35 = c10::convert<float>(tmp34);
                        auto tmp36 = tmp10 ? tmp33 : tmp35;
                        auto tmp37 = tmp3 ? tmp7 : tmp36;
                        auto tmp38 = [&]
                        {
                            auto tmp39 = x2;
                            auto tmp40 = c10::convert<int64_t>(tmp39);
                            auto tmp41 = tmp40 >= tmp2;
                            auto tmp42 = [&]
                            {
                                auto tmp43 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp44 = c10::convert<int64_t>(tmp43);
                                auto tmp45 = static_cast<int64_t>(0);
                                auto tmp46 = tmp44 <= tmp45;
                                auto tmp47 = static_cast<float>(1.0);
                                auto tmp48 = static_cast<float>(0.0);
                                auto tmp49 = tmp46 ? tmp47 : tmp48;
                                auto tmp50 = c10::convert<bool>(tmp49);
                                auto tmp51 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                                auto tmp52 = c10::convert<float>(tmp51);
                                auto tmp53 = -std::numeric_limits<float>::infinity();
                                auto tmp54 = tmp50 ? tmp53 : tmp52;
                                return tmp54;
                            }
                            ;
                            auto tmp55 = tmp41 ? tmp42() : static_cast<decltype(tmp42())>(0.0);
                            auto tmp56 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                            auto tmp57 = c10::convert<float>(tmp56);
                            auto tmp58 = tmp41 ? tmp55 : tmp57;
                            return tmp58;
                        }
                        ;
                        auto tmp59 = tmp3 ? tmp38() : static_cast<decltype(tmp38())>(0.0);
                        auto tmp61 = c10::convert<float>(tmp60);
                        auto tmp62 = tmp3 ? tmp59 : tmp61;
                        auto tmp63 = decltype(tmp37)(tmp37 + tmp62);
                        auto tmp64 = c10::convert<bfloat16>(tmp63);
                        out_ptr3[static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1))] = tmp64;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(6144L); x0+=static_cast<int64_t>(1L))
            {
                {
                    float tmp_acc0 = -std::numeric_limits<float>::infinity();
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(-std::numeric_limits<float>::infinity());
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        tmp_acc0_vec = at::vec::maximum(tmp_acc0_vec, tmp1);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp1 = c10::convert<float>(tmp0);
                        tmp_acc0 = max_propagate_nan(tmp_acc0, tmp1);
                    }
                    tmp_acc0 = max_propagate_nan(tmp_acc0, at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return at::vec::maximum(x, y); }, tmp_acc0_vec));
                    out_ptr4[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
                {
                    float tmp_acc0 = 0;
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(0);
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = at::vec::Vectorized<float>(tmp2);
                        auto tmp4 = tmp1 - tmp3;
                        auto tmp5 = tmp4.exp();
                        tmp5.store(out_ptr5 + static_cast<int64_t>(x1 + (513L*x0)));
                        tmp_acc0_vec = tmp_acc0_vec + tmp5;
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = c10::convert<float>(tmp0);
                        auto tmp3 = decltype(tmp1)(tmp1 - tmp2);
                        auto tmp4 = std::exp(tmp3);
                        out_ptr5[static_cast<int64_t>(x1 + (513L*x0))] = tmp4;
                        tmp_acc0 = tmp_acc0 + tmp4;
                    }
                    tmp_acc0 = tmp_acc0 + at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return x + y; }, tmp_acc0_vec);
                    out_ptr6[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
            }
        }
    }
}
''')


cpp_fused_clone_constant_pad_nd_60 = async_compile.cpp_pybinding(['const bfloat16*', 'const bool*', 'const float*', 'const float*', 'bfloat16*', 'bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bool* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(1024L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = (-256L) + x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(0);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = static_cast<int64_t>(512);
                        auto tmp5 = tmp1 < tmp4;
                        auto tmp6 = tmp3 & tmp5;
                        auto tmp7 = [&]
                        {
                            auto tmp8 = at::vec::VecMask<float,1>::from(tmp6).template loadu<bfloat16,1>(in_ptr0 + static_cast<int64_t>((-196608L) + x2 + (64L*x0) + (768L*x1)));
                            auto tmp9 = at::vec::convert<float>(tmp8);
                            return tmp9;
                        }
                        ;
                        auto tmp10 = tmp6 ? tmp7() : at::vec::Vectorized<float>(static_cast<float>(-1.0));
                        auto tmp11 = at::vec::convert<bfloat16>(tmp10);
                        tmp11.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (65536L*x0)), 16);
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(768L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(513);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 < tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp8 = tmp5.template cast<float,1>().template loadu<float,1>(in_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0)));
                            auto tmp9 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp10 = at::vec::Vectorized<float>(tmp9);
                            auto tmp11 = tmp8 / tmp10;
                            auto tmp12 = static_cast<float>(0.0);
                            auto tmp13 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp14 = at::vec::Vectorized<float>(tmp12);
                            auto tmp15 = decltype(tmp14)::blendv(tmp11, tmp14, tmp13.template cast<float,1>());
                            auto tmp16 = (tmp15);
                            return tmp16;
                        }
                        ;
                        auto tmp19 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp17 = tmp6();
                                auto tmp18 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp17)::blendv(tmp18, tmp17, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp20 = at::vec::convert<bfloat16>(tmp19);
                        tmp20.store(out_ptr1 + static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(768L); x2<static_cast<int64_t>(770L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(513);
                        auto tmp3 = tmp1 < tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp6 = in_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0))];
                            auto tmp7 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp8 = tmp6 / tmp7;
                            auto tmp9 = static_cast<float>(0.0);
                            auto tmp10 = tmp5 ? tmp9 : tmp8;
                            auto tmp11 = c10::convert<float>(tmp10);
                            return tmp11;
                        }
                        ;
                        auto tmp12 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp13 = c10::convert<bfloat16>(tmp12);
                        out_ptr1[static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1))] = tmp13;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(49152L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x2 + (16384L*x1) + (65536L*x0)), 32);
                        tmp0.store(out_ptr2 + static_cast<int64_t>(x2 + (49152L*x1) + (98304L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused_clone_61 = async_compile.cpp_pybinding(['const bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       bfloat16* out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x2 + (64L*x0) + (32768L*x1)), 32);
                        tmp0.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (768L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_62 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    auto tmp19 = at::vec::convert<bfloat16>(tmp18);
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                    tmp19.store(out_ptr3 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_63 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<float>::loadu(out_ptr2 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<bfloat16>(tmp0);
                tmp1.store(out_ptr3 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_64 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<float>(tmp0);
                auto tmp2 = static_cast<float>(0.125);
                auto tmp3 = at::vec::Vectorized<float>(tmp2);
                auto tmp4 = tmp1 * tmp3;
                auto tmp5 = at::vec::convert<bfloat16>(tmp4);
                tmp5.store(in_out_ptr0 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_65 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(32L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 32);
                tmp0.store(in_out_ptr0 + static_cast<int64_t>(x0), 32);
            }
        }
    }
}
''')


cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_66 = async_compile.cpp_pybinding(['const bfloat16*', 'const bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'float*', 'float*', 'float*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bfloat16* in_ptr1,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2,
                       bfloat16* out_ptr3,
                       float* out_ptr4,
                       float* out_ptr5,
                       float* out_ptr6)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(2L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = at::vec::VectorizedN<int64_t,2>::arange(tmp5, 1);
                            auto tmp7 = static_cast<int64_t>(256);
                            auto tmp8 = at::vec::VectorizedN<int64_t,2>(tmp7);
                            auto tmp9 = at::vec::VecMask<int64_t,2>(tmp6 >= tmp8);
                            auto tmp10 = [&]
                            {
                                auto tmp11 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                    {
                                        if (tmp9.is_masked(x3_inner))
                                        {
                                            tmpbuf[x3_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp12 = static_cast<int64_t>(512);
                                auto tmp13 = at::vec::VectorizedN<int64_t,2>(tmp12);
                                auto tmp14 = at::vec::VecMask<int64_t,2>(tmp11 < tmp13);
                                auto tmp16 = tmp14 & tmp9;
                                auto tmp15 = [&]
                                {
                                    auto tmp17 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp16.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>(131072L + x3 + x3_inner + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp18 = at::vec::convert<float>(tmp17);
                                    return tmp18;
                                }
                                ;
                                auto tmp21 =
                                [&]
                                {
                                    if (tmp16.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp19 = tmp15();
                                        auto tmp20 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp19)::blendv(tmp20, tmp19, tmp16.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp21;
                            }
                            ;
                            auto tmp24 =
                            [&]
                            {
                                if (tmp9.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp22 = tmp10();
                                    auto tmp23 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp22)::blendv(tmp23, tmp22, tmp9.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp25 = static_cast<int64_t>(1);
                            auto tmp26 = tmp25 < tmp25;
                            auto tmp27 = [&]
                            {
                                auto tmp29 = at::vec::VecMask<float,1>::from(tmp26);
                                auto tmp30 = tmp9 & tmp29;
                                auto tmp28 = [&]
                                {
                                    auto tmp31 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp30.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp32 = static_cast<int64_t>(512);
                                    auto tmp33 = at::vec::VectorizedN<int64_t,2>(tmp32);
                                    auto tmp34 = at::vec::VecMask<int64_t,2>(tmp31 < tmp33);
                                    auto tmp36 = tmp34 & tmp30;
                                    auto tmp35 = [&]
                                    {
                                        auto tmp37 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp36.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp38 = at::vec::convert<float>(tmp37);
                                        return tmp38;
                                    }
                                    ;
                                    auto tmp41 =
                                    [&]
                                    {
                                        if (tmp36.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp39 = tmp35();
                                            auto tmp40 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp39)::blendv(tmp40, tmp39, tmp36.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp41;
                                }
                                ;
                                auto tmp44 =
                                [&]
                                {
                                    if (tmp30.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp42 = tmp28();
                                        auto tmp43 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp42)::blendv(tmp43, tmp42, tmp30.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp45 = static_cast<float>(0.0);
                                auto tmp46 = at::vec::Vectorized<float>(tmp45);
                                auto tmp47 = decltype(tmp44)::blendv(tmp46, tmp44, tmp9.template cast<float,1>());
                                return tmp47;
                            }
                            ;
                            auto tmp48 = tmp26 ? tmp27() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp49 = static_cast<float>(0.0);
                            auto tmp50 = at::vec::VecMask<float,1>::from(tmp26);
                            auto tmp51 = at::vec::Vectorized<float>(tmp49);
                            auto tmp52 = decltype(tmp48)::blendv(tmp51, tmp48, tmp50.template cast<float,1>());
                            auto tmp53 = decltype(tmp24)::blendv(tmp52, tmp24, tmp9.template cast<float,1>());
                            auto tmp54 = c10::convert<int64_t>(tmp0);
                            auto tmp55 = tmp54 < tmp25;
                            auto tmp56 = [&]
                            {
                                auto tmp58 = at::vec::VecMask<float,1>::from(tmp55);
                                auto tmp59 = tmp9 & tmp58;
                                auto tmp57 = [&]
                                {
                                    auto tmp60 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp59.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp61 = static_cast<int64_t>(512);
                                    auto tmp62 = at::vec::VectorizedN<int64_t,2>(tmp61);
                                    auto tmp63 = at::vec::VecMask<int64_t,2>(tmp60 < tmp62);
                                    auto tmp65 = tmp63 & tmp59;
                                    auto tmp64 = [&]
                                    {
                                        auto tmp66 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp65.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp67 = at::vec::convert<float>(tmp66);
                                        return tmp67;
                                    }
                                    ;
                                    auto tmp70 =
                                    [&]
                                    {
                                        if (tmp65.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp68 = tmp64();
                                            auto tmp69 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp68)::blendv(tmp69, tmp68, tmp65.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp70;
                                }
                                ;
                                auto tmp73 =
                                [&]
                                {
                                    if (tmp59.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp71 = tmp57();
                                        auto tmp72 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp71)::blendv(tmp72, tmp71, tmp59.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp74 = decltype(tmp73)::blendv(tmp51, tmp73, tmp9.template cast<float,1>());
                                return tmp74;
                            }
                            ;
                            auto tmp75 = tmp55 ? tmp56() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp76 = at::vec::VecMask<float,1>::from(tmp55);
                            auto tmp77 = decltype(tmp75)::blendv(tmp51, tmp75, tmp76.template cast<float,1>());
                            auto tmp78 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp79 = decltype(tmp53)::blendv(tmp77, tmp53, tmp78.template cast<float,1>());
                            auto tmp80 = at::vec::convert<bfloat16>(tmp79);
                            tmp80.store(out_ptr0 + static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(256);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + (513L*x1))), static_cast<int64_t>(512L)));
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = static_cast<int64_t>(512);
                                auto tmp12 = tmp10 < tmp11;
                                auto tmp13 = [&]
                                {
                                    auto tmp14 = in_ptr0[static_cast<int64_t>(131072L + x3 + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                    auto tmp15 = c10::convert<float>(tmp14);
                                    return tmp15;
                                }
                                ;
                                auto tmp16 = tmp12 ? tmp13() : static_cast<decltype(tmp13())>(0.0);
                                return tmp16;
                            }
                            ;
                            auto tmp17 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp18 = static_cast<int64_t>(1);
                            auto tmp19 = tmp18 < tmp18;
                            auto tmp20 = [&]
                            {
                                auto tmp21 = [&]
                                {
                                    auto tmp22 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp23 = c10::convert<int64_t>(tmp22);
                                    auto tmp24 = static_cast<int64_t>(512);
                                    auto tmp25 = tmp23 < tmp24;
                                    auto tmp26 = [&]
                                    {
                                        auto tmp27 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                        auto tmp28 = c10::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp29 = tmp25 ? tmp26() : static_cast<decltype(tmp26())>(0.0);
                                    return tmp29;
                                }
                                ;
                                auto tmp30 = tmp7 ? tmp21() : static_cast<decltype(tmp21())>(0.0);
                                auto tmp31 = static_cast<float>(0.0);
                                auto tmp32 = tmp7 ? tmp30 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                            auto tmp34 = static_cast<float>(0.0);
                            auto tmp35 = tmp19 ? tmp33 : tmp34;
                            auto tmp36 = tmp7 ? tmp17 : tmp35;
                            auto tmp37 = c10::convert<int64_t>(tmp0);
                            auto tmp38 = tmp37 < tmp18;
                            auto tmp39 = [&]
                            {
                                auto tmp40 = [&]
                                {
                                    auto tmp41 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp42 = c10::convert<int64_t>(tmp41);
                                    auto tmp43 = static_cast<int64_t>(512);
                                    auto tmp44 = tmp42 < tmp43;
                                    auto tmp45 = [&]
                                    {
                                        auto tmp46 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                        auto tmp47 = c10::convert<float>(tmp46);
                                        return tmp47;
                                    }
                                    ;
                                    auto tmp48 = tmp44 ? tmp45() : static_cast<decltype(tmp45())>(0.0);
                                    return tmp48;
                                }
                                ;
                                auto tmp49 = tmp7 ? tmp40() : static_cast<decltype(tmp40())>(0.0);
                                auto tmp50 = tmp7 ? tmp49 : tmp34;
                                return tmp50;
                            }
                            ;
                            auto tmp51 = tmp38 ? tmp39() : static_cast<decltype(tmp39())>(0.0);
                            auto tmp52 = tmp38 ? tmp51 : tmp34;
                            auto tmp53 = tmp3 ? tmp36 : tmp52;
                            auto tmp54 = c10::convert<bfloat16>(tmp53);
                            out_ptr0[static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0))] = tmp54;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(256L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp96 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp132 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = at::vec::VectorizedN<int64_t,2>::arange(tmp10, 1);
                                auto tmp12 = at::vec::VectorizedN<int64_t,2>(tmp6);
                                auto tmp13 = at::vec::VecMask<int64_t,2>(tmp11 >= tmp12);
                                auto tmp14 = static_cast<int64_t>(256);
                                auto tmp15 = at::vec::VectorizedN<int64_t,2>(tmp14);
                                auto tmp16 = at::vec::VecMask<int64_t,2>(tmp11 < tmp15);
                                auto tmp17 = tmp13 & tmp16;
                                auto tmp19 = at::vec::VecMask<float,1>::from(tmp7);
                                auto tmp20 = tmp17 & tmp19;
                                auto tmp18 = [&]
                                {
                                    auto tmp21 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp20.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp22 = static_cast<int64_t>(512);
                                    auto tmp23 = at::vec::VectorizedN<int64_t,2>(tmp22);
                                    auto tmp24 = at::vec::VecMask<int64_t,2>(tmp21 < tmp23);
                                    auto tmp26 = tmp24 & tmp20;
                                    auto tmp25 = [&]
                                    {
                                        auto tmp27 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp26.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp28 = at::vec::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp31 =
                                    [&]
                                    {
                                        if (tmp26.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp29 = tmp25();
                                            auto tmp30 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp31;
                                }
                                ;
                                auto tmp34 =
                                [&]
                                {
                                    if (tmp20.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp32 = tmp18();
                                        auto tmp33 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp32)::blendv(tmp33, tmp32, tmp20.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp35 = static_cast<int64_t>(0);
                                auto tmp36 = tmp35 >= tmp6;
                                auto tmp38 = tmp36 & tmp7;
                                auto tmp37 = [&]
                                {
                                    auto tmp40 = at::vec::VecMask<float,1>::from(tmp38);
                                    auto tmp41 = tmp16 & tmp40;
                                    auto tmp39 = [&]
                                    {
                                        auto tmp42 =
                                        [&]
                                        {
                                            __at_align__ std::array<int64_t, 16> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp41.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                                }
                                            }
                                            return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp43 = static_cast<int64_t>(512);
                                        auto tmp44 = at::vec::VectorizedN<int64_t,2>(tmp43);
                                        auto tmp45 = at::vec::VecMask<int64_t,2>(tmp42 < tmp44);
                                        auto tmp47 = tmp45 & tmp41;
                                        auto tmp46 = [&]
                                        {
                                            auto tmp48 =
                                            [&]
                                            {
                                                __at_align__ std::array<bfloat16, 32> tmpbuf;
                                                #pragma GCC unroll 16
                                                for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                                {
                                                    if (tmp47.is_masked(x3_inner))
                                                    {
                                                        tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                    }
                                                }
                                                return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                            }
                                            ()
                                            ;
                                            auto tmp49 = at::vec::convert<float>(tmp48);
                                            return tmp49;
                                        }
                                        ;
                                        auto tmp52 =
                                        [&]
                                        {
                                            if (tmp47.all_zero())
                                            {
                                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            }
                                            else
                                            {
                                                auto tmp50 = tmp46();
                                                auto tmp51 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                                return decltype(tmp50)::blendv(tmp51, tmp50, tmp47.template cast<float,1>());
                                            }
                                        }
                                        ()
                                        ;
                                        return tmp52;
                                    }
                                    ;
                                    auto tmp55 =
                                    [&]
                                    {
                                        if (tmp41.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp53 = tmp39();
                                            auto tmp54 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp53)::blendv(tmp54, tmp53, tmp41.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    auto tmp56 = at::vec::VecMask<float,1>::from(tmp38).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                    auto tmp57 = at::vec::convert<float>(tmp56);
                                    auto tmp58 = decltype(tmp55)::blendv(tmp57, tmp55, tmp16.template cast<float,1>());
                                    return tmp58;
                                }
                                ;
                                auto tmp59 = tmp36 ? tmp37() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                                auto tmp60 = at::vec::VecMask<float,1>::from(tmp7).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp61 = at::vec::convert<float>(tmp60);
                                auto tmp62 = at::vec::VecMask<float,1>::from(tmp36);
                                auto tmp63 = decltype(tmp59)::blendv(tmp61, tmp59, tmp62.template cast<float,1>());
                                auto tmp64 = decltype(tmp34)::blendv(tmp63, tmp34, tmp17.template cast<float,1>());
                                return tmp64;
                            }
                            ;
                            auto tmp65 = tmp7 ? tmp8() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp66 = static_cast<int64_t>(0);
                            auto tmp67 = tmp66 >= tmp6;
                            auto tmp68 = [&]
                            {
                                auto tmp69 = x3;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(256);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 < tmp73);
                                auto tmp76 = at::vec::VecMask<float,1>::from(tmp67);
                                auto tmp77 = tmp74 & tmp76;
                                auto tmp75 = [&]
                                {
                                    auto tmp78 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp77.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp79 = static_cast<int64_t>(512);
                                    auto tmp80 = at::vec::VectorizedN<int64_t,2>(tmp79);
                                    auto tmp81 = at::vec::VecMask<int64_t,2>(tmp78 < tmp80);
                                    auto tmp83 = tmp81 & tmp77;
                                    auto tmp82 = [&]
                                    {
                                        auto tmp84 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp83.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp85 = at::vec::convert<float>(tmp84);
                                        return tmp85;
                                    }
                                    ;
                                    auto tmp88 =
                                    [&]
                                    {
                                        if (tmp83.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp86 = tmp82();
                                            auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp86)::blendv(tmp87, tmp86, tmp83.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp88;
                                }
                                ;
                                auto tmp91 =
                                [&]
                                {
                                    if (tmp77.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp89 = tmp75();
                                        auto tmp90 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp89)::blendv(tmp90, tmp89, tmp77.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp92 = at::vec::VecMask<float,1>::from(tmp67).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp93 = at::vec::convert<float>(tmp92);
                                auto tmp94 = decltype(tmp91)::blendv(tmp93, tmp91, tmp74.template cast<float,1>());
                                return tmp94;
                            }
                            ;
                            auto tmp95 = tmp67 ? tmp68() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp97 = at::vec::convert<float>(tmp96);
                            auto tmp98 = at::vec::VecMask<float,1>::from(tmp67);
                            auto tmp99 = decltype(tmp95)::blendv(tmp97, tmp95, tmp98.template cast<float,1>());
                            auto tmp100 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp101 = decltype(tmp65)::blendv(tmp99, tmp65, tmp100.template cast<float,1>());
                            auto tmp102 = c10::convert<int64_t>(tmp0);
                            auto tmp103 = tmp102 >= tmp6;
                            auto tmp104 = [&]
                            {
                                auto tmp105 = x3;
                                auto tmp106 = c10::convert<int64_t>(tmp105);
                                auto tmp107 = at::vec::VectorizedN<int64_t,2>::arange(tmp106, 1);
                                auto tmp108 = static_cast<int64_t>(256);
                                auto tmp109 = at::vec::VectorizedN<int64_t,2>(tmp108);
                                auto tmp110 = at::vec::VecMask<int64_t,2>(tmp107 < tmp109);
                                auto tmp112 = at::vec::VecMask<float,1>::from(tmp103);
                                auto tmp113 = tmp110 & tmp112;
                                auto tmp111 = [&]
                                {
                                    auto tmp114 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp113.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp115 = static_cast<int64_t>(512);
                                    auto tmp116 = at::vec::VectorizedN<int64_t,2>(tmp115);
                                    auto tmp117 = at::vec::VecMask<int64_t,2>(tmp114 < tmp116);
                                    auto tmp119 = tmp117 & tmp113;
                                    auto tmp118 = [&]
                                    {
                                        auto tmp120 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp119.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp121 = at::vec::convert<float>(tmp120);
                                        return tmp121;
                                    }
                                    ;
                                    auto tmp124 =
                                    [&]
                                    {
                                        if (tmp119.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp122 = tmp118();
                                            auto tmp123 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp122)::blendv(tmp123, tmp122, tmp119.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp124;
                                }
                                ;
                                auto tmp127 =
                                [&]
                                {
                                    if (tmp113.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp125 = tmp111();
                                        auto tmp126 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp125)::blendv(tmp126, tmp125, tmp113.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp128 = at::vec::VecMask<float,1>::from(tmp103).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp129 = at::vec::convert<float>(tmp128);
                                auto tmp130 = decltype(tmp127)::blendv(tmp129, tmp127, tmp110.template cast<float,1>());
                                return tmp130;
                            }
                            ;
                            auto tmp131 = tmp103 ? tmp104() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp133 = at::vec::convert<float>(tmp132);
                            auto tmp134 = at::vec::VecMask<float,1>::from(tmp103);
                            auto tmp135 = decltype(tmp131)::blendv(tmp133, tmp131, tmp134.template cast<float,1>());
                            auto tmp136 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp137 = decltype(tmp101)::blendv(tmp135, tmp101, tmp136.template cast<float,1>());
                            auto tmp138 = at::vec::convert<bfloat16>(tmp137);
                            tmp138.store(out_ptr1 + static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp68 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                            auto tmp93 = out_ptr0[static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0))];
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = tmp10 >= tmp6;
                                auto tmp12 = static_cast<int64_t>(256);
                                auto tmp13 = tmp10 < tmp12;
                                auto tmp14 = tmp11 & tmp13;
                                auto tmp15 = [&]
                                {
                                    auto tmp16 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp17 = c10::convert<int64_t>(tmp16);
                                    auto tmp18 = static_cast<int64_t>(512);
                                    auto tmp19 = tmp17 < tmp18;
                                    auto tmp20 = [&]
                                    {
                                        auto tmp21 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                        auto tmp22 = c10::convert<float>(tmp21);
                                        return tmp22;
                                    }
                                    ;
                                    auto tmp23 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                                    return tmp23;
                                }
                                ;
                                auto tmp24 = tmp14 ? tmp15() : static_cast<decltype(tmp15())>(0.0);
                                auto tmp25 = static_cast<int64_t>(0);
                                auto tmp26 = tmp25 >= tmp6;
                                auto tmp27 = [&]
                                {
                                    auto tmp28 = [&]
                                    {
                                        auto tmp29 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                        auto tmp30 = c10::convert<int64_t>(tmp29);
                                        auto tmp31 = static_cast<int64_t>(512);
                                        auto tmp32 = tmp30 < tmp31;
                                        auto tmp33 = [&]
                                        {
                                            auto tmp34 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                            auto tmp35 = c10::convert<float>(tmp34);
                                            return tmp35;
                                        }
                                        ;
                                        auto tmp36 = tmp32 ? tmp33() : static_cast<decltype(tmp33())>(0.0);
                                        return tmp36;
                                    }
                                    ;
                                    auto tmp37 = tmp13 ? tmp28() : static_cast<decltype(tmp28())>(0.0);
                                    auto tmp38 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                    auto tmp39 = c10::convert<float>(tmp38);
                                    auto tmp40 = tmp13 ? tmp37 : tmp39;
                                    return tmp40;
                                }
                                ;
                                auto tmp41 = tmp26 ? tmp27() : static_cast<decltype(tmp27())>(0.0);
                                auto tmp42 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp43 = c10::convert<float>(tmp42);
                                auto tmp44 = tmp26 ? tmp41 : tmp43;
                                auto tmp45 = tmp14 ? tmp24 : tmp44;
                                return tmp45;
                            }
                            ;
                            auto tmp46 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp47 = static_cast<int64_t>(0);
                            auto tmp48 = tmp47 >= tmp6;
                            auto tmp49 = [&]
                            {
                                auto tmp50 = x3;
                                auto tmp51 = c10::convert<int64_t>(tmp50);
                                auto tmp52 = static_cast<int64_t>(256);
                                auto tmp53 = tmp51 < tmp52;
                                auto tmp54 = [&]
                                {
                                    auto tmp55 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp56 = c10::convert<int64_t>(tmp55);
                                    auto tmp57 = static_cast<int64_t>(512);
                                    auto tmp58 = tmp56 < tmp57;
                                    auto tmp59 = [&]
                                    {
                                        auto tmp60 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp61 = c10::convert<float>(tmp60);
                                        return tmp61;
                                    }
                                    ;
                                    auto tmp62 = tmp58 ? tmp59() : static_cast<decltype(tmp59())>(0.0);
                                    return tmp62;
                                }
                                ;
                                auto tmp63 = tmp53 ? tmp54() : static_cast<decltype(tmp54())>(0.0);
                                auto tmp64 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp65 = c10::convert<float>(tmp64);
                                auto tmp66 = tmp53 ? tmp63 : tmp65;
                                return tmp66;
                            }
                            ;
                            auto tmp67 = tmp48 ? tmp49() : static_cast<decltype(tmp49())>(0.0);
                            auto tmp69 = c10::convert<float>(tmp68);
                            auto tmp70 = tmp48 ? tmp67 : tmp69;
                            auto tmp71 = tmp7 ? tmp46 : tmp70;
                            auto tmp72 = c10::convert<int64_t>(tmp0);
                            auto tmp73 = tmp72 >= tmp6;
                            auto tmp74 = [&]
                            {
                                auto tmp75 = x3;
                                auto tmp76 = c10::convert<int64_t>(tmp75);
                                auto tmp77 = static_cast<int64_t>(256);
                                auto tmp78 = tmp76 < tmp77;
                                auto tmp79 = [&]
                                {
                                    auto tmp80 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp81 = c10::convert<int64_t>(tmp80);
                                    auto tmp82 = static_cast<int64_t>(512);
                                    auto tmp83 = tmp81 < tmp82;
                                    auto tmp84 = [&]
                                    {
                                        auto tmp85 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp86 = c10::convert<float>(tmp85);
                                        return tmp86;
                                    }
                                    ;
                                    auto tmp87 = tmp83 ? tmp84() : static_cast<decltype(tmp84())>(0.0);
                                    return tmp87;
                                }
                                ;
                                auto tmp88 = tmp78 ? tmp79() : static_cast<decltype(tmp79())>(0.0);
                                auto tmp89 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp90 = c10::convert<float>(tmp89);
                                auto tmp91 = tmp78 ? tmp88 : tmp90;
                                return tmp91;
                            }
                            ;
                            auto tmp92 = tmp73 ? tmp74() : static_cast<decltype(tmp74())>(0.0);
                            auto tmp94 = c10::convert<float>(tmp93);
                            auto tmp95 = tmp73 ? tmp92 : tmp94;
                            auto tmp96 = tmp3 ? tmp71 : tmp95;
                            auto tmp97 = c10::convert<bfloat16>(tmp96);
                            out_ptr1[static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0))] = tmp97;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp93 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)), 16);
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(256);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 >= tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp8 = c10::convert<int64_t>(tmp7);
                            auto tmp9 = at::vec::VectorizedN<int64_t,2>::arange(tmp8, -1);
                            auto tmp10 = static_cast<int64_t>(0);
                            auto tmp11 = at::vec::VectorizedN<int64_t,2>(tmp10);
                            auto tmp12 = at::vec::VecMask<int64_t,2>(tmp9 <= tmp11);
                            auto tmp13 = static_cast<float>(1.0);
                            auto tmp14 = static_cast<float>(0.0);
                            auto tmp15 = at::vec::Vectorized<float>(tmp13);
                            auto tmp16 = at::vec::Vectorized<float>(tmp14);
                            auto tmp17 = decltype(tmp15)::blendv(tmp16, tmp15, tmp12.template cast<float,1>());
                            auto tmp18 = at::vec::VecMask<float,1>::from<float,1>(tmp17);
                            auto tmp19 = 256L + x1;
                            auto tmp20 = c10::convert<int64_t>(tmp19);
                            auto tmp21 = tmp20 < tmp3;
                            auto tmp23 = at::vec::VecMask<float,1>::from(tmp21);
                            auto tmp24 = tmp23 & tmp5;
                            auto tmp22 = [&]
                            {
                                auto tmp25 = static_cast<int64_t>(257);
                                auto tmp26 = at::vec::VectorizedN<int64_t,2>(tmp25);
                                auto tmp27 = at::vec::VecMask<int64_t,2>(tmp2 < tmp26);
                                auto tmp29 = tmp27 & tmp24;
                                auto tmp28 = [&]
                                {
                                    auto tmp30 = 1L + x1 + x2;
                                    auto tmp31 = c10::convert<int64_t>(tmp30);
                                    auto tmp32 = at::vec::VectorizedN<int64_t,2>::arange(tmp31, 1);
                                    auto tmp33 = at::vec::VecMask<int64_t,2>(tmp32 <= tmp11);
                                    auto tmp34 = decltype(tmp15)::blendv(tmp16, tmp15, tmp33.template cast<float,1>());
                                    auto tmp35 = at::vec::VecMask<float,1>::from<float,1>(tmp34);
                                    auto tmp36 = tmp29.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                    auto tmp37 = at::vec::convert<float>(tmp36);
                                    auto tmp38 = -std::numeric_limits<float>::infinity();
                                    auto tmp39 = at::vec::Vectorized<float>(tmp38);
                                    auto tmp40 = decltype(tmp39)::blendv(tmp37, tmp39, tmp35.template cast<float,1>());
                                    return tmp40;
                                }
                                ;
                                auto tmp43 =
                                [&]
                                {
                                    if (tmp29.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp41 = tmp28();
                                        auto tmp42 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp41)::blendv(tmp42, tmp41, tmp29.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp44 = tmp24.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp45 = at::vec::convert<float>(tmp44);
                                auto tmp46 = decltype(tmp43)::blendv(tmp45, tmp43, tmp27.template cast<float,1>());
                                return tmp46;
                            }
                            ;
                            auto tmp49 =
                            [&]
                            {
                                if (tmp24.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp47 = tmp22();
                                    auto tmp48 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp47)::blendv(tmp48, tmp47, tmp24.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp50 = tmp5.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp51 = at::vec::convert<float>(tmp50);
                            auto tmp52 = decltype(tmp49)::blendv(tmp51, tmp49, tmp23.template cast<float,1>());
                            auto tmp53 = -std::numeric_limits<float>::infinity();
                            auto tmp54 = at::vec::Vectorized<float>(tmp53);
                            auto tmp55 = decltype(tmp54)::blendv(tmp52, tmp54, tmp18.template cast<float,1>());
                            return tmp55;
                        }
                        ;
                        auto tmp58 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp56 = tmp6();
                                auto tmp57 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp56)::blendv(tmp57, tmp56, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp59 = 256L + x1;
                        auto tmp60 = c10::convert<int64_t>(tmp59);
                        auto tmp61 = tmp60 < tmp3;
                        auto tmp62 = [&]
                        {
                            auto tmp63 = static_cast<int64_t>(257);
                            auto tmp64 = at::vec::VectorizedN<int64_t,2>(tmp63);
                            auto tmp65 = at::vec::VecMask<int64_t,2>(tmp2 < tmp64);
                            auto tmp67 = at::vec::VecMask<float,1>::from(tmp61);
                            auto tmp68 = tmp65 & tmp67;
                            auto tmp66 = [&]
                            {
                                auto tmp69 = 1L + x1 + x2;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(0);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 <= tmp73);
                                auto tmp75 = static_cast<float>(1.0);
                                auto tmp76 = static_cast<float>(0.0);
                                auto tmp77 = at::vec::Vectorized<float>(tmp75);
                                auto tmp78 = at::vec::Vectorized<float>(tmp76);
                                auto tmp79 = decltype(tmp77)::blendv(tmp78, tmp77, tmp74.template cast<float,1>());
                                auto tmp80 = at::vec::VecMask<float,1>::from<float,1>(tmp79);
                                auto tmp81 = tmp68.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp82 = at::vec::convert<float>(tmp81);
                                auto tmp83 = -std::numeric_limits<float>::infinity();
                                auto tmp84 = at::vec::Vectorized<float>(tmp83);
                                auto tmp85 = decltype(tmp84)::blendv(tmp82, tmp84, tmp80.template cast<float,1>());
                                return tmp85;
                            }
                            ;
                            auto tmp88 =
                            [&]
                            {
                                if (tmp68.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp86 = tmp66();
                                    auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp86)::blendv(tmp87, tmp86, tmp68.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp89 = at::vec::VecMask<float,1>::from(tmp61).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp90 = at::vec::convert<float>(tmp89);
                            auto tmp91 = decltype(tmp88)::blendv(tmp90, tmp88, tmp65.template cast<float,1>());
                            return tmp91;
                        }
                        ;
                        auto tmp92 = tmp61 ? tmp62() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp94 = at::vec::convert<float>(tmp93);
                        auto tmp95 = at::vec::VecMask<float,1>::from(tmp61);
                        auto tmp96 = decltype(tmp92)::blendv(tmp94, tmp92, tmp95.template cast<float,1>());
                        auto tmp97 = decltype(tmp58)::blendv(tmp96, tmp58, tmp5.template cast<float,1>());
                        auto tmp98 = at::vec::convert<bfloat16>(tmp97);
                        tmp98.store(out_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp64 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp6 = c10::convert<int64_t>(tmp5);
                            auto tmp7 = static_cast<int64_t>(0);
                            auto tmp8 = tmp6 <= tmp7;
                            auto tmp9 = static_cast<float>(1.0);
                            auto tmp10 = static_cast<float>(0.0);
                            auto tmp11 = tmp8 ? tmp9 : tmp10;
                            auto tmp12 = c10::convert<bool>(tmp11);
                            auto tmp13 = 256L + x1;
                            auto tmp14 = c10::convert<int64_t>(tmp13);
                            auto tmp15 = tmp14 < tmp2;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = static_cast<int64_t>(257);
                                auto tmp18 = tmp1 < tmp17;
                                auto tmp19 = [&]
                                {
                                    auto tmp20 = 1L + x1 + x2;
                                    auto tmp21 = c10::convert<int64_t>(tmp20);
                                    auto tmp22 = tmp21 <= tmp7;
                                    auto tmp23 = tmp22 ? tmp9 : tmp10;
                                    auto tmp24 = c10::convert<bool>(tmp23);
                                    auto tmp25 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                    auto tmp26 = c10::convert<float>(tmp25);
                                    auto tmp27 = -std::numeric_limits<float>::infinity();
                                    auto tmp28 = tmp24 ? tmp27 : tmp26;
                                    return tmp28;
                                }
                                ;
                                auto tmp29 = tmp18 ? tmp19() : static_cast<decltype(tmp19())>(0.0);
                                auto tmp30 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp31 = c10::convert<float>(tmp30);
                                auto tmp32 = tmp18 ? tmp29 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp34 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp35 = c10::convert<float>(tmp34);
                            auto tmp36 = tmp15 ? tmp33 : tmp35;
                            auto tmp37 = -std::numeric_limits<float>::infinity();
                            auto tmp38 = tmp12 ? tmp37 : tmp36;
                            return tmp38;
                        }
                        ;
                        auto tmp39 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp40 = 256L + x1;
                        auto tmp41 = c10::convert<int64_t>(tmp40);
                        auto tmp42 = tmp41 < tmp2;
                        auto tmp43 = [&]
                        {
                            auto tmp44 = static_cast<int64_t>(257);
                            auto tmp45 = tmp1 < tmp44;
                            auto tmp46 = [&]
                            {
                                auto tmp47 = 1L + x1 + x2;
                                auto tmp48 = c10::convert<int64_t>(tmp47);
                                auto tmp49 = static_cast<int64_t>(0);
                                auto tmp50 = tmp48 <= tmp49;
                                auto tmp51 = static_cast<float>(1.0);
                                auto tmp52 = static_cast<float>(0.0);
                                auto tmp53 = tmp50 ? tmp51 : tmp52;
                                auto tmp54 = c10::convert<bool>(tmp53);
                                auto tmp55 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp56 = c10::convert<float>(tmp55);
                                auto tmp57 = -std::numeric_limits<float>::infinity();
                                auto tmp58 = tmp54 ? tmp57 : tmp56;
                                return tmp58;
                            }
                            ;
                            auto tmp59 = tmp45 ? tmp46() : static_cast<decltype(tmp46())>(0.0);
                            auto tmp60 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp61 = c10::convert<float>(tmp60);
                            auto tmp62 = tmp45 ? tmp59 : tmp61;
                            return tmp62;
                        }
                        ;
                        auto tmp63 = tmp42 ? tmp43() : static_cast<decltype(tmp43())>(0.0);
                        auto tmp65 = c10::convert<float>(tmp64);
                        auto tmp66 = tmp42 ? tmp63 : tmp65;
                        auto tmp67 = tmp3 ? tmp39 : tmp66;
                        auto tmp68 = c10::convert<bfloat16>(tmp67);
                        out_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0))] = tmp68;
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp45 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)), 16);
                        auto tmp83 = at::vec::Vectorized<bfloat16>::loadu(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)), 16);
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr2 + static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0)));
                            auto tmp6 = at::vec::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = at::vec::VectorizedN<int64_t,2>::arange(tmp13, 1);
                            auto tmp15 = static_cast<int64_t>(257);
                            auto tmp16 = at::vec::VectorizedN<int64_t,2>(tmp15);
                            auto tmp17 = at::vec::VecMask<int64_t,2>(tmp14 < tmp16);
                            auto tmp19 = at::vec::VecMask<float,1>::from(tmp10);
                            auto tmp20 = tmp17 & tmp19;
                            auto tmp18 = [&]
                            {
                                auto tmp21 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp22 = c10::convert<int64_t>(tmp21);
                                auto tmp23 = at::vec::VectorizedN<int64_t,2>::arange(tmp22, 1);
                                auto tmp24 = static_cast<int64_t>(0);
                                auto tmp25 = at::vec::VectorizedN<int64_t,2>(tmp24);
                                auto tmp26 = at::vec::VecMask<int64_t,2>(tmp23 <= tmp25);
                                auto tmp27 = static_cast<float>(1.0);
                                auto tmp28 = static_cast<float>(0.0);
                                auto tmp29 = at::vec::Vectorized<float>(tmp27);
                                auto tmp30 = at::vec::Vectorized<float>(tmp28);
                                auto tmp31 = decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                auto tmp32 = at::vec::VecMask<float,1>::from<float,1>(tmp31);
                                auto tmp33 = tmp20.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                                auto tmp34 = at::vec::convert<float>(tmp33);
                                auto tmp35 = -std::numeric_limits<float>::infinity();
                                auto tmp36 = at::vec::Vectorized<float>(tmp35);
                                auto tmp37 = decltype(tmp36)::blendv(tmp34, tmp36, tmp32.template cast<float,1>());
                                return tmp37;
                            }
                            ;
                            auto tmp40 =
                            [&]
                            {
                                if (tmp20.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp38 = tmp18();
                                    auto tmp39 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp38)::blendv(tmp39, tmp38, tmp20.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp41 = at::vec::VecMask<float,1>::from(tmp10).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                            auto tmp42 = at::vec::convert<float>(tmp41);
                            auto tmp43 = decltype(tmp40)::blendv(tmp42, tmp40, tmp17.template cast<float,1>());
                            return tmp43;
                        }
                        ;
                        auto tmp44 = tmp10 ? tmp11() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp46 = at::vec::convert<float>(tmp45);
                        auto tmp47 = at::vec::VecMask<float,1>::from(tmp10);
                        auto tmp48 = decltype(tmp44)::blendv(tmp46, tmp44, tmp47.template cast<float,1>());
                        auto tmp49 = at::vec::VecMask<float,1>::from(tmp3);
                        auto tmp50 = decltype(tmp7)::blendv(tmp48, tmp7, tmp49.template cast<float,1>());
                        auto tmp51 = [&]
                        {
                            auto tmp52 = x2;
                            auto tmp53 = c10::convert<int64_t>(tmp52);
                            auto tmp54 = at::vec::VectorizedN<int64_t,2>::arange(tmp53, 1);
                            auto tmp55 = at::vec::VectorizedN<int64_t,2>(tmp2);
                            auto tmp56 = at::vec::VecMask<int64_t,2>(tmp54 >= tmp55);
                            auto tmp58 = tmp56 & tmp49;
                            auto tmp57 = [&]
                            {
                                auto tmp59 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp60 = c10::convert<int64_t>(tmp59);
                                auto tmp61 = at::vec::VectorizedN<int64_t,2>::arange(tmp60, -1);
                                auto tmp62 = static_cast<int64_t>(0);
                                auto tmp63 = at::vec::VectorizedN<int64_t,2>(tmp62);
                                auto tmp64 = at::vec::VecMask<int64_t,2>(tmp61 <= tmp63);
                                auto tmp65 = static_cast<float>(1.0);
                                auto tmp66 = static_cast<float>(0.0);
                                auto tmp67 = at::vec::Vectorized<float>(tmp65);
                                auto tmp68 = at::vec::Vectorized<float>(tmp66);
                                auto tmp69 = decltype(tmp67)::blendv(tmp68, tmp67, tmp64.template cast<float,1>());
                                auto tmp70 = at::vec::VecMask<float,1>::from<float,1>(tmp69);
                                auto tmp71 = tmp58.template cast<float,1>().template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                                auto tmp72 = at::vec::convert<float>(tmp71);
                                auto tmp73 = -std::numeric_limits<float>::infinity();
                                auto tmp74 = at::vec::Vectorized<float>(tmp73);
                                auto tmp75 = decltype(tmp74)::blendv(tmp72, tmp74, tmp70.template cast<float,1>());
                                return tmp75;
                            }
                            ;
                            auto tmp78 =
                            [&]
                            {
                                if (tmp58.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp76 = tmp57();
                                    auto tmp77 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp76)::blendv(tmp77, tmp76, tmp58.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp79 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                            auto tmp80 = at::vec::convert<float>(tmp79);
                            auto tmp81 = decltype(tmp78)::blendv(tmp80, tmp78, tmp56.template cast<float,1>());
                            return tmp81;
                        }
                        ;
                        auto tmp82 = tmp3 ? tmp51() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp84 = at::vec::convert<float>(tmp83);
                        auto tmp85 = decltype(tmp82)::blendv(tmp84, tmp82, tmp49.template cast<float,1>());
                        auto tmp86 = tmp50 + tmp85;
                        auto tmp87 = at::vec::convert<bfloat16>(tmp86);
                        tmp87.store(out_ptr3 + static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp34 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                        auto tmp60 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = out_ptr2[static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0))];
                            auto tmp6 = c10::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = static_cast<int64_t>(257);
                            auto tmp15 = tmp13 < tmp14;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp18 = c10::convert<int64_t>(tmp17);
                                auto tmp19 = static_cast<int64_t>(0);
                                auto tmp20 = tmp18 <= tmp19;
                                auto tmp21 = static_cast<float>(1.0);
                                auto tmp22 = static_cast<float>(0.0);
                                auto tmp23 = tmp20 ? tmp21 : tmp22;
                                auto tmp24 = c10::convert<bool>(tmp23);
                                auto tmp25 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                                auto tmp26 = c10::convert<float>(tmp25);
                                auto tmp27 = -std::numeric_limits<float>::infinity();
                                auto tmp28 = tmp24 ? tmp27 : tmp26;
                                return tmp28;
                            }
                            ;
                            auto tmp29 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp30 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                            auto tmp31 = c10::convert<float>(tmp30);
                            auto tmp32 = tmp15 ? tmp29 : tmp31;
                            return tmp32;
                        }
                        ;
                        auto tmp33 = tmp10 ? tmp11() : static_cast<decltype(tmp11())>(0.0);
                        auto tmp35 = c10::convert<float>(tmp34);
                        auto tmp36 = tmp10 ? tmp33 : tmp35;
                        auto tmp37 = tmp3 ? tmp7 : tmp36;
                        auto tmp38 = [&]
                        {
                            auto tmp39 = x2;
                            auto tmp40 = c10::convert<int64_t>(tmp39);
                            auto tmp41 = tmp40 >= tmp2;
                            auto tmp42 = [&]
                            {
                                auto tmp43 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp44 = c10::convert<int64_t>(tmp43);
                                auto tmp45 = static_cast<int64_t>(0);
                                auto tmp46 = tmp44 <= tmp45;
                                auto tmp47 = static_cast<float>(1.0);
                                auto tmp48 = static_cast<float>(0.0);
                                auto tmp49 = tmp46 ? tmp47 : tmp48;
                                auto tmp50 = c10::convert<bool>(tmp49);
                                auto tmp51 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                                auto tmp52 = c10::convert<float>(tmp51);
                                auto tmp53 = -std::numeric_limits<float>::infinity();
                                auto tmp54 = tmp50 ? tmp53 : tmp52;
                                return tmp54;
                            }
                            ;
                            auto tmp55 = tmp41 ? tmp42() : static_cast<decltype(tmp42())>(0.0);
                            auto tmp56 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                            auto tmp57 = c10::convert<float>(tmp56);
                            auto tmp58 = tmp41 ? tmp55 : tmp57;
                            return tmp58;
                        }
                        ;
                        auto tmp59 = tmp3 ? tmp38() : static_cast<decltype(tmp38())>(0.0);
                        auto tmp61 = c10::convert<float>(tmp60);
                        auto tmp62 = tmp3 ? tmp59 : tmp61;
                        auto tmp63 = decltype(tmp37)(tmp37 + tmp62);
                        auto tmp64 = c10::convert<bfloat16>(tmp63);
                        out_ptr3[static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1))] = tmp64;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(6144L); x0+=static_cast<int64_t>(1L))
            {
                {
                    float tmp_acc0 = -std::numeric_limits<float>::infinity();
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(-std::numeric_limits<float>::infinity());
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        tmp_acc0_vec = at::vec::maximum(tmp_acc0_vec, tmp1);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp1 = c10::convert<float>(tmp0);
                        tmp_acc0 = max_propagate_nan(tmp_acc0, tmp1);
                    }
                    tmp_acc0 = max_propagate_nan(tmp_acc0, at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return at::vec::maximum(x, y); }, tmp_acc0_vec));
                    out_ptr4[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
                {
                    float tmp_acc0 = 0;
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(0);
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = at::vec::Vectorized<float>(tmp2);
                        auto tmp4 = tmp1 - tmp3;
                        auto tmp5 = tmp4.exp();
                        tmp5.store(out_ptr5 + static_cast<int64_t>(x1 + (513L*x0)));
                        tmp_acc0_vec = tmp_acc0_vec + tmp5;
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = c10::convert<float>(tmp0);
                        auto tmp3 = decltype(tmp1)(tmp1 - tmp2);
                        auto tmp4 = std::exp(tmp3);
                        out_ptr5[static_cast<int64_t>(x1 + (513L*x0))] = tmp4;
                        tmp_acc0 = tmp_acc0 + tmp4;
                    }
                    tmp_acc0 = tmp_acc0 + at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return x + y; }, tmp_acc0_vec);
                    out_ptr6[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
            }
        }
    }
}
''')


cpp_fused_clone_constant_pad_nd_67 = async_compile.cpp_pybinding(['const bfloat16*', 'const bool*', 'const float*', 'const float*', 'bfloat16*', 'bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bool* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(1024L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = (-256L) + x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(0);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = static_cast<int64_t>(512);
                        auto tmp5 = tmp1 < tmp4;
                        auto tmp6 = tmp3 & tmp5;
                        auto tmp7 = [&]
                        {
                            auto tmp8 = at::vec::VecMask<float,1>::from(tmp6).template loadu<bfloat16,1>(in_ptr0 + static_cast<int64_t>((-196608L) + x2 + (64L*x0) + (768L*x1)));
                            auto tmp9 = at::vec::convert<float>(tmp8);
                            return tmp9;
                        }
                        ;
                        auto tmp10 = tmp6 ? tmp7() : at::vec::Vectorized<float>(static_cast<float>(-1.0));
                        auto tmp11 = at::vec::convert<bfloat16>(tmp10);
                        tmp11.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (65536L*x0)), 16);
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(768L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(513);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 < tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp8 = tmp5.template cast<float,1>().template loadu<float,1>(in_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0)));
                            auto tmp9 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp10 = at::vec::Vectorized<float>(tmp9);
                            auto tmp11 = tmp8 / tmp10;
                            auto tmp12 = static_cast<float>(0.0);
                            auto tmp13 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp14 = at::vec::Vectorized<float>(tmp12);
                            auto tmp15 = decltype(tmp14)::blendv(tmp11, tmp14, tmp13.template cast<float,1>());
                            auto tmp16 = (tmp15);
                            return tmp16;
                        }
                        ;
                        auto tmp19 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp17 = tmp6();
                                auto tmp18 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp17)::blendv(tmp18, tmp17, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp20 = at::vec::convert<bfloat16>(tmp19);
                        tmp20.store(out_ptr1 + static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(768L); x2<static_cast<int64_t>(770L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(513);
                        auto tmp3 = tmp1 < tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp6 = in_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0))];
                            auto tmp7 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp8 = tmp6 / tmp7;
                            auto tmp9 = static_cast<float>(0.0);
                            auto tmp10 = tmp5 ? tmp9 : tmp8;
                            auto tmp11 = c10::convert<float>(tmp10);
                            return tmp11;
                        }
                        ;
                        auto tmp12 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp13 = c10::convert<bfloat16>(tmp12);
                        out_ptr1[static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1))] = tmp13;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(49152L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x2 + (16384L*x1) + (65536L*x0)), 32);
                        tmp0.store(out_ptr2 + static_cast<int64_t>(x2 + (49152L*x1) + (98304L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused_clone_68 = async_compile.cpp_pybinding(['const bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       bfloat16* out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x2 + (64L*x0) + (32768L*x1)), 32);
                        tmp0.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (768L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_69 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    auto tmp19 = at::vec::convert<bfloat16>(tmp18);
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                    tmp19.store(out_ptr3 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_70 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<float>::loadu(out_ptr2 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<bfloat16>(tmp0);
                tmp1.store(out_ptr3 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_71 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<float>(tmp0);
                auto tmp2 = static_cast<float>(0.125);
                auto tmp3 = at::vec::Vectorized<float>(tmp2);
                auto tmp4 = tmp1 * tmp3;
                auto tmp5 = at::vec::convert<bfloat16>(tmp4);
                tmp5.store(in_out_ptr0 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_72 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(32L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 32);
                tmp0.store(in_out_ptr0 + static_cast<int64_t>(x0), 32);
            }
        }
    }
}
''')


cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_73 = async_compile.cpp_pybinding(['const bfloat16*', 'const bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'float*', 'float*', 'float*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bfloat16* in_ptr1,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2,
                       bfloat16* out_ptr3,
                       float* out_ptr4,
                       float* out_ptr5,
                       float* out_ptr6)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(2L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = at::vec::VectorizedN<int64_t,2>::arange(tmp5, 1);
                            auto tmp7 = static_cast<int64_t>(256);
                            auto tmp8 = at::vec::VectorizedN<int64_t,2>(tmp7);
                            auto tmp9 = at::vec::VecMask<int64_t,2>(tmp6 >= tmp8);
                            auto tmp10 = [&]
                            {
                                auto tmp11 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                    {
                                        if (tmp9.is_masked(x3_inner))
                                        {
                                            tmpbuf[x3_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp12 = static_cast<int64_t>(512);
                                auto tmp13 = at::vec::VectorizedN<int64_t,2>(tmp12);
                                auto tmp14 = at::vec::VecMask<int64_t,2>(tmp11 < tmp13);
                                auto tmp16 = tmp14 & tmp9;
                                auto tmp15 = [&]
                                {
                                    auto tmp17 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp16.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>(131072L + x3 + x3_inner + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp18 = at::vec::convert<float>(tmp17);
                                    return tmp18;
                                }
                                ;
                                auto tmp21 =
                                [&]
                                {
                                    if (tmp16.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp19 = tmp15();
                                        auto tmp20 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp19)::blendv(tmp20, tmp19, tmp16.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp21;
                            }
                            ;
                            auto tmp24 =
                            [&]
                            {
                                if (tmp9.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp22 = tmp10();
                                    auto tmp23 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp22)::blendv(tmp23, tmp22, tmp9.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp25 = static_cast<int64_t>(1);
                            auto tmp26 = tmp25 < tmp25;
                            auto tmp27 = [&]
                            {
                                auto tmp29 = at::vec::VecMask<float,1>::from(tmp26);
                                auto tmp30 = tmp9 & tmp29;
                                auto tmp28 = [&]
                                {
                                    auto tmp31 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp30.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp32 = static_cast<int64_t>(512);
                                    auto tmp33 = at::vec::VectorizedN<int64_t,2>(tmp32);
                                    auto tmp34 = at::vec::VecMask<int64_t,2>(tmp31 < tmp33);
                                    auto tmp36 = tmp34 & tmp30;
                                    auto tmp35 = [&]
                                    {
                                        auto tmp37 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp36.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp38 = at::vec::convert<float>(tmp37);
                                        return tmp38;
                                    }
                                    ;
                                    auto tmp41 =
                                    [&]
                                    {
                                        if (tmp36.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp39 = tmp35();
                                            auto tmp40 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp39)::blendv(tmp40, tmp39, tmp36.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp41;
                                }
                                ;
                                auto tmp44 =
                                [&]
                                {
                                    if (tmp30.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp42 = tmp28();
                                        auto tmp43 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp42)::blendv(tmp43, tmp42, tmp30.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp45 = static_cast<float>(0.0);
                                auto tmp46 = at::vec::Vectorized<float>(tmp45);
                                auto tmp47 = decltype(tmp44)::blendv(tmp46, tmp44, tmp9.template cast<float,1>());
                                return tmp47;
                            }
                            ;
                            auto tmp48 = tmp26 ? tmp27() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp49 = static_cast<float>(0.0);
                            auto tmp50 = at::vec::VecMask<float,1>::from(tmp26);
                            auto tmp51 = at::vec::Vectorized<float>(tmp49);
                            auto tmp52 = decltype(tmp48)::blendv(tmp51, tmp48, tmp50.template cast<float,1>());
                            auto tmp53 = decltype(tmp24)::blendv(tmp52, tmp24, tmp9.template cast<float,1>());
                            auto tmp54 = c10::convert<int64_t>(tmp0);
                            auto tmp55 = tmp54 < tmp25;
                            auto tmp56 = [&]
                            {
                                auto tmp58 = at::vec::VecMask<float,1>::from(tmp55);
                                auto tmp59 = tmp9 & tmp58;
                                auto tmp57 = [&]
                                {
                                    auto tmp60 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp59.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp61 = static_cast<int64_t>(512);
                                    auto tmp62 = at::vec::VectorizedN<int64_t,2>(tmp61);
                                    auto tmp63 = at::vec::VecMask<int64_t,2>(tmp60 < tmp62);
                                    auto tmp65 = tmp63 & tmp59;
                                    auto tmp64 = [&]
                                    {
                                        auto tmp66 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp65.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp67 = at::vec::convert<float>(tmp66);
                                        return tmp67;
                                    }
                                    ;
                                    auto tmp70 =
                                    [&]
                                    {
                                        if (tmp65.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp68 = tmp64();
                                            auto tmp69 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp68)::blendv(tmp69, tmp68, tmp65.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp70;
                                }
                                ;
                                auto tmp73 =
                                [&]
                                {
                                    if (tmp59.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp71 = tmp57();
                                        auto tmp72 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp71)::blendv(tmp72, tmp71, tmp59.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp74 = decltype(tmp73)::blendv(tmp51, tmp73, tmp9.template cast<float,1>());
                                return tmp74;
                            }
                            ;
                            auto tmp75 = tmp55 ? tmp56() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp76 = at::vec::VecMask<float,1>::from(tmp55);
                            auto tmp77 = decltype(tmp75)::blendv(tmp51, tmp75, tmp76.template cast<float,1>());
                            auto tmp78 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp79 = decltype(tmp53)::blendv(tmp77, tmp53, tmp78.template cast<float,1>());
                            auto tmp80 = at::vec::convert<bfloat16>(tmp79);
                            tmp80.store(out_ptr0 + static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(256);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + (513L*x1))), static_cast<int64_t>(512L)));
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = static_cast<int64_t>(512);
                                auto tmp12 = tmp10 < tmp11;
                                auto tmp13 = [&]
                                {
                                    auto tmp14 = in_ptr0[static_cast<int64_t>(131072L + x3 + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                    auto tmp15 = c10::convert<float>(tmp14);
                                    return tmp15;
                                }
                                ;
                                auto tmp16 = tmp12 ? tmp13() : static_cast<decltype(tmp13())>(0.0);
                                return tmp16;
                            }
                            ;
                            auto tmp17 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp18 = static_cast<int64_t>(1);
                            auto tmp19 = tmp18 < tmp18;
                            auto tmp20 = [&]
                            {
                                auto tmp21 = [&]
                                {
                                    auto tmp22 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp23 = c10::convert<int64_t>(tmp22);
                                    auto tmp24 = static_cast<int64_t>(512);
                                    auto tmp25 = tmp23 < tmp24;
                                    auto tmp26 = [&]
                                    {
                                        auto tmp27 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                        auto tmp28 = c10::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp29 = tmp25 ? tmp26() : static_cast<decltype(tmp26())>(0.0);
                                    return tmp29;
                                }
                                ;
                                auto tmp30 = tmp7 ? tmp21() : static_cast<decltype(tmp21())>(0.0);
                                auto tmp31 = static_cast<float>(0.0);
                                auto tmp32 = tmp7 ? tmp30 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                            auto tmp34 = static_cast<float>(0.0);
                            auto tmp35 = tmp19 ? tmp33 : tmp34;
                            auto tmp36 = tmp7 ? tmp17 : tmp35;
                            auto tmp37 = c10::convert<int64_t>(tmp0);
                            auto tmp38 = tmp37 < tmp18;
                            auto tmp39 = [&]
                            {
                                auto tmp40 = [&]
                                {
                                    auto tmp41 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp42 = c10::convert<int64_t>(tmp41);
                                    auto tmp43 = static_cast<int64_t>(512);
                                    auto tmp44 = tmp42 < tmp43;
                                    auto tmp45 = [&]
                                    {
                                        auto tmp46 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                        auto tmp47 = c10::convert<float>(tmp46);
                                        return tmp47;
                                    }
                                    ;
                                    auto tmp48 = tmp44 ? tmp45() : static_cast<decltype(tmp45())>(0.0);
                                    return tmp48;
                                }
                                ;
                                auto tmp49 = tmp7 ? tmp40() : static_cast<decltype(tmp40())>(0.0);
                                auto tmp50 = tmp7 ? tmp49 : tmp34;
                                return tmp50;
                            }
                            ;
                            auto tmp51 = tmp38 ? tmp39() : static_cast<decltype(tmp39())>(0.0);
                            auto tmp52 = tmp38 ? tmp51 : tmp34;
                            auto tmp53 = tmp3 ? tmp36 : tmp52;
                            auto tmp54 = c10::convert<bfloat16>(tmp53);
                            out_ptr0[static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0))] = tmp54;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(256L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp96 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp132 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = at::vec::VectorizedN<int64_t,2>::arange(tmp10, 1);
                                auto tmp12 = at::vec::VectorizedN<int64_t,2>(tmp6);
                                auto tmp13 = at::vec::VecMask<int64_t,2>(tmp11 >= tmp12);
                                auto tmp14 = static_cast<int64_t>(256);
                                auto tmp15 = at::vec::VectorizedN<int64_t,2>(tmp14);
                                auto tmp16 = at::vec::VecMask<int64_t,2>(tmp11 < tmp15);
                                auto tmp17 = tmp13 & tmp16;
                                auto tmp19 = at::vec::VecMask<float,1>::from(tmp7);
                                auto tmp20 = tmp17 & tmp19;
                                auto tmp18 = [&]
                                {
                                    auto tmp21 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp20.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp22 = static_cast<int64_t>(512);
                                    auto tmp23 = at::vec::VectorizedN<int64_t,2>(tmp22);
                                    auto tmp24 = at::vec::VecMask<int64_t,2>(tmp21 < tmp23);
                                    auto tmp26 = tmp24 & tmp20;
                                    auto tmp25 = [&]
                                    {
                                        auto tmp27 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp26.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp28 = at::vec::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp31 =
                                    [&]
                                    {
                                        if (tmp26.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp29 = tmp25();
                                            auto tmp30 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp31;
                                }
                                ;
                                auto tmp34 =
                                [&]
                                {
                                    if (tmp20.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp32 = tmp18();
                                        auto tmp33 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp32)::blendv(tmp33, tmp32, tmp20.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp35 = static_cast<int64_t>(0);
                                auto tmp36 = tmp35 >= tmp6;
                                auto tmp38 = tmp36 & tmp7;
                                auto tmp37 = [&]
                                {
                                    auto tmp40 = at::vec::VecMask<float,1>::from(tmp38);
                                    auto tmp41 = tmp16 & tmp40;
                                    auto tmp39 = [&]
                                    {
                                        auto tmp42 =
                                        [&]
                                        {
                                            __at_align__ std::array<int64_t, 16> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp41.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                                }
                                            }
                                            return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp43 = static_cast<int64_t>(512);
                                        auto tmp44 = at::vec::VectorizedN<int64_t,2>(tmp43);
                                        auto tmp45 = at::vec::VecMask<int64_t,2>(tmp42 < tmp44);
                                        auto tmp47 = tmp45 & tmp41;
                                        auto tmp46 = [&]
                                        {
                                            auto tmp48 =
                                            [&]
                                            {
                                                __at_align__ std::array<bfloat16, 32> tmpbuf;
                                                #pragma GCC unroll 16
                                                for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                                {
                                                    if (tmp47.is_masked(x3_inner))
                                                    {
                                                        tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                    }
                                                }
                                                return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                            }
                                            ()
                                            ;
                                            auto tmp49 = at::vec::convert<float>(tmp48);
                                            return tmp49;
                                        }
                                        ;
                                        auto tmp52 =
                                        [&]
                                        {
                                            if (tmp47.all_zero())
                                            {
                                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            }
                                            else
                                            {
                                                auto tmp50 = tmp46();
                                                auto tmp51 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                                return decltype(tmp50)::blendv(tmp51, tmp50, tmp47.template cast<float,1>());
                                            }
                                        }
                                        ()
                                        ;
                                        return tmp52;
                                    }
                                    ;
                                    auto tmp55 =
                                    [&]
                                    {
                                        if (tmp41.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp53 = tmp39();
                                            auto tmp54 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp53)::blendv(tmp54, tmp53, tmp41.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    auto tmp56 = at::vec::VecMask<float,1>::from(tmp38).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                    auto tmp57 = at::vec::convert<float>(tmp56);
                                    auto tmp58 = decltype(tmp55)::blendv(tmp57, tmp55, tmp16.template cast<float,1>());
                                    return tmp58;
                                }
                                ;
                                auto tmp59 = tmp36 ? tmp37() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                                auto tmp60 = at::vec::VecMask<float,1>::from(tmp7).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp61 = at::vec::convert<float>(tmp60);
                                auto tmp62 = at::vec::VecMask<float,1>::from(tmp36);
                                auto tmp63 = decltype(tmp59)::blendv(tmp61, tmp59, tmp62.template cast<float,1>());
                                auto tmp64 = decltype(tmp34)::blendv(tmp63, tmp34, tmp17.template cast<float,1>());
                                return tmp64;
                            }
                            ;
                            auto tmp65 = tmp7 ? tmp8() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp66 = static_cast<int64_t>(0);
                            auto tmp67 = tmp66 >= tmp6;
                            auto tmp68 = [&]
                            {
                                auto tmp69 = x3;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(256);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 < tmp73);
                                auto tmp76 = at::vec::VecMask<float,1>::from(tmp67);
                                auto tmp77 = tmp74 & tmp76;
                                auto tmp75 = [&]
                                {
                                    auto tmp78 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp77.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp79 = static_cast<int64_t>(512);
                                    auto tmp80 = at::vec::VectorizedN<int64_t,2>(tmp79);
                                    auto tmp81 = at::vec::VecMask<int64_t,2>(tmp78 < tmp80);
                                    auto tmp83 = tmp81 & tmp77;
                                    auto tmp82 = [&]
                                    {
                                        auto tmp84 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp83.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp85 = at::vec::convert<float>(tmp84);
                                        return tmp85;
                                    }
                                    ;
                                    auto tmp88 =
                                    [&]
                                    {
                                        if (tmp83.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp86 = tmp82();
                                            auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp86)::blendv(tmp87, tmp86, tmp83.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp88;
                                }
                                ;
                                auto tmp91 =
                                [&]
                                {
                                    if (tmp77.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp89 = tmp75();
                                        auto tmp90 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp89)::blendv(tmp90, tmp89, tmp77.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp92 = at::vec::VecMask<float,1>::from(tmp67).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp93 = at::vec::convert<float>(tmp92);
                                auto tmp94 = decltype(tmp91)::blendv(tmp93, tmp91, tmp74.template cast<float,1>());
                                return tmp94;
                            }
                            ;
                            auto tmp95 = tmp67 ? tmp68() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp97 = at::vec::convert<float>(tmp96);
                            auto tmp98 = at::vec::VecMask<float,1>::from(tmp67);
                            auto tmp99 = decltype(tmp95)::blendv(tmp97, tmp95, tmp98.template cast<float,1>());
                            auto tmp100 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp101 = decltype(tmp65)::blendv(tmp99, tmp65, tmp100.template cast<float,1>());
                            auto tmp102 = c10::convert<int64_t>(tmp0);
                            auto tmp103 = tmp102 >= tmp6;
                            auto tmp104 = [&]
                            {
                                auto tmp105 = x3;
                                auto tmp106 = c10::convert<int64_t>(tmp105);
                                auto tmp107 = at::vec::VectorizedN<int64_t,2>::arange(tmp106, 1);
                                auto tmp108 = static_cast<int64_t>(256);
                                auto tmp109 = at::vec::VectorizedN<int64_t,2>(tmp108);
                                auto tmp110 = at::vec::VecMask<int64_t,2>(tmp107 < tmp109);
                                auto tmp112 = at::vec::VecMask<float,1>::from(tmp103);
                                auto tmp113 = tmp110 & tmp112;
                                auto tmp111 = [&]
                                {
                                    auto tmp114 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp113.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp115 = static_cast<int64_t>(512);
                                    auto tmp116 = at::vec::VectorizedN<int64_t,2>(tmp115);
                                    auto tmp117 = at::vec::VecMask<int64_t,2>(tmp114 < tmp116);
                                    auto tmp119 = tmp117 & tmp113;
                                    auto tmp118 = [&]
                                    {
                                        auto tmp120 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp119.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp121 = at::vec::convert<float>(tmp120);
                                        return tmp121;
                                    }
                                    ;
                                    auto tmp124 =
                                    [&]
                                    {
                                        if (tmp119.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp122 = tmp118();
                                            auto tmp123 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp122)::blendv(tmp123, tmp122, tmp119.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp124;
                                }
                                ;
                                auto tmp127 =
                                [&]
                                {
                                    if (tmp113.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp125 = tmp111();
                                        auto tmp126 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp125)::blendv(tmp126, tmp125, tmp113.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp128 = at::vec::VecMask<float,1>::from(tmp103).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp129 = at::vec::convert<float>(tmp128);
                                auto tmp130 = decltype(tmp127)::blendv(tmp129, tmp127, tmp110.template cast<float,1>());
                                return tmp130;
                            }
                            ;
                            auto tmp131 = tmp103 ? tmp104() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp133 = at::vec::convert<float>(tmp132);
                            auto tmp134 = at::vec::VecMask<float,1>::from(tmp103);
                            auto tmp135 = decltype(tmp131)::blendv(tmp133, tmp131, tmp134.template cast<float,1>());
                            auto tmp136 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp137 = decltype(tmp101)::blendv(tmp135, tmp101, tmp136.template cast<float,1>());
                            auto tmp138 = at::vec::convert<bfloat16>(tmp137);
                            tmp138.store(out_ptr1 + static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp68 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                            auto tmp93 = out_ptr0[static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0))];
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = tmp10 >= tmp6;
                                auto tmp12 = static_cast<int64_t>(256);
                                auto tmp13 = tmp10 < tmp12;
                                auto tmp14 = tmp11 & tmp13;
                                auto tmp15 = [&]
                                {
                                    auto tmp16 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp17 = c10::convert<int64_t>(tmp16);
                                    auto tmp18 = static_cast<int64_t>(512);
                                    auto tmp19 = tmp17 < tmp18;
                                    auto tmp20 = [&]
                                    {
                                        auto tmp21 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                        auto tmp22 = c10::convert<float>(tmp21);
                                        return tmp22;
                                    }
                                    ;
                                    auto tmp23 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                                    return tmp23;
                                }
                                ;
                                auto tmp24 = tmp14 ? tmp15() : static_cast<decltype(tmp15())>(0.0);
                                auto tmp25 = static_cast<int64_t>(0);
                                auto tmp26 = tmp25 >= tmp6;
                                auto tmp27 = [&]
                                {
                                    auto tmp28 = [&]
                                    {
                                        auto tmp29 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                        auto tmp30 = c10::convert<int64_t>(tmp29);
                                        auto tmp31 = static_cast<int64_t>(512);
                                        auto tmp32 = tmp30 < tmp31;
                                        auto tmp33 = [&]
                                        {
                                            auto tmp34 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                            auto tmp35 = c10::convert<float>(tmp34);
                                            return tmp35;
                                        }
                                        ;
                                        auto tmp36 = tmp32 ? tmp33() : static_cast<decltype(tmp33())>(0.0);
                                        return tmp36;
                                    }
                                    ;
                                    auto tmp37 = tmp13 ? tmp28() : static_cast<decltype(tmp28())>(0.0);
                                    auto tmp38 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                    auto tmp39 = c10::convert<float>(tmp38);
                                    auto tmp40 = tmp13 ? tmp37 : tmp39;
                                    return tmp40;
                                }
                                ;
                                auto tmp41 = tmp26 ? tmp27() : static_cast<decltype(tmp27())>(0.0);
                                auto tmp42 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp43 = c10::convert<float>(tmp42);
                                auto tmp44 = tmp26 ? tmp41 : tmp43;
                                auto tmp45 = tmp14 ? tmp24 : tmp44;
                                return tmp45;
                            }
                            ;
                            auto tmp46 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp47 = static_cast<int64_t>(0);
                            auto tmp48 = tmp47 >= tmp6;
                            auto tmp49 = [&]
                            {
                                auto tmp50 = x3;
                                auto tmp51 = c10::convert<int64_t>(tmp50);
                                auto tmp52 = static_cast<int64_t>(256);
                                auto tmp53 = tmp51 < tmp52;
                                auto tmp54 = [&]
                                {
                                    auto tmp55 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp56 = c10::convert<int64_t>(tmp55);
                                    auto tmp57 = static_cast<int64_t>(512);
                                    auto tmp58 = tmp56 < tmp57;
                                    auto tmp59 = [&]
                                    {
                                        auto tmp60 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp61 = c10::convert<float>(tmp60);
                                        return tmp61;
                                    }
                                    ;
                                    auto tmp62 = tmp58 ? tmp59() : static_cast<decltype(tmp59())>(0.0);
                                    return tmp62;
                                }
                                ;
                                auto tmp63 = tmp53 ? tmp54() : static_cast<decltype(tmp54())>(0.0);
                                auto tmp64 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp65 = c10::convert<float>(tmp64);
                                auto tmp66 = tmp53 ? tmp63 : tmp65;
                                return tmp66;
                            }
                            ;
                            auto tmp67 = tmp48 ? tmp49() : static_cast<decltype(tmp49())>(0.0);
                            auto tmp69 = c10::convert<float>(tmp68);
                            auto tmp70 = tmp48 ? tmp67 : tmp69;
                            auto tmp71 = tmp7 ? tmp46 : tmp70;
                            auto tmp72 = c10::convert<int64_t>(tmp0);
                            auto tmp73 = tmp72 >= tmp6;
                            auto tmp74 = [&]
                            {
                                auto tmp75 = x3;
                                auto tmp76 = c10::convert<int64_t>(tmp75);
                                auto tmp77 = static_cast<int64_t>(256);
                                auto tmp78 = tmp76 < tmp77;
                                auto tmp79 = [&]
                                {
                                    auto tmp80 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp81 = c10::convert<int64_t>(tmp80);
                                    auto tmp82 = static_cast<int64_t>(512);
                                    auto tmp83 = tmp81 < tmp82;
                                    auto tmp84 = [&]
                                    {
                                        auto tmp85 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp86 = c10::convert<float>(tmp85);
                                        return tmp86;
                                    }
                                    ;
                                    auto tmp87 = tmp83 ? tmp84() : static_cast<decltype(tmp84())>(0.0);
                                    return tmp87;
                                }
                                ;
                                auto tmp88 = tmp78 ? tmp79() : static_cast<decltype(tmp79())>(0.0);
                                auto tmp89 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp90 = c10::convert<float>(tmp89);
                                auto tmp91 = tmp78 ? tmp88 : tmp90;
                                return tmp91;
                            }
                            ;
                            auto tmp92 = tmp73 ? tmp74() : static_cast<decltype(tmp74())>(0.0);
                            auto tmp94 = c10::convert<float>(tmp93);
                            auto tmp95 = tmp73 ? tmp92 : tmp94;
                            auto tmp96 = tmp3 ? tmp71 : tmp95;
                            auto tmp97 = c10::convert<bfloat16>(tmp96);
                            out_ptr1[static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0))] = tmp97;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp93 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)), 16);
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(256);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 >= tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp8 = c10::convert<int64_t>(tmp7);
                            auto tmp9 = at::vec::VectorizedN<int64_t,2>::arange(tmp8, -1);
                            auto tmp10 = static_cast<int64_t>(0);
                            auto tmp11 = at::vec::VectorizedN<int64_t,2>(tmp10);
                            auto tmp12 = at::vec::VecMask<int64_t,2>(tmp9 <= tmp11);
                            auto tmp13 = static_cast<float>(1.0);
                            auto tmp14 = static_cast<float>(0.0);
                            auto tmp15 = at::vec::Vectorized<float>(tmp13);
                            auto tmp16 = at::vec::Vectorized<float>(tmp14);
                            auto tmp17 = decltype(tmp15)::blendv(tmp16, tmp15, tmp12.template cast<float,1>());
                            auto tmp18 = at::vec::VecMask<float,1>::from<float,1>(tmp17);
                            auto tmp19 = 256L + x1;
                            auto tmp20 = c10::convert<int64_t>(tmp19);
                            auto tmp21 = tmp20 < tmp3;
                            auto tmp23 = at::vec::VecMask<float,1>::from(tmp21);
                            auto tmp24 = tmp23 & tmp5;
                            auto tmp22 = [&]
                            {
                                auto tmp25 = static_cast<int64_t>(257);
                                auto tmp26 = at::vec::VectorizedN<int64_t,2>(tmp25);
                                auto tmp27 = at::vec::VecMask<int64_t,2>(tmp2 < tmp26);
                                auto tmp29 = tmp27 & tmp24;
                                auto tmp28 = [&]
                                {
                                    auto tmp30 = 1L + x1 + x2;
                                    auto tmp31 = c10::convert<int64_t>(tmp30);
                                    auto tmp32 = at::vec::VectorizedN<int64_t,2>::arange(tmp31, 1);
                                    auto tmp33 = at::vec::VecMask<int64_t,2>(tmp32 <= tmp11);
                                    auto tmp34 = decltype(tmp15)::blendv(tmp16, tmp15, tmp33.template cast<float,1>());
                                    auto tmp35 = at::vec::VecMask<float,1>::from<float,1>(tmp34);
                                    auto tmp36 = tmp29.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                    auto tmp37 = at::vec::convert<float>(tmp36);
                                    auto tmp38 = -std::numeric_limits<float>::infinity();
                                    auto tmp39 = at::vec::Vectorized<float>(tmp38);
                                    auto tmp40 = decltype(tmp39)::blendv(tmp37, tmp39, tmp35.template cast<float,1>());
                                    return tmp40;
                                }
                                ;
                                auto tmp43 =
                                [&]
                                {
                                    if (tmp29.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp41 = tmp28();
                                        auto tmp42 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp41)::blendv(tmp42, tmp41, tmp29.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp44 = tmp24.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp45 = at::vec::convert<float>(tmp44);
                                auto tmp46 = decltype(tmp43)::blendv(tmp45, tmp43, tmp27.template cast<float,1>());
                                return tmp46;
                            }
                            ;
                            auto tmp49 =
                            [&]
                            {
                                if (tmp24.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp47 = tmp22();
                                    auto tmp48 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp47)::blendv(tmp48, tmp47, tmp24.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp50 = tmp5.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp51 = at::vec::convert<float>(tmp50);
                            auto tmp52 = decltype(tmp49)::blendv(tmp51, tmp49, tmp23.template cast<float,1>());
                            auto tmp53 = -std::numeric_limits<float>::infinity();
                            auto tmp54 = at::vec::Vectorized<float>(tmp53);
                            auto tmp55 = decltype(tmp54)::blendv(tmp52, tmp54, tmp18.template cast<float,1>());
                            return tmp55;
                        }
                        ;
                        auto tmp58 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp56 = tmp6();
                                auto tmp57 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp56)::blendv(tmp57, tmp56, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp59 = 256L + x1;
                        auto tmp60 = c10::convert<int64_t>(tmp59);
                        auto tmp61 = tmp60 < tmp3;
                        auto tmp62 = [&]
                        {
                            auto tmp63 = static_cast<int64_t>(257);
                            auto tmp64 = at::vec::VectorizedN<int64_t,2>(tmp63);
                            auto tmp65 = at::vec::VecMask<int64_t,2>(tmp2 < tmp64);
                            auto tmp67 = at::vec::VecMask<float,1>::from(tmp61);
                            auto tmp68 = tmp65 & tmp67;
                            auto tmp66 = [&]
                            {
                                auto tmp69 = 1L + x1 + x2;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(0);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 <= tmp73);
                                auto tmp75 = static_cast<float>(1.0);
                                auto tmp76 = static_cast<float>(0.0);
                                auto tmp77 = at::vec::Vectorized<float>(tmp75);
                                auto tmp78 = at::vec::Vectorized<float>(tmp76);
                                auto tmp79 = decltype(tmp77)::blendv(tmp78, tmp77, tmp74.template cast<float,1>());
                                auto tmp80 = at::vec::VecMask<float,1>::from<float,1>(tmp79);
                                auto tmp81 = tmp68.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp82 = at::vec::convert<float>(tmp81);
                                auto tmp83 = -std::numeric_limits<float>::infinity();
                                auto tmp84 = at::vec::Vectorized<float>(tmp83);
                                auto tmp85 = decltype(tmp84)::blendv(tmp82, tmp84, tmp80.template cast<float,1>());
                                return tmp85;
                            }
                            ;
                            auto tmp88 =
                            [&]
                            {
                                if (tmp68.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp86 = tmp66();
                                    auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp86)::blendv(tmp87, tmp86, tmp68.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp89 = at::vec::VecMask<float,1>::from(tmp61).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp90 = at::vec::convert<float>(tmp89);
                            auto tmp91 = decltype(tmp88)::blendv(tmp90, tmp88, tmp65.template cast<float,1>());
                            return tmp91;
                        }
                        ;
                        auto tmp92 = tmp61 ? tmp62() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp94 = at::vec::convert<float>(tmp93);
                        auto tmp95 = at::vec::VecMask<float,1>::from(tmp61);
                        auto tmp96 = decltype(tmp92)::blendv(tmp94, tmp92, tmp95.template cast<float,1>());
                        auto tmp97 = decltype(tmp58)::blendv(tmp96, tmp58, tmp5.template cast<float,1>());
                        auto tmp98 = at::vec::convert<bfloat16>(tmp97);
                        tmp98.store(out_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp64 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp6 = c10::convert<int64_t>(tmp5);
                            auto tmp7 = static_cast<int64_t>(0);
                            auto tmp8 = tmp6 <= tmp7;
                            auto tmp9 = static_cast<float>(1.0);
                            auto tmp10 = static_cast<float>(0.0);
                            auto tmp11 = tmp8 ? tmp9 : tmp10;
                            auto tmp12 = c10::convert<bool>(tmp11);
                            auto tmp13 = 256L + x1;
                            auto tmp14 = c10::convert<int64_t>(tmp13);
                            auto tmp15 = tmp14 < tmp2;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = static_cast<int64_t>(257);
                                auto tmp18 = tmp1 < tmp17;
                                auto tmp19 = [&]
                                {
                                    auto tmp20 = 1L + x1 + x2;
                                    auto tmp21 = c10::convert<int64_t>(tmp20);
                                    auto tmp22 = tmp21 <= tmp7;
                                    auto tmp23 = tmp22 ? tmp9 : tmp10;
                                    auto tmp24 = c10::convert<bool>(tmp23);
                                    auto tmp25 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                    auto tmp26 = c10::convert<float>(tmp25);
                                    auto tmp27 = -std::numeric_limits<float>::infinity();
                                    auto tmp28 = tmp24 ? tmp27 : tmp26;
                                    return tmp28;
                                }
                                ;
                                auto tmp29 = tmp18 ? tmp19() : static_cast<decltype(tmp19())>(0.0);
                                auto tmp30 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp31 = c10::convert<float>(tmp30);
                                auto tmp32 = tmp18 ? tmp29 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp34 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp35 = c10::convert<float>(tmp34);
                            auto tmp36 = tmp15 ? tmp33 : tmp35;
                            auto tmp37 = -std::numeric_limits<float>::infinity();
                            auto tmp38 = tmp12 ? tmp37 : tmp36;
                            return tmp38;
                        }
                        ;
                        auto tmp39 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp40 = 256L + x1;
                        auto tmp41 = c10::convert<int64_t>(tmp40);
                        auto tmp42 = tmp41 < tmp2;
                        auto tmp43 = [&]
                        {
                            auto tmp44 = static_cast<int64_t>(257);
                            auto tmp45 = tmp1 < tmp44;
                            auto tmp46 = [&]
                            {
                                auto tmp47 = 1L + x1 + x2;
                                auto tmp48 = c10::convert<int64_t>(tmp47);
                                auto tmp49 = static_cast<int64_t>(0);
                                auto tmp50 = tmp48 <= tmp49;
                                auto tmp51 = static_cast<float>(1.0);
                                auto tmp52 = static_cast<float>(0.0);
                                auto tmp53 = tmp50 ? tmp51 : tmp52;
                                auto tmp54 = c10::convert<bool>(tmp53);
                                auto tmp55 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp56 = c10::convert<float>(tmp55);
                                auto tmp57 = -std::numeric_limits<float>::infinity();
                                auto tmp58 = tmp54 ? tmp57 : tmp56;
                                return tmp58;
                            }
                            ;
                            auto tmp59 = tmp45 ? tmp46() : static_cast<decltype(tmp46())>(0.0);
                            auto tmp60 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp61 = c10::convert<float>(tmp60);
                            auto tmp62 = tmp45 ? tmp59 : tmp61;
                            return tmp62;
                        }
                        ;
                        auto tmp63 = tmp42 ? tmp43() : static_cast<decltype(tmp43())>(0.0);
                        auto tmp65 = c10::convert<float>(tmp64);
                        auto tmp66 = tmp42 ? tmp63 : tmp65;
                        auto tmp67 = tmp3 ? tmp39 : tmp66;
                        auto tmp68 = c10::convert<bfloat16>(tmp67);
                        out_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0))] = tmp68;
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp45 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)), 16);
                        auto tmp83 = at::vec::Vectorized<bfloat16>::loadu(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)), 16);
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr2 + static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0)));
                            auto tmp6 = at::vec::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = at::vec::VectorizedN<int64_t,2>::arange(tmp13, 1);
                            auto tmp15 = static_cast<int64_t>(257);
                            auto tmp16 = at::vec::VectorizedN<int64_t,2>(tmp15);
                            auto tmp17 = at::vec::VecMask<int64_t,2>(tmp14 < tmp16);
                            auto tmp19 = at::vec::VecMask<float,1>::from(tmp10);
                            auto tmp20 = tmp17 & tmp19;
                            auto tmp18 = [&]
                            {
                                auto tmp21 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp22 = c10::convert<int64_t>(tmp21);
                                auto tmp23 = at::vec::VectorizedN<int64_t,2>::arange(tmp22, 1);
                                auto tmp24 = static_cast<int64_t>(0);
                                auto tmp25 = at::vec::VectorizedN<int64_t,2>(tmp24);
                                auto tmp26 = at::vec::VecMask<int64_t,2>(tmp23 <= tmp25);
                                auto tmp27 = static_cast<float>(1.0);
                                auto tmp28 = static_cast<float>(0.0);
                                auto tmp29 = at::vec::Vectorized<float>(tmp27);
                                auto tmp30 = at::vec::Vectorized<float>(tmp28);
                                auto tmp31 = decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                auto tmp32 = at::vec::VecMask<float,1>::from<float,1>(tmp31);
                                auto tmp33 = tmp20.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                                auto tmp34 = at::vec::convert<float>(tmp33);
                                auto tmp35 = -std::numeric_limits<float>::infinity();
                                auto tmp36 = at::vec::Vectorized<float>(tmp35);
                                auto tmp37 = decltype(tmp36)::blendv(tmp34, tmp36, tmp32.template cast<float,1>());
                                return tmp37;
                            }
                            ;
                            auto tmp40 =
                            [&]
                            {
                                if (tmp20.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp38 = tmp18();
                                    auto tmp39 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp38)::blendv(tmp39, tmp38, tmp20.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp41 = at::vec::VecMask<float,1>::from(tmp10).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                            auto tmp42 = at::vec::convert<float>(tmp41);
                            auto tmp43 = decltype(tmp40)::blendv(tmp42, tmp40, tmp17.template cast<float,1>());
                            return tmp43;
                        }
                        ;
                        auto tmp44 = tmp10 ? tmp11() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp46 = at::vec::convert<float>(tmp45);
                        auto tmp47 = at::vec::VecMask<float,1>::from(tmp10);
                        auto tmp48 = decltype(tmp44)::blendv(tmp46, tmp44, tmp47.template cast<float,1>());
                        auto tmp49 = at::vec::VecMask<float,1>::from(tmp3);
                        auto tmp50 = decltype(tmp7)::blendv(tmp48, tmp7, tmp49.template cast<float,1>());
                        auto tmp51 = [&]
                        {
                            auto tmp52 = x2;
                            auto tmp53 = c10::convert<int64_t>(tmp52);
                            auto tmp54 = at::vec::VectorizedN<int64_t,2>::arange(tmp53, 1);
                            auto tmp55 = at::vec::VectorizedN<int64_t,2>(tmp2);
                            auto tmp56 = at::vec::VecMask<int64_t,2>(tmp54 >= tmp55);
                            auto tmp58 = tmp56 & tmp49;
                            auto tmp57 = [&]
                            {
                                auto tmp59 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp60 = c10::convert<int64_t>(tmp59);
                                auto tmp61 = at::vec::VectorizedN<int64_t,2>::arange(tmp60, -1);
                                auto tmp62 = static_cast<int64_t>(0);
                                auto tmp63 = at::vec::VectorizedN<int64_t,2>(tmp62);
                                auto tmp64 = at::vec::VecMask<int64_t,2>(tmp61 <= tmp63);
                                auto tmp65 = static_cast<float>(1.0);
                                auto tmp66 = static_cast<float>(0.0);
                                auto tmp67 = at::vec::Vectorized<float>(tmp65);
                                auto tmp68 = at::vec::Vectorized<float>(tmp66);
                                auto tmp69 = decltype(tmp67)::blendv(tmp68, tmp67, tmp64.template cast<float,1>());
                                auto tmp70 = at::vec::VecMask<float,1>::from<float,1>(tmp69);
                                auto tmp71 = tmp58.template cast<float,1>().template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                                auto tmp72 = at::vec::convert<float>(tmp71);
                                auto tmp73 = -std::numeric_limits<float>::infinity();
                                auto tmp74 = at::vec::Vectorized<float>(tmp73);
                                auto tmp75 = decltype(tmp74)::blendv(tmp72, tmp74, tmp70.template cast<float,1>());
                                return tmp75;
                            }
                            ;
                            auto tmp78 =
                            [&]
                            {
                                if (tmp58.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp76 = tmp57();
                                    auto tmp77 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp76)::blendv(tmp77, tmp76, tmp58.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp79 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                            auto tmp80 = at::vec::convert<float>(tmp79);
                            auto tmp81 = decltype(tmp78)::blendv(tmp80, tmp78, tmp56.template cast<float,1>());
                            return tmp81;
                        }
                        ;
                        auto tmp82 = tmp3 ? tmp51() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp84 = at::vec::convert<float>(tmp83);
                        auto tmp85 = decltype(tmp82)::blendv(tmp84, tmp82, tmp49.template cast<float,1>());
                        auto tmp86 = tmp50 + tmp85;
                        auto tmp87 = at::vec::convert<bfloat16>(tmp86);
                        tmp87.store(out_ptr3 + static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp34 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                        auto tmp60 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = out_ptr2[static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0))];
                            auto tmp6 = c10::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = static_cast<int64_t>(257);
                            auto tmp15 = tmp13 < tmp14;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp18 = c10::convert<int64_t>(tmp17);
                                auto tmp19 = static_cast<int64_t>(0);
                                auto tmp20 = tmp18 <= tmp19;
                                auto tmp21 = static_cast<float>(1.0);
                                auto tmp22 = static_cast<float>(0.0);
                                auto tmp23 = tmp20 ? tmp21 : tmp22;
                                auto tmp24 = c10::convert<bool>(tmp23);
                                auto tmp25 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                                auto tmp26 = c10::convert<float>(tmp25);
                                auto tmp27 = -std::numeric_limits<float>::infinity();
                                auto tmp28 = tmp24 ? tmp27 : tmp26;
                                return tmp28;
                            }
                            ;
                            auto tmp29 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp30 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                            auto tmp31 = c10::convert<float>(tmp30);
                            auto tmp32 = tmp15 ? tmp29 : tmp31;
                            return tmp32;
                        }
                        ;
                        auto tmp33 = tmp10 ? tmp11() : static_cast<decltype(tmp11())>(0.0);
                        auto tmp35 = c10::convert<float>(tmp34);
                        auto tmp36 = tmp10 ? tmp33 : tmp35;
                        auto tmp37 = tmp3 ? tmp7 : tmp36;
                        auto tmp38 = [&]
                        {
                            auto tmp39 = x2;
                            auto tmp40 = c10::convert<int64_t>(tmp39);
                            auto tmp41 = tmp40 >= tmp2;
                            auto tmp42 = [&]
                            {
                                auto tmp43 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp44 = c10::convert<int64_t>(tmp43);
                                auto tmp45 = static_cast<int64_t>(0);
                                auto tmp46 = tmp44 <= tmp45;
                                auto tmp47 = static_cast<float>(1.0);
                                auto tmp48 = static_cast<float>(0.0);
                                auto tmp49 = tmp46 ? tmp47 : tmp48;
                                auto tmp50 = c10::convert<bool>(tmp49);
                                auto tmp51 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                                auto tmp52 = c10::convert<float>(tmp51);
                                auto tmp53 = -std::numeric_limits<float>::infinity();
                                auto tmp54 = tmp50 ? tmp53 : tmp52;
                                return tmp54;
                            }
                            ;
                            auto tmp55 = tmp41 ? tmp42() : static_cast<decltype(tmp42())>(0.0);
                            auto tmp56 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                            auto tmp57 = c10::convert<float>(tmp56);
                            auto tmp58 = tmp41 ? tmp55 : tmp57;
                            return tmp58;
                        }
                        ;
                        auto tmp59 = tmp3 ? tmp38() : static_cast<decltype(tmp38())>(0.0);
                        auto tmp61 = c10::convert<float>(tmp60);
                        auto tmp62 = tmp3 ? tmp59 : tmp61;
                        auto tmp63 = decltype(tmp37)(tmp37 + tmp62);
                        auto tmp64 = c10::convert<bfloat16>(tmp63);
                        out_ptr3[static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1))] = tmp64;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(6144L); x0+=static_cast<int64_t>(1L))
            {
                {
                    float tmp_acc0 = -std::numeric_limits<float>::infinity();
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(-std::numeric_limits<float>::infinity());
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        tmp_acc0_vec = at::vec::maximum(tmp_acc0_vec, tmp1);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp1 = c10::convert<float>(tmp0);
                        tmp_acc0 = max_propagate_nan(tmp_acc0, tmp1);
                    }
                    tmp_acc0 = max_propagate_nan(tmp_acc0, at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return at::vec::maximum(x, y); }, tmp_acc0_vec));
                    out_ptr4[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
                {
                    float tmp_acc0 = 0;
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(0);
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = at::vec::Vectorized<float>(tmp2);
                        auto tmp4 = tmp1 - tmp3;
                        auto tmp5 = tmp4.exp();
                        tmp5.store(out_ptr5 + static_cast<int64_t>(x1 + (513L*x0)));
                        tmp_acc0_vec = tmp_acc0_vec + tmp5;
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = c10::convert<float>(tmp0);
                        auto tmp3 = decltype(tmp1)(tmp1 - tmp2);
                        auto tmp4 = std::exp(tmp3);
                        out_ptr5[static_cast<int64_t>(x1 + (513L*x0))] = tmp4;
                        tmp_acc0 = tmp_acc0 + tmp4;
                    }
                    tmp_acc0 = tmp_acc0 + at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return x + y; }, tmp_acc0_vec);
                    out_ptr6[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
            }
        }
    }
}
''')


cpp_fused_clone_constant_pad_nd_74 = async_compile.cpp_pybinding(['const bfloat16*', 'const bool*', 'const float*', 'const float*', 'bfloat16*', 'bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bool* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(1024L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = (-256L) + x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(0);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = static_cast<int64_t>(512);
                        auto tmp5 = tmp1 < tmp4;
                        auto tmp6 = tmp3 & tmp5;
                        auto tmp7 = [&]
                        {
                            auto tmp8 = at::vec::VecMask<float,1>::from(tmp6).template loadu<bfloat16,1>(in_ptr0 + static_cast<int64_t>((-196608L) + x2 + (64L*x0) + (768L*x1)));
                            auto tmp9 = at::vec::convert<float>(tmp8);
                            return tmp9;
                        }
                        ;
                        auto tmp10 = tmp6 ? tmp7() : at::vec::Vectorized<float>(static_cast<float>(-1.0));
                        auto tmp11 = at::vec::convert<bfloat16>(tmp10);
                        tmp11.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (65536L*x0)), 16);
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(768L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(513);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 < tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp8 = tmp5.template cast<float,1>().template loadu<float,1>(in_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0)));
                            auto tmp9 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp10 = at::vec::Vectorized<float>(tmp9);
                            auto tmp11 = tmp8 / tmp10;
                            auto tmp12 = static_cast<float>(0.0);
                            auto tmp13 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp14 = at::vec::Vectorized<float>(tmp12);
                            auto tmp15 = decltype(tmp14)::blendv(tmp11, tmp14, tmp13.template cast<float,1>());
                            auto tmp16 = (tmp15);
                            return tmp16;
                        }
                        ;
                        auto tmp19 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp17 = tmp6();
                                auto tmp18 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp17)::blendv(tmp18, tmp17, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp20 = at::vec::convert<bfloat16>(tmp19);
                        tmp20.store(out_ptr1 + static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(768L); x2<static_cast<int64_t>(770L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(513);
                        auto tmp3 = tmp1 < tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp6 = in_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0))];
                            auto tmp7 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp8 = tmp6 / tmp7;
                            auto tmp9 = static_cast<float>(0.0);
                            auto tmp10 = tmp5 ? tmp9 : tmp8;
                            auto tmp11 = c10::convert<float>(tmp10);
                            return tmp11;
                        }
                        ;
                        auto tmp12 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp13 = c10::convert<bfloat16>(tmp12);
                        out_ptr1[static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1))] = tmp13;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(49152L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x2 + (16384L*x1) + (65536L*x0)), 32);
                        tmp0.store(out_ptr2 + static_cast<int64_t>(x2 + (49152L*x1) + (98304L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused_clone_75 = async_compile.cpp_pybinding(['const bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       bfloat16* out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x2 + (64L*x0) + (32768L*x1)), 32);
                        tmp0.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (768L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_76 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    auto tmp19 = at::vec::convert<bfloat16>(tmp18);
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                    tmp19.store(out_ptr3 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_77 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<float>::loadu(out_ptr2 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<bfloat16>(tmp0);
                tmp1.store(out_ptr3 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_78 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(16L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 16);
                auto tmp1 = at::vec::convert<float>(tmp0);
                auto tmp2 = static_cast<float>(0.125);
                auto tmp3 = at::vec::Vectorized<float>(tmp2);
                auto tmp4 = tmp1 * tmp3;
                auto tmp5 = at::vec::convert<bfloat16>(tmp4);
                tmp5.store(in_out_ptr0 + static_cast<int64_t>(x0), 16);
            }
        }
    }
}
''')


cpp_fused_view_79 = async_compile.cpp_pybinding(['bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(bfloat16* in_out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(393216L); x0+=static_cast<int64_t>(32L))
            {
                auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_out_ptr0 + static_cast<int64_t>(x0), 32);
                tmp0.store(in_out_ptr0 + static_cast<int64_t>(x0), 32);
            }
        }
    }
}
''')


cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_80 = async_compile.cpp_pybinding(['const bfloat16*', 'const bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'bfloat16*', 'float*', 'float*', 'float*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bfloat16* in_ptr1,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2,
                       bfloat16* out_ptr3,
                       float* out_ptr4,
                       float* out_ptr5,
                       float* out_ptr6)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(2L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = at::vec::VectorizedN<int64_t,2>::arange(tmp5, 1);
                            auto tmp7 = static_cast<int64_t>(256);
                            auto tmp8 = at::vec::VectorizedN<int64_t,2>(tmp7);
                            auto tmp9 = at::vec::VecMask<int64_t,2>(tmp6 >= tmp8);
                            auto tmp10 = [&]
                            {
                                auto tmp11 =
                                [&]
                                {
                                    __at_align__ std::array<int64_t, 16> tmpbuf;
                                    #pragma GCC unroll 16
                                    for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                    {
                                        if (tmp9.is_masked(x3_inner))
                                        {
                                            tmpbuf[x3_inner] = static_cast<int64_t>(256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))));
                                        }
                                    }
                                    return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                }
                                ()
                                ;
                                auto tmp12 = static_cast<int64_t>(512);
                                auto tmp13 = at::vec::VectorizedN<int64_t,2>(tmp12);
                                auto tmp14 = at::vec::VecMask<int64_t,2>(tmp11 < tmp13);
                                auto tmp16 = tmp14 & tmp9;
                                auto tmp15 = [&]
                                {
                                    auto tmp17 =
                                    [&]
                                    {
                                        __at_align__ std::array<bfloat16, 32> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp16.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>(131072L + x3 + x3_inner + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                            }
                                        }
                                        return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp18 = at::vec::convert<float>(tmp17);
                                    return tmp18;
                                }
                                ;
                                auto tmp21 =
                                [&]
                                {
                                    if (tmp16.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp19 = tmp15();
                                        auto tmp20 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp19)::blendv(tmp20, tmp19, tmp16.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                return tmp21;
                            }
                            ;
                            auto tmp24 =
                            [&]
                            {
                                if (tmp9.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp22 = tmp10();
                                    auto tmp23 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp22)::blendv(tmp23, tmp22, tmp9.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp25 = static_cast<int64_t>(1);
                            auto tmp26 = tmp25 < tmp25;
                            auto tmp27 = [&]
                            {
                                auto tmp29 = at::vec::VecMask<float,1>::from(tmp26);
                                auto tmp30 = tmp9 & tmp29;
                                auto tmp28 = [&]
                                {
                                    auto tmp31 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp30.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp32 = static_cast<int64_t>(512);
                                    auto tmp33 = at::vec::VectorizedN<int64_t,2>(tmp32);
                                    auto tmp34 = at::vec::VecMask<int64_t,2>(tmp31 < tmp33);
                                    auto tmp36 = tmp34 & tmp30;
                                    auto tmp35 = [&]
                                    {
                                        auto tmp37 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp36.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + x3_inner + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp38 = at::vec::convert<float>(tmp37);
                                        return tmp38;
                                    }
                                    ;
                                    auto tmp41 =
                                    [&]
                                    {
                                        if (tmp36.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp39 = tmp35();
                                            auto tmp40 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp39)::blendv(tmp40, tmp39, tmp36.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp41;
                                }
                                ;
                                auto tmp44 =
                                [&]
                                {
                                    if (tmp30.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp42 = tmp28();
                                        auto tmp43 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp42)::blendv(tmp43, tmp42, tmp30.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp45 = static_cast<float>(0.0);
                                auto tmp46 = at::vec::Vectorized<float>(tmp45);
                                auto tmp47 = decltype(tmp44)::blendv(tmp46, tmp44, tmp9.template cast<float,1>());
                                return tmp47;
                            }
                            ;
                            auto tmp48 = tmp26 ? tmp27() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp49 = static_cast<float>(0.0);
                            auto tmp50 = at::vec::VecMask<float,1>::from(tmp26);
                            auto tmp51 = at::vec::Vectorized<float>(tmp49);
                            auto tmp52 = decltype(tmp48)::blendv(tmp51, tmp48, tmp50.template cast<float,1>());
                            auto tmp53 = decltype(tmp24)::blendv(tmp52, tmp24, tmp9.template cast<float,1>());
                            auto tmp54 = c10::convert<int64_t>(tmp0);
                            auto tmp55 = tmp54 < tmp25;
                            auto tmp56 = [&]
                            {
                                auto tmp58 = at::vec::VecMask<float,1>::from(tmp55);
                                auto tmp59 = tmp9 & tmp58;
                                auto tmp57 = [&]
                                {
                                    auto tmp60 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp59.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp61 = static_cast<int64_t>(512);
                                    auto tmp62 = at::vec::VectorizedN<int64_t,2>(tmp61);
                                    auto tmp63 = at::vec::VecMask<int64_t,2>(tmp60 < tmp62);
                                    auto tmp65 = tmp63 & tmp59;
                                    auto tmp64 = [&]
                                    {
                                        auto tmp66 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp65.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp67 = at::vec::convert<float>(tmp66);
                                        return tmp67;
                                    }
                                    ;
                                    auto tmp70 =
                                    [&]
                                    {
                                        if (tmp65.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp68 = tmp64();
                                            auto tmp69 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp68)::blendv(tmp69, tmp68, tmp65.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp70;
                                }
                                ;
                                auto tmp73 =
                                [&]
                                {
                                    if (tmp59.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp71 = tmp57();
                                        auto tmp72 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp71)::blendv(tmp72, tmp71, tmp59.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp74 = decltype(tmp73)::blendv(tmp51, tmp73, tmp9.template cast<float,1>());
                                return tmp74;
                            }
                            ;
                            auto tmp75 = tmp55 ? tmp56() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp76 = at::vec::VecMask<float,1>::from(tmp55);
                            auto tmp77 = decltype(tmp75)::blendv(tmp51, tmp75, tmp76.template cast<float,1>());
                            auto tmp78 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp79 = decltype(tmp53)::blendv(tmp77, tmp53, tmp78.template cast<float,1>());
                            auto tmp80 = at::vec::convert<bfloat16>(tmp79);
                            tmp80.store(out_ptr0 + static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp0 = x2;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(1);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x3;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(256);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = 256L + (c10::div_floor_integer(static_cast<int64_t>((x3 + (513L*x1))), static_cast<int64_t>(512L)));
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = static_cast<int64_t>(512);
                                auto tmp12 = tmp10 < tmp11;
                                auto tmp13 = [&]
                                {
                                    auto tmp14 = in_ptr0[static_cast<int64_t>(131072L + x3 + (513L*x1) + (262144L*x0) + (262144L*(c10::div_floor_integer(static_cast<int64_t>((131072L + x3 + (513L*x1))), static_cast<int64_t>(262656L)))))];
                                    auto tmp15 = c10::convert<float>(tmp14);
                                    return tmp15;
                                }
                                ;
                                auto tmp16 = tmp12 ? tmp13() : static_cast<decltype(tmp13())>(0.0);
                                return tmp16;
                            }
                            ;
                            auto tmp17 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp18 = static_cast<int64_t>(1);
                            auto tmp19 = tmp18 < tmp18;
                            auto tmp20 = [&]
                            {
                                auto tmp21 = [&]
                                {
                                    auto tmp22 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp23 = c10::convert<int64_t>(tmp22);
                                    auto tmp24 = static_cast<int64_t>(512);
                                    auto tmp25 = tmp23 < tmp24;
                                    auto tmp26 = [&]
                                    {
                                        auto tmp27 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>((262400L + x3 + (513L*x1) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((262400L + x3 + (513L*x1))) % static_cast<int64_t>(262656L)))];
                                        auto tmp28 = c10::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp29 = tmp25 ? tmp26() : static_cast<decltype(tmp26())>(0.0);
                                    return tmp29;
                                }
                                ;
                                auto tmp30 = tmp7 ? tmp21() : static_cast<decltype(tmp21())>(0.0);
                                auto tmp31 = static_cast<float>(0.0);
                                auto tmp32 = tmp7 ? tmp30 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                            auto tmp34 = static_cast<float>(0.0);
                            auto tmp35 = tmp19 ? tmp33 : tmp34;
                            auto tmp36 = tmp7 ? tmp17 : tmp35;
                            auto tmp37 = c10::convert<int64_t>(tmp0);
                            auto tmp38 = tmp37 < tmp18;
                            auto tmp39 = [&]
                            {
                                auto tmp40 = [&]
                                {
                                    auto tmp41 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp42 = c10::convert<int64_t>(tmp41);
                                    auto tmp43 = static_cast<int64_t>(512);
                                    auto tmp44 = tmp42 < tmp43;
                                    auto tmp45 = [&]
                                    {
                                        auto tmp46 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x1) + (262656L*x0) + (262656L*x2))) % static_cast<int64_t>(262656L)))];
                                        auto tmp47 = c10::convert<float>(tmp46);
                                        return tmp47;
                                    }
                                    ;
                                    auto tmp48 = tmp44 ? tmp45() : static_cast<decltype(tmp45())>(0.0);
                                    return tmp48;
                                }
                                ;
                                auto tmp49 = tmp7 ? tmp40() : static_cast<decltype(tmp40())>(0.0);
                                auto tmp50 = tmp7 ? tmp49 : tmp34;
                                return tmp50;
                            }
                            ;
                            auto tmp51 = tmp38 ? tmp39() : static_cast<decltype(tmp39())>(0.0);
                            auto tmp52 = tmp38 ? tmp51 : tmp34;
                            auto tmp53 = tmp3 ? tmp36 : tmp52;
                            auto tmp54 = c10::convert<bfloat16>(tmp53);
                            out_ptr0[static_cast<int64_t>(x3 + (513L*x2) + (1026L*x1) + (262656L*x0))] = tmp54;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    #pragma GCC ivdep
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(256L); x2+=static_cast<int64_t>(1L))
                    {
                        for(int64_t x3=static_cast<int64_t>(0L); x3<static_cast<int64_t>(512L); x3+=static_cast<int64_t>(16L))
                        {
                            auto tmp96 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp132 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0)), 16);
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = at::vec::VectorizedN<int64_t,2>::arange(tmp10, 1);
                                auto tmp12 = at::vec::VectorizedN<int64_t,2>(tmp6);
                                auto tmp13 = at::vec::VecMask<int64_t,2>(tmp11 >= tmp12);
                                auto tmp14 = static_cast<int64_t>(256);
                                auto tmp15 = at::vec::VectorizedN<int64_t,2>(tmp14);
                                auto tmp16 = at::vec::VecMask<int64_t,2>(tmp11 < tmp15);
                                auto tmp17 = tmp13 & tmp16;
                                auto tmp19 = at::vec::VecMask<float,1>::from(tmp7);
                                auto tmp20 = tmp17 & tmp19;
                                auto tmp18 = [&]
                                {
                                    auto tmp21 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp20.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp22 = static_cast<int64_t>(512);
                                    auto tmp23 = at::vec::VectorizedN<int64_t,2>(tmp22);
                                    auto tmp24 = at::vec::VecMask<int64_t,2>(tmp21 < tmp23);
                                    auto tmp26 = tmp24 & tmp20;
                                    auto tmp25 = [&]
                                    {
                                        auto tmp27 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp26.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + x3_inner + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp28 = at::vec::convert<float>(tmp27);
                                        return tmp28;
                                    }
                                    ;
                                    auto tmp31 =
                                    [&]
                                    {
                                        if (tmp26.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp29 = tmp25();
                                            auto tmp30 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp31;
                                }
                                ;
                                auto tmp34 =
                                [&]
                                {
                                    if (tmp20.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp32 = tmp18();
                                        auto tmp33 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp32)::blendv(tmp33, tmp32, tmp20.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp35 = static_cast<int64_t>(0);
                                auto tmp36 = tmp35 >= tmp6;
                                auto tmp38 = tmp36 & tmp7;
                                auto tmp37 = [&]
                                {
                                    auto tmp40 = at::vec::VecMask<float,1>::from(tmp38);
                                    auto tmp41 = tmp16 & tmp40;
                                    auto tmp39 = [&]
                                    {
                                        auto tmp42 =
                                        [&]
                                        {
                                            __at_align__ std::array<int64_t, 16> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp41.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                                }
                                            }
                                            return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp43 = static_cast<int64_t>(512);
                                        auto tmp44 = at::vec::VectorizedN<int64_t,2>(tmp43);
                                        auto tmp45 = at::vec::VecMask<int64_t,2>(tmp42 < tmp44);
                                        auto tmp47 = tmp45 & tmp41;
                                        auto tmp46 = [&]
                                        {
                                            auto tmp48 =
                                            [&]
                                            {
                                                __at_align__ std::array<bfloat16, 32> tmpbuf;
                                                #pragma GCC unroll 16
                                                for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                                {
                                                    if (tmp47.is_masked(x3_inner))
                                                    {
                                                        tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                    }
                                                }
                                                return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                            }
                                            ()
                                            ;
                                            auto tmp49 = at::vec::convert<float>(tmp48);
                                            return tmp49;
                                        }
                                        ;
                                        auto tmp52 =
                                        [&]
                                        {
                                            if (tmp47.all_zero())
                                            {
                                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            }
                                            else
                                            {
                                                auto tmp50 = tmp46();
                                                auto tmp51 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                                return decltype(tmp50)::blendv(tmp51, tmp50, tmp47.template cast<float,1>());
                                            }
                                        }
                                        ()
                                        ;
                                        return tmp52;
                                    }
                                    ;
                                    auto tmp55 =
                                    [&]
                                    {
                                        if (tmp41.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp53 = tmp39();
                                            auto tmp54 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp53)::blendv(tmp54, tmp53, tmp41.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    auto tmp56 = at::vec::VecMask<float,1>::from(tmp38).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                    auto tmp57 = at::vec::convert<float>(tmp56);
                                    auto tmp58 = decltype(tmp55)::blendv(tmp57, tmp55, tmp16.template cast<float,1>());
                                    return tmp58;
                                }
                                ;
                                auto tmp59 = tmp36 ? tmp37() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                                auto tmp60 = at::vec::VecMask<float,1>::from(tmp7).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp61 = at::vec::convert<float>(tmp60);
                                auto tmp62 = at::vec::VecMask<float,1>::from(tmp36);
                                auto tmp63 = decltype(tmp59)::blendv(tmp61, tmp59, tmp62.template cast<float,1>());
                                auto tmp64 = decltype(tmp34)::blendv(tmp63, tmp34, tmp17.template cast<float,1>());
                                return tmp64;
                            }
                            ;
                            auto tmp65 = tmp7 ? tmp8() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp66 = static_cast<int64_t>(0);
                            auto tmp67 = tmp66 >= tmp6;
                            auto tmp68 = [&]
                            {
                                auto tmp69 = x3;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(256);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 < tmp73);
                                auto tmp76 = at::vec::VecMask<float,1>::from(tmp67);
                                auto tmp77 = tmp74 & tmp76;
                                auto tmp75 = [&]
                                {
                                    auto tmp78 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp77.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp79 = static_cast<int64_t>(512);
                                    auto tmp80 = at::vec::VectorizedN<int64_t,2>(tmp79);
                                    auto tmp81 = at::vec::VecMask<int64_t,2>(tmp78 < tmp80);
                                    auto tmp83 = tmp81 & tmp77;
                                    auto tmp82 = [&]
                                    {
                                        auto tmp84 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp83.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp85 = at::vec::convert<float>(tmp84);
                                        return tmp85;
                                    }
                                    ;
                                    auto tmp88 =
                                    [&]
                                    {
                                        if (tmp83.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp86 = tmp82();
                                            auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp86)::blendv(tmp87, tmp86, tmp83.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp88;
                                }
                                ;
                                auto tmp91 =
                                [&]
                                {
                                    if (tmp77.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp89 = tmp75();
                                        auto tmp90 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp89)::blendv(tmp90, tmp89, tmp77.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp92 = at::vec::VecMask<float,1>::from(tmp67).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp93 = at::vec::convert<float>(tmp92);
                                auto tmp94 = decltype(tmp91)::blendv(tmp93, tmp91, tmp74.template cast<float,1>());
                                return tmp94;
                            }
                            ;
                            auto tmp95 = tmp67 ? tmp68() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp97 = at::vec::convert<float>(tmp96);
                            auto tmp98 = at::vec::VecMask<float,1>::from(tmp67);
                            auto tmp99 = decltype(tmp95)::blendv(tmp97, tmp95, tmp98.template cast<float,1>());
                            auto tmp100 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp101 = decltype(tmp65)::blendv(tmp99, tmp65, tmp100.template cast<float,1>());
                            auto tmp102 = c10::convert<int64_t>(tmp0);
                            auto tmp103 = tmp102 >= tmp6;
                            auto tmp104 = [&]
                            {
                                auto tmp105 = x3;
                                auto tmp106 = c10::convert<int64_t>(tmp105);
                                auto tmp107 = at::vec::VectorizedN<int64_t,2>::arange(tmp106, 1);
                                auto tmp108 = static_cast<int64_t>(256);
                                auto tmp109 = at::vec::VectorizedN<int64_t,2>(tmp108);
                                auto tmp110 = at::vec::VecMask<int64_t,2>(tmp107 < tmp109);
                                auto tmp112 = at::vec::VecMask<float,1>::from(tmp103);
                                auto tmp113 = tmp110 & tmp112;
                                auto tmp111 = [&]
                                {
                                    auto tmp114 =
                                    [&]
                                    {
                                        __at_align__ std::array<int64_t, 16> tmpbuf;
                                        #pragma GCC unroll 16
                                        for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                        {
                                            if (tmp113.is_masked(x3_inner))
                                            {
                                                tmpbuf[x3_inner] = static_cast<int64_t>(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L));
                                            }
                                        }
                                        return at::vec::VectorizedN<int64_t,2>::loadu(tmpbuf.data(), 16);
                                    }
                                    ()
                                    ;
                                    auto tmp115 = static_cast<int64_t>(512);
                                    auto tmp116 = at::vec::VectorizedN<int64_t,2>(tmp115);
                                    auto tmp117 = at::vec::VecMask<int64_t,2>(tmp114 < tmp116);
                                    auto tmp119 = tmp117 & tmp113;
                                    auto tmp118 = [&]
                                    {
                                        auto tmp120 =
                                        [&]
                                        {
                                            __at_align__ std::array<bfloat16, 32> tmpbuf;
                                            #pragma GCC unroll 16
                                            for (long x3_inner = 0; x3_inner < 16; x3_inner++)
                                            {
                                                if (tmp119.is_masked(x3_inner))
                                                {
                                                    tmpbuf[x3_inner] = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + x3_inner + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + x3_inner + (513L*x2))) % static_cast<int64_t>(512L)))];
                                                }
                                            }
                                            return at::vec::Vectorized<bfloat16>::loadu(tmpbuf.data(), 16);
                                        }
                                        ()
                                        ;
                                        auto tmp121 = at::vec::convert<float>(tmp120);
                                        return tmp121;
                                    }
                                    ;
                                    auto tmp124 =
                                    [&]
                                    {
                                        if (tmp119.all_zero())
                                        {
                                            return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        }
                                        else
                                        {
                                            auto tmp122 = tmp118();
                                            auto tmp123 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                            return decltype(tmp122)::blendv(tmp123, tmp122, tmp119.template cast<float,1>());
                                        }
                                    }
                                    ()
                                    ;
                                    return tmp124;
                                }
                                ;
                                auto tmp127 =
                                [&]
                                {
                                    if (tmp113.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp125 = tmp111();
                                        auto tmp126 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp125)::blendv(tmp126, tmp125, tmp113.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp128 = at::vec::VecMask<float,1>::from(tmp103).template loadu<bfloat16,1>(out_ptr0 + static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0)));
                                auto tmp129 = at::vec::convert<float>(tmp128);
                                auto tmp130 = decltype(tmp127)::blendv(tmp129, tmp127, tmp110.template cast<float,1>());
                                return tmp130;
                            }
                            ;
                            auto tmp131 = tmp103 ? tmp104() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                            auto tmp133 = at::vec::convert<float>(tmp132);
                            auto tmp134 = at::vec::VecMask<float,1>::from(tmp103);
                            auto tmp135 = decltype(tmp131)::blendv(tmp133, tmp131, tmp134.template cast<float,1>());
                            auto tmp136 = at::vec::VecMask<float,1>::from(tmp3);
                            auto tmp137 = decltype(tmp101)::blendv(tmp135, tmp101, tmp136.template cast<float,1>());
                            auto tmp138 = at::vec::convert<bfloat16>(tmp137);
                            tmp138.store(out_ptr1 + static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0)), 16);
                        }
                        #pragma omp simd simdlen(8) 
                        for(int64_t x3=static_cast<int64_t>(512L); x3<static_cast<int64_t>(513L); x3+=static_cast<int64_t>(1L))
                        {
                            auto tmp68 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                            auto tmp93 = out_ptr0[static_cast<int64_t>(x3 + (513L*x1) + (1026L*x2) + (262656L*x0))];
                            auto tmp0 = x1;
                            auto tmp1 = c10::convert<int32_t>(tmp0);
                            auto tmp2 = static_cast<int32_t>(0);
                            auto tmp3 = tmp1 == tmp2;
                            auto tmp4 = x2;
                            auto tmp5 = c10::convert<int64_t>(tmp4);
                            auto tmp6 = static_cast<int64_t>(1);
                            auto tmp7 = tmp5 >= tmp6;
                            auto tmp8 = [&]
                            {
                                auto tmp9 = x3;
                                auto tmp10 = c10::convert<int64_t>(tmp9);
                                auto tmp11 = tmp10 >= tmp6;
                                auto tmp12 = static_cast<int64_t>(256);
                                auto tmp13 = tmp10 < tmp12;
                                auto tmp14 = tmp11 & tmp13;
                                auto tmp15 = [&]
                                {
                                    auto tmp16 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp17 = c10::convert<int64_t>(tmp16);
                                    auto tmp18 = static_cast<int64_t>(512);
                                    auto tmp19 = tmp17 < tmp18;
                                    auto tmp20 = [&]
                                    {
                                        auto tmp21 = in_ptr0[static_cast<int64_t>((262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>(((-256L) + x3 + (513L*x2) + (262656L*x0))) % static_cast<int64_t>(262656L)))];
                                        auto tmp22 = c10::convert<float>(tmp21);
                                        return tmp22;
                                    }
                                    ;
                                    auto tmp23 = tmp19 ? tmp20() : static_cast<decltype(tmp20())>(0.0);
                                    return tmp23;
                                }
                                ;
                                auto tmp24 = tmp14 ? tmp15() : static_cast<decltype(tmp15())>(0.0);
                                auto tmp25 = static_cast<int64_t>(0);
                                auto tmp26 = tmp25 >= tmp6;
                                auto tmp27 = [&]
                                {
                                    auto tmp28 = [&]
                                    {
                                        auto tmp29 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                        auto tmp30 = c10::convert<int64_t>(tmp29);
                                        auto tmp31 = static_cast<int64_t>(512);
                                        auto tmp32 = tmp30 < tmp31;
                                        auto tmp33 = [&]
                                        {
                                            auto tmp34 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                            auto tmp35 = c10::convert<float>(tmp34);
                                            return tmp35;
                                        }
                                        ;
                                        auto tmp36 = tmp32 ? tmp33() : static_cast<decltype(tmp33())>(0.0);
                                        return tmp36;
                                    }
                                    ;
                                    auto tmp37 = tmp13 ? tmp28() : static_cast<decltype(tmp28())>(0.0);
                                    auto tmp38 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                    auto tmp39 = c10::convert<float>(tmp38);
                                    auto tmp40 = tmp13 ? tmp37 : tmp39;
                                    return tmp40;
                                }
                                ;
                                auto tmp41 = tmp26 ? tmp27() : static_cast<decltype(tmp27())>(0.0);
                                auto tmp42 = out_ptr0[static_cast<int64_t>(x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp43 = c10::convert<float>(tmp42);
                                auto tmp44 = tmp26 ? tmp41 : tmp43;
                                auto tmp45 = tmp14 ? tmp24 : tmp44;
                                return tmp45;
                            }
                            ;
                            auto tmp46 = tmp7 ? tmp8() : static_cast<decltype(tmp8())>(0.0);
                            auto tmp47 = static_cast<int64_t>(0);
                            auto tmp48 = tmp47 >= tmp6;
                            auto tmp49 = [&]
                            {
                                auto tmp50 = x3;
                                auto tmp51 = c10::convert<int64_t>(tmp50);
                                auto tmp52 = static_cast<int64_t>(256);
                                auto tmp53 = tmp51 < tmp52;
                                auto tmp54 = [&]
                                {
                                    auto tmp55 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp56 = c10::convert<int64_t>(tmp55);
                                    auto tmp57 = static_cast<int64_t>(512);
                                    auto tmp58 = tmp56 < tmp57;
                                    auto tmp59 = [&]
                                    {
                                        auto tmp60 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp61 = c10::convert<float>(tmp60);
                                        return tmp61;
                                    }
                                    ;
                                    auto tmp62 = tmp58 ? tmp59() : static_cast<decltype(tmp59())>(0.0);
                                    return tmp62;
                                }
                                ;
                                auto tmp63 = tmp53 ? tmp54() : static_cast<decltype(tmp54())>(0.0);
                                auto tmp64 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp65 = c10::convert<float>(tmp64);
                                auto tmp66 = tmp53 ? tmp63 : tmp65;
                                return tmp66;
                            }
                            ;
                            auto tmp67 = tmp48 ? tmp49() : static_cast<decltype(tmp49())>(0.0);
                            auto tmp69 = c10::convert<float>(tmp68);
                            auto tmp70 = tmp48 ? tmp67 : tmp69;
                            auto tmp71 = tmp7 ? tmp46 : tmp70;
                            auto tmp72 = c10::convert<int64_t>(tmp0);
                            auto tmp73 = tmp72 >= tmp6;
                            auto tmp74 = [&]
                            {
                                auto tmp75 = x3;
                                auto tmp76 = c10::convert<int64_t>(tmp75);
                                auto tmp77 = static_cast<int64_t>(256);
                                auto tmp78 = tmp76 < tmp77;
                                auto tmp79 = [&]
                                {
                                    auto tmp80 = static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L);
                                    auto tmp81 = c10::convert<int64_t>(tmp80);
                                    auto tmp82 = static_cast<int64_t>(512);
                                    auto tmp83 = tmp81 < tmp82;
                                    auto tmp84 = [&]
                                    {
                                        auto tmp85 = in_ptr0[static_cast<int64_t>((512L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(512L))) % static_cast<int64_t>(513L))) + (262144L*(static_cast<int64_t>(c10::div_floor_integer(static_cast<int64_t>(((-131584L) + x3 + (513L*x2) + (262656L*x0) + (262656L*x1))), static_cast<int64_t>(262656L))) % static_cast<int64_t>(12L))) + (static_cast<int64_t>((x3 + (513L*x2))) % static_cast<int64_t>(512L)))];
                                        auto tmp86 = c10::convert<float>(tmp85);
                                        return tmp86;
                                    }
                                    ;
                                    auto tmp87 = tmp83 ? tmp84() : static_cast<decltype(tmp84())>(0.0);
                                    return tmp87;
                                }
                                ;
                                auto tmp88 = tmp78 ? tmp79() : static_cast<decltype(tmp79())>(0.0);
                                auto tmp89 = out_ptr0[static_cast<int64_t>(513L + x3 + (1026L*x2) + (262656L*x0))];
                                auto tmp90 = c10::convert<float>(tmp89);
                                auto tmp91 = tmp78 ? tmp88 : tmp90;
                                return tmp91;
                            }
                            ;
                            auto tmp92 = tmp73 ? tmp74() : static_cast<decltype(tmp74())>(0.0);
                            auto tmp94 = c10::convert<float>(tmp93);
                            auto tmp95 = tmp73 ? tmp92 : tmp94;
                            auto tmp96 = tmp3 ? tmp71 : tmp95;
                            auto tmp97 = c10::convert<bfloat16>(tmp96);
                            out_ptr1[static_cast<int64_t>(x3 + (513L*x2) + (131328L*x1) + (262656L*x0))] = tmp97;
                        }
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(256L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp93 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)), 16);
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(256);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 >= tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp8 = c10::convert<int64_t>(tmp7);
                            auto tmp9 = at::vec::VectorizedN<int64_t,2>::arange(tmp8, -1);
                            auto tmp10 = static_cast<int64_t>(0);
                            auto tmp11 = at::vec::VectorizedN<int64_t,2>(tmp10);
                            auto tmp12 = at::vec::VecMask<int64_t,2>(tmp9 <= tmp11);
                            auto tmp13 = static_cast<float>(1.0);
                            auto tmp14 = static_cast<float>(0.0);
                            auto tmp15 = at::vec::Vectorized<float>(tmp13);
                            auto tmp16 = at::vec::Vectorized<float>(tmp14);
                            auto tmp17 = decltype(tmp15)::blendv(tmp16, tmp15, tmp12.template cast<float,1>());
                            auto tmp18 = at::vec::VecMask<float,1>::from<float,1>(tmp17);
                            auto tmp19 = 256L + x1;
                            auto tmp20 = c10::convert<int64_t>(tmp19);
                            auto tmp21 = tmp20 < tmp3;
                            auto tmp23 = at::vec::VecMask<float,1>::from(tmp21);
                            auto tmp24 = tmp23 & tmp5;
                            auto tmp22 = [&]
                            {
                                auto tmp25 = static_cast<int64_t>(257);
                                auto tmp26 = at::vec::VectorizedN<int64_t,2>(tmp25);
                                auto tmp27 = at::vec::VecMask<int64_t,2>(tmp2 < tmp26);
                                auto tmp29 = tmp27 & tmp24;
                                auto tmp28 = [&]
                                {
                                    auto tmp30 = 1L + x1 + x2;
                                    auto tmp31 = c10::convert<int64_t>(tmp30);
                                    auto tmp32 = at::vec::VectorizedN<int64_t,2>::arange(tmp31, 1);
                                    auto tmp33 = at::vec::VecMask<int64_t,2>(tmp32 <= tmp11);
                                    auto tmp34 = decltype(tmp15)::blendv(tmp16, tmp15, tmp33.template cast<float,1>());
                                    auto tmp35 = at::vec::VecMask<float,1>::from<float,1>(tmp34);
                                    auto tmp36 = tmp29.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                    auto tmp37 = at::vec::convert<float>(tmp36);
                                    auto tmp38 = -std::numeric_limits<float>::infinity();
                                    auto tmp39 = at::vec::Vectorized<float>(tmp38);
                                    auto tmp40 = decltype(tmp39)::blendv(tmp37, tmp39, tmp35.template cast<float,1>());
                                    return tmp40;
                                }
                                ;
                                auto tmp43 =
                                [&]
                                {
                                    if (tmp29.all_zero())
                                    {
                                        return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    }
                                    else
                                    {
                                        auto tmp41 = tmp28();
                                        auto tmp42 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                        return decltype(tmp41)::blendv(tmp42, tmp41, tmp29.template cast<float,1>());
                                    }
                                }
                                ()
                                ;
                                auto tmp44 = tmp24.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp45 = at::vec::convert<float>(tmp44);
                                auto tmp46 = decltype(tmp43)::blendv(tmp45, tmp43, tmp27.template cast<float,1>());
                                return tmp46;
                            }
                            ;
                            auto tmp49 =
                            [&]
                            {
                                if (tmp24.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp47 = tmp22();
                                    auto tmp48 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp47)::blendv(tmp48, tmp47, tmp24.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp50 = tmp5.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp51 = at::vec::convert<float>(tmp50);
                            auto tmp52 = decltype(tmp49)::blendv(tmp51, tmp49, tmp23.template cast<float,1>());
                            auto tmp53 = -std::numeric_limits<float>::infinity();
                            auto tmp54 = at::vec::Vectorized<float>(tmp53);
                            auto tmp55 = decltype(tmp54)::blendv(tmp52, tmp54, tmp18.template cast<float,1>());
                            return tmp55;
                        }
                        ;
                        auto tmp58 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp56 = tmp6();
                                auto tmp57 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp56)::blendv(tmp57, tmp56, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp59 = 256L + x1;
                        auto tmp60 = c10::convert<int64_t>(tmp59);
                        auto tmp61 = tmp60 < tmp3;
                        auto tmp62 = [&]
                        {
                            auto tmp63 = static_cast<int64_t>(257);
                            auto tmp64 = at::vec::VectorizedN<int64_t,2>(tmp63);
                            auto tmp65 = at::vec::VecMask<int64_t,2>(tmp2 < tmp64);
                            auto tmp67 = at::vec::VecMask<float,1>::from(tmp61);
                            auto tmp68 = tmp65 & tmp67;
                            auto tmp66 = [&]
                            {
                                auto tmp69 = 1L + x1 + x2;
                                auto tmp70 = c10::convert<int64_t>(tmp69);
                                auto tmp71 = at::vec::VectorizedN<int64_t,2>::arange(tmp70, 1);
                                auto tmp72 = static_cast<int64_t>(0);
                                auto tmp73 = at::vec::VectorizedN<int64_t,2>(tmp72);
                                auto tmp74 = at::vec::VecMask<int64_t,2>(tmp71 <= tmp73);
                                auto tmp75 = static_cast<float>(1.0);
                                auto tmp76 = static_cast<float>(0.0);
                                auto tmp77 = at::vec::Vectorized<float>(tmp75);
                                auto tmp78 = at::vec::Vectorized<float>(tmp76);
                                auto tmp79 = decltype(tmp77)::blendv(tmp78, tmp77, tmp74.template cast<float,1>());
                                auto tmp80 = at::vec::VecMask<float,1>::from<float,1>(tmp79);
                                auto tmp81 = tmp68.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                                auto tmp82 = at::vec::convert<float>(tmp81);
                                auto tmp83 = -std::numeric_limits<float>::infinity();
                                auto tmp84 = at::vec::Vectorized<float>(tmp83);
                                auto tmp85 = decltype(tmp84)::blendv(tmp82, tmp84, tmp80.template cast<float,1>());
                                return tmp85;
                            }
                            ;
                            auto tmp88 =
                            [&]
                            {
                                if (tmp68.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp86 = tmp66();
                                    auto tmp87 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp86)::blendv(tmp87, tmp86, tmp68.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp89 = at::vec::VecMask<float,1>::from(tmp61).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0)));
                            auto tmp90 = at::vec::convert<float>(tmp89);
                            auto tmp91 = decltype(tmp88)::blendv(tmp90, tmp88, tmp65.template cast<float,1>());
                            return tmp91;
                        }
                        ;
                        auto tmp92 = tmp61 ? tmp62() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp94 = at::vec::convert<float>(tmp93);
                        auto tmp95 = at::vec::VecMask<float,1>::from(tmp61);
                        auto tmp96 = decltype(tmp92)::blendv(tmp94, tmp92, tmp95.template cast<float,1>());
                        auto tmp97 = decltype(tmp58)::blendv(tmp96, tmp58, tmp5.template cast<float,1>());
                        auto tmp98 = at::vec::convert<bfloat16>(tmp97);
                        tmp98.store(out_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp64 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = 512L + ((-1L)*x1) + ((-1L)*x2);
                            auto tmp6 = c10::convert<int64_t>(tmp5);
                            auto tmp7 = static_cast<int64_t>(0);
                            auto tmp8 = tmp6 <= tmp7;
                            auto tmp9 = static_cast<float>(1.0);
                            auto tmp10 = static_cast<float>(0.0);
                            auto tmp11 = tmp8 ? tmp9 : tmp10;
                            auto tmp12 = c10::convert<bool>(tmp11);
                            auto tmp13 = 256L + x1;
                            auto tmp14 = c10::convert<int64_t>(tmp13);
                            auto tmp15 = tmp14 < tmp2;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = static_cast<int64_t>(257);
                                auto tmp18 = tmp1 < tmp17;
                                auto tmp19 = [&]
                                {
                                    auto tmp20 = 1L + x1 + x2;
                                    auto tmp21 = c10::convert<int64_t>(tmp20);
                                    auto tmp22 = tmp21 <= tmp7;
                                    auto tmp23 = tmp22 ? tmp9 : tmp10;
                                    auto tmp24 = c10::convert<bool>(tmp23);
                                    auto tmp25 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                    auto tmp26 = c10::convert<float>(tmp25);
                                    auto tmp27 = -std::numeric_limits<float>::infinity();
                                    auto tmp28 = tmp24 ? tmp27 : tmp26;
                                    return tmp28;
                                }
                                ;
                                auto tmp29 = tmp18 ? tmp19() : static_cast<decltype(tmp19())>(0.0);
                                auto tmp30 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp31 = c10::convert<float>(tmp30);
                                auto tmp32 = tmp18 ? tmp29 : tmp31;
                                return tmp32;
                            }
                            ;
                            auto tmp33 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp34 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp35 = c10::convert<float>(tmp34);
                            auto tmp36 = tmp15 ? tmp33 : tmp35;
                            auto tmp37 = -std::numeric_limits<float>::infinity();
                            auto tmp38 = tmp12 ? tmp37 : tmp36;
                            return tmp38;
                        }
                        ;
                        auto tmp39 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp40 = 256L + x1;
                        auto tmp41 = c10::convert<int64_t>(tmp40);
                        auto tmp42 = tmp41 < tmp2;
                        auto tmp43 = [&]
                        {
                            auto tmp44 = static_cast<int64_t>(257);
                            auto tmp45 = tmp1 < tmp44;
                            auto tmp46 = [&]
                            {
                                auto tmp47 = 1L + x1 + x2;
                                auto tmp48 = c10::convert<int64_t>(tmp47);
                                auto tmp49 = static_cast<int64_t>(0);
                                auto tmp50 = tmp48 <= tmp49;
                                auto tmp51 = static_cast<float>(1.0);
                                auto tmp52 = static_cast<float>(0.0);
                                auto tmp53 = tmp50 ? tmp51 : tmp52;
                                auto tmp54 = c10::convert<bool>(tmp53);
                                auto tmp55 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                                auto tmp56 = c10::convert<float>(tmp55);
                                auto tmp57 = -std::numeric_limits<float>::infinity();
                                auto tmp58 = tmp54 ? tmp57 : tmp56;
                                return tmp58;
                            }
                            ;
                            auto tmp59 = tmp45 ? tmp46() : static_cast<decltype(tmp46())>(0.0);
                            auto tmp60 = out_ptr1[static_cast<int64_t>(131328L + x2 + (513L*x1) + (262656L*x0))];
                            auto tmp61 = c10::convert<float>(tmp60);
                            auto tmp62 = tmp45 ? tmp59 : tmp61;
                            return tmp62;
                        }
                        ;
                        auto tmp63 = tmp42 ? tmp43() : static_cast<decltype(tmp43())>(0.0);
                        auto tmp65 = c10::convert<float>(tmp64);
                        auto tmp66 = tmp42 ? tmp63 : tmp65;
                        auto tmp67 = tmp3 ? tmp39 : tmp66;
                        auto tmp68 = c10::convert<bfloat16>(tmp67);
                        out_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (131328L*x0))] = tmp68;
                    }
                }
            }
        }
        {
            #pragma omp for collapse(2)
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(512L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp45 = at::vec::Vectorized<bfloat16>::loadu(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)), 16);
                        auto tmp83 = at::vec::Vectorized<bfloat16>::loadu(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)), 16);
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(out_ptr2 + static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0)));
                            auto tmp6 = at::vec::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = at::vec::VectorizedN<int64_t,2>::arange(tmp13, 1);
                            auto tmp15 = static_cast<int64_t>(257);
                            auto tmp16 = at::vec::VectorizedN<int64_t,2>(tmp15);
                            auto tmp17 = at::vec::VecMask<int64_t,2>(tmp14 < tmp16);
                            auto tmp19 = at::vec::VecMask<float,1>::from(tmp10);
                            auto tmp20 = tmp17 & tmp19;
                            auto tmp18 = [&]
                            {
                                auto tmp21 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp22 = c10::convert<int64_t>(tmp21);
                                auto tmp23 = at::vec::VectorizedN<int64_t,2>::arange(tmp22, 1);
                                auto tmp24 = static_cast<int64_t>(0);
                                auto tmp25 = at::vec::VectorizedN<int64_t,2>(tmp24);
                                auto tmp26 = at::vec::VecMask<int64_t,2>(tmp23 <= tmp25);
                                auto tmp27 = static_cast<float>(1.0);
                                auto tmp28 = static_cast<float>(0.0);
                                auto tmp29 = at::vec::Vectorized<float>(tmp27);
                                auto tmp30 = at::vec::Vectorized<float>(tmp28);
                                auto tmp31 = decltype(tmp29)::blendv(tmp30, tmp29, tmp26.template cast<float,1>());
                                auto tmp32 = at::vec::VecMask<float,1>::from<float,1>(tmp31);
                                auto tmp33 = tmp20.template cast<float,1>().template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                                auto tmp34 = at::vec::convert<float>(tmp33);
                                auto tmp35 = -std::numeric_limits<float>::infinity();
                                auto tmp36 = at::vec::Vectorized<float>(tmp35);
                                auto tmp37 = decltype(tmp36)::blendv(tmp34, tmp36, tmp32.template cast<float,1>());
                                return tmp37;
                            }
                            ;
                            auto tmp40 =
                            [&]
                            {
                                if (tmp20.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp38 = tmp18();
                                    auto tmp39 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp38)::blendv(tmp39, tmp38, tmp20.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp41 = at::vec::VecMask<float,1>::from(tmp10).template loadu<bfloat16,1>(out_ptr1 + static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0)));
                            auto tmp42 = at::vec::convert<float>(tmp41);
                            auto tmp43 = decltype(tmp40)::blendv(tmp42, tmp40, tmp17.template cast<float,1>());
                            return tmp43;
                        }
                        ;
                        auto tmp44 = tmp10 ? tmp11() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp46 = at::vec::convert<float>(tmp45);
                        auto tmp47 = at::vec::VecMask<float,1>::from(tmp10);
                        auto tmp48 = decltype(tmp44)::blendv(tmp46, tmp44, tmp47.template cast<float,1>());
                        auto tmp49 = at::vec::VecMask<float,1>::from(tmp3);
                        auto tmp50 = decltype(tmp7)::blendv(tmp48, tmp7, tmp49.template cast<float,1>());
                        auto tmp51 = [&]
                        {
                            auto tmp52 = x2;
                            auto tmp53 = c10::convert<int64_t>(tmp52);
                            auto tmp54 = at::vec::VectorizedN<int64_t,2>::arange(tmp53, 1);
                            auto tmp55 = at::vec::VectorizedN<int64_t,2>(tmp2);
                            auto tmp56 = at::vec::VecMask<int64_t,2>(tmp54 >= tmp55);
                            auto tmp58 = tmp56 & tmp49;
                            auto tmp57 = [&]
                            {
                                auto tmp59 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp60 = c10::convert<int64_t>(tmp59);
                                auto tmp61 = at::vec::VectorizedN<int64_t,2>::arange(tmp60, -1);
                                auto tmp62 = static_cast<int64_t>(0);
                                auto tmp63 = at::vec::VectorizedN<int64_t,2>(tmp62);
                                auto tmp64 = at::vec::VecMask<int64_t,2>(tmp61 <= tmp63);
                                auto tmp65 = static_cast<float>(1.0);
                                auto tmp66 = static_cast<float>(0.0);
                                auto tmp67 = at::vec::Vectorized<float>(tmp65);
                                auto tmp68 = at::vec::Vectorized<float>(tmp66);
                                auto tmp69 = decltype(tmp67)::blendv(tmp68, tmp67, tmp64.template cast<float,1>());
                                auto tmp70 = at::vec::VecMask<float,1>::from<float,1>(tmp69);
                                auto tmp71 = tmp58.template cast<float,1>().template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                                auto tmp72 = at::vec::convert<float>(tmp71);
                                auto tmp73 = -std::numeric_limits<float>::infinity();
                                auto tmp74 = at::vec::Vectorized<float>(tmp73);
                                auto tmp75 = decltype(tmp74)::blendv(tmp72, tmp74, tmp70.template cast<float,1>());
                                return tmp75;
                            }
                            ;
                            auto tmp78 =
                            [&]
                            {
                                if (tmp58.all_zero())
                                {
                                    return at::vec::Vectorized<float>(static_cast<float>(0.0));
                                }
                                else
                                {
                                    auto tmp76 = tmp57();
                                    auto tmp77 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                    return decltype(tmp76)::blendv(tmp77, tmp76, tmp58.template cast<float,1>());
                                }
                            }
                            ()
                            ;
                            auto tmp79 = at::vec::VecMask<float,1>::from(tmp3).template loadu<bfloat16,1>(in_ptr1 + static_cast<int64_t>(x2 + (513L*x1)));
                            auto tmp80 = at::vec::convert<float>(tmp79);
                            auto tmp81 = decltype(tmp78)::blendv(tmp80, tmp78, tmp56.template cast<float,1>());
                            return tmp81;
                        }
                        ;
                        auto tmp82 = tmp3 ? tmp51() : at::vec::Vectorized<float>(static_cast<float>(0.0));
                        auto tmp84 = at::vec::convert<float>(tmp83);
                        auto tmp85 = decltype(tmp82)::blendv(tmp84, tmp82, tmp49.template cast<float,1>());
                        auto tmp86 = tmp50 + tmp85;
                        auto tmp87 = at::vec::convert<bfloat16>(tmp86);
                        tmp87.store(out_ptr3 + static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(512L); x2<static_cast<int64_t>(513L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp34 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                        auto tmp60 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                        auto tmp0 = x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(256);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = out_ptr2[static_cast<int64_t>((-131328L) + x2 + (513L*x1) + (131328L*x0))];
                            auto tmp6 = c10::convert<float>(tmp5);
                            return tmp6;
                        }
                        ;
                        auto tmp7 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp8 = x1 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                        auto tmp9 = c10::convert<int64_t>(tmp8);
                        auto tmp10 = tmp9 < tmp2;
                        auto tmp11 = [&]
                        {
                            auto tmp12 = x2;
                            auto tmp13 = c10::convert<int64_t>(tmp12);
                            auto tmp14 = static_cast<int64_t>(257);
                            auto tmp15 = tmp13 < tmp14;
                            auto tmp16 = [&]
                            {
                                auto tmp17 = (-255L) + x1 + x2 + (256L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L))));
                                auto tmp18 = c10::convert<int64_t>(tmp17);
                                auto tmp19 = static_cast<int64_t>(0);
                                auto tmp20 = tmp18 <= tmp19;
                                auto tmp21 = static_cast<float>(1.0);
                                auto tmp22 = static_cast<float>(0.0);
                                auto tmp23 = tmp20 ? tmp21 : tmp22;
                                auto tmp24 = c10::convert<bool>(tmp23);
                                auto tmp25 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                                auto tmp26 = c10::convert<float>(tmp25);
                                auto tmp27 = -std::numeric_limits<float>::infinity();
                                auto tmp28 = tmp24 ? tmp27 : tmp26;
                                return tmp28;
                            }
                            ;
                            auto tmp29 = tmp15 ? tmp16() : static_cast<decltype(tmp16())>(0.0);
                            auto tmp30 = out_ptr1[static_cast<int64_t>(x2 + (513L*x1) + (131328L*(c10::div_floor_integer(static_cast<int64_t>((static_cast<int64_t>(x1) % static_cast<int64_t>(256L))), static_cast<int64_t>(256L)))) + (262656L*x0))];
                            auto tmp31 = c10::convert<float>(tmp30);
                            auto tmp32 = tmp15 ? tmp29 : tmp31;
                            return tmp32;
                        }
                        ;
                        auto tmp33 = tmp10 ? tmp11() : static_cast<decltype(tmp11())>(0.0);
                        auto tmp35 = c10::convert<float>(tmp34);
                        auto tmp36 = tmp10 ? tmp33 : tmp35;
                        auto tmp37 = tmp3 ? tmp7 : tmp36;
                        auto tmp38 = [&]
                        {
                            auto tmp39 = x2;
                            auto tmp40 = c10::convert<int64_t>(tmp39);
                            auto tmp41 = tmp40 >= tmp2;
                            auto tmp42 = [&]
                            {
                                auto tmp43 = 768L + ((-1L)*x1) + ((-1L)*x2);
                                auto tmp44 = c10::convert<int64_t>(tmp43);
                                auto tmp45 = static_cast<int64_t>(0);
                                auto tmp46 = tmp44 <= tmp45;
                                auto tmp47 = static_cast<float>(1.0);
                                auto tmp48 = static_cast<float>(0.0);
                                auto tmp49 = tmp46 ? tmp47 : tmp48;
                                auto tmp50 = c10::convert<bool>(tmp49);
                                auto tmp51 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                                auto tmp52 = c10::convert<float>(tmp51);
                                auto tmp53 = -std::numeric_limits<float>::infinity();
                                auto tmp54 = tmp50 ? tmp53 : tmp52;
                                return tmp54;
                            }
                            ;
                            auto tmp55 = tmp41 ? tmp42() : static_cast<decltype(tmp42())>(0.0);
                            auto tmp56 = in_ptr1[static_cast<int64_t>(x2 + (513L*x1))];
                            auto tmp57 = c10::convert<float>(tmp56);
                            auto tmp58 = tmp41 ? tmp55 : tmp57;
                            return tmp58;
                        }
                        ;
                        auto tmp59 = tmp3 ? tmp38() : static_cast<decltype(tmp38())>(0.0);
                        auto tmp61 = c10::convert<float>(tmp60);
                        auto tmp62 = tmp3 ? tmp59 : tmp61;
                        auto tmp63 = decltype(tmp37)(tmp37 + tmp62);
                        auto tmp64 = c10::convert<bfloat16>(tmp63);
                        out_ptr3[static_cast<int64_t>(x2 + (513L*x0) + (6156L*x1))] = tmp64;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(6144L); x0+=static_cast<int64_t>(1L))
            {
                {
                    float tmp_acc0 = -std::numeric_limits<float>::infinity();
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(-std::numeric_limits<float>::infinity());
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        tmp_acc0_vec = at::vec::maximum(tmp_acc0_vec, tmp1);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp1 = c10::convert<float>(tmp0);
                        tmp_acc0 = max_propagate_nan(tmp_acc0, tmp1);
                    }
                    tmp_acc0 = max_propagate_nan(tmp_acc0, at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return at::vec::maximum(x, y); }, tmp_acc0_vec));
                    out_ptr4[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
                {
                    float tmp_acc0 = 0;
                    at::vec::Vectorized<float> tmp_acc0_vec = at::vec::Vectorized<float>(0);
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(512L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr3 + static_cast<int64_t>(x1 + (513L*x0)), 16);
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = at::vec::Vectorized<float>(tmp2);
                        auto tmp4 = tmp1 - tmp3;
                        auto tmp5 = tmp4.exp();
                        tmp5.store(out_ptr5 + static_cast<int64_t>(x1 + (513L*x0)));
                        tmp_acc0_vec = tmp_acc0_vec + tmp5;
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x1=static_cast<int64_t>(512L); x1<static_cast<int64_t>(513L); x1+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = out_ptr3[static_cast<int64_t>(x1 + (513L*x0))];
                        auto tmp2 = out_ptr4[static_cast<int64_t>(x0)];
                        auto tmp1 = c10::convert<float>(tmp0);
                        auto tmp3 = decltype(tmp1)(tmp1 - tmp2);
                        auto tmp4 = std::exp(tmp3);
                        out_ptr5[static_cast<int64_t>(x1 + (513L*x0))] = tmp4;
                        tmp_acc0 = tmp_acc0 + tmp4;
                    }
                    tmp_acc0 = tmp_acc0 + at::vec::vec_reduce_all<float>([](at::vec::Vectorized<float>& x, at::vec::Vectorized<float>& y) { return x + y; }, tmp_acc0_vec);
                    out_ptr6[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0);
                }
            }
        }
    }
}
''')


cpp_fused_clone_constant_pad_nd_81 = async_compile.cpp_pybinding(['const bfloat16*', 'const bool*', 'const float*', 'const float*', 'bfloat16*', 'bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const bool* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       bfloat16* out_ptr0,
                       bfloat16* out_ptr1,
                       bfloat16* out_ptr2)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(1024L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = (-256L) + x1;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(0);
                        auto tmp3 = tmp1 >= tmp2;
                        auto tmp4 = static_cast<int64_t>(512);
                        auto tmp5 = tmp1 < tmp4;
                        auto tmp6 = tmp3 & tmp5;
                        auto tmp7 = [&]
                        {
                            auto tmp8 = at::vec::VecMask<float,1>::from(tmp6).template loadu<bfloat16,1>(in_ptr0 + static_cast<int64_t>((-196608L) + x2 + (64L*x0) + (768L*x1)));
                            auto tmp9 = at::vec::convert<float>(tmp8);
                            return tmp9;
                        }
                        ;
                        auto tmp10 = tmp6 ? tmp7() : at::vec::Vectorized<float>(static_cast<float>(-1.0));
                        auto tmp11 = at::vec::convert<bfloat16>(tmp10);
                        tmp11.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (65536L*x0)), 16);
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(768L); x2+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = at::vec::VectorizedN<int64_t,2>::arange(tmp1, 1);
                        auto tmp3 = static_cast<int64_t>(513);
                        auto tmp4 = at::vec::VectorizedN<int64_t,2>(tmp3);
                        auto tmp5 = at::vec::VecMask<int64_t,2>(tmp2 < tmp4);
                        auto tmp6 = [&]
                        {
                            auto tmp7 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp8 = tmp5.template cast<float,1>().template loadu<float,1>(in_ptr2 + static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0)));
                            auto tmp9 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp10 = at::vec::Vectorized<float>(tmp9);
                            auto tmp11 = tmp8 / tmp10;
                            auto tmp12 = static_cast<float>(0.0);
                            auto tmp13 = at::vec::VecMask<float,1>::from(tmp7);
                            auto tmp14 = at::vec::Vectorized<float>(tmp12);
                            auto tmp15 = decltype(tmp14)::blendv(tmp11, tmp14, tmp13.template cast<float,1>());
                            auto tmp16 = (tmp15);
                            return tmp16;
                        }
                        ;
                        auto tmp19 =
                        [&]
                        {
                            if (tmp5.all_zero())
                            {
                                return at::vec::Vectorized<float>(static_cast<float>(0.0));
                            }
                            else
                            {
                                auto tmp17 = tmp6();
                                auto tmp18 = at::vec::Vectorized<float>(static_cast<float>(0.0));
                                return decltype(tmp17)::blendv(tmp18, tmp17, tmp5.template cast<float,1>());
                            }
                        }
                        ()
                        ;
                        auto tmp20 = at::vec::convert<bfloat16>(tmp19);
                        tmp20.store(out_ptr1 + static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1)), 16);
                    }
                    #pragma omp simd simdlen(8) 
                    for(int64_t x2=static_cast<int64_t>(768L); x2<static_cast<int64_t>(770L); x2+=static_cast<int64_t>(1L))
                    {
                        auto tmp0 = x2;
                        auto tmp1 = c10::convert<int64_t>(tmp0);
                        auto tmp2 = static_cast<int64_t>(513);
                        auto tmp3 = tmp1 < tmp2;
                        auto tmp4 = [&]
                        {
                            auto tmp5 = in_ptr1[static_cast<int64_t>(x0)];
                            auto tmp6 = in_ptr2[static_cast<int64_t>(x2 + (513L*x1) + (6156L*x0))];
                            auto tmp7 = in_ptr3[static_cast<int64_t>(x1 + (12L*x0))];
                            auto tmp8 = tmp6 / tmp7;
                            auto tmp9 = static_cast<float>(0.0);
                            auto tmp10 = tmp5 ? tmp9 : tmp8;
                            auto tmp11 = c10::convert<float>(tmp10);
                            return tmp11;
                        }
                        ;
                        auto tmp12 = tmp3 ? tmp4() : static_cast<decltype(tmp4())>(0.0);
                        auto tmp13 = c10::convert<bfloat16>(tmp12);
                        out_ptr1[static_cast<int64_t>(x2 + (770L*x0) + (394240L*x1))] = tmp13;
                    }
                }
            }
        }
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(12L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(2L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(49152L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(out_ptr0 + static_cast<int64_t>(x2 + (16384L*x1) + (65536L*x0)), 32);
                        tmp0.store(out_ptr2 + static_cast<int64_t>(x2 + (49152L*x1) + (98304L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused_clone_82 = async_compile.cpp_pybinding(['const bfloat16*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       bfloat16* out_ptr0)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                #pragma GCC ivdep
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(12L); x1+=static_cast<int64_t>(1L))
                {
                    for(int64_t x2=static_cast<int64_t>(0L); x2<static_cast<int64_t>(64L); x2+=static_cast<int64_t>(32L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x2 + (64L*x0) + (32768L*x1)), 32);
                        tmp0.store(out_ptr0 + static_cast<int64_t>(x2 + (64L*x1) + (768L*x0)), 32);
                    }
                }
            }
        }
    }
}
''')


cpp_fused__to_copy_add_native_layer_norm_83 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*', 'bfloat16*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2,
                       bfloat16* out_ptr3)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    auto tmp19 = at::vec::convert<bfloat16>(tmp18);
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                    tmp19.store(out_ptr3 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                }
            }
        }
    }
}
''')


cpp_fused_add_native_layer_norm_84 = async_compile.cpp_pybinding(['const bfloat16*', 'const float*', 'const float*', 'const float*', 'float*', 'float*', 'float*'], '''
#include "/tmp/torchinductor_leslie/z4/cz4j2mmotlx3z2b7u4fbjtdt4x6plhd67ljwzg5bk7ekv4xz6y7q.h"
extern "C"  void kernel(const bfloat16* in_ptr0,
                       const float* in_ptr1,
                       const float* in_ptr2,
                       const float* in_ptr3,
                       float* out_ptr0,
                       float* out_ptr1,
                       float* out_ptr2)
{
    #pragma omp parallel num_threads(56)
    {
        int tid = omp_get_thread_num();
        {
            #pragma omp for
            for(int64_t x0=static_cast<int64_t>(0L); x0<static_cast<int64_t>(512L); x0+=static_cast<int64_t>(1L))
            {
                {
                    Welford<float> tmp_acc0 = Welford<float>();
                    Welford<at::vec::Vectorized<float>> tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    Welford<at::vec::Vectorized<float>> masked_tmp_acc0_vec = Welford<at::vec::Vectorized<float>>();
                    static WeightRecp<at::vec::Vectorized<float>> wrecps0(static_cast<int64_t>(48L));
                    for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                    {
                        auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                        auto tmp1 = at::vec::convert<float>(tmp0);
                        auto tmp3 = tmp1 + tmp2;
                        tmp_acc0_vec = welford_combine(tmp_acc0_vec, tmp3, &wrecps0);
                    }
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(masked_tmp_acc0_vec));
                    tmp_acc0 = welford_combine(tmp_acc0, welford_vec_reduce_all(tmp_acc0_vec));
                    out_ptr0[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.mean);
                    out_ptr1[static_cast<int64_t>(x0)] = static_cast<float>(tmp_acc0.m2);
                }
                for(int64_t x1=static_cast<int64_t>(0L); x1<static_cast<int64_t>(768L); x1+=static_cast<int64_t>(16L))
                {
                    auto tmp0 = at::vec::Vectorized<bfloat16>::loadu(in_ptr0 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp2 = at::vec::Vectorized<float>::loadu(in_ptr1 + static_cast<int64_t>(x1 + (768L*x0)), 16);
                    auto tmp4 = out_ptr0[static_cast<int64_t>(x0)];
                    auto tmp7 = out_ptr1[static_cast<int64_t>(x0)];
                    auto tmp15 = at::vec::Vectorized<float>::loadu(in_ptr2 + static_cast<int64_t>(x1), 16);
                    auto tmp17 = at::vec::Vectorized<float>::loadu(in_ptr3 + static_cast<int64_t>(x1), 16);
                    auto tmp1 = at::vec::convert<float>(tmp0);
                    auto tmp3 = tmp1 + tmp2;
                    auto tmp5 = at::vec::Vectorized<float>(tmp4);
                    auto tmp6 = tmp3 - tmp5;
                    auto tmp8 = static_cast<float>(768.0);
                    auto tmp9 = tmp7 / tmp8;
                    auto tmp10 = static_cast<float>(1e-05);
                    auto tmp11 = decltype(tmp9)(tmp9 + tmp10);
                    auto tmp12 = 1 / std::sqrt(tmp11);
                    auto tmp13 = at::vec::Vectorized<float>(tmp12);
                    auto tmp14 = tmp6 * tmp13;
                    auto tmp16 = tmp14 * tmp15;
                    auto tmp18 = tmp16 + tmp17;
                    tmp18.store(out_ptr2 + static_cast<int64_t>(x1 + (768L*x0)));
                }
            }
        }
    }
}
''')


async_compile.wait(globals())
del async_compile

def call(args):
    arg192_1, arg193_1, arg194_1 = args
    args.clear()
    assert_size_stride(arg192_1, (1, 512, 768), (393216, 768, 1))
    assert_size_stride(arg193_1, (1, 512), (512, 1))
    assert_size_stride(arg194_1, (1, 512), (512, 1))
    buf0 = empty_strided_cpu((512, 1, 768), (768, 393216, 1), torch.bfloat16)
    cpp_fused__to_copy_0(arg192_1, buf0)
    buf1 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf0, (512, 768), (768, 1), 0), _frozen_param336, _frozen_param192, 'none', [-1], '')
    buf2 = reinterpret_tensor(buf1, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf1  # reuse
    cpp_fused_view_1(buf2)
    buf3 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf0, (512, 768), (768, 1), 0), _frozen_param337, _frozen_param194, 'none', [-1], '')
    buf4 = reinterpret_tensor(buf3, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf3  # reuse
    cpp_fused_view_2(buf4)
    buf5 = empty_strided_cpu((12, 512, 512), (262144, 512, 1), torch.bfloat16)
    # Topologically Sorted Source Nodes: [diagonal_chunked_attention_scores], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf2, (12, 512, 64), (64, 768, 1), 0), reinterpret_tensor(buf4, (12, 64, 512), (64, 1, 768), 0), out=buf5)
    del buf2
    del buf4
    buf6 = empty_strided_cpu((12, 2, 256, 513), (262656, 513, 1026, 1), torch.bfloat16)
    buf7 = empty_strided_cpu((12, 2, 256, 513), (262656, 131328, 513, 1), torch.bfloat16)
    buf8 = empty_strided_cpu((1, 256, 12, 513), (1575936, 513, 131328, 1), torch.bfloat16)
    buf9 = empty_strided_cpu((1, 1, 512, 1), (512, 512, 1, 1), torch.bfloat16)
    buf10 = empty_strided_cpu((1, 2, 256, 513), (262656, 131328, 513, 1), torch.bfloat16)
    buf11 = empty_strided_cpu((1, 256, 513), (131328, 513, 1), torch.bfloat16)
    buf12 = empty_strided_cpu((1, 256, 1, 257), (65792, 257, 65792, 1), torch.bfloat16)
    buf13 = empty_strided_cpu((1, 512, 1, 513), (262656, 513, 262656, 1), torch.bfloat16)
    buf14 = empty_strided_cpu((1, 512, 12, 513), (3151872, 6156, 513, 1), torch.bfloat16)
    buf15 = empty_strided_cpu((1, 512, 12, 1), (6144, 12, 1, 6144), torch.float32)
    buf16 = empty_strided_cpu((1, 512, 12, 513), (3151872, 6156, 513, 1), torch.float32)
    buf17 = empty_strided_cpu((1, 512, 12, 1), (6144, 12, 1, 6144), torch.float32)
    cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_view_where_3(buf5, arg193_1, buf6, buf7, buf8, buf9, buf10, buf11, buf12, buf13, buf14, buf15, buf16, buf17)
    del arg193_1
    del buf10
    del buf11
    del buf12
    del buf9
    buf18 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf0, (512, 768), (768, 1), 0), _frozen_param338, _frozen_param196, 'none', [-1], '')
    buf19 = empty_strided_cpu((12, 1024, 64), (65536, 64, 1), torch.bfloat16)
    buf20 = empty_strided_cpu((12, 2, 256, 770), (394240, 197120, 770, 1), torch.bfloat16)
    buf21 = empty_strided_cpu((12, 2, 768, 64, 1), (98304, 49152, 64, 1, 1), torch.bfloat16)
    cpp_fused_clone_constant_pad_nd_4(buf18, arg194_1, buf16, buf17, buf19, buf20, buf21)
    buf22 = reinterpret_tensor(buf18, (24, 256, 64), (16384, 64, 1), 0); del buf18  # reuse
    # Topologically Sorted Source Nodes: [context], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf20, (24, 256, 768), (197120, 769, 1), 0), reinterpret_tensor(buf21, (24, 768, 64), (49152, 64, 1), 0), out=buf22)
    buf23 = reinterpret_tensor(buf0, (512, 1, 12, 64), (768, 1, 64, 1), 0); del buf0  # reuse
    cpp_fused_clone_5(buf22, buf23)
    del buf22
    buf24 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf23, (512, 768), (768, 1), 0), _frozen_param339, _frozen_param198, 'none', [-1], '')
    buf25 = empty_strided_cpu((1, 512, 1), (512, 1, 512), torch.float32)
    buf26 = empty_strided_cpu((1, 512, 1), (512, 1, 512), torch.float32)
    buf28 = empty_strided_cpu((1, 512, 768), (393216, 768, 1), torch.float32)
    buf29 = reinterpret_tensor(buf23, (1, 512, 768), (393216, 768, 1), 0); del buf23  # reuse
    cpp_fused__to_copy_add_native_layer_norm_6(buf24, arg192_1, _frozen_param8, _frozen_param9, buf25, buf26, buf28, buf29)
    del arg192_1
    del buf24
    buf30 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf29, (512, 768), (768, 1), 0), _frozen_param340, _frozen_param200, 'gelu', [-1], 'none')
    buf31 = torch.ops.mkldnn._linear_pointwise.default(buf30, _frozen_param341, _frozen_param202, 'none', [-1], '')
    del buf30
    buf32 = buf26; del buf26  # reuse
    buf33 = buf25; del buf25  # reuse
    buf35 = empty_strided_cpu((1, 512, 768), (393216, 768, 1), torch.float32)
    buf36 = reinterpret_tensor(buf29, (512, 1, 768), (768, 393216, 1), 0); del buf29  # reuse
    cpp_fused__to_copy_add_native_layer_norm_7(buf31, buf28, _frozen_param14, _frozen_param15, buf32, buf33, buf35, buf36)
    del buf31
    buf37 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf36, (512, 768), (768, 1), 0), _frozen_param342, _frozen_param204, 'none', [-1], '')
    buf38 = reinterpret_tensor(buf37, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf37  # reuse
    cpp_fused_view_8(buf38)
    buf39 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf36, (512, 768), (768, 1), 0), _frozen_param343, _frozen_param206, 'none', [-1], '')
    buf40 = reinterpret_tensor(buf39, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf39  # reuse
    cpp_fused_view_9(buf40)
    buf41 = buf5; del buf5  # reuse
    # Topologically Sorted Source Nodes: [diagonal_chunked_attention_scores_2], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf38, (12, 512, 64), (64, 768, 1), 0), reinterpret_tensor(buf40, (12, 64, 512), (64, 1, 768), 0), out=buf41)
    del buf38
    del buf40
    buf42 = reinterpret_tensor(buf7, (12, 2, 256, 513), (262656, 513, 1026, 1), 0); del buf7  # reuse
    buf43 = reinterpret_tensor(buf6, (12, 2, 256, 513), (262656, 131328, 513, 1), 0); del buf6  # reuse
    buf44 = buf8; del buf8  # reuse
    buf45 = buf14; del buf14  # reuse
    buf46 = buf17; del buf17  # reuse
    buf47 = buf16; del buf16  # reuse
    buf48 = buf15; del buf15  # reuse
    cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_10(buf41, buf13, buf42, buf43, buf44, buf45, buf46, buf47, buf48)
    buf49 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf36, (512, 768), (768, 1), 0), _frozen_param344, _frozen_param208, 'none', [-1], '')
    buf50 = buf19; del buf19  # reuse
    buf51 = buf20; del buf20  # reuse
    buf52 = buf21; del buf21  # reuse
    cpp_fused_clone_constant_pad_nd_11(buf49, arg194_1, buf47, buf48, buf50, buf51, buf52)
    buf53 = reinterpret_tensor(buf49, (24, 256, 64), (16384, 64, 1), 0); del buf49  # reuse
    # Topologically Sorted Source Nodes: [context_1], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf51, (24, 256, 768), (197120, 769, 1), 0), reinterpret_tensor(buf52, (24, 768, 64), (49152, 64, 1), 0), out=buf53)
    buf54 = reinterpret_tensor(buf36, (512, 1, 12, 64), (768, 1, 64, 1), 0); del buf36  # reuse
    cpp_fused_clone_12(buf53, buf54)
    del buf53
    buf55 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf54, (512, 768), (768, 1), 0), _frozen_param345, _frozen_param210, 'none', [-1], '')
    buf56 = buf33; del buf33  # reuse
    buf57 = buf32; del buf32  # reuse
    buf59 = buf28; del buf28  # reuse
    buf60 = reinterpret_tensor(buf54, (1, 512, 768), (393216, 768, 1), 0); del buf54  # reuse
    cpp_fused__to_copy_add_native_layer_norm_13(buf55, buf35, _frozen_param24, _frozen_param25, buf56, buf57, buf59, buf60)
    del buf55
    buf61 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf60, (512, 768), (768, 1), 0), _frozen_param346, _frozen_param212, 'gelu', [-1], 'none')
    buf62 = torch.ops.mkldnn._linear_pointwise.default(buf61, _frozen_param347, _frozen_param214, 'none', [-1], '')
    del buf61
    buf63 = buf57; del buf57  # reuse
    buf64 = buf56; del buf56  # reuse
    buf66 = buf35; del buf35  # reuse
    buf67 = reinterpret_tensor(buf60, (512, 1, 768), (768, 393216, 1), 0); del buf60  # reuse
    cpp_fused__to_copy_add_native_layer_norm_14(buf62, buf59, _frozen_param30, _frozen_param31, buf63, buf64, buf66, buf67)
    del buf62
    buf68 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf67, (512, 768), (768, 1), 0), _frozen_param348, _frozen_param216, 'none', [-1], '')
    buf69 = reinterpret_tensor(buf68, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf68  # reuse
    cpp_fused_view_15(buf69)
    buf70 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf67, (512, 768), (768, 1), 0), _frozen_param349, _frozen_param218, 'none', [-1], '')
    buf71 = reinterpret_tensor(buf70, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf70  # reuse
    cpp_fused_view_16(buf71)
    buf72 = buf41; del buf41  # reuse
    # Topologically Sorted Source Nodes: [diagonal_chunked_attention_scores_4], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf69, (12, 512, 64), (64, 768, 1), 0), reinterpret_tensor(buf71, (12, 64, 512), (64, 1, 768), 0), out=buf72)
    del buf69
    del buf71
    buf73 = reinterpret_tensor(buf45, (12, 2, 256, 513), (262656, 513, 1026, 1), 0); del buf45  # reuse
    buf74 = buf43; del buf43  # reuse
    buf75 = buf44; del buf44  # reuse
    buf76 = reinterpret_tensor(buf42, (1, 512, 12, 513), (3151872, 6156, 513, 1), 0); del buf42  # reuse
    buf77 = buf48; del buf48  # reuse
    buf78 = buf47; del buf47  # reuse
    buf79 = buf46; del buf46  # reuse
    cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_17(buf72, buf13, buf73, buf74, buf75, buf76, buf77, buf78, buf79)
    buf80 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf67, (512, 768), (768, 1), 0), _frozen_param350, _frozen_param220, 'none', [-1], '')
    buf81 = buf50; del buf50  # reuse
    buf82 = buf51; del buf51  # reuse
    buf83 = buf52; del buf52  # reuse
    cpp_fused_clone_constant_pad_nd_18(buf80, arg194_1, buf78, buf79, buf81, buf82, buf83)
    buf84 = reinterpret_tensor(buf80, (24, 256, 64), (16384, 64, 1), 0); del buf80  # reuse
    # Topologically Sorted Source Nodes: [context_2], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf82, (24, 256, 768), (197120, 769, 1), 0), reinterpret_tensor(buf83, (24, 768, 64), (49152, 64, 1), 0), out=buf84)
    buf85 = reinterpret_tensor(buf67, (512, 1, 12, 64), (768, 1, 64, 1), 0); del buf67  # reuse
    cpp_fused_clone_19(buf84, buf85)
    del buf84
    buf86 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf85, (512, 768), (768, 1), 0), _frozen_param351, _frozen_param222, 'none', [-1], '')
    buf87 = buf64; del buf64  # reuse
    buf88 = buf63; del buf63  # reuse
    buf90 = buf59; del buf59  # reuse
    buf91 = reinterpret_tensor(buf85, (1, 512, 768), (393216, 768, 1), 0); del buf85  # reuse
    cpp_fused__to_copy_add_native_layer_norm_20(buf86, buf66, _frozen_param40, _frozen_param41, buf87, buf88, buf90, buf91)
    del buf86
    buf92 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf91, (512, 768), (768, 1), 0), _frozen_param352, _frozen_param224, 'gelu', [-1], 'none')
    buf93 = torch.ops.mkldnn._linear_pointwise.default(buf92, _frozen_param353, _frozen_param226, 'none', [-1], '')
    del buf92
    buf94 = buf88; del buf88  # reuse
    buf95 = buf87; del buf87  # reuse
    buf97 = buf66; del buf66  # reuse
    buf98 = reinterpret_tensor(buf91, (512, 1, 768), (768, 393216, 1), 0); del buf91  # reuse
    cpp_fused__to_copy_add_native_layer_norm_21(buf93, buf90, _frozen_param46, _frozen_param47, buf94, buf95, buf97, buf98)
    del buf93
    buf99 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf98, (512, 768), (768, 1), 0), _frozen_param354, _frozen_param228, 'none', [-1], '')
    buf100 = reinterpret_tensor(buf99, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf99  # reuse
    cpp_fused_view_22(buf100)
    buf101 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf98, (512, 768), (768, 1), 0), _frozen_param355, _frozen_param230, 'none', [-1], '')
    buf102 = reinterpret_tensor(buf101, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf101  # reuse
    cpp_fused_view_23(buf102)
    buf103 = buf72; del buf72  # reuse
    # Topologically Sorted Source Nodes: [diagonal_chunked_attention_scores_6], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf100, (12, 512, 64), (64, 768, 1), 0), reinterpret_tensor(buf102, (12, 64, 512), (64, 1, 768), 0), out=buf103)
    del buf100
    del buf102
    buf104 = reinterpret_tensor(buf76, (12, 2, 256, 513), (262656, 513, 1026, 1), 0); del buf76  # reuse
    buf105 = buf74; del buf74  # reuse
    buf106 = buf75; del buf75  # reuse
    buf107 = reinterpret_tensor(buf73, (1, 512, 12, 513), (3151872, 6156, 513, 1), 0); del buf73  # reuse
    buf108 = buf79; del buf79  # reuse
    buf109 = buf78; del buf78  # reuse
    buf110 = buf77; del buf77  # reuse
    cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_24(buf103, buf13, buf104, buf105, buf106, buf107, buf108, buf109, buf110)
    buf111 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf98, (512, 768), (768, 1), 0), _frozen_param356, _frozen_param232, 'none', [-1], '')
    buf112 = buf81; del buf81  # reuse
    buf113 = buf82; del buf82  # reuse
    buf114 = buf83; del buf83  # reuse
    cpp_fused_clone_constant_pad_nd_25(buf111, arg194_1, buf109, buf110, buf112, buf113, buf114)
    buf115 = reinterpret_tensor(buf111, (24, 256, 64), (16384, 64, 1), 0); del buf111  # reuse
    # Topologically Sorted Source Nodes: [context_3], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf113, (24, 256, 768), (197120, 769, 1), 0), reinterpret_tensor(buf114, (24, 768, 64), (49152, 64, 1), 0), out=buf115)
    buf116 = reinterpret_tensor(buf98, (512, 1, 12, 64), (768, 1, 64, 1), 0); del buf98  # reuse
    cpp_fused_clone_26(buf115, buf116)
    del buf115
    buf117 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf116, (512, 768), (768, 1), 0), _frozen_param357, _frozen_param234, 'none', [-1], '')
    buf118 = buf95; del buf95  # reuse
    buf119 = buf94; del buf94  # reuse
    buf121 = buf90; del buf90  # reuse
    buf122 = reinterpret_tensor(buf116, (1, 512, 768), (393216, 768, 1), 0); del buf116  # reuse
    cpp_fused__to_copy_add_native_layer_norm_27(buf117, buf97, _frozen_param56, _frozen_param57, buf118, buf119, buf121, buf122)
    del buf117
    buf123 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf122, (512, 768), (768, 1), 0), _frozen_param358, _frozen_param236, 'gelu', [-1], 'none')
    buf124 = torch.ops.mkldnn._linear_pointwise.default(buf123, _frozen_param359, _frozen_param238, 'none', [-1], '')
    del buf123
    buf125 = buf119; del buf119  # reuse
    buf126 = buf118; del buf118  # reuse
    buf128 = buf97; del buf97  # reuse
    buf129 = reinterpret_tensor(buf122, (512, 1, 768), (768, 393216, 1), 0); del buf122  # reuse
    cpp_fused__to_copy_add_native_layer_norm_28(buf124, buf121, _frozen_param62, _frozen_param63, buf125, buf126, buf128, buf129)
    del buf124
    buf130 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf129, (512, 768), (768, 1), 0), _frozen_param360, _frozen_param240, 'none', [-1], '')
    buf131 = reinterpret_tensor(buf130, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf130  # reuse
    cpp_fused_view_29(buf131)
    buf132 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf129, (512, 768), (768, 1), 0), _frozen_param361, _frozen_param242, 'none', [-1], '')
    buf133 = reinterpret_tensor(buf132, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf132  # reuse
    cpp_fused_view_30(buf133)
    buf134 = buf103; del buf103  # reuse
    # Topologically Sorted Source Nodes: [diagonal_chunked_attention_scores_8], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf131, (12, 512, 64), (64, 768, 1), 0), reinterpret_tensor(buf133, (12, 64, 512), (64, 1, 768), 0), out=buf134)
    del buf131
    del buf133
    buf135 = reinterpret_tensor(buf107, (12, 2, 256, 513), (262656, 513, 1026, 1), 0); del buf107  # reuse
    buf136 = buf105; del buf105  # reuse
    buf137 = buf106; del buf106  # reuse
    buf138 = reinterpret_tensor(buf104, (1, 512, 12, 513), (3151872, 6156, 513, 1), 0); del buf104  # reuse
    buf139 = buf110; del buf110  # reuse
    buf140 = buf109; del buf109  # reuse
    buf141 = buf108; del buf108  # reuse
    cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_31(buf134, buf13, buf135, buf136, buf137, buf138, buf139, buf140, buf141)
    buf142 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf129, (512, 768), (768, 1), 0), _frozen_param362, _frozen_param244, 'none', [-1], '')
    buf143 = buf112; del buf112  # reuse
    buf144 = buf113; del buf113  # reuse
    buf145 = buf114; del buf114  # reuse
    cpp_fused_clone_constant_pad_nd_32(buf142, arg194_1, buf140, buf141, buf143, buf144, buf145)
    buf146 = reinterpret_tensor(buf142, (24, 256, 64), (16384, 64, 1), 0); del buf142  # reuse
    # Topologically Sorted Source Nodes: [context_4], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf144, (24, 256, 768), (197120, 769, 1), 0), reinterpret_tensor(buf145, (24, 768, 64), (49152, 64, 1), 0), out=buf146)
    buf147 = reinterpret_tensor(buf129, (512, 1, 12, 64), (768, 1, 64, 1), 0); del buf129  # reuse
    cpp_fused_clone_33(buf146, buf147)
    del buf146
    buf148 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf147, (512, 768), (768, 1), 0), _frozen_param363, _frozen_param246, 'none', [-1], '')
    buf149 = buf126; del buf126  # reuse
    buf150 = buf125; del buf125  # reuse
    buf152 = buf121; del buf121  # reuse
    buf153 = reinterpret_tensor(buf147, (1, 512, 768), (393216, 768, 1), 0); del buf147  # reuse
    cpp_fused__to_copy_add_native_layer_norm_34(buf148, buf128, _frozen_param72, _frozen_param73, buf149, buf150, buf152, buf153)
    del buf148
    buf154 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf153, (512, 768), (768, 1), 0), _frozen_param364, _frozen_param248, 'gelu', [-1], 'none')
    buf155 = torch.ops.mkldnn._linear_pointwise.default(buf154, _frozen_param365, _frozen_param250, 'none', [-1], '')
    del buf154
    buf156 = buf150; del buf150  # reuse
    buf157 = buf149; del buf149  # reuse
    buf159 = buf128; del buf128  # reuse
    buf160 = reinterpret_tensor(buf153, (512, 1, 768), (768, 393216, 1), 0); del buf153  # reuse
    cpp_fused__to_copy_add_native_layer_norm_35(buf155, buf152, _frozen_param78, _frozen_param79, buf156, buf157, buf159, buf160)
    del buf155
    buf161 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf160, (512, 768), (768, 1), 0), _frozen_param366, _frozen_param252, 'none', [-1], '')
    buf162 = reinterpret_tensor(buf161, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf161  # reuse
    cpp_fused_view_36(buf162)
    buf163 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf160, (512, 768), (768, 1), 0), _frozen_param367, _frozen_param254, 'none', [-1], '')
    buf164 = reinterpret_tensor(buf163, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf163  # reuse
    cpp_fused_view_37(buf164)
    buf165 = buf134; del buf134  # reuse
    # Topologically Sorted Source Nodes: [diagonal_chunked_attention_scores_10], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf162, (12, 512, 64), (64, 768, 1), 0), reinterpret_tensor(buf164, (12, 64, 512), (64, 1, 768), 0), out=buf165)
    del buf162
    del buf164
    buf166 = reinterpret_tensor(buf138, (12, 2, 256, 513), (262656, 513, 1026, 1), 0); del buf138  # reuse
    buf167 = buf136; del buf136  # reuse
    buf168 = buf137; del buf137  # reuse
    buf169 = reinterpret_tensor(buf135, (1, 512, 12, 513), (3151872, 6156, 513, 1), 0); del buf135  # reuse
    buf170 = buf141; del buf141  # reuse
    buf171 = buf140; del buf140  # reuse
    buf172 = buf139; del buf139  # reuse
    cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_38(buf165, buf13, buf166, buf167, buf168, buf169, buf170, buf171, buf172)
    buf173 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf160, (512, 768), (768, 1), 0), _frozen_param368, _frozen_param256, 'none', [-1], '')
    buf174 = buf143; del buf143  # reuse
    buf175 = buf144; del buf144  # reuse
    buf176 = buf145; del buf145  # reuse
    cpp_fused_clone_constant_pad_nd_39(buf173, arg194_1, buf171, buf172, buf174, buf175, buf176)
    buf177 = reinterpret_tensor(buf173, (24, 256, 64), (16384, 64, 1), 0); del buf173  # reuse
    # Topologically Sorted Source Nodes: [context_5], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf175, (24, 256, 768), (197120, 769, 1), 0), reinterpret_tensor(buf176, (24, 768, 64), (49152, 64, 1), 0), out=buf177)
    buf178 = reinterpret_tensor(buf160, (512, 1, 12, 64), (768, 1, 64, 1), 0); del buf160  # reuse
    cpp_fused_clone_40(buf177, buf178)
    del buf177
    buf179 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf178, (512, 768), (768, 1), 0), _frozen_param369, _frozen_param258, 'none', [-1], '')
    buf180 = buf157; del buf157  # reuse
    buf181 = buf156; del buf156  # reuse
    buf183 = buf152; del buf152  # reuse
    buf184 = reinterpret_tensor(buf178, (1, 512, 768), (393216, 768, 1), 0); del buf178  # reuse
    cpp_fused__to_copy_add_native_layer_norm_41(buf179, buf159, _frozen_param88, _frozen_param89, buf180, buf181, buf183, buf184)
    del buf179
    buf185 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf184, (512, 768), (768, 1), 0), _frozen_param370, _frozen_param260, 'gelu', [-1], 'none')
    buf186 = torch.ops.mkldnn._linear_pointwise.default(buf185, _frozen_param371, _frozen_param262, 'none', [-1], '')
    del buf185
    buf187 = buf181; del buf181  # reuse
    buf188 = buf180; del buf180  # reuse
    buf190 = buf159; del buf159  # reuse
    buf191 = reinterpret_tensor(buf184, (512, 1, 768), (768, 393216, 1), 0); del buf184  # reuse
    cpp_fused__to_copy_add_native_layer_norm_42(buf186, buf183, _frozen_param94, _frozen_param95, buf187, buf188, buf190, buf191)
    del buf186
    buf192 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf191, (512, 768), (768, 1), 0), _frozen_param372, _frozen_param264, 'none', [-1], '')
    buf193 = reinterpret_tensor(buf192, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf192  # reuse
    cpp_fused_view_43(buf193)
    buf194 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf191, (512, 768), (768, 1), 0), _frozen_param373, _frozen_param266, 'none', [-1], '')
    buf195 = reinterpret_tensor(buf194, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf194  # reuse
    cpp_fused_view_44(buf195)
    buf196 = buf165; del buf165  # reuse
    # Topologically Sorted Source Nodes: [diagonal_chunked_attention_scores_12], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf193, (12, 512, 64), (64, 768, 1), 0), reinterpret_tensor(buf195, (12, 64, 512), (64, 1, 768), 0), out=buf196)
    del buf193
    del buf195
    buf197 = reinterpret_tensor(buf169, (12, 2, 256, 513), (262656, 513, 1026, 1), 0); del buf169  # reuse
    buf198 = buf167; del buf167  # reuse
    buf199 = buf168; del buf168  # reuse
    buf200 = reinterpret_tensor(buf166, (1, 512, 12, 513), (3151872, 6156, 513, 1), 0); del buf166  # reuse
    buf201 = buf172; del buf172  # reuse
    buf202 = buf171; del buf171  # reuse
    buf203 = buf170; del buf170  # reuse
    cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_45(buf196, buf13, buf197, buf198, buf199, buf200, buf201, buf202, buf203)
    buf204 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf191, (512, 768), (768, 1), 0), _frozen_param374, _frozen_param268, 'none', [-1], '')
    buf205 = buf174; del buf174  # reuse
    buf206 = buf175; del buf175  # reuse
    buf207 = buf176; del buf176  # reuse
    cpp_fused_clone_constant_pad_nd_46(buf204, arg194_1, buf202, buf203, buf205, buf206, buf207)
    buf208 = reinterpret_tensor(buf204, (24, 256, 64), (16384, 64, 1), 0); del buf204  # reuse
    # Topologically Sorted Source Nodes: [context_6], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf206, (24, 256, 768), (197120, 769, 1), 0), reinterpret_tensor(buf207, (24, 768, 64), (49152, 64, 1), 0), out=buf208)
    buf209 = reinterpret_tensor(buf191, (512, 1, 12, 64), (768, 1, 64, 1), 0); del buf191  # reuse
    cpp_fused_clone_47(buf208, buf209)
    del buf208
    buf210 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf209, (512, 768), (768, 1), 0), _frozen_param375, _frozen_param270, 'none', [-1], '')
    buf211 = buf188; del buf188  # reuse
    buf212 = buf187; del buf187  # reuse
    buf214 = buf183; del buf183  # reuse
    buf215 = reinterpret_tensor(buf209, (1, 512, 768), (393216, 768, 1), 0); del buf209  # reuse
    cpp_fused__to_copy_add_native_layer_norm_48(buf210, buf190, _frozen_param104, _frozen_param105, buf211, buf212, buf214, buf215)
    del buf210
    buf216 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf215, (512, 768), (768, 1), 0), _frozen_param376, _frozen_param272, 'gelu', [-1], 'none')
    buf217 = torch.ops.mkldnn._linear_pointwise.default(buf216, _frozen_param377, _frozen_param274, 'none', [-1], '')
    del buf216
    buf218 = buf212; del buf212  # reuse
    buf219 = buf211; del buf211  # reuse
    buf221 = buf190; del buf190  # reuse
    buf222 = reinterpret_tensor(buf215, (512, 1, 768), (768, 393216, 1), 0); del buf215  # reuse
    cpp_fused__to_copy_add_native_layer_norm_49(buf217, buf214, _frozen_param110, _frozen_param111, buf218, buf219, buf221, buf222)
    del buf217
    buf223 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf222, (512, 768), (768, 1), 0), _frozen_param378, _frozen_param276, 'none', [-1], '')
    buf224 = reinterpret_tensor(buf223, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf223  # reuse
    cpp_fused_view_50(buf224)
    buf225 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf222, (512, 768), (768, 1), 0), _frozen_param379, _frozen_param278, 'none', [-1], '')
    buf226 = reinterpret_tensor(buf225, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf225  # reuse
    cpp_fused_view_51(buf226)
    buf227 = buf196; del buf196  # reuse
    # Topologically Sorted Source Nodes: [diagonal_chunked_attention_scores_14], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf224, (12, 512, 64), (64, 768, 1), 0), reinterpret_tensor(buf226, (12, 64, 512), (64, 1, 768), 0), out=buf227)
    del buf224
    del buf226
    buf228 = reinterpret_tensor(buf200, (12, 2, 256, 513), (262656, 513, 1026, 1), 0); del buf200  # reuse
    buf229 = buf198; del buf198  # reuse
    buf230 = buf199; del buf199  # reuse
    buf231 = reinterpret_tensor(buf197, (1, 512, 12, 513), (3151872, 6156, 513, 1), 0); del buf197  # reuse
    buf232 = buf203; del buf203  # reuse
    buf233 = buf202; del buf202  # reuse
    buf234 = buf201; del buf201  # reuse
    cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_52(buf227, buf13, buf228, buf229, buf230, buf231, buf232, buf233, buf234)
    buf235 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf222, (512, 768), (768, 1), 0), _frozen_param380, _frozen_param280, 'none', [-1], '')
    buf236 = buf205; del buf205  # reuse
    buf237 = buf206; del buf206  # reuse
    buf238 = buf207; del buf207  # reuse
    cpp_fused_clone_constant_pad_nd_53(buf235, arg194_1, buf233, buf234, buf236, buf237, buf238)
    buf239 = reinterpret_tensor(buf235, (24, 256, 64), (16384, 64, 1), 0); del buf235  # reuse
    # Topologically Sorted Source Nodes: [context_7], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf237, (24, 256, 768), (197120, 769, 1), 0), reinterpret_tensor(buf238, (24, 768, 64), (49152, 64, 1), 0), out=buf239)
    buf240 = reinterpret_tensor(buf222, (512, 1, 12, 64), (768, 1, 64, 1), 0); del buf222  # reuse
    cpp_fused_clone_54(buf239, buf240)
    del buf239
    buf241 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf240, (512, 768), (768, 1), 0), _frozen_param381, _frozen_param282, 'none', [-1], '')
    buf242 = buf219; del buf219  # reuse
    buf243 = buf218; del buf218  # reuse
    buf245 = buf214; del buf214  # reuse
    buf246 = reinterpret_tensor(buf240, (1, 512, 768), (393216, 768, 1), 0); del buf240  # reuse
    cpp_fused__to_copy_add_native_layer_norm_55(buf241, buf221, _frozen_param120, _frozen_param121, buf242, buf243, buf245, buf246)
    del buf241
    buf247 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf246, (512, 768), (768, 1), 0), _frozen_param382, _frozen_param284, 'gelu', [-1], 'none')
    buf248 = torch.ops.mkldnn._linear_pointwise.default(buf247, _frozen_param383, _frozen_param286, 'none', [-1], '')
    del buf247
    buf249 = buf243; del buf243  # reuse
    buf250 = buf242; del buf242  # reuse
    buf252 = buf221; del buf221  # reuse
    buf253 = reinterpret_tensor(buf246, (512, 1, 768), (768, 393216, 1), 0); del buf246  # reuse
    cpp_fused__to_copy_add_native_layer_norm_56(buf248, buf245, _frozen_param126, _frozen_param127, buf249, buf250, buf252, buf253)
    del buf248
    buf254 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf253, (512, 768), (768, 1), 0), _frozen_param384, _frozen_param288, 'none', [-1], '')
    buf255 = reinterpret_tensor(buf254, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf254  # reuse
    cpp_fused_view_57(buf255)
    buf256 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf253, (512, 768), (768, 1), 0), _frozen_param385, _frozen_param290, 'none', [-1], '')
    buf257 = reinterpret_tensor(buf256, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf256  # reuse
    cpp_fused_view_58(buf257)
    buf258 = buf227; del buf227  # reuse
    # Topologically Sorted Source Nodes: [diagonal_chunked_attention_scores_16], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf255, (12, 512, 64), (64, 768, 1), 0), reinterpret_tensor(buf257, (12, 64, 512), (64, 1, 768), 0), out=buf258)
    del buf255
    del buf257
    buf259 = reinterpret_tensor(buf231, (12, 2, 256, 513), (262656, 513, 1026, 1), 0); del buf231  # reuse
    buf260 = buf229; del buf229  # reuse
    buf261 = buf230; del buf230  # reuse
    buf262 = reinterpret_tensor(buf228, (1, 512, 12, 513), (3151872, 6156, 513, 1), 0); del buf228  # reuse
    buf263 = buf234; del buf234  # reuse
    buf264 = buf233; del buf233  # reuse
    buf265 = buf232; del buf232  # reuse
    cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_59(buf258, buf13, buf259, buf260, buf261, buf262, buf263, buf264, buf265)
    buf266 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf253, (512, 768), (768, 1), 0), _frozen_param386, _frozen_param292, 'none', [-1], '')
    buf267 = buf236; del buf236  # reuse
    buf268 = buf237; del buf237  # reuse
    buf269 = buf238; del buf238  # reuse
    cpp_fused_clone_constant_pad_nd_60(buf266, arg194_1, buf264, buf265, buf267, buf268, buf269)
    buf270 = reinterpret_tensor(buf266, (24, 256, 64), (16384, 64, 1), 0); del buf266  # reuse
    # Topologically Sorted Source Nodes: [context_8], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf268, (24, 256, 768), (197120, 769, 1), 0), reinterpret_tensor(buf269, (24, 768, 64), (49152, 64, 1), 0), out=buf270)
    buf271 = reinterpret_tensor(buf253, (512, 1, 12, 64), (768, 1, 64, 1), 0); del buf253  # reuse
    cpp_fused_clone_61(buf270, buf271)
    del buf270
    buf272 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf271, (512, 768), (768, 1), 0), _frozen_param387, _frozen_param294, 'none', [-1], '')
    buf273 = buf250; del buf250  # reuse
    buf274 = buf249; del buf249  # reuse
    buf276 = buf245; del buf245  # reuse
    buf277 = reinterpret_tensor(buf271, (1, 512, 768), (393216, 768, 1), 0); del buf271  # reuse
    cpp_fused__to_copy_add_native_layer_norm_62(buf272, buf252, _frozen_param136, _frozen_param137, buf273, buf274, buf276, buf277)
    del buf272
    buf278 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf277, (512, 768), (768, 1), 0), _frozen_param388, _frozen_param296, 'gelu', [-1], 'none')
    buf279 = torch.ops.mkldnn._linear_pointwise.default(buf278, _frozen_param389, _frozen_param298, 'none', [-1], '')
    del buf278
    buf280 = buf274; del buf274  # reuse
    buf281 = buf273; del buf273  # reuse
    buf283 = buf252; del buf252  # reuse
    buf284 = reinterpret_tensor(buf277, (512, 1, 768), (768, 393216, 1), 0); del buf277  # reuse
    cpp_fused__to_copy_add_native_layer_norm_63(buf279, buf276, _frozen_param142, _frozen_param143, buf280, buf281, buf283, buf284)
    del buf279
    buf285 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf284, (512, 768), (768, 1), 0), _frozen_param390, _frozen_param300, 'none', [-1], '')
    buf286 = reinterpret_tensor(buf285, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf285  # reuse
    cpp_fused_view_64(buf286)
    buf287 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf284, (512, 768), (768, 1), 0), _frozen_param391, _frozen_param302, 'none', [-1], '')
    buf288 = reinterpret_tensor(buf287, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf287  # reuse
    cpp_fused_view_65(buf288)
    buf289 = buf258; del buf258  # reuse
    # Topologically Sorted Source Nodes: [diagonal_chunked_attention_scores_18], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf286, (12, 512, 64), (64, 768, 1), 0), reinterpret_tensor(buf288, (12, 64, 512), (64, 1, 768), 0), out=buf289)
    del buf286
    del buf288
    buf290 = reinterpret_tensor(buf262, (12, 2, 256, 513), (262656, 513, 1026, 1), 0); del buf262  # reuse
    buf291 = buf260; del buf260  # reuse
    buf292 = buf261; del buf261  # reuse
    buf293 = reinterpret_tensor(buf259, (1, 512, 12, 513), (3151872, 6156, 513, 1), 0); del buf259  # reuse
    buf294 = buf265; del buf265  # reuse
    buf295 = buf264; del buf264  # reuse
    buf296 = buf263; del buf263  # reuse
    cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_66(buf289, buf13, buf290, buf291, buf292, buf293, buf294, buf295, buf296)
    buf297 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf284, (512, 768), (768, 1), 0), _frozen_param392, _frozen_param304, 'none', [-1], '')
    buf298 = buf267; del buf267  # reuse
    buf299 = buf268; del buf268  # reuse
    buf300 = buf269; del buf269  # reuse
    cpp_fused_clone_constant_pad_nd_67(buf297, arg194_1, buf295, buf296, buf298, buf299, buf300)
    buf301 = reinterpret_tensor(buf297, (24, 256, 64), (16384, 64, 1), 0); del buf297  # reuse
    # Topologically Sorted Source Nodes: [context_9], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf299, (24, 256, 768), (197120, 769, 1), 0), reinterpret_tensor(buf300, (24, 768, 64), (49152, 64, 1), 0), out=buf301)
    buf302 = reinterpret_tensor(buf284, (512, 1, 12, 64), (768, 1, 64, 1), 0); del buf284  # reuse
    cpp_fused_clone_68(buf301, buf302)
    del buf301
    buf303 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf302, (512, 768), (768, 1), 0), _frozen_param393, _frozen_param306, 'none', [-1], '')
    buf304 = buf281; del buf281  # reuse
    buf305 = buf280; del buf280  # reuse
    buf307 = buf276; del buf276  # reuse
    buf308 = reinterpret_tensor(buf302, (1, 512, 768), (393216, 768, 1), 0); del buf302  # reuse
    cpp_fused__to_copy_add_native_layer_norm_69(buf303, buf283, _frozen_param152, _frozen_param153, buf304, buf305, buf307, buf308)
    del buf303
    buf309 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf308, (512, 768), (768, 1), 0), _frozen_param394, _frozen_param308, 'gelu', [-1], 'none')
    buf310 = torch.ops.mkldnn._linear_pointwise.default(buf309, _frozen_param395, _frozen_param310, 'none', [-1], '')
    del buf309
    buf311 = buf305; del buf305  # reuse
    buf312 = buf304; del buf304  # reuse
    buf314 = buf283; del buf283  # reuse
    buf315 = reinterpret_tensor(buf308, (512, 1, 768), (768, 393216, 1), 0); del buf308  # reuse
    cpp_fused__to_copy_add_native_layer_norm_70(buf310, buf307, _frozen_param158, _frozen_param159, buf311, buf312, buf314, buf315)
    del buf310
    buf316 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf315, (512, 768), (768, 1), 0), _frozen_param396, _frozen_param312, 'none', [-1], '')
    buf317 = reinterpret_tensor(buf316, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf316  # reuse
    cpp_fused_view_71(buf317)
    buf318 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf315, (512, 768), (768, 1), 0), _frozen_param397, _frozen_param314, 'none', [-1], '')
    buf319 = reinterpret_tensor(buf318, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf318  # reuse
    cpp_fused_view_72(buf319)
    buf320 = buf289; del buf289  # reuse
    # Topologically Sorted Source Nodes: [diagonal_chunked_attention_scores_20], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf317, (12, 512, 64), (64, 768, 1), 0), reinterpret_tensor(buf319, (12, 64, 512), (64, 1, 768), 0), out=buf320)
    del buf317
    del buf319
    buf321 = reinterpret_tensor(buf293, (12, 2, 256, 513), (262656, 513, 1026, 1), 0); del buf293  # reuse
    buf322 = buf291; del buf291  # reuse
    buf323 = buf292; del buf292  # reuse
    buf324 = reinterpret_tensor(buf290, (1, 512, 12, 513), (3151872, 6156, 513, 1), 0); del buf290  # reuse
    buf325 = buf296; del buf296  # reuse
    buf326 = buf295; del buf295  # reuse
    buf327 = buf294; del buf294  # reuse
    cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_73(buf320, buf13, buf321, buf322, buf323, buf324, buf325, buf326, buf327)
    buf328 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf315, (512, 768), (768, 1), 0), _frozen_param398, _frozen_param316, 'none', [-1], '')
    buf329 = buf298; del buf298  # reuse
    buf330 = buf299; del buf299  # reuse
    buf331 = buf300; del buf300  # reuse
    cpp_fused_clone_constant_pad_nd_74(buf328, arg194_1, buf326, buf327, buf329, buf330, buf331)
    buf332 = reinterpret_tensor(buf328, (24, 256, 64), (16384, 64, 1), 0); del buf328  # reuse
    # Topologically Sorted Source Nodes: [context_10], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf330, (24, 256, 768), (197120, 769, 1), 0), reinterpret_tensor(buf331, (24, 768, 64), (49152, 64, 1), 0), out=buf332)
    buf333 = reinterpret_tensor(buf315, (512, 1, 12, 64), (768, 1, 64, 1), 0); del buf315  # reuse
    cpp_fused_clone_75(buf332, buf333)
    del buf332
    buf334 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf333, (512, 768), (768, 1), 0), _frozen_param399, _frozen_param318, 'none', [-1], '')
    buf335 = buf312; del buf312  # reuse
    buf336 = buf311; del buf311  # reuse
    buf338 = buf307; del buf307  # reuse
    buf339 = reinterpret_tensor(buf333, (1, 512, 768), (393216, 768, 1), 0); del buf333  # reuse
    cpp_fused__to_copy_add_native_layer_norm_76(buf334, buf314, _frozen_param168, _frozen_param169, buf335, buf336, buf338, buf339)
    del buf334
    buf340 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf339, (512, 768), (768, 1), 0), _frozen_param400, _frozen_param320, 'gelu', [-1], 'none')
    buf341 = torch.ops.mkldnn._linear_pointwise.default(buf340, _frozen_param401, _frozen_param322, 'none', [-1], '')
    del buf340
    buf342 = buf336; del buf336  # reuse
    buf343 = buf335; del buf335  # reuse
    buf345 = buf314; del buf314  # reuse
    buf346 = reinterpret_tensor(buf339, (512, 1, 768), (768, 393216, 1), 0); del buf339  # reuse
    cpp_fused__to_copy_add_native_layer_norm_77(buf341, buf338, _frozen_param174, _frozen_param175, buf342, buf343, buf345, buf346)
    del buf341
    buf347 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf346, (512, 768), (768, 1), 0), _frozen_param402, _frozen_param324, 'none', [-1], '')
    buf348 = reinterpret_tensor(buf347, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf347  # reuse
    cpp_fused_view_78(buf348)
    buf349 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf346, (512, 768), (768, 1), 0), _frozen_param403, _frozen_param326, 'none', [-1], '')
    buf350 = reinterpret_tensor(buf349, (12, 1, 512, 64), (64, 393216, 768, 1), 0); del buf349  # reuse
    cpp_fused_view_79(buf350)
    buf351 = buf320; del buf320  # reuse
    # Topologically Sorted Source Nodes: [diagonal_chunked_attention_scores_22], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf348, (12, 512, 64), (64, 768, 1), 0), reinterpret_tensor(buf350, (12, 64, 512), (64, 1, 768), 0), out=buf351)
    del buf348
    del buf350
    buf352 = reinterpret_tensor(buf324, (12, 2, 256, 513), (262656, 513, 1026, 1), 0); del buf324  # reuse
    buf353 = buf322; del buf322  # reuse
    buf354 = buf323; del buf323  # reuse
    buf355 = reinterpret_tensor(buf321, (1, 512, 12, 513), (3151872, 6156, 513, 1), 0); del buf321  # reuse
    buf356 = buf327; del buf327  # reuse
    buf357 = buf326; del buf326  # reuse
    buf358 = buf325; del buf325  # reuse
    cpp_fused__softmax__to_copy_add_copy_full_like_new_zeros_where_80(buf351, buf13, buf352, buf353, buf354, buf355, buf356, buf357, buf358)
    del buf13
    del buf351
    del buf352
    del buf353
    del buf354
    del buf355
    del buf356
    buf359 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf346, (512, 768), (768, 1), 0), _frozen_param404, _frozen_param328, 'none', [-1], '')
    buf360 = buf329; del buf329  # reuse
    buf361 = buf330; del buf330  # reuse
    buf362 = buf331; del buf331  # reuse
    cpp_fused_clone_constant_pad_nd_81(buf359, arg194_1, buf357, buf358, buf360, buf361, buf362)
    del arg194_1
    del buf357
    del buf358
    del buf360
    buf363 = reinterpret_tensor(buf359, (24, 256, 64), (16384, 64, 1), 0); del buf359  # reuse
    # Topologically Sorted Source Nodes: [context_11], Original ATen: [aten.bmm]
    extern_kernels.bmm(reinterpret_tensor(buf361, (24, 256, 768), (197120, 769, 1), 0), reinterpret_tensor(buf362, (24, 768, 64), (49152, 64, 1), 0), out=buf363)
    del buf361
    del buf362
    buf364 = reinterpret_tensor(buf346, (512, 1, 12, 64), (768, 1, 64, 1), 0); del buf346  # reuse
    cpp_fused_clone_82(buf363, buf364)
    del buf363
    buf365 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf364, (512, 768), (768, 1), 0), _frozen_param405, _frozen_param330, 'none', [-1], '')
    buf366 = buf343; del buf343  # reuse
    buf367 = buf342; del buf342  # reuse
    buf369 = buf338; del buf338  # reuse
    buf370 = reinterpret_tensor(buf364, (1, 512, 768), (393216, 768, 1), 0); del buf364  # reuse
    cpp_fused__to_copy_add_native_layer_norm_83(buf365, buf345, _frozen_param184, _frozen_param185, buf366, buf367, buf369, buf370)
    del buf365
    buf371 = torch.ops.mkldnn._linear_pointwise.default(reinterpret_tensor(buf370, (512, 768), (768, 1), 0), _frozen_param406, _frozen_param332, 'gelu', [-1], 'none')
    del buf370
    buf372 = torch.ops.mkldnn._linear_pointwise.default(buf371, _frozen_param407, _frozen_param334, 'none', [-1], '')
    del buf371
    buf373 = buf367; del buf367  # reuse
    buf374 = buf366; del buf366  # reuse
    buf376 = buf345; del buf345  # reuse
    cpp_fused_add_native_layer_norm_84(buf372, buf369, _frozen_param190, _frozen_param191, buf373, buf374, buf376)
    return (buf376, )


def benchmark_compiled_module(times=10, repeat=10):
    from torch._dynamo.testing import rand_strided
    from torch._inductor.utils import print_performance
    global _frozen_param8
    _frozen_param8 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param9
    _frozen_param9 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param14
    _frozen_param14 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param15
    _frozen_param15 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param24
    _frozen_param24 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param25
    _frozen_param25 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param30
    _frozen_param30 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param31
    _frozen_param31 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param40
    _frozen_param40 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param41
    _frozen_param41 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param46
    _frozen_param46 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param47
    _frozen_param47 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param56
    _frozen_param56 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param57
    _frozen_param57 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param62
    _frozen_param62 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param63
    _frozen_param63 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param72
    _frozen_param72 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param73
    _frozen_param73 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param78
    _frozen_param78 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param79
    _frozen_param79 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param88
    _frozen_param88 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param89
    _frozen_param89 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param94
    _frozen_param94 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param95
    _frozen_param95 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param104
    _frozen_param104 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param105
    _frozen_param105 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param110
    _frozen_param110 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param111
    _frozen_param111 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param120
    _frozen_param120 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param121
    _frozen_param121 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param126
    _frozen_param126 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param127
    _frozen_param127 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param136
    _frozen_param136 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param137
    _frozen_param137 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param142
    _frozen_param142 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param143
    _frozen_param143 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param152
    _frozen_param152 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param153
    _frozen_param153 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param158
    _frozen_param158 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param159
    _frozen_param159 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param168
    _frozen_param168 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param169
    _frozen_param169 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param174
    _frozen_param174 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param175
    _frozen_param175 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param184
    _frozen_param184 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param185
    _frozen_param185 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param190
    _frozen_param190 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param191
    _frozen_param191 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.float32)
    global _frozen_param192
    _frozen_param192 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param336
    _frozen_param336 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param194
    _frozen_param194 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param337
    _frozen_param337 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param196
    _frozen_param196 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param338
    _frozen_param338 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param198
    _frozen_param198 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param339
    _frozen_param339 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param200
    _frozen_param200 = rand_strided((3072, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param340
    _frozen_param340 = rand_strided((3072, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param202
    _frozen_param202 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param341
    _frozen_param341 = rand_strided((768, 3072), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param204
    _frozen_param204 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param342
    _frozen_param342 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param206
    _frozen_param206 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param343
    _frozen_param343 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param208
    _frozen_param208 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param344
    _frozen_param344 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param210
    _frozen_param210 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param345
    _frozen_param345 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param212
    _frozen_param212 = rand_strided((3072, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param346
    _frozen_param346 = rand_strided((3072, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param214
    _frozen_param214 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param347
    _frozen_param347 = rand_strided((768, 3072), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param216
    _frozen_param216 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param348
    _frozen_param348 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param218
    _frozen_param218 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param349
    _frozen_param349 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param220
    _frozen_param220 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param350
    _frozen_param350 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param222
    _frozen_param222 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param351
    _frozen_param351 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param224
    _frozen_param224 = rand_strided((3072, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param352
    _frozen_param352 = rand_strided((3072, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param226
    _frozen_param226 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param353
    _frozen_param353 = rand_strided((768, 3072), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param228
    _frozen_param228 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param354
    _frozen_param354 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param230
    _frozen_param230 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param355
    _frozen_param355 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param232
    _frozen_param232 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param356
    _frozen_param356 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param234
    _frozen_param234 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param357
    _frozen_param357 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param236
    _frozen_param236 = rand_strided((3072, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param358
    _frozen_param358 = rand_strided((3072, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param238
    _frozen_param238 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param359
    _frozen_param359 = rand_strided((768, 3072), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param240
    _frozen_param240 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param360
    _frozen_param360 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param242
    _frozen_param242 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param361
    _frozen_param361 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param244
    _frozen_param244 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param362
    _frozen_param362 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param246
    _frozen_param246 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param363
    _frozen_param363 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param248
    _frozen_param248 = rand_strided((3072, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param364
    _frozen_param364 = rand_strided((3072, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param250
    _frozen_param250 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param365
    _frozen_param365 = rand_strided((768, 3072), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param252
    _frozen_param252 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param366
    _frozen_param366 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param254
    _frozen_param254 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param367
    _frozen_param367 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param256
    _frozen_param256 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param368
    _frozen_param368 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param258
    _frozen_param258 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param369
    _frozen_param369 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param260
    _frozen_param260 = rand_strided((3072, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param370
    _frozen_param370 = rand_strided((3072, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param262
    _frozen_param262 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param371
    _frozen_param371 = rand_strided((768, 3072), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param264
    _frozen_param264 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param372
    _frozen_param372 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param266
    _frozen_param266 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param373
    _frozen_param373 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param268
    _frozen_param268 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param374
    _frozen_param374 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param270
    _frozen_param270 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param375
    _frozen_param375 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param272
    _frozen_param272 = rand_strided((3072, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param376
    _frozen_param376 = rand_strided((3072, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param274
    _frozen_param274 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param377
    _frozen_param377 = rand_strided((768, 3072), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param276
    _frozen_param276 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param378
    _frozen_param378 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param278
    _frozen_param278 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param379
    _frozen_param379 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param280
    _frozen_param280 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param380
    _frozen_param380 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param282
    _frozen_param282 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param381
    _frozen_param381 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param284
    _frozen_param284 = rand_strided((3072, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param382
    _frozen_param382 = rand_strided((3072, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param286
    _frozen_param286 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param383
    _frozen_param383 = rand_strided((768, 3072), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param288
    _frozen_param288 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param384
    _frozen_param384 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param290
    _frozen_param290 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param385
    _frozen_param385 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param292
    _frozen_param292 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param386
    _frozen_param386 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param294
    _frozen_param294 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param387
    _frozen_param387 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param296
    _frozen_param296 = rand_strided((3072, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param388
    _frozen_param388 = rand_strided((3072, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param298
    _frozen_param298 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param389
    _frozen_param389 = rand_strided((768, 3072), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param300
    _frozen_param300 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param390
    _frozen_param390 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param302
    _frozen_param302 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param391
    _frozen_param391 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param304
    _frozen_param304 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param392
    _frozen_param392 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param306
    _frozen_param306 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param393
    _frozen_param393 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param308
    _frozen_param308 = rand_strided((3072, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param394
    _frozen_param394 = rand_strided((3072, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param310
    _frozen_param310 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param395
    _frozen_param395 = rand_strided((768, 3072), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param312
    _frozen_param312 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param396
    _frozen_param396 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param314
    _frozen_param314 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param397
    _frozen_param397 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param316
    _frozen_param316 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param398
    _frozen_param398 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param318
    _frozen_param318 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param399
    _frozen_param399 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param320
    _frozen_param320 = rand_strided((3072, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param400
    _frozen_param400 = rand_strided((3072, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param322
    _frozen_param322 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param401
    _frozen_param401 = rand_strided((768, 3072), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param324
    _frozen_param324 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param402
    _frozen_param402 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param326
    _frozen_param326 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param403
    _frozen_param403 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param328
    _frozen_param328 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param404
    _frozen_param404 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param330
    _frozen_param330 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param405
    _frozen_param405 = rand_strided((768, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param332
    _frozen_param332 = rand_strided((3072, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param406
    _frozen_param406 = rand_strided((3072, 768), (1, 0), device='cpu', dtype=torch.bfloat16)
    global _frozen_param334
    _frozen_param334 = rand_strided((768, ), (1, ), device='cpu', dtype=torch.bfloat16)
    global _frozen_param407
    _frozen_param407 = rand_strided((768, 3072), (1, 0), device='cpu', dtype=torch.bfloat16)
    arg192_1 = rand_strided((1, 512, 768), (393216, 768, 1), device='cpu', dtype=torch.float32)
    arg193_1 = rand_strided((1, 512), (512, 1), device='cpu', dtype=torch.float32)
    arg194_1 = rand_strided((1, 512), (512, 1), device='cpu', dtype=torch.bool)
    fn = lambda: call([arg192_1, arg193_1, arg194_1])
    return print_performance(fn, times=times, repeat=repeat)


if __name__ == "__main__":
    from torch._inductor.wrapper_benchmark import compiled_module_main
    compiled_module_main('hf_Longformer', benchmark_compiled_module)
